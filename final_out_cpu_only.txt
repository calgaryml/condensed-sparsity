/home/user/condensed-sparsity/src/condensed_sparsity/v2/condensed_linear.py:142: UserWarning: Sparse CSR tensor support is in beta state. If you miss a functionality in the sparse tensor support, please submit a feature request to https://github.com/pytorch/pytorch/issues. (Triggered internally at ../aten/src/ATen/SparseCsrTensorImpl.cpp:54.)
  torch.clone(self.weight.detach().type(dtype).to_sparse_csr()),
Sparsity 99 with 1 threads using compilation strategy inductor and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
[2023-09-26 04:46:57,606] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:47:35,495] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:47:58,849] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:48:24,671] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:48:50,698] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:49:23,579] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:49:50,921] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:50:19,122] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:50:49,273] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:51:13,584] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:51:41,636] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:52:06,598] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:52:36,784] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:53:03,675] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:53:32,960] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:53:57,524] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:54:24,332] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:54:56,845] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:55:24,842] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:55:53,230] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:56:23,485] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:56:49,103] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:57:17,284] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:57:42,536] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:58:34,114] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:59:05,595] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 04:59:32,412] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:00:03,135] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:00:29,113] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:00:56,592] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:01:26,638] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:01:53,442] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:02:21,694] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:02:50,607] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:03:21,049] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:03:49,694] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:04:50,301] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:05:33,610] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:06:04,137] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:06:30,000] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:06:58,964] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:07:24,419] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:07:51,653] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:08:28,560] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:08:55,657] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:09:24,321] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:09:48,916] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:10:19,493] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 1 threads using compilation strategy inductor and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 1 threads using compilation strategy inductor and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 1 threads using compilation strategy inductor and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[---------------------------------------------------------------------------------------------------------------------------------- Sparsity 99 with 1 threads using compilation strategy inductor and dtype torch.float32 on device cpu. ----------------------------------------------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  structured + csr - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  structured + csr with backend inductor  |  Fine-grained + structured with backend inductor
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        52097.1        [0m[0m  |  [31m[1m          14507.3          [0m[0m  |  [31m[1m        61617.8         [0m[0m  |  [31m[1m  481038.8  [0m[0m  |  [31m[1m             490883.5            [0m[0m  |  [31m[1m                   52715.1                   [0m[0m  |  [31m[1m                      14657.5                       [0m[0m  |  [31m[1m               61460.7                [0m[0m  |  [31m[1m                     3999.6                    [0m[0m
      1024   x 768   |  [31m[1m        25495.3        [0m[0m  |  [31m[1m           7347.9          [0m[0m  |  [31m[1m        30655.1         [0m[0m  |  [31m[1m  190939.2  [0m[0m  |  [31m[1m             181259.2            [0m[0m  |  [31m[1m                   26022.4                   [0m[0m  |  [31m[1m                       7386.0                       [0m[0m  |  [31m[1m               30536.5                [0m[0m  |  [31m[1m                     2064.2                    [0m[0m
      512    x 768   |  [31m[1m        12980.4        [0m[0m  |  [31m[1m           3793.3          [0m[0m  |  [31m[1m        15340.3         [0m[0m  |  [31m[1m   71319.3  [0m[0m  |  [31m[1m              71139.8            [0m[0m  |  [31m[1m                   12989.9                   [0m[0m  |  [31m[1m                       3826.3                       [0m[0m  |  [31m[1m               15337.9                [0m[0m  |  [31m[1m                     1130.1                    [0m[0m
      256    x 768   |  [31m[1m         6498.9        [0m[0m  |  [31m[1m           1904.7          [0m[0m  |  [31m[1m         7707.9         [0m[0m  |  [31m[1m   34640.7  [0m[0m  |  [31m[1m              34376.0            [0m[0m  |  [31m[1m                    6632.7                   [0m[0m  |  [31m[1m                       1982.3                       [0m[0m  |  [31m[1m                7824.9                [0m[0m  |  [31m[1m                      745.4                    [0m[0m
      128    x 768   |  [31m[1m         3490.1        [0m[0m  |  [31m[1m           1080.4          [0m[0m  |  [31m[1m         3909.5         [0m[0m  |  [31m[1m   16165.4  [0m[0m  |  [31m[1m              15922.0            [0m[0m  |  [31m[1m                    3689.2                   [0m[0m  |  [31m[1m                       1146.7                       [0m[0m  |  [31m[1m                3954.7                [0m[0m  |  [2m[91m                      412.4                    [0m[0m
      64     x 768   |  [31m[1m         2039.1        [0m[0m  |  [31m[1m            592.2          [0m[0m  |  [31m[1m         2002.4         [0m[0m  |  [31m[1m    7919.1  [0m[0m  |  [31m[1m               7839.1            [0m[0m  |  [31m[1m                    2187.2                   [0m[0m  |  [2m[91m                        693.2                       [0m[0m  |  [31m[1m                2043.5                [0m[0m  |  [2m[91m                      252.8                    [0m[0m
      32     x 768   |  [2m[91m         1297.8        [0m[0m  |  [2m[91m            371.9          [0m[0m  |  [31m[1m         1031.1         [0m[0m  |  [31m[1m    4091.0  [0m[0m  |  [31m[1m               3919.9            [0m[0m  |  [2m[91m                    1307.8                   [0m[0m  |  [2m[91m                        427.8                       [0m[0m  |  [31m[1m                1083.5                [0m[0m  |                        165.0                    
      16     x 768   |  [2m[91m          893.2        [0m[0m  |  [2m[91m            259.3          [0m[0m  |  [31m[1m          523.5         [0m[0m  |  [31m[1m    2143.1  [0m[0m  |  [31m[1m               1987.7            [0m[0m  |  [2m[91m                     910.4                   [0m[0m  |                          320.1                         |  [31m[1m                 572.2                [0m[0m  |                        155.9                    
      8      x 768   |  [2m[91m         1080.3        [0m[0m  |  [2m[91m            299.0          [0m[0m  |  [2m[91m          279.8         [0m[0m  |  [2m[91m    1171.8  [0m[0m  |  [31m[1m               1038.1            [0m[0m  |  [2m[91m                    1296.5                   [0m[0m  |                          348.7                         |  [2m[91m                 309.1                [0m[0m  |                        160.3                    
      4      x 768   |            602.3          |              172.5            |  [2m[91m          155.3         [0m[0m  |  [2m[91m     650.6  [0m[0m  |  [2m[91m                515.3            [0m[0m  |                       626.7                     |                          233.6                         |                   183.8                  |  [2m[91m                      233.4                    [0m[0m
      2      x 768   |            390.4          |              121.2            |            101.3           |       404.5    |                  265.6              |                       421.5                     |  [34m[1m                        184.4                       [0m[0m  |                   127.3                  |                        135.4                    
      1      x 768   |  [92m[1m          343.5        [0m[0m  |  [92m[1m            106.8          [0m[0m  |  [92m[1m           71.8         [0m[0m  |  [92m[1m     271.6  [0m[0m  |  [92m[1m                143.2            [0m[0m  |  [92m[1m                     381.4                   [0m[0m  |  [92m[1m                        182.1                       [0m[0m  |  [92m[1m                 107.7                [0m[0m  |  [92m[1m                       90.5                    [0m[0m

Times are in microseconds (us).

[---------------------------------------------------------------------------------------------------------------------------------- Sparsity 95 with 1 threads using compilation strategy inductor and dtype torch.float32 on device cpu. ----------------------------------------------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  structured + csr - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  structured + csr with backend inductor  |  Fine-grained + structured with backend inductor
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        51389.7        [0m[0m  |  [31m[1m          17716.6          [0m[0m  |  [31m[1m        248763.6        [0m[0m  |  [31m[1m 2369533.0  [0m[0m  |  [31m[1m            2372447.4            [0m[0m  |  [31m[1m                   52131.5                   [0m[0m  |  [31m[1m                      17595.8                       [0m[0m  |  [31m[1m               250906.8               [0m[0m  |  [31m[1m                    20598.1                    [0m[0m
      1024   x 768   |  [31m[1m        25536.3        [0m[0m  |  [31m[1m           8787.1          [0m[0m  |  [31m[1m        124561.3        [0m[0m  |  [31m[1m 1201366.4  [0m[0m  |  [31m[1m            1206203.0            [0m[0m  |  [31m[1m                   25468.4                   [0m[0m  |  [31m[1m                       8875.0                       [0m[0m  |  [31m[1m               126317.7               [0m[0m  |  [31m[1m                    10748.8                    [0m[0m
      512    x 768   |  [31m[1m        13035.0        [0m[0m  |  [31m[1m           4559.0          [0m[0m  |  [31m[1m         62691.9        [0m[0m  |  [31m[1m  605806.8  [0m[0m  |  [31m[1m             604223.3            [0m[0m  |  [31m[1m                   13164.9                   [0m[0m  |  [31m[1m                       4629.7                       [0m[0m  |  [31m[1m                62771.8               [0m[0m  |  [31m[1m                     5543.2                    [0m[0m
      256    x 768   |  [31m[1m         6850.4        [0m[0m  |  [31m[1m           2387.8          [0m[0m  |  [31m[1m         31184.9        [0m[0m  |  [31m[1m  301925.1  [0m[0m  |  [31m[1m             298854.1            [0m[0m  |  [31m[1m                    6854.4                   [0m[0m  |  [31m[1m                       2465.5                       [0m[0m  |  [31m[1m                31512.2               [0m[0m  |  [31m[1m                     3072.1                    [0m[0m
      128    x 768   |  [31m[1m         3604.9        [0m[0m  |  [31m[1m           1276.6          [0m[0m  |  [31m[1m         15644.0        [0m[0m  |  [31m[1m   94699.3  [0m[0m  |  [31m[1m              94653.1            [0m[0m  |  [31m[1m                    3692.9                   [0m[0m  |  [31m[1m                       1357.1                       [0m[0m  |  [31m[1m                15788.4               [0m[0m  |  [31m[1m                     1636.9                    [0m[0m
      64     x 768   |  [31m[1m         2095.5        [0m[0m  |  [31m[1m            771.2          [0m[0m  |  [31m[1m          7906.7        [0m[0m  |  [31m[1m   42479.8  [0m[0m  |  [31m[1m              42632.2            [0m[0m  |  [31m[1m                    2210.3                   [0m[0m  |  [2m[91m                        795.7                       [0m[0m  |  [31m[1m                 8015.5               [0m[0m  |  [2m[91m                      940.1                    [0m[0m
      32     x 768   |  [2m[91m         1248.1        [0m[0m  |  [2m[91m            452.0          [0m[0m  |  [31m[1m          4027.1        [0m[0m  |  [31m[1m   20860.5  [0m[0m  |  [31m[1m              20389.1            [0m[0m  |  [2m[91m                    1308.7                   [0m[0m  |  [2m[91m                        504.2                       [0m[0m  |  [31m[1m                 4083.3               [0m[0m  |                        566.1                    
      16     x 768   |  [2m[91m          883.8        [0m[0m  |  [2m[91m            352.0          [0m[0m  |  [31m[1m          2132.5        [0m[0m  |  [31m[1m    9973.1  [0m[0m  |  [31m[1m               9781.9            [0m[0m  |  [2m[91m                    1029.5                   [0m[0m  |  [2m[91m                        421.8                       [0m[0m  |  [31m[1m                 2156.8               [0m[0m  |                        540.3                    
      8      x 768   |  [2m[91m         1251.4        [0m[0m  |  [2m[91m            421.2          [0m[0m  |  [2m[91m          1114.4        [0m[0m  |  [31m[1m    5054.1  [0m[0m  |  [31m[1m               4898.4            [0m[0m  |  [2m[91m                    1283.3                   [0m[0m  |  [2m[91m                        480.3                       [0m[0m  |  [2m[91m                 1145.8               [0m[0m  |                        432.0                    
      4      x 768   |  [2m[91m          754.8        [0m[0m  |  [2m[91m            270.5          [0m[0m  |  [2m[91m           620.9        [0m[0m  |  [2m[91m    2639.2  [0m[0m  |  [2m[91m               2492.8            [0m[0m  |  [2m[91m                     780.0                   [0m[0m  |  [2m[91m                        335.2                       [0m[0m  |  [2m[91m                  653.5               [0m[0m  |                        433.9                    
      2      x 768   |            319.4          |  [34m[1m            116.3          [0m[0m  |             349.0          |      1393.5    |                 1256.7              |                       341.1                     |  [34m[1m                        178.9                       [0m[0m  |                    389.0                 |                        449.1                    
      1      x 768   |  [92m[1m          276.9        [0m[0m  |  [92m[1m            106.8          [0m[0m  |  [92m[1m           233.5        [0m[0m  |  [92m[1m     782.5  [0m[0m  |  [92m[1m                638.5            [0m[0m  |  [92m[1m                     292.8                   [0m[0m  |  [92m[1m                        167.5                       [0m[0m  |  [92m[1m                  293.3               [0m[0m  |  [92m[1m                      320.3                    [0m[0m

Times are in microseconds (us).

[---------------------------------------------------------------------------------------------------------------------------------- Sparsity 90 with 1 threads using compilation strategy inductor and dtype torch.float32 on device cpu. ----------------------------------------------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  structured + csr - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  structured + csr with backend inductor  |  Fine-grained + structured with backend inductor
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        50792.0        [0m[0m  |  [31m[1m          19349.2          [0m[0m  |  [31m[1m        489319.2        [0m[0m  |  [31m[1m 5362957.1  [0m[0m  |  [31m[1m            5057709.5            [0m[0m  |  [31m[1m                   53209.7                   [0m[0m  |  [31m[1m                      19537.5                       [0m[0m  |  [31m[1m               470624.3               [0m[0m  |  [31m[1m                    41003.0                    [0m[0m
      1024   x 768   |  [31m[1m        25663.5        [0m[0m  |  [31m[1m           9722.9          [0m[0m  |  [31m[1m        234168.3        [0m[0m  |  [31m[1m 2384418.9  [0m[0m  |  [31m[1m            2384380.7            [0m[0m  |  [31m[1m                   25937.0                   [0m[0m  |  [31m[1m                       9659.4                       [0m[0m  |  [31m[1m               235457.0               [0m[0m  |  [31m[1m                    20162.4                    [0m[0m
      512    x 768   |  [31m[1m        12974.0        [0m[0m  |  [31m[1m           5142.5          [0m[0m  |  [31m[1m        119647.1        [0m[0m  |  [31m[1m 1235894.6  [0m[0m  |  [31m[1m            1242614.1            [0m[0m  |  [31m[1m                   13586.1                   [0m[0m  |  [31m[1m                       5281.2                       [0m[0m  |  [31m[1m               120255.0               [0m[0m  |  [31m[1m                    10286.9                    [0m[0m
      256    x 768   |  [31m[1m         7182.5        [0m[0m  |  [31m[1m           2687.0          [0m[0m  |  [31m[1m         59009.4        [0m[0m  |  [31m[1m  602439.4  [0m[0m  |  [31m[1m             608316.2            [0m[0m  |  [31m[1m                    6978.7                   [0m[0m  |  [31m[1m                       2575.3                       [0m[0m  |  [31m[1m                59214.0               [0m[0m  |  [31m[1m                     5685.2                    [0m[0m
      128    x 768   |  [31m[1m         3600.9        [0m[0m  |  [31m[1m           1455.7          [0m[0m  |  [31m[1m         29241.8        [0m[0m  |  [31m[1m  300225.7  [0m[0m  |  [31m[1m             300782.4            [0m[0m  |  [31m[1m                    3735.2                   [0m[0m  |  [31m[1m                       1532.7                       [0m[0m  |  [31m[1m                29393.5               [0m[0m  |  [31m[1m                     3237.8                    [0m[0m
      64     x 768   |  [31m[1m         2142.8        [0m[0m  |  [31m[1m            859.7          [0m[0m  |  [31m[1m         15088.8        [0m[0m  |  [31m[1m   89408.9  [0m[0m  |  [31m[1m              88677.0            [0m[0m  |  [31m[1m                    2093.8                   [0m[0m  |  [2m[91m                        901.0                       [0m[0m  |  [31m[1m                14845.5               [0m[0m  |  [31m[1m                     1398.7                    [0m[0m
      32     x 768   |  [2m[91m         1287.9        [0m[0m  |  [2m[91m            501.6          [0m[0m  |  [31m[1m          7528.8        [0m[0m  |  [31m[1m   45468.4  [0m[0m  |  [31m[1m              45436.8            [0m[0m  |  [2m[91m                    1356.2                   [0m[0m  |  [2m[91m                        590.2                       [0m[0m  |  [31m[1m                 7561.5               [0m[0m  |  [31m[1m                      753.9                    [0m[0m
      16     x 768   |  [2m[91m          892.4        [0m[0m  |  [2m[91m            348.0          [0m[0m  |  [31m[1m          3849.5        [0m[0m  |  [31m[1m   21013.7  [0m[0m  |  [31m[1m              20680.8            [0m[0m  |  [2m[91m                     959.7                   [0m[0m  |                          412.9                         |  [31m[1m                 3859.4               [0m[0m  |  [2m[91m                      467.8                    [0m[0m
      8      x 768   |  [2m[91m         1010.1        [0m[0m  |  [2m[91m            387.7          [0m[0m  |  [2m[91m          2008.3        [0m[0m  |  [31m[1m    9868.7  [0m[0m  |  [31m[1m               9746.5            [0m[0m  |  [2m[91m                    1071.9                   [0m[0m  |  [2m[91m                        437.9                       [0m[0m  |  [2m[91m                 2041.7               [0m[0m  |  [2m[91m                      276.3                    [0m[0m
      4      x 768   |  [2m[91m          728.9        [0m[0m  |              278.4            |  [2m[91m          1116.2        [0m[0m  |  [2m[91m    5125.2  [0m[0m  |  [2m[91m               5004.1            [0m[0m  |                       760.8                     |                          346.8                         |  [2m[91m                 1178.8               [0m[0m  |                        168.4                    
      2      x 768   |            392.3          |              170.3            |             654.8          |      2666.1    |                 2532.3              |  [34m[1m                     419.1                   [0m[0m  |  [34m[1m                        226.3                       [0m[0m  |                    694.3                 |                        120.2                    
      1      x 768   |  [92m[1m          295.7        [0m[0m  |  [92m[1m            148.4          [0m[0m  |  [92m[1m           437.3        [0m[0m  |  [92m[1m    1454.6  [0m[0m  |  [92m[1m               1302.4            [0m[0m  |  [92m[1m                     385.1                   [0m[0m  |  [92m[1m                        210.3                       [0m[0m  |  [92m[1m                  472.4               [0m[0m  |  [92m[1m                      101.4                    [0m[0m

Times are in microseconds (us).

[---------------------------------------------------------------------------------------------------------------------------------- Sparsity 80 with 1 threads using compilation strategy inductor and dtype torch.float32 on device cpu. ----------------------------------------------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  structured + csr - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  structured + csr with backend inductor  |  Fine-grained + structured with backend inductor
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        51316.1        [0m[0m  |  [31m[1m          20082.4          [0m[0m  |  [31m[1m        929320.4        [0m[0m  |  [31m[1m 9785478.7  [0m[0m  |  [31m[1m            9312256.7            [0m[0m  |  [31m[1m                   51756.5                   [0m[0m  |  [31m[1m                      20170.4                       [0m[0m  |  [31m[1m               929378.5               [0m[0m  |  [31m[1m                    82366.1                    [0m[0m
      1024   x 768   |  [31m[1m        25438.5        [0m[0m  |  [31m[1m          10504.1          [0m[0m  |  [31m[1m        488715.9        [0m[0m  |  [31m[1m 4730047.7  [0m[0m  |  [31m[1m            4731813.9            [0m[0m  |  [31m[1m                   25990.2                   [0m[0m  |  [31m[1m                      10336.8                       [0m[0m  |  [31m[1m               466498.4               [0m[0m  |  [31m[1m                    41326.0                    [0m[0m
      512    x 768   |  [31m[1m        12963.1        [0m[0m  |  [31m[1m           5294.3          [0m[0m  |  [31m[1m        231926.5        [0m[0m  |  [31m[1m 2386028.4  [0m[0m  |  [31m[1m            2391218.9            [0m[0m  |  [31m[1m                   13290.7                   [0m[0m  |  [31m[1m                       5384.3                       [0m[0m  |  [31m[1m               234967.9               [0m[0m  |  [31m[1m                    20975.2                    [0m[0m
      256    x 768   |  [31m[1m         6894.4        [0m[0m  |  [31m[1m           2778.6          [0m[0m  |  [31m[1m        116037.0        [0m[0m  |  [31m[1m 1202966.7  [0m[0m  |  [31m[1m            1260205.3            [0m[0m  |  [31m[1m                    6945.6                   [0m[0m  |  [31m[1m                       2690.9                       [0m[0m  |  [31m[1m               116509.3               [0m[0m  |  [31m[1m                    11117.2                    [0m[0m
      128    x 768   |  [31m[1m         3669.5        [0m[0m  |  [31m[1m           1483.0          [0m[0m  |  [31m[1m         58035.5        [0m[0m  |  [31m[1m  596005.9  [0m[0m  |  [31m[1m             597651.9            [0m[0m  |  [31m[1m                    3675.6                   [0m[0m  |  [31m[1m                       1481.9                       [0m[0m  |  [31m[1m                58139.6               [0m[0m  |  [31m[1m                     5000.5                    [0m[0m
      64     x 768   |  [31m[1m         2051.7        [0m[0m  |  [31m[1m            878.8          [0m[0m  |  [31m[1m         29408.8        [0m[0m  |  [31m[1m  299080.6  [0m[0m  |  [31m[1m             296329.4            [0m[0m  |  [31m[1m                    2066.0                   [0m[0m  |  [2m[91m                        905.1                       [0m[0m  |  [31m[1m                29091.9               [0m[0m  |  [31m[1m                     2732.6                    [0m[0m
      32     x 768   |  [2m[91m         1250.0        [0m[0m  |  [2m[91m            505.7          [0m[0m  |  [31m[1m         14712.1        [0m[0m  |  [31m[1m   85503.9  [0m[0m  |  [31m[1m              94464.4            [0m[0m  |  [2m[91m                    1387.2                   [0m[0m  |  [2m[91m                        604.2                       [0m[0m  |  [31m[1m                14914.2               [0m[0m  |  [31m[1m                     1472.7                    [0m[0m
      16     x 768   |  [2m[91m          892.0        [0m[0m  |  [2m[91m            361.2          [0m[0m  |  [31m[1m          7544.1        [0m[0m  |  [31m[1m   42372.1  [0m[0m  |  [31m[1m              41994.3            [0m[0m  |  [2m[91m                     900.4                   [0m[0m  |                          423.9                         |  [31m[1m                 7539.1               [0m[0m  |  [31m[1m                      781.5                    [0m[0m
      8      x 768   |  [2m[91m          988.8        [0m[0m  |  [2m[91m            398.5          [0m[0m  |  [2m[91m          3875.4        [0m[0m  |  [31m[1m   20259.5  [0m[0m  |  [31m[1m              20123.1            [0m[0m  |  [2m[91m                    1029.3                   [0m[0m  |  [2m[91m                        477.7                       [0m[0m  |  [2m[91m                 3930.9               [0m[0m  |  [2m[91m                      371.0                    [0m[0m
      4      x 768   |            595.3          |              251.2            |  [2m[91m          2158.6        [0m[0m  |  [2m[91m   10001.6  [0m[0m  |  [2m[91m               9858.4            [0m[0m  |                       761.9                     |                          302.3                         |  [2m[91m                 2107.7               [0m[0m  |  [2m[91m                      282.8                    [0m[0m
      2      x 768   |  [92m[1m          300.9        [0m[0m  |  [92m[1m            134.1          [0m[0m  |            1195.7          |      4940.4    |                 4822.8              |  [34m[1m                     417.2                   [0m[0m  |  [34m[1m                        232.3                       [0m[0m  |                   1319.6                 |                        165.7                    
      1      x 768   |            341.9          |              158.4            |  [92m[1m           790.3        [0m[0m  |  [92m[1m    2650.7  [0m[0m  |  [92m[1m               2504.8            [0m[0m  |  [92m[1m                     394.4                   [0m[0m  |  [92m[1m                        221.7                       [0m[0m  |  [92m[1m                  844.8               [0m[0m  |  [92m[1m                      112.5                    [0m[0m

Times are in microseconds (us).
/home/user/build/.venv/lib/python3.10/site-packages/torch/jit/_script.py:1241: UserWarning: `optimize` is deprecated and has no effect. Use `with torch.jit.optimized_execution() instead
  warnings.warn(

Sparsity 99 with 1 threads using compilation strategy script and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 1 threads using compilation strategy script and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 1 threads using compilation strategy script and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 1 threads using compilation strategy script and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[-------------------------------------------------------------------------------------------- Sparsity 99 with 1 threads using compilation strategy script and dtype torch.float32 on device cpu. --------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        51172.0        [0m[0m  |  [31m[1m          14194.3          [0m[0m  |  [31m[1m  478993.1  [0m[0m  |  [31m[1m             478495.3            [0m[0m  |  [31m[1m                  53473.9                  [0m[0m  |  [31m[1m                     15048.5                      [0m[0m  |  [31m[1m                   485101.9                  [0m[0m
      1024   x 768   |  [31m[1m        25544.3        [0m[0m  |  [31m[1m           7380.4          [0m[0m  |  [31m[1m  139733.2  [0m[0m  |  [31m[1m             154388.9            [0m[0m  |  [31m[1m                  28118.0                  [0m[0m  |  [31m[1m                      7811.4                      [0m[0m  |  [31m[1m                   260099.3                  [0m[0m
      512    x 768   |  [31m[1m        13087.6        [0m[0m  |  [31m[1m           3797.9          [0m[0m  |  [31m[1m   68041.9  [0m[0m  |  [31m[1m              67953.6            [0m[0m  |  [31m[1m                  13722.0                  [0m[0m  |  [31m[1m                      3883.5                      [0m[0m  |  [31m[1m                   118183.4                  [0m[0m
      256    x 768   |  [31m[1m         6640.2        [0m[0m  |  [31m[1m           1927.1          [0m[0m  |  [31m[1m   35060.1  [0m[0m  |  [31m[1m              34655.6            [0m[0m  |  [31m[1m                   6697.8                  [0m[0m  |  [31m[1m                      2041.2                      [0m[0m  |  [31m[1m                    32945.0                  [0m[0m
      128    x 768   |  [31m[1m         3425.6        [0m[0m  |  [31m[1m           1027.5          [0m[0m  |  [31m[1m   16819.2  [0m[0m  |  [31m[1m              15807.2            [0m[0m  |  [31m[1m                   6508.3                  [0m[0m  |  [31m[1m                      1069.4                      [0m[0m  |  [31m[1m                    16916.6                  [0m[0m
      64     x 768   |  [31m[1m         2159.5        [0m[0m  |  [31m[1m            628.8          [0m[0m  |  [31m[1m    8119.8  [0m[0m  |  [31m[1m               7995.4            [0m[0m  |  [31m[1m                   3256.7                  [0m[0m  |  [2m[91m                       565.8                      [0m[0m  |  [31m[1m                     8056.1                  [0m[0m
      32     x 768   |  [2m[91m         1329.9        [0m[0m  |  [2m[91m            386.5          [0m[0m  |  [31m[1m    4078.2  [0m[0m  |  [31m[1m               3931.7            [0m[0m  |  [2m[91m                   1630.1                  [0m[0m  |  [2m[91m                       322.8                      [0m[0m  |  [31m[1m                     4069.7                  [0m[0m
      16     x 768   |  [2m[91m          947.4        [0m[0m  |  [2m[91m            262.9          [0m[0m  |  [31m[1m    2170.7  [0m[0m  |  [31m[1m               2026.9            [0m[0m  |  [2m[91m                    826.9                  [0m[0m  |                         201.5                        |  [31m[1m                     2033.2                  [0m[0m
      8      x 768   |  [2m[91m         1042.0        [0m[0m  |  [2m[91m            361.6          [0m[0m  |  [2m[91m    1200.1  [0m[0m  |  [31m[1m               1046.3            [0m[0m  |                      432.4                    |                         160.1                        |  [31m[1m                     1031.2                  [0m[0m
      4      x 768   |            619.2          |              180.1            |  [2m[91m     658.9  [0m[0m  |  [2m[91m                526.0            [0m[0m  |  [34m[1m                    410.5                  [0m[0m  |                         136.8                        |  [2m[91m                      524.8                  [0m[0m
      2      x 768   |            402.2          |              122.4            |       410.4    |                  274.5              |  [34m[1m                    406.2                  [0m[0m  |                         134.1                        |                        278.8                  
      1      x 768   |  [92m[1m          317.3        [0m[0m  |  [92m[1m             93.6          [0m[0m  |  [92m[1m     275.2  [0m[0m  |  [92m[1m                145.6            [0m[0m  |  [92m[1m                    387.9                  [0m[0m  |  [92m[1m                       114.4                      [0m[0m  |  [92m[1m                      142.7                  [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------- Sparsity 95 with 1 threads using compilation strategy script and dtype torch.float32 on device cpu. --------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        53356.8        [0m[0m  |  [31m[1m          18162.6          [0m[0m  |  [31m[1m 2441284.7  [0m[0m  |  [31m[1m            2424944.7            [0m[0m  |  [31m[1m                  53556.8                  [0m[0m  |  [31m[1m                     18097.1                      [0m[0m  |  [31m[1m                  2492819.3                  [0m[0m
      1024   x 768   |  [31m[1m        25740.6        [0m[0m  |  [31m[1m           8875.5          [0m[0m  |  [31m[1m 1228692.1  [0m[0m  |  [31m[1m            1237443.2            [0m[0m  |  [31m[1m                  27583.9                  [0m[0m  |  [31m[1m                      9013.7                      [0m[0m  |  [31m[1m                  1241718.0                  [0m[0m
      512    x 768   |  [31m[1m        13197.5        [0m[0m  |  [31m[1m           4630.7          [0m[0m  |  [31m[1m  616823.8  [0m[0m  |  [31m[1m             610733.8            [0m[0m  |  [31m[1m                  14421.5                  [0m[0m  |  [31m[1m                      4731.3                      [0m[0m  |  [31m[1m                   610447.6                  [0m[0m
      256    x 768   |  [31m[1m         6668.5        [0m[0m  |  [31m[1m           2425.9          [0m[0m  |  [31m[1m  308284.3  [0m[0m  |  [31m[1m             300565.4            [0m[0m  |  [31m[1m                   7068.3                  [0m[0m  |  [31m[1m                      2405.6                      [0m[0m  |  [31m[1m                   301150.5                  [0m[0m
      128    x 768   |  [31m[1m         3837.4        [0m[0m  |  [31m[1m           1357.6          [0m[0m  |  [31m[1m  118293.5  [0m[0m  |  [31m[1m             117302.0            [0m[0m  |  [31m[1m                   6743.6                  [0m[0m  |  [31m[1m                      1433.7                      [0m[0m  |  [31m[1m                   150313.5                  [0m[0m
      64     x 768   |  [31m[1m         2171.1        [0m[0m  |  [31m[1m            733.3          [0m[0m  |  [31m[1m   45456.1  [0m[0m  |  [31m[1m              46218.8            [0m[0m  |  [31m[1m                   3106.8                  [0m[0m  |  [31m[1m                       722.7                      [0m[0m  |  [31m[1m                    45172.3                  [0m[0m
      32     x 768   |  [2m[91m         1363.0        [0m[0m  |  [2m[91m            458.0          [0m[0m  |  [31m[1m   21300.7  [0m[0m  |  [31m[1m              20771.9            [0m[0m  |  [2m[91m                   1550.0                  [0m[0m  |  [2m[91m                       460.8                      [0m[0m  |  [31m[1m                    20988.4                  [0m[0m
      16     x 768   |  [2m[91m          892.0        [0m[0m  |  [2m[91m            313.8          [0m[0m  |  [31m[1m   10234.2  [0m[0m  |  [31m[1m               9863.9            [0m[0m  |  [2m[91m                    828.3                  [0m[0m  |                         268.3                        |  [31m[1m                    10083.6                  [0m[0m
      8      x 768   |  [2m[91m         1016.8        [0m[0m  |  [2m[91m            344.3          [0m[0m  |  [31m[1m    5119.4  [0m[0m  |  [31m[1m               4998.3            [0m[0m  |                      431.3                    |                         172.9                        |  [31m[1m                     4987.4                  [0m[0m
      4      x 768   |  [2m[91m          747.5        [0m[0m  |              268.8            |  [2m[91m    2644.2  [0m[0m  |  [2m[91m               2514.1            [0m[0m  |  [34m[1m                    407.8                  [0m[0m  |                         161.4                        |  [2m[91m                     2537.5                  [0m[0m
      2      x 768   |            385.1          |  [34m[1m            148.3          [0m[0m  |      1454.8    |  [2m[91m               1313.0            [0m[0m  |                      425.3                    |                         171.0                        |                       1308.5                  
      1      x 768   |  [92m[1m          347.4        [0m[0m  |  [92m[1m            136.0          [0m[0m  |  [92m[1m     800.5  [0m[0m  |  [92m[1m                653.7            [0m[0m  |  [92m[1m                    385.3                  [0m[0m  |  [92m[1m                       140.7                      [0m[0m  |  [92m[1m                      654.8                  [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------- Sparsity 90 with 1 threads using compilation strategy script and dtype torch.float32 on device cpu. --------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        53907.4        [0m[0m  |  [31m[1m          19689.9          [0m[0m  |  [31m[1m 4843949.9  [0m[0m  |  [31m[1m            4910184.2            [0m[0m  |  [31m[1m                  54897.4                  [0m[0m  |  [31m[1m                     20567.4                      [0m[0m  |  [31m[1m                  4904120.4                  [0m[0m
      1024   x 768   |  [31m[1m        26499.8        [0m[0m  |  [31m[1m           9910.2          [0m[0m  |  [31m[1m 2471147.2  [0m[0m  |  [31m[1m            2465447.8            [0m[0m  |  [31m[1m                  29189.5                  [0m[0m  |  [31m[1m                     10022.2                      [0m[0m  |  [31m[1m                  2458694.9                  [0m[0m
      512    x 768   |  [31m[1m        13099.6        [0m[0m  |  [31m[1m           5005.5          [0m[0m  |  [31m[1m 1217498.4  [0m[0m  |  [31m[1m            1225636.4            [0m[0m  |  [31m[1m                  14418.4                  [0m[0m  |  [31m[1m                      5195.8                      [0m[0m  |  [31m[1m                  1237268.1                  [0m[0m
      256    x 768   |  [31m[1m         6879.2        [0m[0m  |  [31m[1m           2729.6          [0m[0m  |  [31m[1m  617793.1  [0m[0m  |  [31m[1m             614712.6            [0m[0m  |  [31m[1m                   7113.1                  [0m[0m  |  [31m[1m                      2738.1                      [0m[0m  |  [31m[1m                   620720.7                  [0m[0m
      128    x 768   |  [31m[1m         3845.7        [0m[0m  |  [31m[1m           1443.8          [0m[0m  |  [31m[1m  303528.1  [0m[0m  |  [31m[1m             305391.9            [0m[0m  |  [31m[1m                   6142.4                  [0m[0m  |  [31m[1m                      1536.4                      [0m[0m  |  [31m[1m                   305261.1                  [0m[0m
      64     x 768   |  [31m[1m         2175.9        [0m[0m  |  [31m[1m            846.7          [0m[0m  |  [31m[1m  151063.1  [0m[0m  |  [31m[1m             149401.2            [0m[0m  |  [31m[1m                   3279.2                  [0m[0m  |  [2m[91m                       838.4                      [0m[0m  |  [31m[1m                   152752.2                  [0m[0m
      32     x 768   |  [2m[91m         1303.6        [0m[0m  |  [2m[91m            528.4          [0m[0m  |  [31m[1m   45990.2  [0m[0m  |  [31m[1m              48018.3            [0m[0m  |  [2m[91m                   1736.9                  [0m[0m  |  [2m[91m                       539.7                      [0m[0m  |  [31m[1m                    59248.5                  [0m[0m
      16     x 768   |  [2m[91m          941.1        [0m[0m  |  [2m[91m            352.7          [0m[0m  |  [31m[1m   22519.2  [0m[0m  |  [31m[1m              22045.0            [0m[0m  |  [2m[91m                    860.4                  [0m[0m  |                         272.9                        |  [31m[1m                    21694.1                  [0m[0m
      8      x 768   |  [2m[91m         1264.5        [0m[0m  |  [2m[91m            479.7          [0m[0m  |  [31m[1m   10220.6  [0m[0m  |  [31m[1m              10054.3            [0m[0m  |                      441.5                    |                         193.0                        |  [31m[1m                     9960.0                  [0m[0m
      4      x 768   |            783.7          |              299.7            |  [2m[91m    5155.2  [0m[0m  |  [2m[91m               4894.0            [0m[0m  |  [34m[1m                    415.0                  [0m[0m  |  [34m[1m                       177.3                      [0m[0m  |  [2m[91m                     5012.5                  [0m[0m
      2      x 768   |  [34m[1m          411.0        [0m[0m  |  [34m[1m            171.9          [0m[0m  |      2701.3    |                 2533.9              |  [34m[1m                    419.6                  [0m[0m  |  [34m[1m                       184.6                      [0m[0m  |                       2520.4                  
      1      x 768   |  [92m[1m          394.6        [0m[0m  |  [92m[1m            164.9          [0m[0m  |  [92m[1m    1446.3  [0m[0m  |  [92m[1m               1299.3            [0m[0m  |  [92m[1m                    393.6                  [0m[0m  |  [92m[1m                       168.8                      [0m[0m  |  [92m[1m                     1294.1                  [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------- Sparsity 80 with 1 threads using compilation strategy script and dtype torch.float32 on device cpu. --------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        53259.6        [0m[0m  |  [31m[1m          20584.7          [0m[0m  |  [31m[1m 9376946.5  [0m[0m  |  [31m[1m            9299518.5            [0m[0m  |  [31m[1m                  54056.4                  [0m[0m  |  [31m[1m                     21551.2                      [0m[0m  |  [31m[1m                  9369327.2                  [0m[0m
      1024   x 768   |  [31m[1m        25240.5        [0m[0m  |  [31m[1m          10112.9          [0m[0m  |  [31m[1m 4910225.8  [0m[0m  |  [31m[1m            4726369.6            [0m[0m  |  [31m[1m                  26812.2                  [0m[0m  |  [31m[1m                     10232.0                      [0m[0m  |  [31m[1m                  4745078.0                  [0m[0m
      512    x 768   |  [31m[1m        13208.1        [0m[0m  |  [31m[1m           5464.7          [0m[0m  |  [31m[1m 2390816.3  [0m[0m  |  [31m[1m            2391197.3            [0m[0m  |  [31m[1m                  13780.2                  [0m[0m  |  [31m[1m                      5217.4                      [0m[0m  |  [31m[1m                  2385919.6                  [0m[0m
      256    x 768   |  [31m[1m         6880.7        [0m[0m  |  [31m[1m           2797.0          [0m[0m  |  [31m[1m 1203802.6  [0m[0m  |  [31m[1m            1205174.2            [0m[0m  |  [31m[1m                   6591.6                  [0m[0m  |  [31m[1m                      2824.9                      [0m[0m  |  [31m[1m                  1204925.8                  [0m[0m
      128    x 768   |  [31m[1m         3688.1        [0m[0m  |  [31m[1m           1497.7          [0m[0m  |  [31m[1m  600412.1  [0m[0m  |  [31m[1m             601311.9            [0m[0m  |  [31m[1m                   6188.8                  [0m[0m  |  [31m[1m                      1423.6                      [0m[0m  |  [31m[1m                   599715.4                  [0m[0m
      64     x 768   |  [31m[1m         2076.8        [0m[0m  |  [31m[1m            847.1          [0m[0m  |  [31m[1m  297766.2  [0m[0m  |  [31m[1m             298618.7            [0m[0m  |  [31m[1m                   3164.7                  [0m[0m  |  [2m[91m                       697.9                      [0m[0m  |  [31m[1m                   301669.3                  [0m[0m
      32     x 768   |  [2m[91m         1313.3        [0m[0m  |  [2m[91m            538.1          [0m[0m  |  [31m[1m  114992.1  [0m[0m  |  [31m[1m             113653.1            [0m[0m  |  [2m[91m                   1635.8                  [0m[0m  |  [2m[91m                       445.5                      [0m[0m  |  [31m[1m                   148745.5                  [0m[0m
      16     x 768   |  [2m[91m          938.6        [0m[0m  |  [2m[91m            392.0          [0m[0m  |  [31m[1m   42754.8  [0m[0m  |  [31m[1m              42197.6            [0m[0m  |  [2m[91m                    874.5                  [0m[0m  |                         284.5                        |  [31m[1m                    58308.1                  [0m[0m
      8      x 768   |  [2m[91m         1202.0        [0m[0m  |  [2m[91m            497.7          [0m[0m  |  [31m[1m   20661.0  [0m[0m  |  [31m[1m              20054.5            [0m[0m  |                      429.5                    |  [34m[1m                       183.5                      [0m[0m  |  [31m[1m                    20174.3                  [0m[0m
      4      x 768   |            582.6          |              235.6            |  [2m[91m    9854.2  [0m[0m  |  [2m[91m               9655.2            [0m[0m  |  [34m[1m                    401.8                  [0m[0m  |  [34m[1m                       175.1                      [0m[0m  |  [2m[91m                     9845.2                  [0m[0m
      2      x 768   |  [92m[1m          335.6        [0m[0m  |  [92m[1m            136.4          [0m[0m  |      4912.8    |                 4787.0              |  [34m[1m                    400.6                  [0m[0m  |  [34m[1m                       181.4                      [0m[0m  |                       4878.5                  
      1      x 768   |  [34m[1m          345.4        [0m[0m  |              157.7            |  [92m[1m    2599.8  [0m[0m  |  [92m[1m               2449.0            [0m[0m  |  [92m[1m                    390.1                  [0m[0m  |  [92m[1m                       171.5                      [0m[0m  |  [92m[1m                     2443.9                  [0m[0m

Times are in microseconds (us).

Sparsity 99 with 1 threads using compilation strategy trace and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 1 threads using compilation strategy trace and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 1 threads using compilation strategy trace and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 1 threads using compilation strategy trace and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[------------------------------------------------------------------------------------------- Sparsity 99 with 1 threads using compilation strategy trace and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
1 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        51204.6        [0m[0m  |  [31m[1m          14682.3          [0m[0m  |  [31m[1m  362194.8  [0m[0m  |  [31m[1m             364785.0            [0m[0m  |  [31m[1m                 52710.8                  [0m[0m  |  [31m[1m                     14851.3                     [0m[0m  |  [31m[1m                  473402.8                  [0m[0m
      1024   x 768   |  [31m[1m        25459.4        [0m[0m  |  [31m[1m           7282.7          [0m[0m  |  [31m[1m  151771.2  [0m[0m  |  [31m[1m             151351.0            [0m[0m  |  [31m[1m                 26391.5                  [0m[0m  |  [31m[1m                      7379.7                     [0m[0m  |  [31m[1m                  238032.0                  [0m[0m
      512    x 768   |  [31m[1m        13100.3        [0m[0m  |  [31m[1m           3771.7          [0m[0m  |  [31m[1m   70594.4  [0m[0m  |  [31m[1m              70143.4            [0m[0m  |  [31m[1m                 13232.7                  [0m[0m  |  [31m[1m                      3766.7                     [0m[0m  |  [31m[1m                  118321.9                  [0m[0m
      256    x 768   |  [31m[1m         6837.6        [0m[0m  |  [31m[1m           2044.7          [0m[0m  |  [31m[1m   35576.4  [0m[0m  |  [31m[1m              35255.9            [0m[0m  |  [31m[1m                  6963.7                  [0m[0m  |  [31m[1m                      2034.1                     [0m[0m  |  [31m[1m                   33833.6                  [0m[0m
      128    x 768   |  [31m[1m         3671.7        [0m[0m  |  [31m[1m           1079.8          [0m[0m  |  [31m[1m   15957.3  [0m[0m  |  [31m[1m              15789.6            [0m[0m  |  [31m[1m                  3691.6                  [0m[0m  |  [31m[1m                      1100.1                     [0m[0m  |  [31m[1m                   15836.9                  [0m[0m
      64     x 768   |  [31m[1m         2051.8        [0m[0m  |  [31m[1m            582.1          [0m[0m  |  [31m[1m    8162.7  [0m[0m  |  [31m[1m               8054.2            [0m[0m  |  [31m[1m                  2139.6                  [0m[0m  |  [2m[91m                       596.8                     [0m[0m  |  [31m[1m                    7734.5                  [0m[0m
      32     x 768   |  [2m[91m         1265.6        [0m[0m  |  [2m[91m            364.3          [0m[0m  |  [31m[1m    4067.5  [0m[0m  |  [31m[1m               3898.5            [0m[0m  |  [2m[91m                  1312.5                  [0m[0m  |  [2m[91m                       391.8                     [0m[0m  |  [31m[1m                    3938.0                  [0m[0m
      16     x 768   |  [2m[91m          936.8        [0m[0m  |  [2m[91m            274.3          [0m[0m  |  [31m[1m    2147.1  [0m[0m  |  [31m[1m               2002.0            [0m[0m  |  [2m[91m                   947.0                  [0m[0m  |  [2m[91m                       283.7                     [0m[0m  |  [31m[1m                    2005.6                  [0m[0m
      8      x 768   |  [2m[91m         1217.7        [0m[0m  |  [2m[91m            353.7          [0m[0m  |  [2m[91m    1182.8  [0m[0m  |  [31m[1m               1046.6            [0m[0m  |  [2m[91m                  1230.7                  [0m[0m  |  [2m[91m                       364.6                     [0m[0m  |  [31m[1m                    1046.8                  [0m[0m
      4      x 768   |  [2m[91m          721.4        [0m[0m  |  [2m[91m            221.2          [0m[0m  |  [2m[91m     660.6  [0m[0m  |  [2m[91m                516.4            [0m[0m  |  [2m[91m                   729.1                  [0m[0m  |                         231.2                       |  [2m[91m                     519.7                  [0m[0m
      2      x 768   |  [34m[1m          372.7        [0m[0m  |              121.4            |       404.1    |                  265.9              |  [34m[1m                   387.1                  [0m[0m  |                         132.0                       |                       269.9                  
      1      x 768   |  [92m[1m          343.5        [0m[0m  |  [92m[1m            108.1          [0m[0m  |  [92m[1m     275.2  [0m[0m  |  [92m[1m                146.2            [0m[0m  |  [92m[1m                   357.6                  [0m[0m  |  [92m[1m                       119.9                     [0m[0m  |  [92m[1m                     147.2                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------- Sparsity 95 with 1 threads using compilation strategy trace and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
1 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        51838.2        [0m[0m  |  [31m[1m          17483.5          [0m[0m  |  [31m[1m 2360267.9  [0m[0m  |  [31m[1m            2359590.6            [0m[0m  |  [31m[1m                 51998.0                  [0m[0m  |  [31m[1m                     18072.0                     [0m[0m  |  [31m[1m                 2348742.4                  [0m[0m
      1024   x 768   |  [31m[1m        25434.2        [0m[0m  |  [31m[1m           8702.2          [0m[0m  |  [31m[1m 1173605.6  [0m[0m  |  [31m[1m            1184913.4            [0m[0m  |  [31m[1m                 26805.7                  [0m[0m  |  [31m[1m                      8764.4                     [0m[0m  |  [31m[1m                 1174450.9                  [0m[0m
      512    x 768   |  [31m[1m        12961.0        [0m[0m  |  [31m[1m           4549.5          [0m[0m  |  [31m[1m  587961.9  [0m[0m  |  [31m[1m             589037.1            [0m[0m  |  [31m[1m                 13231.1                  [0m[0m  |  [31m[1m                      4485.8                     [0m[0m  |  [31m[1m                  588554.1                  [0m[0m
      256    x 768   |  [31m[1m         6457.2        [0m[0m  |  [31m[1m           2260.4          [0m[0m  |  [31m[1m  297418.9  [0m[0m  |  [31m[1m             296705.8            [0m[0m  |  [31m[1m                  6689.3                  [0m[0m  |  [31m[1m                      2435.2                     [0m[0m  |  [31m[1m                  300116.2                  [0m[0m
      128    x 768   |  [31m[1m         3654.9        [0m[0m  |  [31m[1m           1301.1          [0m[0m  |  [31m[1m  114255.6  [0m[0m  |  [31m[1m             119044.7            [0m[0m  |  [31m[1m                  3853.8                  [0m[0m  |  [31m[1m                      1345.4                     [0m[0m  |  [31m[1m                  150699.9                  [0m[0m
      64     x 768   |  [31m[1m         2179.2        [0m[0m  |  [31m[1m            756.4          [0m[0m  |  [31m[1m   43461.4  [0m[0m  |  [31m[1m              42870.0            [0m[0m  |  [31m[1m                  2046.1                  [0m[0m  |  [31m[1m                       740.8                     [0m[0m  |  [31m[1m                   42239.5                  [0m[0m
      32     x 768   |  [2m[91m         1269.2        [0m[0m  |  [2m[91m            446.3          [0m[0m  |  [31m[1m   21092.9  [0m[0m  |  [31m[1m              20838.8            [0m[0m  |  [2m[91m                  1350.0                  [0m[0m  |  [2m[91m                       484.2                     [0m[0m  |  [31m[1m                   21598.2                  [0m[0m
      16     x 768   |  [2m[91m          978.4        [0m[0m  |  [2m[91m            342.4          [0m[0m  |  [31m[1m   10537.4  [0m[0m  |  [31m[1m               9827.3            [0m[0m  |  [2m[91m                   956.9                  [0m[0m  |  [2m[91m                       374.4                     [0m[0m  |  [31m[1m                   10226.0                  [0m[0m
      8      x 768   |  [2m[91m         1232.2        [0m[0m  |  [2m[91m            446.7          [0m[0m  |  [31m[1m    5068.4  [0m[0m  |  [31m[1m               4910.7            [0m[0m  |  [2m[91m                  1244.3                  [0m[0m  |  [2m[91m                       457.7                     [0m[0m  |  [31m[1m                    4920.5                  [0m[0m
      4      x 768   |  [2m[91m          743.4        [0m[0m  |              267.1            |  [2m[91m    2662.6  [0m[0m  |  [2m[91m               2529.5            [0m[0m  |  [2m[91m                   754.2                  [0m[0m  |                         273.3                       |  [2m[91m                    2503.2                  [0m[0m
      2      x 768   |            398.8          |  [34m[1m            144.3          [0m[0m  |      1447.8    |  [2m[91m               1299.1            [0m[0m  |                     411.7                    |                         168.0                       |                      1337.1                  
      1      x 768   |  [92m[1m          359.3        [0m[0m  |  [92m[1m            139.6          [0m[0m  |  [92m[1m     842.8  [0m[0m  |  [92m[1m                640.9            [0m[0m  |  [92m[1m                   366.6                  [0m[0m  |  [92m[1m                       144.0                     [0m[0m  |  [92m[1m                     689.0                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------- Sparsity 90 with 1 threads using compilation strategy trace and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
1 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        54066.9        [0m[0m  |  [31m[1m          19979.2          [0m[0m  |  [31m[1m 4716281.3  [0m[0m  |  [31m[1m            4840977.6            [0m[0m  |  [31m[1m                 56312.6                  [0m[0m  |  [31m[1m                     20316.5                     [0m[0m  |  [31m[1m                 4713796.4                  [0m[0m
      1024   x 768   |  [31m[1m        25545.7        [0m[0m  |  [31m[1m           9751.4          [0m[0m  |  [31m[1m 2357844.6  [0m[0m  |  [31m[1m            2359799.3            [0m[0m  |  [31m[1m                 26777.7                  [0m[0m  |  [31m[1m                      9844.1                     [0m[0m  |  [31m[1m                 2366212.1                  [0m[0m
      512    x 768   |  [31m[1m        13168.9        [0m[0m  |  [31m[1m           5034.3          [0m[0m  |  [31m[1m 1210644.8  [0m[0m  |  [31m[1m            1179387.1            [0m[0m  |  [31m[1m                 14057.7                  [0m[0m  |  [31m[1m                      5149.9                     [0m[0m  |  [31m[1m                 1228836.8                  [0m[0m
      256    x 768   |  [31m[1m         6942.1        [0m[0m  |  [31m[1m           2762.5          [0m[0m  |  [31m[1m  612357.0  [0m[0m  |  [31m[1m             612888.0            [0m[0m  |  [31m[1m                  7076.5                  [0m[0m  |  [31m[1m                      2715.1                     [0m[0m  |  [31m[1m                  609670.7                  [0m[0m
      128    x 768   |  [31m[1m         3809.1        [0m[0m  |  [31m[1m           1493.4          [0m[0m  |  [31m[1m  296077.7  [0m[0m  |  [31m[1m             296505.7            [0m[0m  |  [31m[1m                  3700.5                  [0m[0m  |  [31m[1m                      1420.9                     [0m[0m  |  [31m[1m                  298584.0                  [0m[0m
      64     x 768   |  [31m[1m         2055.1        [0m[0m  |  [31m[1m            800.1          [0m[0m  |  [31m[1m  113603.5  [0m[0m  |  [31m[1m             113262.8            [0m[0m  |  [31m[1m                  2116.5                  [0m[0m  |  [31m[1m                       846.8                     [0m[0m  |  [31m[1m                  151351.1                  [0m[0m
      32     x 768   |  [2m[91m         1377.3        [0m[0m  |  [2m[91m            547.0          [0m[0m  |  [31m[1m   48932.7  [0m[0m  |  [31m[1m              48159.7            [0m[0m  |  [2m[91m                  1427.6                  [0m[0m  |  [2m[91m                       565.1                     [0m[0m  |  [31m[1m                   59683.9                  [0m[0m
      16     x 768   |  [2m[91m          932.7        [0m[0m  |  [2m[91m            342.1          [0m[0m  |  [31m[1m   22921.0  [0m[0m  |  [31m[1m              22357.2            [0m[0m  |  [2m[91m                   988.5                  [0m[0m  |  [2m[91m                       398.7                     [0m[0m  |  [31m[1m                   21934.6                  [0m[0m
      8      x 768   |  [2m[91m         1164.9        [0m[0m  |  [2m[91m            446.2          [0m[0m  |  [31m[1m   10342.4  [0m[0m  |  [31m[1m              10078.1            [0m[0m  |  [2m[91m                  1267.0                  [0m[0m  |  [2m[91m                       469.3                     [0m[0m  |  [31m[1m                   10330.7                  [0m[0m
      4      x 768   |  [2m[91m          784.8        [0m[0m  |              302.6            |  [2m[91m    5181.9  [0m[0m  |  [2m[91m               5038.9            [0m[0m  |                     583.4                    |                         228.9                       |  [2m[91m                    4928.6                  [0m[0m
      2      x 768   |  [34m[1m          390.7        [0m[0m  |  [34m[1m            165.7          [0m[0m  |      2664.6    |                 2532.0              |  [34m[1m                   405.4                  [0m[0m  |  [34m[1m                       169.1                     [0m[0m  |                      2564.0                  
      1      x 768   |  [92m[1m          383.3        [0m[0m  |  [92m[1m            153.6          [0m[0m  |  [92m[1m    1470.0  [0m[0m  |  [92m[1m               1300.3            [0m[0m  |  [92m[1m                   396.7                  [0m[0m  |  [92m[1m                       166.5                     [0m[0m  |  [92m[1m                    1293.6                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------- Sparsity 80 with 1 threads using compilation strategy trace and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
1 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        52268.7        [0m[0m  |  [31m[1m          20069.6          [0m[0m  |  [31m[1m 9454646.5  [0m[0m  |  [31m[1m            9456969.8            [0m[0m  |  [31m[1m                 52578.5                  [0m[0m  |  [31m[1m                     20819.0                     [0m[0m  |  [31m[1m                 9580472.5                  [0m[0m
      1024   x 768   |  [31m[1m        25707.9        [0m[0m  |  [31m[1m          10589.5          [0m[0m  |  [31m[1m 4852341.1  [0m[0m  |  [31m[1m            4687573.7            [0m[0m  |  [31m[1m                 27957.0                  [0m[0m  |  [31m[1m                     10469.9                     [0m[0m  |  [31m[1m                 4844969.4                  [0m[0m
      512    x 768   |  [31m[1m        13670.0        [0m[0m  |  [31m[1m           5425.7          [0m[0m  |  [31m[1m 2425161.8  [0m[0m  |  [31m[1m            2344939.9            [0m[0m  |  [31m[1m                 13742.4                  [0m[0m  |  [31m[1m                      5300.6                     [0m[0m  |  [31m[1m                 2354579.6                  [0m[0m
      256    x 768   |  [31m[1m         6516.4        [0m[0m  |  [31m[1m           2639.7          [0m[0m  |  [31m[1m 1186441.7  [0m[0m  |  [31m[1m            1185775.9            [0m[0m  |  [31m[1m                  7091.4                  [0m[0m  |  [31m[1m                      2820.3                     [0m[0m  |  [31m[1m                 1183053.0                  [0m[0m
      128    x 768   |  [31m[1m         3793.3        [0m[0m  |  [31m[1m           1512.3          [0m[0m  |  [31m[1m  613667.3  [0m[0m  |  [31m[1m             612786.2            [0m[0m  |  [31m[1m                  4022.9                  [0m[0m  |  [31m[1m                      1612.6                     [0m[0m  |  [31m[1m                  614650.7                  [0m[0m
      64     x 768   |  [31m[1m         2098.5        [0m[0m  |  [31m[1m            916.0          [0m[0m  |  [31m[1m  237254.9  [0m[0m  |  [31m[1m             239685.9            [0m[0m  |  [31m[1m                  2252.9                  [0m[0m  |  [31m[1m                       915.7                     [0m[0m  |  [31m[1m                  308829.6                  [0m[0m
      32     x 768   |  [2m[91m         1373.2        [0m[0m  |  [2m[91m            570.1          [0m[0m  |  [31m[1m  115610.4  [0m[0m  |  [31m[1m             117363.4            [0m[0m  |  [2m[91m                  1315.8                  [0m[0m  |  [2m[91m                       539.2                     [0m[0m  |  [31m[1m                  147835.6                  [0m[0m
      16     x 768   |  [2m[91m          917.0        [0m[0m  |  [2m[91m            402.8          [0m[0m  |  [31m[1m   42985.2  [0m[0m  |  [31m[1m              42713.0            [0m[0m  |  [2m[91m                  1008.6                  [0m[0m  |  [2m[91m                       425.0                     [0m[0m  |  [31m[1m                   58145.1                  [0m[0m
      8      x 768   |  [2m[91m         1030.4        [0m[0m  |  [2m[91m            422.2          [0m[0m  |  [31m[1m   20629.2  [0m[0m  |  [31m[1m              20328.9            [0m[0m  |  [2m[91m                  1083.6                  [0m[0m  |  [2m[91m                       443.4                     [0m[0m  |  [31m[1m                   20287.4                  [0m[0m
      4      x 768   |            612.7          |              252.9            |  [2m[91m    9888.7  [0m[0m  |  [2m[91m               9691.1            [0m[0m  |                     656.3                    |                         267.1                       |  [2m[91m                    9768.2                  [0m[0m
      2      x 768   |  [92m[1m          324.3        [0m[0m  |  [92m[1m            141.8          [0m[0m  |      4971.7    |  [2m[91m               5010.9            [0m[0m  |  [34m[1m                   405.0                  [0m[0m  |  [34m[1m                       179.1                     [0m[0m  |                      5006.8                  
      1      x 768   |            369.3          |  [92m[1m            140.6          [0m[0m  |  [92m[1m    2628.3  [0m[0m  |  [92m[1m               2484.2            [0m[0m  |  [92m[1m                   395.1                  [0m[0m  |  [92m[1m                       170.7                     [0m[0m  |  [92m[1m                    2537.9                  [0m[0m

Times are in microseconds (us).
[2023-09-26 05:50:02,820] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:50:29,067] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:50:57,623] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:51:25,576] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:51:51,225] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:52:17,612] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:52:41,130] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:53:06,454] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:53:33,602] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:54:02,448] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:54:30,175] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:55:01,382] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:55:27,567] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:55:53,348] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:56:22,134] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:56:46,529] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:57:10,357] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:57:39,140] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:58:06,501] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:58:30,606] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:58:56,416] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:59:20,739] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 05:59:45,676] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:00:13,923] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:00:41,071] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:01:06,737] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:01:33,651] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:02:00,595] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:02:23,068] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:02:46,217] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:03:12,345] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:03:38,848] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:04:05,804] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:04:31,036] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:04:54,593] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:05:21,419] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:05:50,732] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:06:17,806] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:06:44,800] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:07:09,827] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:07:35,406] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:07:57,672] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:08:22,744] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:08:47,193] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:09:16,611] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:09:41,891] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:10:06,875] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:10:31,370] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.

Sparsity 99 with 40 threads using compilation strategy inductor and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 40 threads using compilation strategy inductor and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 40 threads using compilation strategy inductor and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 40 threads using compilation strategy inductor and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[---------------------------------------------------------------------------------------------------------------------------------- Sparsity 99 with 40 threads using compilation strategy inductor and dtype torch.float32 on device cpu. ---------------------------------------------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  structured + csr - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  structured + csr with backend inductor  |  Fine-grained + structured with backend inductor
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         5091.3        [0m[0m  |  [31m[1m           1534.6          [0m[0m  |  [31m[1m         3733.4         [0m[0m  |  [31m[1m  72613.6   [0m[0m  |  [31m[1m             70654.4             [0m[0m  |  [31m[1m                    3201.5                   [0m[0m  |  [31m[1m                       1203.5                       [0m[0m  |  [31m[1m                3589.8                [0m[0m  |  [31m[1m                     3916.7                    [0m[0m
      1024   x 768   |  [31m[1m         2685.0        [0m[0m  |  [31m[1m            866.0          [0m[0m  |  [31m[1m         1830.2         [0m[0m  |  [31m[1m   8355.6   [0m[0m  |  [31m[1m              8123.5             [0m[0m  |  [31m[1m                    1880.3                   [0m[0m  |  [31m[1m                        724.8                       [0m[0m  |  [31m[1m                1982.1                [0m[0m  |  [31m[1m                     1705.0                    [0m[0m
      512    x 768   |  [31m[1m         1022.1        [0m[0m  |  [31m[1m            396.6          [0m[0m  |  [31m[1m         1094.0         [0m[0m  |  [31m[1m   4932.3   [0m[0m  |  [31m[1m              3587.7             [0m[0m  |  [31m[1m                    1041.5                   [0m[0m  |  [31m[1m                        496.5                       [0m[0m  |  [31m[1m                1100.8                [0m[0m  |  [31m[1m                     1152.9                    [0m[0m
      256    x 768   |  [31m[1m          616.7        [0m[0m  |  [31m[1m            252.4          [0m[0m  |  [31m[1m          627.1         [0m[0m  |  [31m[1m   1489.8   [0m[0m  |  [31m[1m              1341.2             [0m[0m  |  [31m[1m                     634.9                   [0m[0m  |  [2m[91m                        344.2                       [0m[0m  |  [31m[1m                 686.5                [0m[0m  |  [31m[1m                      632.6                    [0m[0m
      128    x 768   |  [31m[1m          357.6        [0m[0m  |  [31m[1m            220.0          [0m[0m  |  [31m[1m          402.4         [0m[0m  |  [2m[91m    942.3   [0m[0m  |  [31m[1m               724.4             [0m[0m  |  [31m[1m                     406.2                   [0m[0m  |  [2m[91m                        301.0                       [0m[0m  |  [2m[91m                 459.0                [0m[0m  |  [2m[91m                      402.7                    [0m[0m
      64     x 768   |  [31m[1m          273.8        [0m[0m  |  [31m[1m            162.5          [0m[0m  |  [2m[91m          278.9         [0m[0m  |  [2m[91m    612.2   [0m[0m  |  [2m[91m               432.0             [0m[0m  |  [2m[91m                     304.8                   [0m[0m  |  [2m[91m                        231.9                       [0m[0m  |  [2m[91m                 329.5                [0m[0m  |  [2m[91m                      251.8                    [0m[0m
      32     x 768   |  [31m[1m          214.6        [0m[0m  |  [2m[91m            114.4          [0m[0m  |  [2m[91m          202.3         [0m[0m  |  [2m[91m    534.9   [0m[0m  |  [2m[91m               353.8             [0m[0m  |  [2m[91m                     247.7                   [0m[0m  |                          183.9                         |  [2m[91m                 251.1                [0m[0m  |                        152.0                    
      16     x 768   |  [31m[1m          188.1        [0m[0m  |  [2m[91m             90.1          [0m[0m  |            134.9           |      442.1     |  [2m[91m               265.0             [0m[0m  |  [2m[91m                     221.2                   [0m[0m  |                          155.4                         |                   176.0                  |                        145.7                    
      8      x 768   |             64.4          |               44.1            |             98.7           |      358.0     |  [2m[91m               180.4             [0m[0m  |                        96.6                     |                          107.1                         |                   137.6                  |                        137.7                    
      4      x 768   |             48.9          |               37.1            |             84.3           |      299.1     |                 129.2               |                        80.3                     |                          101.4                         |                   119.1                  |  [2m[91m                      243.7                    [0m[0m
      2      x 768   |  [92m[1m           37.6        [0m[0m  |  [34m[1m             31.8          [0m[0m  |  [92m[1m           75.1         [0m[0m  |      289.5     |                 126.2               |  [34m[1m                      67.2                   [0m[0m  |  [34m[1m                         93.2                       [0m[0m  |  [34m[1m                 107.9                [0m[0m  |                        139.3                    
      1      x 768   |  [92m[1m           37.2        [0m[0m  |  [92m[1m             30.6          [0m[0m  |             99.1           |  [92m[1m    260.2   [0m[0m  |  [92m[1m                86.7             [0m[0m  |  [92m[1m                      64.9                   [0m[0m  |  [92m[1m                         92.1                       [0m[0m  |  [92m[1m                 102.2                [0m[0m  |  [92m[1m                       90.8                    [0m[0m

Times are in microseconds (us).

[---------------------------------------------------------------------------------------------------------------------------------- Sparsity 95 with 40 threads using compilation strategy inductor and dtype torch.float32 on device cpu. ---------------------------------------------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  structured + csr - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  structured + csr with backend inductor  |  Fine-grained + structured with backend inductor
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         3012.4        [0m[0m  |  [31m[1m           1210.6          [0m[0m  |  [31m[1m         9524.5         [0m[0m  |  [31m[1m  303714.5  [0m[0m  |  [31m[1m             331959.0            [0m[0m  |  [31m[1m                    3138.7                   [0m[0m  |  [31m[1m                       1306.7                       [0m[0m  |  [31m[1m                9636.9                [0m[0m  |  [31m[1m                    15162.6                    [0m[0m
      1024   x 768   |  [31m[1m         1731.7        [0m[0m  |  [31m[1m            767.5          [0m[0m  |  [31m[1m         4918.5         [0m[0m  |  [31m[1m  163245.0  [0m[0m  |  [31m[1m             171885.6            [0m[0m  |  [31m[1m                    1820.3                   [0m[0m  |  [31m[1m                        845.9                       [0m[0m  |  [31m[1m                4968.0                [0m[0m  |  [31m[1m                     7958.0                    [0m[0m
      512    x 768   |  [31m[1m         1007.9        [0m[0m  |  [31m[1m            478.3          [0m[0m  |  [31m[1m         2625.7         [0m[0m  |  [31m[1m   86326.0  [0m[0m  |  [31m[1m              89282.5            [0m[0m  |  [31m[1m                    1029.9                   [0m[0m  |  [31m[1m                        571.3                       [0m[0m  |  [31m[1m                3144.0                [0m[0m  |  [31m[1m                     4691.6                    [0m[0m
      256    x 768   |  [31m[1m          621.5        [0m[0m  |  [31m[1m            329.0          [0m[0m  |  [31m[1m         1453.0         [0m[0m  |  [31m[1m   25645.5  [0m[0m  |  [31m[1m              25497.1            [0m[0m  |  [31m[1m                     647.4                   [0m[0m  |  [2m[91m                        418.8                       [0m[0m  |  [31m[1m                1620.5                [0m[0m  |  [31m[1m                     2266.8                    [0m[0m
      128    x 768   |  [31m[1m          357.0        [0m[0m  |  [31m[1m            250.0          [0m[0m  |  [31m[1m          835.7         [0m[0m  |  [31m[1m    5467.6  [0m[0m  |  [31m[1m               5133.1            [0m[0m  |  [31m[1m                     403.8                   [0m[0m  |  [2m[91m                        335.9                       [0m[0m  |  [31m[1m                 888.6                [0m[0m  |  [2m[91m                     1419.9                    [0m[0m
      64     x 768   |  [31m[1m          272.0        [0m[0m  |  [31m[1m            177.8          [0m[0m  |  [31m[1m          499.7         [0m[0m  |  [31m[1m    1973.2  [0m[0m  |  [31m[1m               1704.4            [0m[0m  |  [2m[91m                     308.3                   [0m[0m  |  [2m[91m                        252.1                       [0m[0m  |  [2m[91m                 547.1                [0m[0m  |  [2m[91m                      792.7                    [0m[0m
      32     x 768   |  [31m[1m          218.2        [0m[0m  |  [2m[91m            133.1          [0m[0m  |  [2m[91m          313.3         [0m[0m  |  [2m[91m    1089.3  [0m[0m  |  [31m[1m                935.3            [0m[0m  |  [2m[91m                     252.5                   [0m[0m  |  [2m[91m                        200.1                       [0m[0m  |  [2m[91m                 359.8                [0m[0m  |                        447.2                    
      16     x 768   |  [31m[1m          190.7        [0m[0m  |  [2m[91m            103.2          [0m[0m  |  [2m[91m          209.1         [0m[0m  |  [2m[91m     666.7  [0m[0m  |  [2m[91m                473.2            [0m[0m  |  [2m[91m                     228.8                   [0m[0m  |                          169.5                         |                   251.5                  |                        443.0                    
      8      x 768   |             65.5          |               46.9            |            144.4           |       558.0    |  [2m[91m                370.9            [0m[0m  |                       100.0                     |                          111.6                         |                   182.5                  |                        440.4                    
      4      x 768   |             48.9          |               38.7            |            115.4           |       403.2    |                  222.9              |                        80.0                     |  [34m[1m                        101.9                       [0m[0m  |                   153.4                  |                        438.3                    
      2      x 768   |  [34m[1m           39.0        [0m[0m  |  [34m[1m             33.9          [0m[0m  |            102.2           |       347.7    |                  170.4              |  [34m[1m                      68.3                   [0m[0m  |  [34m[1m                         95.1                       [0m[0m  |  [34m[1m                 138.4                [0m[0m  |                        432.7                    
      1      x 768   |  [92m[1m           36.9        [0m[0m  |  [92m[1m             32.1          [0m[0m  |  [92m[1m           92.8         [0m[0m  |  [92m[1m     314.0  [0m[0m  |  [92m[1m                144.7            [0m[0m  |  [92m[1m                      65.7                   [0m[0m  |  [92m[1m                         93.7                       [0m[0m  |  [92m[1m                 128.3                [0m[0m  |  [92m[1m                      324.0                    [0m[0m

Times are in microseconds (us).

[---------------------------------------------------------------------------------------------------------------------------------- Sparsity 90 with 40 threads using compilation strategy inductor and dtype torch.float32 on device cpu. ---------------------------------------------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  structured + csr - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  structured + csr with backend inductor  |  Fine-grained + structured with backend inductor
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         2847.2        [0m[0m  |  [31m[1m           1225.2          [0m[0m  |  [31m[1m        16041.6         [0m[0m  |  [31m[1m  589772.7  [0m[0m  |  [31m[1m             581750.2            [0m[0m  |  [31m[1m                    2952.2                   [0m[0m  |  [31m[1m                       1295.3                       [0m[0m  |  [31m[1m               15975.9                [0m[0m  |  [31m[1m                    29420.6                    [0m[0m
      1024   x 768   |  [31m[1m         1621.5        [0m[0m  |  [31m[1m            808.6          [0m[0m  |  [31m[1m         8339.4         [0m[0m  |  [31m[1m  311119.3  [0m[0m  |  [31m[1m             308155.1            [0m[0m  |  [31m[1m                    1802.3                   [0m[0m  |  [31m[1m                        870.7                       [0m[0m  |  [31m[1m                8356.0                [0m[0m  |  [31m[1m                    14872.5                    [0m[0m
      512    x 768   |  [31m[1m          978.7        [0m[0m  |  [31m[1m            495.5          [0m[0m  |  [31m[1m         4333.3         [0m[0m  |  [31m[1m  160570.5  [0m[0m  |  [31m[1m             174753.9            [0m[0m  |  [31m[1m                    1069.7                   [0m[0m  |  [31m[1m                        585.6                       [0m[0m  |  [31m[1m                4366.8                [0m[0m  |  [31m[1m                     7803.0                    [0m[0m
      256    x 768   |  [31m[1m          620.3        [0m[0m  |  [31m[1m            341.1          [0m[0m  |  [31m[1m         2303.2         [0m[0m  |  [31m[1m   83020.3  [0m[0m  |  [31m[1m              81377.4            [0m[0m  |  [31m[1m                     665.7                   [0m[0m  |  [2m[91m                        425.4                       [0m[0m  |  [31m[1m                2338.4                [0m[0m  |  [31m[1m                     4278.6                    [0m[0m
      128    x 768   |  [31m[1m          367.5        [0m[0m  |  [31m[1m            264.2          [0m[0m  |  [31m[1m         1271.9         [0m[0m  |  [31m[1m   25933.3  [0m[0m  |  [31m[1m              25757.9            [0m[0m  |  [31m[1m                     404.2                   [0m[0m  |  [2m[91m                        376.5                       [0m[0m  |  [31m[1m                1318.7                [0m[0m  |  [31m[1m                     2423.2                    [0m[0m
      64     x 768   |  [31m[1m          271.6        [0m[0m  |  [31m[1m            184.1          [0m[0m  |  [31m[1m          740.5         [0m[0m  |  [31m[1m    5531.5  [0m[0m  |  [31m[1m               5188.6            [0m[0m  |  [2m[91m                     306.6                   [0m[0m  |  [2m[91m                        255.7                       [0m[0m  |  [31m[1m                 785.3                [0m[0m  |  [31m[1m                     1201.2                    [0m[0m
      32     x 768   |  [31m[1m          215.0        [0m[0m  |  [2m[91m            139.2          [0m[0m  |  [2m[91m          446.5         [0m[0m  |  [31m[1m    1995.1  [0m[0m  |  [31m[1m               1769.0            [0m[0m  |  [2m[91m                     253.8                   [0m[0m  |  [2m[91m                        215.6                       [0m[0m  |  [2m[91m                 487.6                [0m[0m  |  [31m[1m                      646.2                    [0m[0m
      16     x 768   |  [31m[1m          193.7        [0m[0m  |  [2m[91m            107.9          [0m[0m  |  [2m[91m          274.9         [0m[0m  |  [2m[91m    1073.5  [0m[0m  |  [2m[91m                892.4            [0m[0m  |  [2m[91m                     224.8                   [0m[0m  |                          180.1                         |  [2m[91m                 314.7                [0m[0m  |  [2m[91m                      370.5                    [0m[0m
      8      x 768   |             65.4          |               48.1            |            181.6           |       645.4    |  [2m[91m                465.3            [0m[0m  |                       100.9                     |                          110.7                         |                   221.3                  |  [2m[91m                      220.2                    [0m[0m
      4      x 768   |             48.4          |               38.3            |            136.8           |       595.3    |                  422.0              |                        79.7                     |  [34m[1m                        101.6                       [0m[0m  |                   176.4                  |                        147.3                    
      2      x 768   |  [34m[1m           38.9        [0m[0m  |  [34m[1m             33.8          [0m[0m  |  [34m[1m          119.5         [0m[0m  |  [34m[1m     401.2  [0m[0m  |  [34m[1m                223.5            [0m[0m  |  [34m[1m                      67.2                   [0m[0m  |  [34m[1m                         95.6                       [0m[0m  |  [34m[1m                 157.6                [0m[0m  |                        110.8                    
      1      x 768   |  [92m[1m           36.3        [0m[0m  |  [92m[1m             31.7          [0m[0m  |  [92m[1m          109.8         [0m[0m  |  [92m[1m     395.0  [0m[0m  |  [92m[1m                215.9            [0m[0m  |  [92m[1m                      64.0                   [0m[0m  |  [92m[1m                         92.8                       [0m[0m  |  [92m[1m                 147.0                [0m[0m  |  [92m[1m                       92.9                    [0m[0m

Times are in microseconds (us).

[---------------------------------------------------------------------------------------------------------------------------------- Sparsity 80 with 40 threads using compilation strategy inductor and dtype torch.float32 on device cpu. ---------------------------------------------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  structured + csr - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  structured + csr with backend inductor  |  Fine-grained + structured with backend inductor
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         2872.0        [0m[0m  |  [31m[1m           1491.8          [0m[0m  |  [31m[1m        30647.7         [0m[0m  |  [31m[1m 1139045.3  [0m[0m  |  [31m[1m            1108030.1            [0m[0m  |  [31m[1m                    3008.5                   [0m[0m  |  [31m[1m                       1353.5                       [0m[0m  |  [31m[1m               30662.7                [0m[0m  |  [31m[1m                    59527.5                    [0m[0m
      1024   x 768   |  [31m[1m         1714.5        [0m[0m  |  [31m[1m            810.0          [0m[0m  |  [31m[1m        15336.7         [0m[0m  |  [31m[1m  594370.1  [0m[0m  |  [31m[1m             653295.4            [0m[0m  |  [31m[1m                    1686.6                   [0m[0m  |  [31m[1m                        870.0                       [0m[0m  |  [31m[1m               15445.7                [0m[0m  |  [31m[1m                    29763.1                    [0m[0m
      512    x 768   |  [31m[1m          986.6        [0m[0m  |  [31m[1m            471.4          [0m[0m  |  [31m[1m         7916.9         [0m[0m  |  [31m[1m  337746.1  [0m[0m  |  [31m[1m             317301.3            [0m[0m  |  [31m[1m                    1029.5                   [0m[0m  |  [31m[1m                        559.0                       [0m[0m  |  [31m[1m                7973.5                [0m[0m  |  [31m[1m                    15038.1                    [0m[0m
      256    x 768   |  [31m[1m          623.8        [0m[0m  |  [31m[1m            330.6          [0m[0m  |  [31m[1m         4161.2         [0m[0m  |  [31m[1m  172149.1  [0m[0m  |  [31m[1m             178939.4            [0m[0m  |  [31m[1m                     692.8                   [0m[0m  |  [2m[91m                        420.3                       [0m[0m  |  [31m[1m                4139.7                [0m[0m  |  [31m[1m                     8302.8                    [0m[0m
      128    x 768   |  [31m[1m          366.1        [0m[0m  |  [31m[1m            253.0          [0m[0m  |  [31m[1m         2161.8         [0m[0m  |  [31m[1m   83597.4  [0m[0m  |  [31m[1m              82057.1            [0m[0m  |  [31m[1m                     415.7                   [0m[0m  |  [2m[91m                        336.3                       [0m[0m  |  [31m[1m                2206.7                [0m[0m  |  [31m[1m                     4780.9                    [0m[0m
      64     x 768   |  [31m[1m          271.0        [0m[0m  |  [31m[1m            184.4          [0m[0m  |  [31m[1m         1197.3         [0m[0m  |  [31m[1m   25743.2  [0m[0m  |  [31m[1m              25847.6            [0m[0m  |  [2m[91m                     309.4                   [0m[0m  |  [2m[91m                        257.6                       [0m[0m  |  [31m[1m                1230.8                [0m[0m  |  [31m[1m                     2179.7                    [0m[0m
      32     x 768   |  [31m[1m          214.7        [0m[0m  |  [2m[91m            142.1          [0m[0m  |  [31m[1m          700.8         [0m[0m  |  [31m[1m    5769.6  [0m[0m  |  [31m[1m               5438.6            [0m[0m  |  [2m[91m                     248.0                   [0m[0m  |  [2m[91m                        216.1                       [0m[0m  |  [2m[91m                 742.6                [0m[0m  |  [31m[1m                     1173.1                    [0m[0m
      16     x 768   |  [31m[1m          194.6        [0m[0m  |  [2m[91m            108.8          [0m[0m  |  [2m[91m          405.9         [0m[0m  |  [31m[1m    2034.8  [0m[0m  |  [31m[1m               1850.7            [0m[0m  |  [2m[91m                     227.2                   [0m[0m  |                          178.2                         |  [2m[91m                 449.2                [0m[0m  |  [31m[1m                      663.3                    [0m[0m
      8      x 768   |             65.3          |               46.7            |  [2m[91m          254.6         [0m[0m  |  [2m[91m    1045.6  [0m[0m  |  [2m[91m                873.8            [0m[0m  |                        99.3                     |                          111.6                         |                   295.3                  |  [2m[91m                      373.3                    [0m[0m
      4      x 768   |             47.1          |               38.4            |            173.6           |       672.7    |  [2m[91m                454.8            [0m[0m  |                        77.8                     |  [34m[1m                        102.6                       [0m[0m  |                   216.1                  |  [2m[91m                      228.9                    [0m[0m
      2      x 768   |  [34m[1m           38.0        [0m[0m  |  [34m[1m             32.9          [0m[0m  |            136.4           |       608.2    |                  363.8              |  [34m[1m                      67.0                   [0m[0m  |  [34m[1m                         95.4                       [0m[0m  |                   179.3                  |                        151.7                    
      1      x 768   |  [92m[1m           36.9        [0m[0m  |  [92m[1m             32.6          [0m[0m  |  [92m[1m          123.1         [0m[0m  |  [92m[1m     401.5  [0m[0m  |  [92m[1m                221.7            [0m[0m  |  [92m[1m                      63.4                   [0m[0m  |  [92m[1m                         93.8                       [0m[0m  |  [92m[1m                 161.1                [0m[0m  |  [92m[1m                      109.4                    [0m[0m

Times are in microseconds (us).
/home/user/build/.venv/lib/python3.10/site-packages/torch/jit/_script.py:1241: UserWarning: `optimize` is deprecated and has no effect. Use `with torch.jit.optimized_execution() instead
  warnings.warn(

Sparsity 99 with 40 threads using compilation strategy script and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 40 threads using compilation strategy script and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 40 threads using compilation strategy script and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 40 threads using compilation strategy script and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[-------------------------------------------------------------------------------------------- Sparsity 99 with 40 threads using compilation strategy script and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         2996.7        [0m[0m  |  [31m[1m           1030.2          [0m[0m  |  [31m[1m  69503.9   [0m[0m  |  [31m[1m             66198.9             [0m[0m  |  [31m[1m                   3755.7                  [0m[0m  |  [31m[1m                      989.8                       [0m[0m  |  [31m[1m                   64538.0                   [0m[0m
      1024   x 768   |  [31m[1m         1749.1        [0m[0m  |  [31m[1m            628.2          [0m[0m  |  [31m[1m  20582.6   [0m[0m  |  [31m[1m             20140.9             [0m[0m  |  [31m[1m                   1544.5                  [0m[0m  |  [31m[1m                      579.4                       [0m[0m  |  [31m[1m                   31412.1                   [0m[0m
      512    x 768   |  [31m[1m         1046.9        [0m[0m  |  [31m[1m            402.3          [0m[0m  |  [31m[1m   4308.9   [0m[0m  |  [31m[1m              3968.9             [0m[0m  |  [31m[1m                    921.9                  [0m[0m  |  [31m[1m                      364.4                       [0m[0m  |  [31m[1m                   15405.0                   [0m[0m
      256    x 768   |  [31m[1m          622.1        [0m[0m  |  [31m[1m            253.0          [0m[0m  |  [31m[1m   1487.8   [0m[0m  |  [31m[1m              1319.4             [0m[0m  |  [31m[1m                    578.2                  [0m[0m  |  [31m[1m                      284.2                       [0m[0m  |  [31m[1m                    1342.9                   [0m[0m
      128    x 768   |  [31m[1m          352.3        [0m[0m  |  [31m[1m            223.4          [0m[0m  |  [2m[91m    957.8   [0m[0m  |  [31m[1m               731.7             [0m[0m  |  [31m[1m                    420.5                  [0m[0m  |  [31m[1m                      231.5                       [0m[0m  |  [31m[1m                     717.9                   [0m[0m
      64     x 768   |  [31m[1m          264.6        [0m[0m  |  [31m[1m            163.4          [0m[0m  |  [2m[91m    614.5   [0m[0m  |  [31m[1m               434.8             [0m[0m  |  [2m[91m                    239.2                  [0m[0m  |  [2m[91m                      126.3                       [0m[0m  |  [31m[1m                     433.7                   [0m[0m
      32     x 768   |  [31m[1m          216.4        [0m[0m  |  [2m[91m            112.6          [0m[0m  |  [2m[91m    571.0   [0m[0m  |  [2m[91m               385.9             [0m[0m  |  [2m[91m                    156.6                  [0m[0m  |  [2m[91m                      123.9                       [0m[0m  |  [2m[91m                     377.6                   [0m[0m
      16     x 768   |  [31m[1m          190.8        [0m[0m  |  [2m[91m             92.4          [0m[0m  |      436.3     |  [2m[91m               256.2             [0m[0m  |                       86.9                    |                         59.7                         |  [2m[91m                     263.6                   [0m[0m
      8      x 768   |             68.0          |               44.3            |      361.4     |  [2m[91m               182.3             [0m[0m  |                      102.6                    |                         44.6                         |  [2m[91m                     182.0                   [0m[0m
      4      x 768   |             51.6          |               36.4            |      301.7     |                 130.2               |                       63.1                    |  [34m[1m                       39.6                       [0m[0m  |                       149.6                   
      2      x 768   |  [34m[1m           38.4        [0m[0m  |  [34m[1m             32.0          [0m[0m  |      289.8     |                 122.8               |  [34m[1m                     56.2                  [0m[0m  |  [92m[1m                       37.8                       [0m[0m  |                       128.1                   
      1      x 768   |  [92m[1m           36.3        [0m[0m  |  [92m[1m             30.9          [0m[0m  |  [92m[1m    254.8   [0m[0m  |  [92m[1m                86.7             [0m[0m  |  [92m[1m                     55.3                  [0m[0m  |  [34m[1m                       39.8                       [0m[0m  |  [92m[1m                      80.6                   [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------- Sparsity 95 with 40 threads using compilation strategy script and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         2921.5        [0m[0m  |  [31m[1m           1270.8          [0m[0m  |  [31m[1m  304859.5  [0m[0m  |  [31m[1m             305790.1            [0m[0m  |  [31m[1m                   3886.7                  [0m[0m  |  [31m[1m                      1170.7                      [0m[0m  |  [31m[1m                   311969.3                  [0m[0m
      1024   x 768   |  [31m[1m         1631.6        [0m[0m  |  [31m[1m            773.0          [0m[0m  |  [31m[1m  170376.7  [0m[0m  |  [31m[1m             172854.7            [0m[0m  |  [31m[1m                   1517.5                  [0m[0m  |  [31m[1m                       665.5                      [0m[0m  |  [31m[1m                   162355.4                  [0m[0m
      512    x 768   |  [31m[1m         1029.2        [0m[0m  |  [31m[1m            470.9          [0m[0m  |  [31m[1m   88225.6  [0m[0m  |  [31m[1m              83166.7            [0m[0m  |  [31m[1m                    897.1                  [0m[0m  |  [31m[1m                       418.4                      [0m[0m  |  [31m[1m                    84497.9                  [0m[0m
      256    x 768   |  [31m[1m          611.5        [0m[0m  |  [31m[1m            318.6          [0m[0m  |  [31m[1m   40575.7  [0m[0m  |  [31m[1m              40401.5            [0m[0m  |  [31m[1m                    571.9                  [0m[0m  |  [31m[1m                       327.5                      [0m[0m  |  [31m[1m                    40110.2                  [0m[0m
      128    x 768   |  [31m[1m          361.2        [0m[0m  |  [31m[1m            249.8          [0m[0m  |  [31m[1m   20009.1  [0m[0m  |  [31m[1m              19754.7            [0m[0m  |  [31m[1m                    412.1                  [0m[0m  |  [31m[1m                       279.0                      [0m[0m  |  [31m[1m                    19638.2                  [0m[0m
      64     x 768   |  [31m[1m          272.1        [0m[0m  |  [31m[1m            171.3          [0m[0m  |  [31m[1m    2014.8  [0m[0m  |  [31m[1m               1866.9            [0m[0m  |  [2m[91m                    238.5                  [0m[0m  |  [2m[91m                       128.7                      [0m[0m  |  [31m[1m                     2075.1                  [0m[0m
      32     x 768   |  [31m[1m          218.7        [0m[0m  |  [2m[91m            126.6          [0m[0m  |  [2m[91m    1083.7  [0m[0m  |  [31m[1m                920.6            [0m[0m  |  [2m[91m                    154.1                  [0m[0m  |  [2m[91m                        95.6                      [0m[0m  |  [31m[1m                      932.0                  [0m[0m
      16     x 768   |  [31m[1m          190.4        [0m[0m  |  [2m[91m            103.2          [0m[0m  |  [2m[91m     657.2  [0m[0m  |  [2m[91m                460.6            [0m[0m  |                       86.0                    |  [2m[91m                        83.9                      [0m[0m  |  [2m[91m                      471.4                  [0m[0m
      8      x 768   |             66.7          |               47.4            |       608.4    |  [2m[91m                431.4            [0m[0m  |                      101.6                    |                          47.7                        |  [2m[91m                      417.7                  [0m[0m
      4      x 768   |             47.8          |               38.6            |       432.6    |                  252.4              |                       61.4                    |                          41.8                        |  [2m[91m                      267.7                  [0m[0m
      2      x 768   |  [34m[1m           36.8        [0m[0m  |  [34m[1m             33.3          [0m[0m  |  [34m[1m     342.8  [0m[0m  |  [34m[1m                167.3            [0m[0m  |  [34m[1m                     55.5                  [0m[0m  |  [34m[1m                        38.4                      [0m[0m  |                        201.0                  
      1      x 768   |  [92m[1m           36.0        [0m[0m  |  [92m[1m             31.5          [0m[0m  |  [92m[1m     325.3  [0m[0m  |  [92m[1m                157.8            [0m[0m  |  [92m[1m                     51.9                  [0m[0m  |  [92m[1m                        37.6                      [0m[0m  |  [92m[1m                      129.0                  [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------- Sparsity 90 with 40 threads using compilation strategy script and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         2962.2        [0m[0m  |  [31m[1m           1249.7          [0m[0m  |  [31m[1m  580104.0  [0m[0m  |  [31m[1m             584882.0            [0m[0m  |  [31m[1m                   3604.9                  [0m[0m  |  [31m[1m                      1273.8                      [0m[0m  |  [31m[1m                   584456.4                  [0m[0m
      1024   x 768   |  [31m[1m         1759.2        [0m[0m  |  [31m[1m            781.1          [0m[0m  |  [31m[1m  310392.1  [0m[0m  |  [31m[1m             306826.2            [0m[0m  |  [31m[1m                   1621.1                  [0m[0m  |  [31m[1m                       736.0                      [0m[0m  |  [31m[1m                   304128.4                  [0m[0m
      512    x 768   |  [31m[1m         1033.6        [0m[0m  |  [31m[1m            501.6          [0m[0m  |  [31m[1m  171355.6  [0m[0m  |  [31m[1m             161074.7            [0m[0m  |  [31m[1m                    892.1                  [0m[0m  |  [31m[1m                       456.9                      [0m[0m  |  [31m[1m                   161380.5                  [0m[0m
      256    x 768   |  [31m[1m          614.6        [0m[0m  |  [31m[1m            333.7          [0m[0m  |  [31m[1m   80900.5  [0m[0m  |  [31m[1m              80277.8            [0m[0m  |  [31m[1m                    602.2                  [0m[0m  |  [31m[1m                       344.7                      [0m[0m  |  [31m[1m                    85908.2                  [0m[0m
      128    x 768   |  [31m[1m          351.6        [0m[0m  |  [31m[1m            267.5          [0m[0m  |  [31m[1m   40481.9  [0m[0m  |  [31m[1m              40122.8            [0m[0m  |  [31m[1m                    413.5                  [0m[0m  |  [31m[1m                       299.5                      [0m[0m  |  [31m[1m                    40086.8                  [0m[0m
      64     x 768   |  [31m[1m          267.0        [0m[0m  |  [31m[1m            185.2          [0m[0m  |  [31m[1m   20021.1  [0m[0m  |  [31m[1m              19543.4            [0m[0m  |  [2m[91m                    238.6                  [0m[0m  |  [2m[91m                       131.2                      [0m[0m  |  [31m[1m                    19704.1                  [0m[0m
      32     x 768   |  [31m[1m          218.9        [0m[0m  |  [2m[91m            141.6          [0m[0m  |  [31m[1m    2053.4  [0m[0m  |  [31m[1m               1817.3            [0m[0m  |  [2m[91m                    201.7                  [0m[0m  |  [2m[91m                       113.4                      [0m[0m  |  [31m[1m                     6056.1                  [0m[0m
      16     x 768   |  [31m[1m          193.7        [0m[0m  |  [2m[91m            108.1          [0m[0m  |  [2m[91m    1041.1  [0m[0m  |  [31m[1m                889.4            [0m[0m  |                       83.7                    |  [2m[91m                        86.5                      [0m[0m  |  [2m[91m                      933.8                  [0m[0m
      8      x 768   |             69.6          |               45.8            |       643.8    |  [2m[91m                461.1            [0m[0m  |                      101.4                    |                          46.6                        |  [2m[91m                      452.7                  [0m[0m
      4      x 768   |             46.4          |               37.5            |       535.9    |  [2m[91m                369.4            [0m[0m  |                       61.1                    |                          41.3                        |  [2m[91m                      425.6                  [0m[0m
      2      x 768   |  [34m[1m           37.6        [0m[0m  |  [34m[1m             32.3          [0m[0m  |       393.8    |                  220.0              |  [34m[1m                     55.8                  [0m[0m  |  [34m[1m                        38.8                      [0m[0m  |                        261.5                  
      1      x 768   |  [92m[1m           36.4        [0m[0m  |  [92m[1m             30.9          [0m[0m  |  [92m[1m     340.0  [0m[0m  |  [92m[1m                164.0            [0m[0m  |  [92m[1m                     54.8                  [0m[0m  |  [92m[1m                        37.3                      [0m[0m  |  [92m[1m                      207.1                  [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------- Sparsity 80 with 40 threads using compilation strategy script and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         2942.4        [0m[0m  |  [31m[1m           1263.6          [0m[0m  |  [31m[1m 1108234.5  [0m[0m  |  [31m[1m            1162531.2            [0m[0m  |  [31m[1m                   3336.2                  [0m[0m  |  [31m[1m                      1247.4                      [0m[0m  |  [31m[1m                  1105713.3                  [0m[0m
      1024   x 768   |  [31m[1m         1716.7        [0m[0m  |  [31m[1m            770.3          [0m[0m  |  [31m[1m  638671.4  [0m[0m  |  [31m[1m             618616.1            [0m[0m  |  [31m[1m                   1516.4                  [0m[0m  |  [31m[1m                       773.8                      [0m[0m  |  [31m[1m                   581929.7                  [0m[0m
      512    x 768   |  [31m[1m          972.7        [0m[0m  |  [31m[1m            472.4          [0m[0m  |  [31m[1m  311098.8  [0m[0m  |  [31m[1m             301686.1            [0m[0m  |  [31m[1m                    907.2                  [0m[0m  |  [31m[1m                       478.6                      [0m[0m  |  [31m[1m                   304377.6                  [0m[0m
      256    x 768   |  [31m[1m          617.6        [0m[0m  |  [31m[1m            328.6          [0m[0m  |  [31m[1m  158248.6  [0m[0m  |  [31m[1m             162483.8            [0m[0m  |  [31m[1m                    576.3                  [0m[0m  |  [31m[1m                       351.4                      [0m[0m  |  [31m[1m                   158469.2                  [0m[0m
      128    x 768   |  [31m[1m          351.9        [0m[0m  |  [31m[1m            254.0          [0m[0m  |  [31m[1m   83339.9  [0m[0m  |  [31m[1m              84629.8            [0m[0m  |  [31m[1m                    414.9                  [0m[0m  |  [31m[1m                       310.2                      [0m[0m  |  [31m[1m                    81813.3                  [0m[0m
      64     x 768   |  [31m[1m          262.1        [0m[0m  |  [31m[1m            189.6          [0m[0m  |  [31m[1m   39758.0  [0m[0m  |  [31m[1m              39731.4            [0m[0m  |  [2m[91m                    249.6                  [0m[0m  |  [2m[91m                       154.7                      [0m[0m  |  [31m[1m                    40073.8                  [0m[0m
      32     x 768   |  [31m[1m          219.4        [0m[0m  |  [2m[91m            146.2          [0m[0m  |  [31m[1m   13131.5  [0m[0m  |  [31m[1m              13061.7            [0m[0m  |  [2m[91m                    154.5                  [0m[0m  |  [2m[91m                       108.9                      [0m[0m  |  [31m[1m                    19838.9                  [0m[0m
      16     x 768   |  [31m[1m          191.5        [0m[0m  |  [2m[91m            105.9          [0m[0m  |  [31m[1m    2053.0  [0m[0m  |  [31m[1m               1764.8            [0m[0m  |                       86.1                    |  [2m[91m                        90.5                      [0m[0m  |  [31m[1m                     6064.0                  [0m[0m
      8      x 768   |             66.3          |               46.0            |  [2m[91m    1041.5  [0m[0m  |  [2m[91m                884.1            [0m[0m  |                       98.7                    |                          47.3                        |  [2m[91m                      925.3                  [0m[0m
      4      x 768   |             47.6          |               37.5            |       640.0    |  [2m[91m                468.1            [0m[0m  |                       60.9                    |                          40.4                        |                        465.4                  
      2      x 768   |  [34m[1m           36.6        [0m[0m  |  [34m[1m             32.4          [0m[0m  |       562.0    |                  383.0              |  [34m[1m                     55.3                  [0m[0m  |  [34m[1m                        37.5                      [0m[0m  |                        424.2                  
      1      x 768   |  [92m[1m           35.4        [0m[0m  |  [92m[1m             31.4          [0m[0m  |  [92m[1m     396.4  [0m[0m  |  [92m[1m                219.1            [0m[0m  |  [92m[1m                     52.9                  [0m[0m  |  [92m[1m                        36.6                      [0m[0m  |  [92m[1m                      252.9                  [0m[0m

Times are in microseconds (us).

Sparsity 99 with 40 threads using compilation strategy trace and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 40 threads using compilation strategy trace and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 40 threads using compilation strategy trace and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 40 threads using compilation strategy trace and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[------------------------------------------------------------------------------------------ Sparsity 99 with 40 threads using compilation strategy trace and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
40 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         2938.5        [0m[0m  |  [31m[1m           1010.6          [0m[0m  |  [31m[1m  62873.8   [0m[0m  |  [31m[1m             64192.1             [0m[0m  |  [31m[1m                  3976.4                  [0m[0m  |  [31m[1m                      1067.1                     [0m[0m  |  [31m[1m                  63211.2                   [0m[0m
      1024   x 768   |  [31m[1m         1724.0        [0m[0m  |  [31m[1m            623.8          [0m[0m  |  [31m[1m  13847.8   [0m[0m  |  [31m[1m             13209.2             [0m[0m  |  [31m[1m                  1914.5                  [0m[0m  |  [31m[1m                       625.4                     [0m[0m  |  [31m[1m                  31567.6                   [0m[0m
      512    x 768   |  [31m[1m         1001.5        [0m[0m  |  [31m[1m            394.5          [0m[0m  |  [31m[1m   5066.7   [0m[0m  |  [31m[1m              4938.0             [0m[0m  |  [31m[1m                  1048.4                  [0m[0m  |  [31m[1m                       426.3                     [0m[0m  |  [31m[1m                  15221.2                   [0m[0m
      256    x 768   |  [31m[1m          598.5        [0m[0m  |  [31m[1m            252.8          [0m[0m  |  [31m[1m   1515.0   [0m[0m  |  [31m[1m              1375.1             [0m[0m  |  [31m[1m                   625.7                  [0m[0m  |  [31m[1m                       265.1                     [0m[0m  |  [31m[1m                   1470.9                   [0m[0m
      128    x 768   |  [31m[1m          355.1        [0m[0m  |  [31m[1m            234.9          [0m[0m  |  [2m[91m    949.5   [0m[0m  |  [31m[1m               740.9             [0m[0m  |  [31m[1m                   374.1                  [0m[0m  |  [31m[1m                       244.6                     [0m[0m  |  [31m[1m                    728.5                   [0m[0m
      64     x 768   |  [31m[1m          266.2        [0m[0m  |  [31m[1m            163.7          [0m[0m  |  [2m[91m    607.5   [0m[0m  |  [31m[1m               429.9             [0m[0m  |  [31m[1m                   280.7                  [0m[0m  |  [2m[91m                       167.1                     [0m[0m  |  [31m[1m                    435.9                   [0m[0m
      32     x 768   |  [31m[1m          217.0        [0m[0m  |  [2m[91m            116.4          [0m[0m  |  [2m[91m    526.6   [0m[0m  |  [2m[91m               345.8             [0m[0m  |  [31m[1m                   223.4                  [0m[0m  |  [2m[91m                       116.5                     [0m[0m  |  [2m[91m                    399.5                   [0m[0m
      16     x 768   |  [31m[1m          188.6        [0m[0m  |  [2m[91m             88.2          [0m[0m  |      430.3     |  [2m[91m               255.2             [0m[0m  |  [2m[91m                   201.3                  [0m[0m  |  [2m[91m                        95.3                     [0m[0m  |  [2m[91m                    265.5                   [0m[0m
      8      x 768   |             67.3          |               45.3            |      333.5     |                 159.6               |                      76.1                    |                          53.1                       |  [2m[91m                    190.7                   [0m[0m
      4      x 768   |             50.3          |               36.3            |      298.7     |                 130.9               |                      56.6                    |                          44.1                       |                      150.3                   
      2      x 768   |  [34m[1m           38.7        [0m[0m  |  [34m[1m             32.2          [0m[0m  |      285.7     |                 125.5               |  [34m[1m                    46.3                  [0m[0m  |  [34m[1m                        38.1                     [0m[0m  |                      130.6                   
      1      x 768   |  [92m[1m           35.3        [0m[0m  |  [92m[1m             30.4          [0m[0m  |  [92m[1m    247.6   [0m[0m  |  [92m[1m                83.7             [0m[0m  |  [92m[1m                    43.6                  [0m[0m  |  [92m[1m                        36.4                     [0m[0m  |  [92m[1m                     85.2                   [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------ Sparsity 95 with 40 threads using compilation strategy trace and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
40 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         2925.4        [0m[0m  |  [31m[1m           1222.8          [0m[0m  |  [31m[1m  295545.5  [0m[0m  |  [31m[1m             326998.4            [0m[0m  |  [31m[1m                  3242.8                  [0m[0m  |  [31m[1m                      1307.5                     [0m[0m  |  [31m[1m                  310741.9                  [0m[0m
      1024   x 768   |  [31m[1m         1652.8        [0m[0m  |  [31m[1m            809.9          [0m[0m  |  [31m[1m  155079.5  [0m[0m  |  [31m[1m             168236.0            [0m[0m  |  [31m[1m                  1888.4                  [0m[0m  |  [31m[1m                       803.7                     [0m[0m  |  [31m[1m                  156446.6                  [0m[0m
      512    x 768   |  [31m[1m         1315.3        [0m[0m  |  [31m[1m            487.4          [0m[0m  |  [31m[1m   82476.5  [0m[0m  |  [31m[1m              80228.6            [0m[0m  |  [31m[1m                   966.6                  [0m[0m  |  [31m[1m                       502.1                     [0m[0m  |  [31m[1m                   79170.2                  [0m[0m
      256    x 768   |  [31m[1m          573.5        [0m[0m  |  [31m[1m            314.0          [0m[0m  |  [31m[1m   38560.4  [0m[0m  |  [31m[1m              38142.5            [0m[0m  |  [31m[1m                   639.9                  [0m[0m  |  [31m[1m                       338.8                     [0m[0m  |  [31m[1m                   37927.4                  [0m[0m
      128    x 768   |  [31m[1m          356.0        [0m[0m  |  [31m[1m            234.9          [0m[0m  |  [31m[1m   12636.5  [0m[0m  |  [31m[1m              12355.0            [0m[0m  |  [31m[1m                   372.0                  [0m[0m  |  [31m[1m                       259.0                     [0m[0m  |  [31m[1m                   18760.3                  [0m[0m
      64     x 768   |  [31m[1m          268.1        [0m[0m  |  [31m[1m            163.1          [0m[0m  |  [31m[1m    2026.7  [0m[0m  |  [31m[1m               1838.6            [0m[0m  |  [31m[1m                   281.3                  [0m[0m  |  [2m[91m                       174.5                     [0m[0m  |  [31m[1m                    1958.5                  [0m[0m
      32     x 768   |  [31m[1m          215.0        [0m[0m  |  [2m[91m            127.6          [0m[0m  |  [2m[91m    1084.7  [0m[0m  |  [31m[1m                929.4            [0m[0m  |  [31m[1m                   236.4                  [0m[0m  |  [2m[91m                       138.0                     [0m[0m  |  [31m[1m                     951.5                  [0m[0m
      16     x 768   |  [31m[1m          190.7        [0m[0m  |  [2m[91m            101.7          [0m[0m  |  [2m[91m     660.4  [0m[0m  |  [2m[91m                476.6            [0m[0m  |  [2m[91m                   206.4                  [0m[0m  |  [2m[91m                       105.3                     [0m[0m  |  [2m[91m                     466.9                  [0m[0m
      8      x 768   |             65.4          |               50.2            |       548.8    |  [2m[91m                370.3            [0m[0m  |                      78.0                    |                          56.5                       |  [2m[91m                     415.3                  [0m[0m
      4      x 768   |             47.4          |               40.0            |       442.4    |                  260.3              |                      58.9                    |                          45.9                       |                       266.5                  
      2      x 768   |  [34m[1m           37.8        [0m[0m  |  [34m[1m             32.6          [0m[0m  |       338.6    |  [34m[1m                164.4            [0m[0m  |  [34m[1m                    45.4                  [0m[0m  |  [34m[1m                        39.8                     [0m[0m  |                       207.0                  
      1      x 768   |  [92m[1m           34.8        [0m[0m  |  [92m[1m             31.1          [0m[0m  |  [92m[1m     295.2  [0m[0m  |  [92m[1m                157.0            [0m[0m  |  [92m[1m                    42.6                  [0m[0m  |  [92m[1m                        37.5                     [0m[0m  |  [92m[1m                     159.9                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------ Sparsity 90 with 40 threads using compilation strategy trace and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
40 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         2869.5        [0m[0m  |  [31m[1m           1217.9          [0m[0m  |  [31m[1m  568324.7  [0m[0m  |  [31m[1m             567088.9            [0m[0m  |  [31m[1m                  3276.3                  [0m[0m  |  [31m[1m                      1352.8                     [0m[0m  |  [31m[1m                  572101.5                  [0m[0m
      1024   x 768   |  [31m[1m         1648.8        [0m[0m  |  [31m[1m            784.1          [0m[0m  |  [31m[1m  298002.2  [0m[0m  |  [31m[1m             307442.8            [0m[0m  |  [31m[1m                  1718.9                  [0m[0m  |  [31m[1m                       785.9                     [0m[0m  |  [31m[1m                  298756.2                  [0m[0m
      512    x 768   |  [31m[1m          965.7        [0m[0m  |  [31m[1m            509.7          [0m[0m  |  [31m[1m  156243.2  [0m[0m  |  [31m[1m             157227.5            [0m[0m  |  [31m[1m                  1012.6                  [0m[0m  |  [31m[1m                       505.1                     [0m[0m  |  [31m[1m                  157151.4                  [0m[0m
      256    x 768   |  [31m[1m          612.8        [0m[0m  |  [31m[1m            330.1          [0m[0m  |  [31m[1m   82138.2  [0m[0m  |  [31m[1m              83443.7            [0m[0m  |  [31m[1m                   636.4                  [0m[0m  |  [31m[1m                       342.3                     [0m[0m  |  [31m[1m                   79537.7                  [0m[0m
      128    x 768   |  [31m[1m          350.9        [0m[0m  |  [31m[1m            260.9          [0m[0m  |  [31m[1m   38298.7  [0m[0m  |  [31m[1m              38523.1            [0m[0m  |  [31m[1m                   388.1                  [0m[0m  |  [31m[1m                       286.6                     [0m[0m  |  [31m[1m                   38323.8                  [0m[0m
      64     x 768   |  [31m[1m          266.7        [0m[0m  |  [31m[1m            191.3          [0m[0m  |  [31m[1m    5671.9  [0m[0m  |  [31m[1m               5335.1            [0m[0m  |  [31m[1m                   278.3                  [0m[0m  |  [31m[1m                       195.5                     [0m[0m  |  [31m[1m                   18812.3                  [0m[0m
      32     x 768   |  [31m[1m          215.8        [0m[0m  |  [2m[91m            138.1          [0m[0m  |  [31m[1m    2066.3  [0m[0m  |  [31m[1m               1732.6            [0m[0m  |  [31m[1m                   233.6                  [0m[0m  |  [2m[91m                       149.0                     [0m[0m  |  [31m[1m                    5896.2                  [0m[0m
      16     x 768   |  [31m[1m          186.6        [0m[0m  |  [2m[91m            108.3          [0m[0m  |  [2m[91m    1035.4  [0m[0m  |  [2m[91m                877.7            [0m[0m  |  [2m[91m                   204.9                  [0m[0m  |  [2m[91m                       113.6                     [0m[0m  |  [2m[91m                     925.6                  [0m[0m
      8      x 768   |             68.6          |               47.9            |       648.7    |  [2m[91m                457.7            [0m[0m  |                      78.6                    |                          54.9                       |  [2m[91m                     471.8                  [0m[0m
      4      x 768   |             49.3          |               37.4            |       540.8    |                  368.1              |                      58.7                    |                          46.0                       |  [2m[91m                     450.4                  [0m[0m
      2      x 768   |             38.6          |  [34m[1m             32.4          [0m[0m  |  [34m[1m     390.8  [0m[0m  |  [34m[1m                217.2            [0m[0m  |  [34m[1m                    46.3                  [0m[0m  |  [34m[1m                        39.9                     [0m[0m  |                       269.2                  
      1      x 768   |  [92m[1m           34.9        [0m[0m  |  [92m[1m             31.2          [0m[0m  |  [92m[1m     375.0  [0m[0m  |  [92m[1m                200.6            [0m[0m  |  [92m[1m                    42.2                  [0m[0m  |  [92m[1m                        37.0                     [0m[0m  |  [92m[1m                     206.2                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------ Sparsity 80 with 40 threads using compilation strategy trace and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
40 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         2863.0        [0m[0m  |  [31m[1m           1257.6          [0m[0m  |  [31m[1m 1065313.5  [0m[0m  |  [31m[1m            1087727.4            [0m[0m  |  [31m[1m                  3280.9                  [0m[0m  |  [31m[1m                      1237.5                     [0m[0m  |  [31m[1m                 1067294.0                  [0m[0m
      1024   x 768   |  [31m[1m         1691.1        [0m[0m  |  [31m[1m            786.8          [0m[0m  |  [31m[1m  566100.3  [0m[0m  |  [31m[1m             566205.2            [0m[0m  |  [31m[1m                  1688.4                  [0m[0m  |  [31m[1m                       806.6                     [0m[0m  |  [31m[1m                  576279.3                  [0m[0m
      512    x 768   |  [31m[1m          960.0        [0m[0m  |  [31m[1m            477.2          [0m[0m  |  [31m[1m  323375.1  [0m[0m  |  [31m[1m             293814.0            [0m[0m  |  [31m[1m                  1032.6                  [0m[0m  |  [31m[1m                       476.8                     [0m[0m  |  [31m[1m                  295963.7                  [0m[0m
      256    x 768   |  [31m[1m          593.3        [0m[0m  |  [31m[1m            326.7          [0m[0m  |  [31m[1m  155817.4  [0m[0m  |  [31m[1m             165766.2            [0m[0m  |  [31m[1m                   607.5                  [0m[0m  |  [31m[1m                       330.4                     [0m[0m  |  [31m[1m                  156073.2                  [0m[0m
      128    x 768   |  [31m[1m          338.3        [0m[0m  |  [31m[1m            244.1          [0m[0m  |  [31m[1m   84072.5  [0m[0m  |  [31m[1m              79977.9            [0m[0m  |  [31m[1m                   369.1                  [0m[0m  |  [31m[1m                       259.5                     [0m[0m  |  [31m[1m                   81153.0                  [0m[0m
      64     x 768   |  [31m[1m          262.7        [0m[0m  |  [31m[1m            176.3          [0m[0m  |  [31m[1m   38764.8  [0m[0m  |  [31m[1m              38083.3            [0m[0m  |  [31m[1m                   276.6                  [0m[0m  |  [2m[91m                       185.0                     [0m[0m  |  [31m[1m                   37917.3                  [0m[0m
      32     x 768   |  [31m[1m          228.3        [0m[0m  |  [2m[91m            137.2          [0m[0m  |  [31m[1m   12720.4  [0m[0m  |  [31m[1m              12432.7            [0m[0m  |  [31m[1m                   235.7                  [0m[0m  |  [2m[91m                       149.9                     [0m[0m  |  [31m[1m                   19149.8                  [0m[0m
      16     x 768   |  [31m[1m          188.1        [0m[0m  |  [2m[91m            109.8          [0m[0m  |  [31m[1m    2210.4  [0m[0m  |  [31m[1m               1807.7            [0m[0m  |  [2m[91m                   200.6                  [0m[0m  |  [2m[91m                       114.7                     [0m[0m  |  [31m[1m                    5842.6                  [0m[0m
      8      x 768   |             69.5          |               49.7            |  [2m[91m    1030.2  [0m[0m  |  [2m[91m                863.9            [0m[0m  |                      78.0                    |                          56.5                       |  [2m[91m                     919.0                  [0m[0m
      4      x 768   |             47.8          |               37.5            |       645.1    |  [2m[91m                453.2            [0m[0m  |                      58.4                    |                          46.3                       |                       473.6                  
      2      x 768   |  [34m[1m           37.2        [0m[0m  |  [34m[1m             33.0          [0m[0m  |       533.5    |                  370.6              |  [34m[1m                    45.0                  [0m[0m  |  [34m[1m                        40.0                     [0m[0m  |                       412.9                  
      1      x 768   |  [92m[1m           35.5        [0m[0m  |  [92m[1m             31.5          [0m[0m  |  [92m[1m     386.7  [0m[0m  |  [92m[1m                212.7            [0m[0m  |  [92m[1m                    42.2                  [0m[0m  |  [92m[1m                        37.9                     [0m[0m  |  [92m[1m                     258.7                  [0m[0m

Times are in microseconds (us).
[2023-09-26 06:44:00,669] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:44:26,820] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:44:59,355] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:45:28,404] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:45:55,425] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:46:23,903] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:46:51,664] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:47:19,283] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:47:44,692] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:48:18,335] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:48:50,268] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:49:23,295] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:49:49,634] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:50:14,743] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:50:45,376] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:51:11,272] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:51:45,173] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:52:11,015] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:52:41,659] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:53:11,863] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:53:41,355] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:54:10,651] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:54:42,616] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:55:08,425] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:55:34,979] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:56:01,867] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:56:31,965] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:56:59,742] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:57:26,669] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:57:54,691] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:58:19,802] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:58:48,210] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:59:19,819] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 06:59:45,406] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 07:00:14,338] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 07:00:46,222] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 07:01:15,707] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 07:01:49,019] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 07:02:21,071] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 07:02:48,725] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 07:03:16,439] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 07:03:43,419] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 07:04:13,859] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 07:04:40,399] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 07:05:14,884] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 07:05:48,971] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 07:06:16,303] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 07:06:46,306] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.

Sparsity 99 with 80 threads using compilation strategy inductor and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 80 threads using compilation strategy inductor and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 80 threads using compilation strategy inductor and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 80 threads using compilation strategy inductor and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[---------------------------------------------------------------------------------------------------------------------------------- Sparsity 99 with 80 threads using compilation strategy inductor and dtype torch.float32 on device cpu. ---------------------------------------------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  structured + csr - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  structured + csr with backend inductor  |  Fine-grained + structured with backend inductor
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         3431.5        [0m[0m  |  [31m[1m           1416.2          [0m[0m  |  [31m[1m         2764.1         [0m[0m  |  [31m[1m  72755.0   [0m[0m  |  [31m[1m             64260.7             [0m[0m  |  [31m[1m                    3322.9                   [0m[0m  |  [31m[1m                       1192.6                       [0m[0m  |  [31m[1m                4115.1                [0m[0m  |  [31m[1m                     4101.4                    [0m[0m
      1024   x 768   |  [31m[1m         1646.2        [0m[0m  |  [31m[1m            841.0          [0m[0m  |  [31m[1m         1562.1         [0m[0m  |  [31m[1m  23273.8   [0m[0m  |  [31m[1m             22719.8             [0m[0m  |  [31m[1m                    2392.3                   [0m[0m  |  [31m[1m                        914.8                       [0m[0m  |  [31m[1m                1804.8                [0m[0m  |  [31m[1m                     2138.6                    [0m[0m
      512    x 768   |  [31m[1m         1270.5        [0m[0m  |  [31m[1m            475.7          [0m[0m  |  [31m[1m         1282.6         [0m[0m  |  [31m[1m   6197.5   [0m[0m  |  [31m[1m              5612.8             [0m[0m  |  [31m[1m                    1292.5                   [0m[0m  |  [31m[1m                        753.6                       [0m[0m  |  [31m[1m                1317.9                [0m[0m  |  [31m[1m                     1202.7                    [0m[0m
      256    x 768   |  [31m[1m          701.0        [0m[0m  |  [31m[1m            429.3          [0m[0m  |  [31m[1m          708.6         [0m[0m  |  [31m[1m   2023.2   [0m[0m  |  [31m[1m              1344.5             [0m[0m  |  [31m[1m                    1122.3                   [0m[0m  |  [2m[91m                        546.2                       [0m[0m  |  [31m[1m                 866.3                [0m[0m  |  [31m[1m                      669.8                    [0m[0m
      128    x 768   |  [31m[1m          716.7        [0m[0m  |  [31m[1m            365.4          [0m[0m  |  [31m[1m          600.8         [0m[0m  |  [2m[91m   1157.2   [0m[0m  |  [31m[1m               834.6             [0m[0m  |  [31m[1m                     733.1                   [0m[0m  |  [2m[91m                        465.6                       [0m[0m  |  [2m[91m                 662.0                [0m[0m  |  [31m[1m                      459.3                    [0m[0m
      64     x 768   |  [31m[1m          470.4        [0m[0m  |  [2m[91m            242.6          [0m[0m  |  [2m[91m          391.4         [0m[0m  |  [2m[91m   1095.9   [0m[0m  |  [31m[1m               805.7             [0m[0m  |  [2m[91m                     527.2                   [0m[0m  |  [2m[91m                        368.5                       [0m[0m  |  [2m[91m                 502.0                [0m[0m  |  [2m[91m                      262.5                    [0m[0m
      32     x 768   |  [31m[1m          393.8        [0m[0m  |  [2m[91m            166.8          [0m[0m  |  [2m[91m          318.8         [0m[0m  |  [31m[1m   3801.4   [0m[0m  |  [2m[91m               619.3             [0m[0m  |  [2m[91m                     390.4                   [0m[0m  |  [2m[91m                        279.9                       [0m[0m  |  [2m[91m                 347.2                [0m[0m  |  [2m[91m                      193.4                    [0m[0m
      16     x 768   |  [2m[91m          266.3        [0m[0m  |  [2m[91m            142.6          [0m[0m  |            191.1           |      697.0     |                 282.3               |  [2m[91m                     328.0                   [0m[0m  |  [31m[1m                        824.5                       [0m[0m  |                   237.4                  |                        145.9                    
      8      x 768   |            116.4          |               80.8            |            150.3           |  [2m[91m   1165.4   [0m[0m  |  [31m[1m             83337.9             [0m[0m  |  [34m[1m                     122.4                   [0m[0m  |                          156.4                         |                   199.9                  |                        141.2                    
      4      x 768   |             92.3          |               82.3            |            147.9           |  [92m[1m    391.7   [0m[0m  |                 203.2               |  [2m[91m                     293.8                   [0m[0m  |                          171.4                         |                   155.7                  |  [2m[91m                      242.5                    [0m[0m
      2      x 768   |             86.6          |  [34m[1m             68.4          [0m[0m  |            142.0           |      501.9     |  [2m[91m               364.7             [0m[0m  |  [34m[1m                     124.2                   [0m[0m  |  [92m[1m                        130.6                       [0m[0m  |  [2m[91m                 502.6                [0m[0m  |                        140.7                    
      1      x 768   |  [92m[1m           74.3        [0m[0m  |  [92m[1m             64.9          [0m[0m  |  [92m[1m          116.6         [0m[0m  |  [34m[1m    404.4   [0m[0m  |  [92m[1m               155.3             [0m[0m  |  [92m[1m                     118.5                   [0m[0m  |                          172.5                         |  [92m[1m                 137.5                [0m[0m  |  [92m[1m                       89.7                    [0m[0m

Times are in microseconds (us).

[---------------------------------------------------------------------------------------------------------------------------------- Sparsity 95 with 80 threads using compilation strategy inductor and dtype torch.float32 on device cpu. ---------------------------------------------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  structured + csr - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  structured + csr with backend inductor  |  Fine-grained + structured with backend inductor
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         3327.9        [0m[0m  |  [31m[1m           1526.6          [0m[0m  |  [31m[1m         7227.3         [0m[0m  |  [31m[1m  365813.6  [0m[0m  |  [31m[1m             305991.7            [0m[0m  |  [31m[1m                    4767.7                   [0m[0m  |  [31m[1m                       1427.5                       [0m[0m  |  [31m[1m                7368.4                [0m[0m  |  [31m[1m                    20543.7                    [0m[0m
      1024   x 768   |  [31m[1m         2365.3        [0m[0m  |  [31m[1m           1086.3          [0m[0m  |  [31m[1m         4479.4         [0m[0m  |  [31m[1m  175697.0  [0m[0m  |  [31m[1m             157701.7            [0m[0m  |  [31m[1m                    2394.2                   [0m[0m  |  [31m[1m                       1031.3                       [0m[0m  |  [31m[1m                7610.8                [0m[0m  |  [31m[1m                     9775.0                    [0m[0m
      512    x 768   |  [31m[1m         1224.5        [0m[0m  |  [31m[1m            660.7          [0m[0m  |  [31m[1m         2471.8         [0m[0m  |  [31m[1m   86315.7  [0m[0m  |  [31m[1m             105678.1            [0m[0m  |  [31m[1m                    1418.0                   [0m[0m  |  [2m[91m                        780.1                       [0m[0m  |  [31m[1m                2400.6                [0m[0m  |  [31m[1m                     4441.2                    [0m[0m
      256    x 768   |  [31m[1m          736.7        [0m[0m  |  [31m[1m            442.9          [0m[0m  |  [31m[1m         1492.1         [0m[0m  |  [31m[1m   31061.2  [0m[0m  |  [31m[1m              32872.6            [0m[0m  |  [31m[1m                     834.9                   [0m[0m  |  [2m[91m                        513.9                       [0m[0m  |  [31m[1m                1580.7                [0m[0m  |  [31m[1m                     2382.3                    [0m[0m
      128    x 768   |  [31m[1m          728.8        [0m[0m  |  [31m[1m            377.3          [0m[0m  |  [31m[1m         1059.5         [0m[0m  |  [31m[1m    8450.8  [0m[0m  |  [31m[1m               9126.9            [0m[0m  |  [31m[1m                     789.4                   [0m[0m  |  [2m[91m                        511.9                       [0m[0m  |  [31m[1m                1065.4                [0m[0m  |  [2m[91m                     1353.2                    [0m[0m
      64     x 768   |  [31m[1m          441.9        [0m[0m  |  [2m[91m            278.4          [0m[0m  |  [2m[91m          614.6         [0m[0m  |  [31m[1m    2125.9  [0m[0m  |  [31m[1m               1796.3            [0m[0m  |  [31m[1m                     590.2                   [0m[0m  |  [2m[91m                        419.0                       [0m[0m  |  [2m[91m                 731.6                [0m[0m  |  [2m[91m                      847.7                    [0m[0m
      32     x 768   |  [2m[91m          351.5        [0m[0m  |  [2m[91m            263.7          [0m[0m  |  [2m[91m          436.5         [0m[0m  |  [2m[91m    1456.4  [0m[0m  |  [31m[1m               1406.6            [0m[0m  |  [2m[91m                     404.8                   [0m[0m  |                          311.7                         |  [2m[91m                 520.5                [0m[0m  |                        559.9                    
      16     x 768   |  [2m[91m          317.5        [0m[0m  |  [2m[91m            203.4          [0m[0m  |  [2m[91m          330.5         [0m[0m  |  [2m[91m    1980.0  [0m[0m  |  [2m[91m               1012.7            [0m[0m  |  [2m[91m                     323.8                   [0m[0m  |                          199.1                         |  [2m[91m                 383.3                [0m[0m  |                        560.7                    
      8      x 768   |            108.5          |  [2m[91m            135.0          [0m[0m  |            243.1           |  [2m[91m     890.1  [0m[0m  |  [2m[91m                583.6            [0m[0m  |                       202.8                     |  [34m[1m                        158.5                       [0m[0m  |                   246.5                  |                        426.6                    
      4      x 768   |            102.9          |               83.3            |  [92m[1m          150.2         [0m[0m  |       658.7    |  [2m[91m                524.7            [0m[0m  |  [92m[1m                     109.8                   [0m[0m  |  [2m[91m                        337.3                       [0m[0m  |                   256.3                  |                        426.2                    
      2      x 768   |  [92m[1m           82.1        [0m[0m  |  [2m[91m            132.2          [0m[0m  |  [31m[1m         1106.2         [0m[0m  |       620.6    |  [92m[1m                208.9            [0m[0m  |                       123.5                     |  [92m[1m                        156.4                       [0m[0m  |                   226.8                  |                        420.9                    
      1      x 768   |  [2m[91m          171.9        [0m[0m  |  [92m[1m             56.4          [0m[0m  |  [34m[1m          156.5         [0m[0m  |  [92m[1m     400.3  [0m[0m  |  [34m[1m                213.0            [0m[0m  |                       148.7                     |                          227.9                         |  [92m[1m                 191.6                [0m[0m  |  [92m[1m                      312.7                    [0m[0m

Times are in microseconds (us).

[---------------------------------------------------------------------------------------------------------------------------------- Sparsity 90 with 80 threads using compilation strategy inductor and dtype torch.float32 on device cpu. ---------------------------------------------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  structured + csr - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  structured + csr with backend inductor  |  Fine-grained + structured with backend inductor
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         4153.2        [0m[0m  |  [31m[1m           1650.0          [0m[0m  |  [31m[1m        12176.3         [0m[0m  |  [31m[1m  591008.0  [0m[0m  |  [31m[1m             639397.0            [0m[0m  |  [31m[1m                   10049.0                   [0m[0m  |  [31m[1m                       6576.8                       [0m[0m  |  [31m[1m               12115.4                [0m[0m  |  [31m[1m                    41311.2                    [0m[0m
      1024   x 768   |  [31m[1m         2037.3        [0m[0m  |  [31m[1m           1447.2          [0m[0m  |  [31m[1m         6241.5         [0m[0m  |  [31m[1m  371960.2  [0m[0m  |  [31m[1m             350994.6            [0m[0m  |  [31m[1m                    2664.6                   [0m[0m  |  [31m[1m                       1221.8                       [0m[0m  |  [31m[1m                8145.7                [0m[0m  |  [31m[1m                    19257.3                    [0m[0m
      512    x 768   |  [31m[1m         1548.6        [0m[0m  |  [31m[1m            715.5          [0m[0m  |  [31m[1m         4165.7         [0m[0m  |  [31m[1m  172904.6  [0m[0m  |  [31m[1m             172639.7            [0m[0m  |  [31m[1m                    1322.6                   [0m[0m  |  [31m[1m                        875.5                       [0m[0m  |  [31m[1m                4012.6                [0m[0m  |  [31m[1m                     7793.3                    [0m[0m
      256    x 768   |  [31m[1m         2330.9        [0m[0m  |  [31m[1m            441.1          [0m[0m  |  [31m[1m         2430.0         [0m[0m  |  [31m[1m   87771.6  [0m[0m  |  [31m[1m              94011.8            [0m[0m  |  [31m[1m                     801.4                   [0m[0m  |  [31m[1m                        851.5                       [0m[0m  |  [31m[1m                2259.1                [0m[0m  |  [31m[1m                     5851.3                    [0m[0m
      128    x 768   |  [31m[1m         1333.5        [0m[0m  |  [31m[1m            463.5          [0m[0m  |  [31m[1m         1051.9         [0m[0m  |  [31m[1m   34483.4  [0m[0m  |  [31m[1m              36246.4            [0m[0m  |  [31m[1m                     655.4                   [0m[0m  |  [2m[91m                        525.9                       [0m[0m  |  [31m[1m                1579.3                [0m[0m  |  [31m[1m                     3171.7                    [0m[0m
      64     x 768   |  [2m[91m          343.2        [0m[0m  |  [31m[1m            293.8          [0m[0m  |  [2m[91m          758.3         [0m[0m  |  [31m[1m    8443.0  [0m[0m  |  [31m[1m               5265.9            [0m[0m  |  [2m[91m                     533.1                   [0m[0m  |  [31m[1m                        930.8                       [0m[0m  |  [2m[91m                1111.9                [0m[0m  |  [31m[1m                     1332.1                    [0m[0m
      32     x 768   |  [2m[91m          255.9        [0m[0m  |  [2m[91m            206.8          [0m[0m  |  [2m[91m          499.2         [0m[0m  |  [31m[1m    2971.4  [0m[0m  |  [31m[1m               2779.8            [0m[0m  |  [2m[91m                     383.8                   [0m[0m  |  [2m[91m                        349.8                       [0m[0m  |  [2m[91m                 557.3                [0m[0m  |  [31m[1m                      738.8                    [0m[0m
      16     x 768   |  [2m[91m          280.2        [0m[0m  |  [2m[91m            171.9          [0m[0m  |            336.5           |  [2m[91m    1059.9  [0m[0m  |  [2m[91m                895.9            [0m[0m  |  [2m[91m                     325.0                   [0m[0m  |                          275.6                         |  [31m[1m                3650.8                [0m[0m  |  [2m[91m                      441.2                    [0m[0m
      8      x 768   |             99.7          |  [2m[91m            136.1          [0m[0m  |  [31m[1m         1070.6         [0m[0m  |  [2m[91m    1163.2  [0m[0m  |  [2m[91m                814.8            [0m[0m  |                       142.4                     |                          216.5                         |  [92m[1m                 244.2                [0m[0m  |  [2m[91m                      266.4                    [0m[0m
      4      x 768   |            100.4          |  [92m[1m             58.3          [0m[0m  |  [31m[1m         2166.8         [0m[0m  |  [2m[91m    1109.7  [0m[0m  |  [2m[91m                559.5            [0m[0m  |  [92m[1m                     119.2                   [0m[0m  |  [92m[1m                        141.1                       [0m[0m  |                   280.6                  |                        151.3                    
      2      x 768   |            134.1          |  [31m[1m            337.9          [0m[0m  |  [92m[1m          178.4         [0m[0m  |       619.5    |                  351.1              |  [34m[1m                     130.6                   [0m[0m  |  [92m[1m                        140.5                       [0m[0m  |  [34m[1m                 253.5                [0m[0m  |                        134.1                    
      1      x 768   |  [92m[1m           83.2        [0m[0m  |               68.9            |  [2m[91m          677.2         [0m[0m  |  [92m[1m     414.4  [0m[0m  |  [92m[1m                230.5            [0m[0m  |  [34m[1m                     121.9                   [0m[0m  |                          163.0                         |                   270.2                  |  [92m[1m                      104.7                    [0m[0m

Times are in microseconds (us).

[---------------------------------------------------------------------------------------------------------------------------------- Sparsity 80 with 80 threads using compilation strategy inductor and dtype torch.float32 on device cpu. ---------------------------------------------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  structured + csr - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  structured + csr with backend inductor  |  Fine-grained + structured with backend inductor
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         4081.1        [0m[0m  |  [31m[1m           1976.1          [0m[0m  |  [31m[1m        23391.0         [0m[0m  |  [31m[1m 1109005.7  [0m[0m  |  [31m[1m            1127232.8            [0m[0m  |  [31m[1m                    4191.4                   [0m[0m  |  [31m[1m                       2022.9                       [0m[0m  |  [31m[1m               33112.8                [0m[0m  |  [31m[1m                    81296.5                    [0m[0m
      1024   x 768   |  [31m[1m         1742.7        [0m[0m  |  [31m[1m            991.5          [0m[0m  |  [31m[1m        14982.1         [0m[0m  |  [31m[1m  619125.7  [0m[0m  |  [31m[1m             611787.3            [0m[0m  |  [31m[1m                    4489.6                   [0m[0m  |  [31m[1m                       1328.0                       [0m[0m  |  [31m[1m               23039.0                [0m[0m  |  [31m[1m                    40053.4                    [0m[0m
      512    x 768   |  [31m[1m         1297.9        [0m[0m  |  [31m[1m            626.9          [0m[0m  |  [31m[1m         7671.6         [0m[0m  |  [31m[1m  323185.3  [0m[0m  |  [31m[1m             327731.4            [0m[0m  |  [31m[1m                    2111.8                   [0m[0m  |  [31m[1m                        788.4                       [0m[0m  |  [31m[1m                7989.6                [0m[0m  |  [31m[1m                    15656.4                    [0m[0m
      256    x 768   |  [31m[1m          820.4        [0m[0m  |  [31m[1m            479.7          [0m[0m  |  [31m[1m         4075.9         [0m[0m  |  [31m[1m  167621.7  [0m[0m  |  [31m[1m             174037.9            [0m[0m  |  [31m[1m                     775.2                   [0m[0m  |  [2m[91m                        554.6                       [0m[0m  |  [31m[1m                4959.0                [0m[0m  |  [31m[1m                    11482.4                    [0m[0m
      128    x 768   |  [31m[1m          569.0        [0m[0m  |  [31m[1m            423.1          [0m[0m  |  [31m[1m         1996.2         [0m[0m  |  [31m[1m   82543.7  [0m[0m  |  [31m[1m              95425.7            [0m[0m  |  [31m[1m                     963.6                   [0m[0m  |  [2m[91m                        485.0                       [0m[0m  |  [31m[1m                2246.7                [0m[0m  |  [31m[1m                     5118.4                    [0m[0m
      64     x 768   |  [2m[91m          338.0        [0m[0m  |  [2m[91m            331.5          [0m[0m  |  [31m[1m         1386.2         [0m[0m  |  [31m[1m   35376.3  [0m[0m  |  [31m[1m              34211.4            [0m[0m  |  [31m[1m                     494.0                   [0m[0m  |  [2m[91m                        382.6                       [0m[0m  |  [31m[1m                1723.0                [0m[0m  |  [31m[1m                     2914.0                    [0m[0m
      32     x 768   |  [2m[91m          354.7        [0m[0m  |  [2m[91m            240.7          [0m[0m  |  [31m[1m          998.7         [0m[0m  |  [31m[1m    8459.4  [0m[0m  |  [31m[1m               7545.1            [0m[0m  |  [2m[91m                     437.4                   [0m[0m  |  [2m[91m                        352.7                       [0m[0m  |  [2m[91m                 883.3                [0m[0m  |  [31m[1m                     1137.4                    [0m[0m
      16     x 768   |  [2m[91m          210.8        [0m[0m  |              140.1            |  [31m[1m         1526.8         [0m[0m  |  [2m[91m    2352.6  [0m[0m  |  [31m[1m               2506.2            [0m[0m  |  [2m[91m                     346.8                   [0m[0m  |                          202.7                         |  [2m[91m                 587.0                [0m[0m  |  [31m[1m                      742.4                    [0m[0m
      8      x 768   |            123.3          |               81.4            |            327.5           |  [2m[91m    1640.4  [0m[0m  |  [2m[91m               1757.0            [0m[0m  |                       170.1                     |                          167.0                         |  [2m[91m                 444.3                [0m[0m  |  [2m[91m                      406.0                    [0m[0m
      4      x 768   |             98.6          |               89.1            |  [92m[1m          199.4         [0m[0m  |  [2m[91m    1430.0  [0m[0m  |  [2m[91m                791.4            [0m[0m  |                       137.5                     |                          167.4                         |                   366.0                  |  [2m[91m                      301.3                    [0m[0m
      2      x 768   |             91.3          |               86.3            |            230.4           |  [2m[91m    1180.0  [0m[0m  |                  569.8              |  [92m[1m                      92.1                   [0m[0m  |  [92m[1m                        132.0                       [0m[0m  |                   284.8                  |                        174.3                    
      1      x 768   |  [92m[1m           82.3        [0m[0m  |  [92m[1m             71.3          [0m[0m  |            231.3           |  [92m[1m     480.3  [0m[0m  |  [92m[1m                352.2            [0m[0m  |                       126.7                     |                          170.0                         |  [92m[1m                 210.2                [0m[0m  |  [92m[1m                      114.5                    [0m[0m

Times are in microseconds (us).
/home/user/build/.venv/lib/python3.10/site-packages/torch/jit/_script.py:1241: UserWarning: `optimize` is deprecated and has no effect. Use `with torch.jit.optimized_execution() instead
  warnings.warn(

Sparsity 99 with 80 threads using compilation strategy script and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 80 threads using compilation strategy script and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 80 threads using compilation strategy script and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 80 threads using compilation strategy script and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[-------------------------------------------------------------------------------------------- Sparsity 99 with 80 threads using compilation strategy script and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         4773.0        [0m[0m  |  [31m[1m           1740.1          [0m[0m  |  [31m[1m  78912.6   [0m[0m  |  [31m[1m             69517.9             [0m[0m  |  [31m[1m                   3648.9                  [0m[0m  |  [31m[1m                      1095.0                      [0m[0m  |  [31m[1m                   72913.0                   [0m[0m
      1024   x 768   |  [31m[1m         2294.7        [0m[0m  |  [31m[1m            899.8          [0m[0m  |  [31m[1m  35267.8   [0m[0m  |  [31m[1m             42439.5             [0m[0m  |  [31m[1m                   1988.5                  [0m[0m  |  [31m[1m                       785.0                      [0m[0m  |  [31m[1m                   34913.0                   [0m[0m
      512    x 768   |  [31m[1m         1042.8        [0m[0m  |  [31m[1m            557.6          [0m[0m  |  [31m[1m  11748.1   [0m[0m  |  [31m[1m             12577.5             [0m[0m  |  [31m[1m                   1386.9                  [0m[0m  |  [31m[1m                       641.9                      [0m[0m  |  [31m[1m                   17405.5                   [0m[0m
      256    x 768   |  [31m[1m         1040.1        [0m[0m  |  [31m[1m           1263.0          [0m[0m  |  [31m[1m   2014.8   [0m[0m  |  [31m[1m              1557.5             [0m[0m  |  [31m[1m                    701.3                  [0m[0m  |  [31m[1m                       637.5                      [0m[0m  |  [31m[1m                    2095.0                   [0m[0m
      128    x 768   |  [31m[1m          624.3        [0m[0m  |  [31m[1m            371.4          [0m[0m  |  [2m[91m   1360.1   [0m[0m  |  [31m[1m               834.3             [0m[0m  |  [31m[1m                    915.2                  [0m[0m  |  [31m[1m                       500.6                      [0m[0m  |  [31m[1m                    1216.0                   [0m[0m
      64     x 768   |  [31m[1m          487.0        [0m[0m  |  [2m[91m            249.4          [0m[0m  |  [2m[91m    979.0   [0m[0m  |  [2m[91m               655.6             [0m[0m  |  [2m[91m                    428.9                  [0m[0m  |  [2m[91m                       315.9                      [0m[0m  |  [31m[1m                    1385.8                   [0m[0m
      32     x 768   |  [31m[1m          384.0        [0m[0m  |  [2m[91m            170.5          [0m[0m  |  [2m[91m   1197.7   [0m[0m  |  [31m[1m              2840.8             [0m[0m  |  [2m[91m                    306.1                  [0m[0m  |  [2m[91m                       221.5                      [0m[0m  |  [2m[91m                     639.7                   [0m[0m
      16     x 768   |  [2m[91m          294.7        [0m[0m  |  [2m[91m            126.7          [0m[0m  |      631.5     |  [2m[91m               456.6             [0m[0m  |                      167.6                    |                         100.5                        |  [2m[91m                     440.3                   [0m[0m
      8      x 768   |            123.9          |  [2m[91m            105.9          [0m[0m  |      585.0     |                 280.2               |                      123.1                    |                          93.7                        |                       303.4                   
      4      x 768   |            107.5          |               82.8            |  [92m[1m    392.8   [0m[0m  |                 301.6               |                      107.2                    |  [34m[1m                        83.2                      [0m[0m  |                       254.0                   
      2      x 768   |            113.8          |              100.7            |      555.4     |                 249.7               |  [34m[1m                     97.7                  [0m[0m  |  [92m[1m                        78.3                      [0m[0m  |                       252.2                   
      1      x 768   |  [92m[1m           74.0        [0m[0m  |  [92m[1m             50.7          [0m[0m  |      468.4     |  [92m[1m               162.9             [0m[0m  |  [92m[1m                     94.8                  [0m[0m  |  [34m[1m                        79.9                      [0m[0m  |  [92m[1m                     159.4                   [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------- Sparsity 95 with 80 threads using compilation strategy script and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         4308.3        [0m[0m  |  [31m[1m           1790.2          [0m[0m  |  [31m[1m  324751.0  [0m[0m  |  [31m[1m             302049.3            [0m[0m  |  [31m[1m                   5387.3                  [0m[0m  |  [31m[1m                      1484.8                      [0m[0m  |  [31m[1m                   306287.8                  [0m[0m
      1024   x 768   |  [31m[1m         2100.3        [0m[0m  |  [31m[1m           1484.5          [0m[0m  |  [31m[1m  194488.9  [0m[0m  |  [31m[1m             170494.4            [0m[0m  |  [31m[1m                   1817.2                  [0m[0m  |  [31m[1m                      1270.0                      [0m[0m  |  [31m[1m                   172780.2                  [0m[0m
      512    x 768   |  [31m[1m         1425.8        [0m[0m  |  [31m[1m            875.2          [0m[0m  |  [31m[1m   92718.6  [0m[0m  |  [31m[1m              88963.1            [0m[0m  |  [31m[1m                   1112.8                  [0m[0m  |  [31m[1m                       588.0                      [0m[0m  |  [31m[1m                    90550.4                  [0m[0m
      256    x 768   |  [31m[1m          722.1        [0m[0m  |  [31m[1m            434.8          [0m[0m  |  [31m[1m   50269.6  [0m[0m  |  [31m[1m              42488.0            [0m[0m  |  [31m[1m                   1322.4                  [0m[0m  |  [31m[1m                       719.5                      [0m[0m  |  [31m[1m                    49005.7                  [0m[0m
      128    x 768   |  [31m[1m          730.1        [0m[0m  |  [2m[91m            359.8          [0m[0m  |  [31m[1m   22426.2  [0m[0m  |  [31m[1m              22181.2            [0m[0m  |  [31m[1m                   1335.6                  [0m[0m  |  [31m[1m                       678.4                      [0m[0m  |  [31m[1m                    27061.7                  [0m[0m
      64     x 768   |  [31m[1m         1037.1        [0m[0m  |  [2m[91m            257.4          [0m[0m  |  [31m[1m    3035.4  [0m[0m  |  [31m[1m               2384.5            [0m[0m  |  [31m[1m                    486.0                  [0m[0m  |  [2m[91m                       310.4                      [0m[0m  |  [31m[1m                     1915.7                  [0m[0m
      32     x 768   |  [2m[91m          325.7        [0m[0m  |  [2m[91m            168.3          [0m[0m  |  [2m[91m    1479.1  [0m[0m  |  [2m[91m                972.0            [0m[0m  |  [2m[91m                    315.5                  [0m[0m  |  [2m[91m                       221.8                      [0m[0m  |  [2m[91m                     1293.9                  [0m[0m
      16     x 768   |  [2m[91m          297.0        [0m[0m  |              117.7            |  [2m[91m    1269.9  [0m[0m  |  [2m[91m                850.4            [0m[0m  |                      159.4                    |                         121.1                        |  [2m[91m                     1025.2                  [0m[0m
      8      x 768   |            129.5          |               93.2            |       867.4    |  [2m[91m                592.2            [0m[0m  |                      123.0                    |                         100.0                        |  [2m[91m                      658.5                  [0m[0m
      4      x 768   |  [92m[1m           76.6        [0m[0m  |              127.3            |  [2m[91m    1152.7  [0m[0m  |                  510.0              |  [92m[1m                     84.2                  [0m[0m  |                          83.1                        |                        406.0                  
      2      x 768   |            133.7          |              141.2            |  [92m[1m     569.5  [0m[0m  |                  293.9              |                      102.7                    |                          85.5                        |                        324.6                  
      1      x 768   |            105.6          |  [92m[1m             78.3          [0m[0m  |  [92m[1m     564.0  [0m[0m  |  [92m[1m                258.8            [0m[0m  |                      100.0                    |  [92m[1m                        71.1                      [0m[0m  |  [92m[1m                      290.0                  [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------- Sparsity 90 with 80 threads using compilation strategy script and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         3385.9        [0m[0m  |  [31m[1m           1745.8          [0m[0m  |  [31m[1m  572558.4  [0m[0m  |  [31m[1m             595321.8            [0m[0m  |  [31m[1m                   3575.7                  [0m[0m  |  [31m[1m                      1694.4                      [0m[0m  |  [31m[1m                   593779.0                  [0m[0m
      1024   x 768   |  [31m[1m         2292.4        [0m[0m  |  [31m[1m           1198.5          [0m[0m  |  [31m[1m  309999.9  [0m[0m  |  [31m[1m             311149.1            [0m[0m  |  [31m[1m                   2366.8                  [0m[0m  |  [31m[1m                       978.2                      [0m[0m  |  [31m[1m                   311865.0                  [0m[0m
      512    x 768   |  [31m[1m         1366.2        [0m[0m  |  [31m[1m            879.8          [0m[0m  |  [31m[1m  171326.6  [0m[0m  |  [31m[1m             197379.6            [0m[0m  |  [31m[1m                   1177.4                  [0m[0m  |  [31m[1m                       936.4                      [0m[0m  |  [31m[1m                   181945.6                  [0m[0m
      256    x 768   |  [31m[1m          801.6        [0m[0m  |  [31m[1m            412.1          [0m[0m  |  [31m[1m  124024.5  [0m[0m  |  [31m[1m              88022.4            [0m[0m  |  [31m[1m                    922.6                  [0m[0m  |  [31m[1m                       698.6                      [0m[0m  |  [31m[1m                    94764.5                  [0m[0m
      128    x 768   |  [31m[1m          749.5        [0m[0m  |  [31m[1m            432.3          [0m[0m  |  [31m[1m   42059.9  [0m[0m  |  [31m[1m              50002.6            [0m[0m  |  [31m[1m                   2020.3                  [0m[0m  |  [31m[1m                       581.1                      [0m[0m  |  [31m[1m                    49387.0                  [0m[0m
      64     x 768   |  [31m[1m          457.4        [0m[0m  |  [2m[91m            299.6          [0m[0m  |  [31m[1m   21259.1  [0m[0m  |  [31m[1m              21586.7            [0m[0m  |  [31m[1m                    489.1                  [0m[0m  |  [31m[1m                       325.7                      [0m[0m  |  [31m[1m                    20820.6                  [0m[0m
      32     x 768   |  [2m[91m          351.5        [0m[0m  |  [2m[91m            189.0          [0m[0m  |  [2m[91m    2141.6  [0m[0m  |  [31m[1m               2075.0            [0m[0m  |  [2m[91m                    331.4                  [0m[0m  |  [2m[91m                       248.8                      [0m[0m  |  [31m[1m                     8261.0                  [0m[0m
      16     x 768   |  [2m[91m          290.6        [0m[0m  |  [2m[91m            129.3          [0m[0m  |  [2m[91m    1436.5  [0m[0m  |  [2m[91m               1038.8            [0m[0m  |                      135.5                    |                         118.6                        |  [2m[91m                     1443.5                  [0m[0m
      8      x 768   |             93.7          |               97.3            |       900.0    |  [2m[91m               1088.2            [0m[0m  |                      131.4                    |                         106.6                        |  [2m[91m                     1015.6                  [0m[0m
      4      x 768   |            111.7          |  [92m[1m             62.4          [0m[0m  |       802.0    |  [2m[91m                607.0            [0m[0m  |  [34m[1m                     77.7                  [0m[0m  |  [92m[1m                        65.0                      [0m[0m  |                        658.8                  
      2      x 768   |             96.1          |               75.1            |       620.3    |                  390.2              |  [92m[1m                     72.0                  [0m[0m  |                         119.3                        |  [92m[1m                      381.9                  [0m[0m
      1      x 768   |  [92m[1m           76.9        [0m[0m  |  [34m[1m             64.1          [0m[0m  |  [92m[1m     532.5  [0m[0m  |  [92m[1m                271.8            [0m[0m  |                      105.5                    |                          71.5                        |  [2m[91m                     1102.4                  [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------- Sparsity 80 with 80 threads using compilation strategy script and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         7293.8        [0m[0m  |  [31m[1m           1579.1          [0m[0m  |  [31m[1m 1084869.4  [0m[0m  |  [31m[1m            1068349.3            [0m[0m  |  [31m[1m                   4580.0                  [0m[0m  |  [31m[1m                      1737.6                      [0m[0m  |  [31m[1m                  1106523.8                  [0m[0m
      1024   x 768   |  [31m[1m         2414.0        [0m[0m  |  [31m[1m           1095.4          [0m[0m  |  [31m[1m  595735.8  [0m[0m  |  [31m[1m             575879.4            [0m[0m  |  [31m[1m                   3390.0                  [0m[0m  |  [31m[1m                      1046.6                      [0m[0m  |  [31m[1m                   586105.7                  [0m[0m
      512    x 768   |  [31m[1m         1371.2        [0m[0m  |  [31m[1m            636.8          [0m[0m  |  [31m[1m  303969.0  [0m[0m  |  [31m[1m             306266.3            [0m[0m  |  [31m[1m                   1250.1                  [0m[0m  |  [31m[1m                      1041.1                      [0m[0m  |  [31m[1m                   355893.8                  [0m[0m
      256    x 768   |  [31m[1m         2681.1        [0m[0m  |  [31m[1m            431.1          [0m[0m  |  [31m[1m  185106.3  [0m[0m  |  [31m[1m             177949.9            [0m[0m  |  [31m[1m                   1483.4                  [0m[0m  |  [31m[1m                       766.2                      [0m[0m  |  [31m[1m                   219522.8                  [0m[0m
      128    x 768   |  [31m[1m         1216.8        [0m[0m  |  [31m[1m            542.9          [0m[0m  |  [31m[1m  104946.0  [0m[0m  |  [31m[1m             128964.4            [0m[0m  |  [31m[1m                    783.8                  [0m[0m  |  [31m[1m                       458.3                      [0m[0m  |  [31m[1m                    94749.8                  [0m[0m
      64     x 768   |  [31m[1m          515.3        [0m[0m  |  [2m[91m            276.4          [0m[0m  |  [31m[1m   42666.0  [0m[0m  |  [31m[1m              50771.9            [0m[0m  |  [31m[1m                    760.4                  [0m[0m  |  [31m[1m                       423.3                      [0m[0m  |  [31m[1m                    56928.6                  [0m[0m
      32     x 768   |  [2m[91m          352.4        [0m[0m  |  [2m[91m            240.8          [0m[0m  |  [31m[1m   21363.1  [0m[0m  |  [31m[1m              20944.4            [0m[0m  |  [2m[91m                    322.6                  [0m[0m  |  [2m[91m                       259.5                      [0m[0m  |  [31m[1m                    25611.1                  [0m[0m
      16     x 768   |  [2m[91m          270.6        [0m[0m  |  [2m[91m            182.8          [0m[0m  |  [2m[91m    2285.8  [0m[0m  |  [31m[1m               2801.6            [0m[0m  |                      134.0                    |                         122.9                        |  [31m[1m                     7534.2                  [0m[0m
      8      x 768   |            135.7          |               92.7            |      1258.1    |  [2m[91m               1063.1            [0m[0m  |                      126.9                    |                         100.0                        |  [2m[91m                     1101.4                  [0m[0m
      4      x 768   |  [34m[1m           89.6        [0m[0m  |              111.7            |       845.7    |  [2m[91m                847.3            [0m[0m  |  [34m[1m                     77.4                  [0m[0m  |  [2m[91m                       159.7                      [0m[0m  |  [2m[91m                     1194.5                  [0m[0m
      2      x 768   |  [92m[1m           85.1        [0m[0m  |  [34m[1m             82.1          [0m[0m  |  [34m[1m     764.0  [0m[0m  |                  523.8              |  [92m[1m                     71.2                  [0m[0m  |  [92m[1m                        65.1                      [0m[0m  |  [2m[91m                      794.0                  [0m[0m
      1      x 768   |  [34m[1m           86.2        [0m[0m  |  [92m[1m             76.8          [0m[0m  |  [92m[1m     749.4  [0m[0m  |  [92m[1m                405.1            [0m[0m  |                      101.0                    |  [92m[1m                        64.8                      [0m[0m  |  [92m[1m                      378.9                  [0m[0m

Times are in microseconds (us).

Sparsity 99 with 80 threads using compilation strategy trace and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 80 threads using compilation strategy trace and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 80 threads using compilation strategy trace and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 80 threads using compilation strategy trace and dtype torch.float32 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[------------------------------------------------------------------------------------------ Sparsity 99 with 80 threads using compilation strategy trace and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
80 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         2992.2        [0m[0m  |  [31m[1m           1658.4          [0m[0m  |  [31m[1m  58961.3   [0m[0m  |  [31m[1m             55729.0             [0m[0m  |  [31m[1m                  5585.7                  [0m[0m  |  [31m[1m                      1544.3                     [0m[0m  |  [31m[1m                  74526.4                   [0m[0m
      1024   x 768   |  [31m[1m         2270.1        [0m[0m  |  [31m[1m           1175.0          [0m[0m  |  [31m[1m  23832.7   [0m[0m  |  [31m[1m             23097.1             [0m[0m  |  [31m[1m                  1783.5                  [0m[0m  |  [31m[1m                       778.4                     [0m[0m  |  [31m[1m                  36951.2                   [0m[0m
      512    x 768   |  [31m[1m         1268.2        [0m[0m  |  [31m[1m            595.5          [0m[0m  |  [31m[1m   6255.0   [0m[0m  |  [31m[1m              4544.8             [0m[0m  |  [31m[1m                  1159.1                  [0m[0m  |  [31m[1m                       731.8                     [0m[0m  |  [31m[1m                  20823.9                   [0m[0m
      256    x 768   |  [31m[1m          918.3        [0m[0m  |  [31m[1m            319.9          [0m[0m  |  [2m[91m   2005.6   [0m[0m  |  [31m[1m              1580.2             [0m[0m  |  [31m[1m                   799.1                  [0m[0m  |  [31m[1m                       439.8                     [0m[0m  |  [31m[1m                   1393.7                   [0m[0m
      128    x 768   |  [31m[1m         1112.7        [0m[0m  |  [31m[1m            460.4          [0m[0m  |  [2m[91m    997.3   [0m[0m  |  [31m[1m              1445.4             [0m[0m  |  [31m[1m                   660.5                  [0m[0m  |  [31m[1m                       409.7                     [0m[0m  |  [31m[1m                   1486.9                   [0m[0m
      64     x 768   |  [31m[1m          439.4        [0m[0m  |  [31m[1m            298.1          [0m[0m  |  [2m[91m   1483.0   [0m[0m  |  [31m[1m               857.0             [0m[0m  |  [31m[1m                   333.6                  [0m[0m  |  [2m[91m                       190.8                     [0m[0m  |  [31m[1m                    900.4                   [0m[0m
      32     x 768   |  [2m[91m          362.2        [0m[0m  |  [2m[91m            167.1          [0m[0m  |      802.9     |  [31m[1m              2469.5             [0m[0m  |  [31m[1m                   357.3                  [0m[0m  |  [2m[91m                       171.8                     [0m[0m  |  [2m[91m                    571.1                   [0m[0m
      16     x 768   |  [2m[91m          293.1        [0m[0m  |  [2m[91m            125.9          [0m[0m  |      737.4     |  [2m[91m               447.3             [0m[0m  |  [2m[91m                   289.8                  [0m[0m  |  [2m[91m                       165.8                     [0m[0m  |  [31m[1m                   1670.6                   [0m[0m
      8      x 768   |            122.0          |               82.6            |      565.9     |                 291.1               |                     125.7                    |                          77.5                       |  [2m[91m                    398.2                   [0m[0m
      4      x 768   |            107.2          |  [92m[1m             56.4          [0m[0m  |  [34m[1m    505.0   [0m[0m  |                 277.8               |                     100.9                    |                          88.2                       |                      275.4                   
      2      x 768   |            118.7          |               69.0            |  [92m[1m    468.2   [0m[0m  |                 247.6               |                     103.5                    |                          80.5                       |                      212.5                   
      1      x 768   |  [92m[1m           81.0        [0m[0m  |               73.6            |  [34m[1m    496.7   [0m[0m  |  [92m[1m               168.3             [0m[0m  |  [92m[1m                    65.8                  [0m[0m  |  [92m[1m                        59.4                     [0m[0m  |  [92m[1m                    157.0                   [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------ Sparsity 95 with 80 threads using compilation strategy trace and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
80 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         4678.1        [0m[0m  |  [31m[1m           1665.1          [0m[0m  |  [31m[1m  377579.8  [0m[0m  |  [31m[1m             347254.9            [0m[0m  |  [31m[1m                  4999.9                  [0m[0m  |  [31m[1m                      1275.8                     [0m[0m  |  [31m[1m                  299309.0                  [0m[0m
      1024   x 768   |  [31m[1m         1584.0        [0m[0m  |  [31m[1m            937.5          [0m[0m  |  [31m[1m  197559.2  [0m[0m  |  [31m[1m             175338.1            [0m[0m  |  [31m[1m                  2488.6                  [0m[0m  |  [31m[1m                      1090.5                     [0m[0m  |  [31m[1m                  224937.7                  [0m[0m
      512    x 768   |  [31m[1m         1357.1        [0m[0m  |  [31m[1m            642.5          [0m[0m  |  [31m[1m  168703.3  [0m[0m  |  [31m[1m             155537.1            [0m[0m  |  [31m[1m                  1350.8                  [0m[0m  |  [31m[1m                       730.5                     [0m[0m  |  [31m[1m                   91138.1                  [0m[0m
      256    x 768   |  [31m[1m          727.7        [0m[0m  |  [31m[1m            435.9          [0m[0m  |  [31m[1m   48372.3  [0m[0m  |  [31m[1m              42036.3            [0m[0m  |  [31m[1m                   813.1                  [0m[0m  |  [31m[1m                      1389.7                     [0m[0m  |  [31m[1m                   42318.4                  [0m[0m
      128    x 768   |  [31m[1m          734.0        [0m[0m  |  [31m[1m            358.0          [0m[0m  |  [31m[1m   25977.4  [0m[0m  |  [31m[1m              21923.2            [0m[0m  |  [31m[1m                   634.8                  [0m[0m  |  [31m[1m                       387.2                     [0m[0m  |  [31m[1m                   27173.7                  [0m[0m
      64     x 768   |  [31m[1m          416.5        [0m[0m  |  [31m[1m            292.8          [0m[0m  |  [31m[1m    2741.4  [0m[0m  |  [31m[1m               2510.9            [0m[0m  |  [31m[1m                   573.6                  [0m[0m  |  [2m[91m                       294.3                     [0m[0m  |  [31m[1m                    2527.3                  [0m[0m
      32     x 768   |  [31m[1m          381.1        [0m[0m  |  [2m[91m            204.9          [0m[0m  |  [2m[91m    1367.1  [0m[0m  |  [2m[91m               1228.2            [0m[0m  |  [2m[91m                   367.3                  [0m[0m  |  [2m[91m                       268.6                     [0m[0m  |  [31m[1m                    1577.1                  [0m[0m
      16     x 768   |  [2m[91m          307.3        [0m[0m  |  [2m[91m            119.5          [0m[0m  |  [2m[91m    1126.8  [0m[0m  |                  671.5              |  [2m[91m                   274.8                  [0m[0m  |  [2m[91m                       180.5                     [0m[0m  |  [2m[91m                    1163.3                  [0m[0m
      8      x 768   |  [2m[91m          162.7        [0m[0m  |  [31m[1m            390.3          [0m[0m  |  [2m[91m     820.0  [0m[0m  |                  556.4              |  [2m[91m                   271.2                  [0m[0m  |  [92m[1m                        74.4                     [0m[0m  |  [2m[91m                     589.8                  [0m[0m
      4      x 768   |            100.4          |               79.7            |       522.9    |  [92m[1m                396.3            [0m[0m  |  [92m[1m                    86.9                  [0m[0m  |                          84.0                       |                       420.7                  
      2      x 768   |             77.7          |               65.4            |       508.2    |  [31m[1m               3448.2            [0m[0m  |  [34m[1m                    91.4                  [0m[0m  |                          89.1                       |                       332.5                  
      1      x 768   |  [92m[1m           68.3        [0m[0m  |  [92m[1m             52.0          [0m[0m  |  [92m[1m     382.5  [0m[0m  |                  449.2              |                     100.7                    |                          85.7                       |  [92m[1m                     280.1                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------ Sparsity 90 with 80 threads using compilation strategy trace and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
80 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         5105.1        [0m[0m  |  [31m[1m           1848.5          [0m[0m  |  [31m[1m  571183.4  [0m[0m  |  [31m[1m             589278.5            [0m[0m  |  [31m[1m                  4680.6                  [0m[0m  |  [31m[1m                      1579.2                     [0m[0m  |  [31m[1m                  575813.2                  [0m[0m
      1024   x 768   |  [31m[1m         2085.7        [0m[0m  |  [31m[1m           1186.3          [0m[0m  |  [31m[1m  302014.2  [0m[0m  |  [31m[1m             364178.2            [0m[0m  |  [31m[1m                  2404.1                  [0m[0m  |  [31m[1m                      1146.7                     [0m[0m  |  [31m[1m                  318429.7                  [0m[0m
      512    x 768   |  [31m[1m         1319.1        [0m[0m  |  [31m[1m            734.2          [0m[0m  |  [31m[1m  172004.4  [0m[0m  |  [31m[1m             184677.0            [0m[0m  |  [31m[1m                  1365.8                  [0m[0m  |  [31m[1m                       650.5                     [0m[0m  |  [31m[1m                  163758.2                  [0m[0m
      256    x 768   |  [31m[1m          859.6        [0m[0m  |  [31m[1m            518.7          [0m[0m  |  [31m[1m   89754.6  [0m[0m  |  [31m[1m              82378.0            [0m[0m  |  [31m[1m                  1404.8                  [0m[0m  |  [31m[1m                       447.1                     [0m[0m  |  [31m[1m                  173093.2                  [0m[0m
      128    x 768   |  [31m[1m          777.0        [0m[0m  |  [31m[1m            522.2          [0m[0m  |  [31m[1m   85481.0  [0m[0m  |  [31m[1m              50467.6            [0m[0m  |  [31m[1m                   651.0                  [0m[0m  |  [31m[1m                       424.2                     [0m[0m  |  [31m[1m                   43986.7                  [0m[0m
      64     x 768   |  [31m[1m          509.3        [0m[0m  |  [2m[91m            264.2          [0m[0m  |  [31m[1m   28152.0  [0m[0m  |  [31m[1m              21668.4            [0m[0m  |  [31m[1m                  2178.2                  [0m[0m  |  [2m[91m                       289.3                     [0m[0m  |  [31m[1m                   24350.9                  [0m[0m
      32     x 768   |  [2m[91m          355.9        [0m[0m  |  [31m[1m            538.9          [0m[0m  |  [2m[91m    2067.4  [0m[0m  |  [31m[1m               2524.3            [0m[0m  |  [2m[91m                   265.4                  [0m[0m  |  [2m[91m                       248.0                     [0m[0m  |  [31m[1m                    2796.5                  [0m[0m
      16     x 768   |  [2m[91m          268.5        [0m[0m  |  [2m[91m            258.1          [0m[0m  |  [2m[91m    1512.1  [0m[0m  |  [31m[1m               2207.5            [0m[0m  |  [2m[91m                   303.5                  [0m[0m  |                         136.1                       |  [2m[91m                     993.7                  [0m[0m
      8      x 768   |            118.0          |  [2m[91m            226.1          [0m[0m  |  [2m[91m    1166.3  [0m[0m  |  [2m[91m               1036.8            [0m[0m  |                     131.9                    |  [2m[91m                       221.9                     [0m[0m  |  [2m[91m                    1055.6                  [0m[0m
      4      x 768   |             96.7          |               80.4            |  [2m[91m    1170.5  [0m[0m  |                  507.2              |                     105.0                    |  [92m[1m                        79.8                     [0m[0m  |                       554.2                  
      2      x 768   |            134.1          |  [92m[1m             58.2          [0m[0m  |       673.5    |  [92m[1m                286.0            [0m[0m  |  [92m[1m                    86.3                  [0m[0m  |                         128.9                       |                       391.8                  
      1      x 768   |  [92m[1m           81.8        [0m[0m  |               73.9            |  [92m[1m     550.1  [0m[0m  |  [2m[91m               1204.3            [0m[0m  |  [2m[91m                   225.7                  [0m[0m  |                          94.0                       |  [92m[1m                     303.1                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------ Sparsity 80 with 80 threads using compilation strategy trace and dtype torch.float32 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
80 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m         3814.6        [0m[0m  |  [31m[1m           1809.3          [0m[0m  |  [31m[1m 1086577.7  [0m[0m  |  [31m[1m            1117191.7            [0m[0m  |  [31m[1m                  5539.4                  [0m[0m  |  [31m[1m                      1957.1                     [0m[0m  |  [31m[1m                 1100148.6                  [0m[0m
      1024   x 768   |  [31m[1m         2249.4        [0m[0m  |  [31m[1m           1550.2          [0m[0m  |  [31m[1m  625608.4  [0m[0m  |  [31m[1m             565437.9            [0m[0m  |  [31m[1m                  2155.2                  [0m[0m  |  [31m[1m                       780.8                     [0m[0m  |  [31m[1m                  587781.4                  [0m[0m
      512    x 768   |  [31m[1m         1090.9        [0m[0m  |  [31m[1m            535.5          [0m[0m  |  [31m[1m  308497.5  [0m[0m  |  [31m[1m             316798.7            [0m[0m  |  [31m[1m                  1414.6                  [0m[0m  |  [31m[1m                       809.2                     [0m[0m  |  [31m[1m                  321394.4                  [0m[0m
      256    x 768   |  [31m[1m          751.2        [0m[0m  |  [31m[1m            462.0          [0m[0m  |  [31m[1m  213995.3  [0m[0m  |  [31m[1m             235514.0            [0m[0m  |  [31m[1m                   683.9                  [0m[0m  |  [31m[1m                       442.6                     [0m[0m  |  [31m[1m                  161226.7                  [0m[0m
      128    x 768   |  [31m[1m          748.4        [0m[0m  |  [31m[1m            396.9          [0m[0m  |  [31m[1m   88246.9  [0m[0m  |  [31m[1m              91744.2            [0m[0m  |  [31m[1m                   815.3                  [0m[0m  |  [31m[1m                       459.6                     [0m[0m  |  [31m[1m                   92180.7                  [0m[0m
      64     x 768   |  [31m[1m          472.4        [0m[0m  |  [2m[91m            262.3          [0m[0m  |  [31m[1m   50315.9  [0m[0m  |  [31m[1m              49111.4            [0m[0m  |  [31m[1m                   520.9                  [0m[0m  |  [31m[1m                       344.0                     [0m[0m  |  [31m[1m                   41858.9                  [0m[0m
      32     x 768   |  [31m[1m          343.2        [0m[0m  |  [2m[91m            204.2          [0m[0m  |  [31m[1m   21459.1  [0m[0m  |  [31m[1m              23535.1            [0m[0m  |  [2m[91m                   360.9                  [0m[0m  |  [2m[91m                       181.5                     [0m[0m  |  [31m[1m                   21804.7                  [0m[0m
      16     x 768   |  [2m[91m          291.6        [0m[0m  |  [31m[1m            325.6          [0m[0m  |  [2m[91m    2924.4  [0m[0m  |  [31m[1m               2453.1            [0m[0m  |  [2m[91m                   308.3                  [0m[0m  |  [2m[91m                       143.2                     [0m[0m  |  [31m[1m                    3149.0                  [0m[0m
      8      x 768   |  [2m[91m          154.2        [0m[0m  |  [2m[91m            113.5          [0m[0m  |      1185.8    |  [2m[91m               1591.2            [0m[0m  |                     131.8                    |                         105.9                       |  [2m[91m                    1091.9                  [0m[0m
      4      x 768   |  [2m[91m          226.3        [0m[0m  |  [2m[91m            216.6          [0m[0m  |       898.4    |  [2m[91m                948.9            [0m[0m  |                     140.9                    |                          75.9                       |  [2m[91m                    1308.8                  [0m[0m
      2      x 768   |             88.8          |  [92m[1m             56.1          [0m[0m  |      1043.2    |                  577.1              |  [92m[1m                    90.3                  [0m[0m  |                          86.1                       |                       720.7                  
      1      x 768   |  [92m[1m           63.9        [0m[0m  |               66.6            |  [92m[1m     631.3  [0m[0m  |  [92m[1m                405.3            [0m[0m  |  [34m[1m                    94.8                  [0m[0m  |  [92m[1m                        65.0                     [0m[0m  |  [92m[1m                     394.2                  [0m[0m

Times are in microseconds (us).

Sparsity 99 with 1 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 1 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 1 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 1 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[---------------------------------------------------------------------------------------------- Sparsity 99 with 1 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu. ---------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  Fine-grained + structured with backend inductor
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        266535.1       [0m[0m  |  [31m[1m          76638.1          [0m[0m  |  [31m[1m  358679.4  [0m[0m  |  [31m[1m             358246.5            [0m[0m  |  [31m[1m                   267643.2                  [0m[0m  |  [31m[1m                      77293.0                       [0m[0m  |  [31m[1m                    11338.9                    [0m[0m
      1024   x 768   |  [31m[1m        133308.7       [0m[0m  |  [31m[1m          38277.3          [0m[0m  |  [31m[1m  179347.5  [0m[0m  |  [31m[1m             178362.7            [0m[0m  |  [31m[1m                   132340.1                  [0m[0m  |  [31m[1m                      38086.9                       [0m[0m  |  [31m[1m                     5763.9                    [0m[0m
      512    x 768   |  [31m[1m         66805.7       [0m[0m  |  [31m[1m          19306.0          [0m[0m  |  [31m[1m   64130.6  [0m[0m  |  [31m[1m              63423.5            [0m[0m  |  [31m[1m                    67785.8                  [0m[0m  |  [31m[1m                      19248.4                       [0m[0m  |  [31m[1m                     2333.2                    [0m[0m
      256    x 768   |  [31m[1m         33657.1       [0m[0m  |  [31m[1m           9631.7          [0m[0m  |  [31m[1m   31007.1  [0m[0m  |  [31m[1m              30781.6            [0m[0m  |  [31m[1m                    33455.8                  [0m[0m  |  [31m[1m                       9784.3                       [0m[0m  |  [31m[1m                     1548.4                    [0m[0m
      128    x 768   |  [31m[1m         16857.3       [0m[0m  |  [31m[1m           4953.9          [0m[0m  |  [31m[1m   15369.8  [0m[0m  |  [31m[1m              15308.1            [0m[0m  |  [31m[1m                    16887.0                  [0m[0m  |  [31m[1m                       5040.0                       [0m[0m  |  [31m[1m                      967.3                    [0m[0m
      64     x 768   |  [31m[1m          8730.1       [0m[0m  |  [31m[1m           2539.6          [0m[0m  |  [31m[1m    7826.9  [0m[0m  |  [31m[1m               7748.0            [0m[0m  |  [31m[1m                     8756.0                  [0m[0m  |  [31m[1m                       2592.9                       [0m[0m  |  [2m[91m                      522.8                    [0m[0m
      32     x 768   |  [31m[1m          4447.6       [0m[0m  |  [31m[1m           1359.9          [0m[0m  |  [31m[1m    4028.9  [0m[0m  |  [31m[1m               3872.1            [0m[0m  |  [31m[1m                     4535.2                  [0m[0m  |  [31m[1m                       1434.4                       [0m[0m  |                        299.5                    
      16     x 768   |  [31m[1m          2486.0       [0m[0m  |  [31m[1m            743.0          [0m[0m  |  [31m[1m    2120.3  [0m[0m  |  [31m[1m               1978.9            [0m[0m  |  [31m[1m                     2460.8                  [0m[0m  |  [31m[1m                        818.7                       [0m[0m  |                        280.8                    
      8      x 768   |  [31m[1m          1374.7       [0m[0m  |  [2m[91m            437.8          [0m[0m  |  [2m[91m    1141.5  [0m[0m  |  [31m[1m               1011.8            [0m[0m  |  [31m[1m                     1464.7                  [0m[0m  |  [2m[91m                        522.8                       [0m[0m  |                        222.8                    
      4      x 768   |  [2m[91m           857.4       [0m[0m  |  [2m[91m            276.2          [0m[0m  |  [2m[91m     639.5  [0m[0m  |  [2m[91m                507.0            [0m[0m  |  [2m[91m                      901.6                  [0m[0m  |  [2m[91m                        338.1                       [0m[0m  |  [2m[91m                      534.1                    [0m[0m
      2      x 768   |  [2m[91m           601.7       [0m[0m  |  [2m[91m            207.0          [0m[0m  |       397.8    |                  263.9              |  [2m[91m                      636.8                  [0m[0m  |                          276.7                         |                        284.8                    
      1      x 768   |  [92m[1m           237.3       [0m[0m  |  [92m[1m             96.1          [0m[0m  |  [92m[1m     271.4  [0m[0m  |  [92m[1m                143.2            [0m[0m  |  [92m[1m                      269.2                  [0m[0m  |  [92m[1m                        160.2                       [0m[0m  |  [92m[1m                      160.3                    [0m[0m

Times are in microseconds (us).

[---------------------------------------------------------------------------------------------- Sparsity 95 with 1 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu. ---------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  Fine-grained + structured with backend inductor
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        267091.7       [0m[0m  |  [31m[1m          92046.6          [0m[0m  |  [31m[1m 1695255.8  [0m[0m  |  [31m[1m            1698671.3            [0m[0m  |  [31m[1m                   267360.3                  [0m[0m  |  [31m[1m                      91755.9                       [0m[0m  |  [31m[1m                    57277.3                    [0m[0m
      1024   x 768   |  [31m[1m        131897.2       [0m[0m  |  [31m[1m          46278.6          [0m[0m  |  [31m[1m  846805.4  [0m[0m  |  [31m[1m             844491.6            [0m[0m  |  [31m[1m                   131806.2                  [0m[0m  |  [31m[1m                      45706.2                       [0m[0m  |  [31m[1m                    28093.4                    [0m[0m
      512    x 768   |  [31m[1m         67545.4       [0m[0m  |  [31m[1m          22783.1          [0m[0m  |  [31m[1m  426579.0  [0m[0m  |  [31m[1m             429214.1            [0m[0m  |  [31m[1m                    67215.5                  [0m[0m  |  [31m[1m                      22881.0                       [0m[0m  |  [31m[1m                    14090.8                    [0m[0m
      256    x 768   |  [31m[1m         33459.1       [0m[0m  |  [31m[1m          11611.2          [0m[0m  |  [31m[1m  213414.7  [0m[0m  |  [31m[1m             213637.2            [0m[0m  |  [31m[1m                    33600.9                  [0m[0m  |  [31m[1m                      11544.9                       [0m[0m  |  [31m[1m                     7596.1                    [0m[0m
      128    x 768   |  [31m[1m         16761.8       [0m[0m  |  [31m[1m           5952.6          [0m[0m  |  [31m[1m   74321.6  [0m[0m  |  [31m[1m              73187.9            [0m[0m  |  [31m[1m                    16885.1                  [0m[0m  |  [31m[1m                       6003.0                       [0m[0m  |  [31m[1m                     4391.8                    [0m[0m
      64     x 768   |  [31m[1m          8702.1       [0m[0m  |  [31m[1m           3050.1          [0m[0m  |  [31m[1m   36377.5  [0m[0m  |  [31m[1m              36257.5            [0m[0m  |  [31m[1m                     8655.4                  [0m[0m  |  [31m[1m                       3102.4                       [0m[0m  |  [2m[91m                     2062.1                    [0m[0m
      32     x 768   |  [31m[1m          4448.3       [0m[0m  |  [31m[1m           1602.6          [0m[0m  |  [31m[1m   17729.5  [0m[0m  |  [31m[1m              17615.5            [0m[0m  |  [31m[1m                     4498.2                  [0m[0m  |  [31m[1m                       1659.3                       [0m[0m  |                       1035.1                    
      16     x 768   |  [31m[1m          2429.9       [0m[0m  |  [31m[1m            887.7          [0m[0m  |  [31m[1m    9232.1  [0m[0m  |  [31m[1m               8866.1            [0m[0m  |  [31m[1m                     2416.8                  [0m[0m  |  [31m[1m                        977.1                       [0m[0m  |                        919.9                    
      8      x 768   |  [31m[1m          1373.8       [0m[0m  |  [2m[91m            514.4          [0m[0m  |  [31m[1m    4633.4  [0m[0m  |  [31m[1m               4435.9            [0m[0m  |  [2m[91m                     1397.9                  [0m[0m  |  [2m[91m                        589.3                       [0m[0m  |                        902.1                    
      4      x 768   |  [2m[91m           822.3       [0m[0m  |  [2m[91m            323.7          [0m[0m  |  [2m[91m    2391.6  [0m[0m  |  [2m[91m               2274.0            [0m[0m  |  [2m[91m                      857.4                  [0m[0m  |  [2m[91m                        390.7                       [0m[0m  |                        927.3                    
      2      x 768   |  [2m[91m           588.7       [0m[0m  |  [2m[91m            235.8          [0m[0m  |      1289.2    |                 1159.6              |  [2m[91m                      611.6                  [0m[0m  |                          302.6                         |                        881.9                    
      1      x 768   |  [92m[1m           226.5       [0m[0m  |  [92m[1m            108.8          [0m[0m  |  [92m[1m     732.0  [0m[0m  |  [92m[1m                588.1            [0m[0m  |  [92m[1m                      285.4                  [0m[0m  |  [92m[1m                        175.3                       [0m[0m  |  [92m[1m                      719.1                    [0m[0m

Times are in microseconds (us).

[---------------------------------------------------------------------------------------------- Sparsity 90 with 1 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu. ---------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  Fine-grained + structured with backend inductor
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        263436.4       [0m[0m  |  [31m[1m          101310.4         [0m[0m  |  [31m[1m 3407533.3  [0m[0m  |  [31m[1m            3411886.4            [0m[0m  |  [31m[1m                   265619.3                  [0m[0m  |  [31m[1m                      101323.3                      [0m[0m  |  [31m[1m                    112134.7                   [0m[0m
      1024   x 768   |  [31m[1m        132118.9       [0m[0m  |  [31m[1m           50341.3         [0m[0m  |  [31m[1m 1707756.0  [0m[0m  |  [31m[1m            1706187.3            [0m[0m  |  [31m[1m                   132907.2                  [0m[0m  |  [31m[1m                       50653.9                      [0m[0m  |  [31m[1m                     42717.1                   [0m[0m
      512    x 768   |  [31m[1m         66167.0       [0m[0m  |  [31m[1m           25219.4         [0m[0m  |  [31m[1m  850239.3  [0m[0m  |  [31m[1m             857605.3            [0m[0m  |  [31m[1m                    66521.7                  [0m[0m  |  [31m[1m                       25122.9                      [0m[0m  |  [31m[1m                     26103.0                   [0m[0m
      256    x 768   |  [31m[1m         33055.3       [0m[0m  |  [31m[1m           12744.9         [0m[0m  |  [31m[1m  432588.4  [0m[0m  |  [31m[1m             435821.5            [0m[0m  |  [31m[1m                    34028.9                  [0m[0m  |  [31m[1m                       13032.5                      [0m[0m  |  [31m[1m                     11612.7                   [0m[0m
      128    x 768   |  [31m[1m         16892.2       [0m[0m  |  [31m[1m            6490.5         [0m[0m  |  [31m[1m  217091.6  [0m[0m  |  [31m[1m             215390.5            [0m[0m  |  [31m[1m                    16946.8                  [0m[0m  |  [31m[1m                        6623.9                      [0m[0m  |  [31m[1m                      6910.1                   [0m[0m
      64     x 768   |  [31m[1m          8640.5       [0m[0m  |  [31m[1m            3347.9         [0m[0m  |  [31m[1m   74911.1  [0m[0m  |  [31m[1m              74821.5            [0m[0m  |  [31m[1m                     8624.8                  [0m[0m  |  [31m[1m                        3380.4                      [0m[0m  |  [31m[1m                      2819.3                   [0m[0m
      32     x 768   |  [31m[1m          4435.9       [0m[0m  |  [31m[1m            1774.1         [0m[0m  |  [31m[1m   36586.1  [0m[0m  |  [31m[1m              36364.0            [0m[0m  |  [31m[1m                     4568.0                  [0m[0m  |  [31m[1m                        1846.2                      [0m[0m  |  [31m[1m                      1466.1                   [0m[0m
      16     x 768   |  [31m[1m          2425.4       [0m[0m  |  [31m[1m             967.5         [0m[0m  |  [31m[1m   18355.3  [0m[0m  |  [31m[1m              17714.2            [0m[0m  |  [31m[1m                     2470.2                  [0m[0m  |  [31m[1m                        1033.4                      [0m[0m  |  [31m[1m                       773.6                   [0m[0m
      8      x 768   |  [31m[1m          1366.0       [0m[0m  |  [2m[91m             553.7         [0m[0m  |  [31m[1m    9026.6  [0m[0m  |  [31m[1m               8880.8            [0m[0m  |  [2m[91m                     1410.6                  [0m[0m  |  [2m[91m                         628.0                      [0m[0m  |  [2m[91m                       535.0                   [0m[0m
      4      x 768   |  [2m[91m           805.2       [0m[0m  |  [2m[91m             337.8         [0m[0m  |  [2m[91m    4600.6  [0m[0m  |  [2m[91m               4450.6            [0m[0m  |  [2m[91m                      827.4                  [0m[0m  |  [2m[91m                         413.0                      [0m[0m  |  [2m[91m                       308.2                   [0m[0m
      2      x 768   |  [2m[91m           557.0       [0m[0m  |  [2m[91m             253.8         [0m[0m  |      2387.1    |                 2259.3              |  [2m[91m                      606.0                  [0m[0m  |                           323.9                        |                         177.7                   
      1      x 768   |  [92m[1m           216.4       [0m[0m  |  [92m[1m             113.6         [0m[0m  |  [92m[1m    1284.9  [0m[0m  |  [92m[1m               1148.0            [0m[0m  |  [92m[1m                      286.3                  [0m[0m  |  [92m[1m                         202.8                      [0m[0m  |  [92m[1m                       120.3                   [0m[0m

Times are in microseconds (us).

[---------------------------------------------------------------------------------------------- Sparsity 80 with 1 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu. ---------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  Fine-grained + structured with backend inductor
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        265158.5       [0m[0m  |  [31m[1m          107476.8         [0m[0m  |  [31m[1m 6706016.7  [0m[0m  |  [31m[1m            6698160.3            [0m[0m  |  [31m[1m                   264740.6                  [0m[0m  |  [31m[1m                      106834.3                      [0m[0m  |  [31m[1m                    215857.0                   [0m[0m
      1024   x 768   |  [31m[1m        131667.0       [0m[0m  |  [31m[1m           52876.0         [0m[0m  |  [31m[1m 3387357.4  [0m[0m  |  [31m[1m            3411742.7            [0m[0m  |  [31m[1m                   135271.5                  [0m[0m  |  [31m[1m                       54528.7                      [0m[0m  |  [31m[1m                    112020.6                   [0m[0m
      512    x 768   |  [31m[1m         67887.8       [0m[0m  |  [31m[1m           27095.1         [0m[0m  |  [31m[1m 1730433.1  [0m[0m  |  [31m[1m            1798253.1            [0m[0m  |  [31m[1m                    68194.3                  [0m[0m  |  [31m[1m                       26886.9                      [0m[0m  |  [31m[1m                     56552.7                   [0m[0m
      256    x 768   |  [31m[1m         33499.8       [0m[0m  |  [31m[1m           13570.1         [0m[0m  |  [31m[1m  865711.2  [0m[0m  |  [31m[1m             867416.3            [0m[0m  |  [31m[1m                    33535.7                  [0m[0m  |  [31m[1m                       13579.3                      [0m[0m  |  [31m[1m                     30366.8                   [0m[0m
      128    x 768   |  [31m[1m         17776.2       [0m[0m  |  [31m[1m            6941.6         [0m[0m  |  [31m[1m  433023.0  [0m[0m  |  [31m[1m             427731.9            [0m[0m  |  [31m[1m                    16868.9                  [0m[0m  |  [31m[1m                        6872.8                      [0m[0m  |  [31m[1m                     16808.4                   [0m[0m
      64     x 768   |  [31m[1m          8586.5       [0m[0m  |  [31m[1m            3509.9         [0m[0m  |  [31m[1m  212806.8  [0m[0m  |  [31m[1m             211867.6            [0m[0m  |  [31m[1m                     8845.4                  [0m[0m  |  [31m[1m                        3597.9                      [0m[0m  |  [31m[1m                      6998.0                   [0m[0m
      32     x 768   |  [31m[1m          4486.1       [0m[0m  |  [31m[1m            1894.3         [0m[0m  |  [31m[1m   74043.4  [0m[0m  |  [31m[1m              73795.1            [0m[0m  |  [31m[1m                     4566.8                  [0m[0m  |  [31m[1m                        1944.7                      [0m[0m  |  [31m[1m                      3668.1                   [0m[0m
      16     x 768   |  [31m[1m          2424.6       [0m[0m  |  [31m[1m            1022.8         [0m[0m  |  [31m[1m   36641.3  [0m[0m  |  [31m[1m              36415.8            [0m[0m  |  [31m[1m                     2459.1                  [0m[0m  |  [31m[1m                        1096.1                      [0m[0m  |  [31m[1m                      1417.6                   [0m[0m
      8      x 768   |  [31m[1m          1469.8       [0m[0m  |  [2m[91m             593.5         [0m[0m  |  [31m[1m   18038.0  [0m[0m  |  [31m[1m              17798.8            [0m[0m  |  [31m[1m                     1411.6                  [0m[0m  |  [2m[91m                         651.2                      [0m[0m  |  [2m[91m                       744.4                   [0m[0m
      4      x 768   |  [2m[91m           812.5       [0m[0m  |  [2m[91m             381.2         [0m[0m  |  [2m[91m    8956.3  [0m[0m  |  [2m[91m               8813.5            [0m[0m  |  [2m[91m                      902.9                  [0m[0m  |  [2m[91m                         444.6                      [0m[0m  |  [2m[91m                       535.7                   [0m[0m
      2      x 768   |  [2m[91m           584.0       [0m[0m  |  [2m[91m             273.6         [0m[0m  |      4621.0    |                 4569.4              |  [2m[91m                      665.4                  [0m[0m  |                           352.7                        |                         240.1                   
      1      x 768   |  [92m[1m           252.8       [0m[0m  |  [92m[1m             130.7         [0m[0m  |  [92m[1m    2414.4  [0m[0m  |  [92m[1m               2292.4            [0m[0m  |  [92m[1m                      257.0                  [0m[0m  |  [92m[1m                         196.0                      [0m[0m  |  [92m[1m                       180.1                   [0m[0m

Times are in microseconds (us).
/home/user/build/.venv/lib/python3.10/site-packages/torch/jit/_script.py:1241: UserWarning: `optimize` is deprecated and has no effect. Use `with torch.jit.optimized_execution() instead
  warnings.warn(

Sparsity 99 with 1 threads using compilation strategy script and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 1 threads using compilation strategy script and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 1 threads using compilation strategy script and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 1 threads using compilation strategy script and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[-------------------------------------------------------------------------------------------- Sparsity 99 with 1 threads using compilation strategy script and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        267862.2       [0m[0m  |  [31m[1m          76356.1          [0m[0m  |  [31m[1m  367656.4  [0m[0m  |  [31m[1m             366753.0            [0m[0m  |  [31m[1m                  271468.0                 [0m[0m  |  [31m[1m                     76234.2                      [0m[0m  |  [31m[1m                   365901.8                  [0m[0m
      1024   x 768   |  [31m[1m        133018.9       [0m[0m  |  [31m[1m          38025.6          [0m[0m  |  [31m[1m  179589.6  [0m[0m  |  [31m[1m             179084.5            [0m[0m  |  [31m[1m                  133872.0                 [0m[0m  |  [31m[1m                     38720.8                      [0m[0m  |  [31m[1m                   181185.2                  [0m[0m
      512    x 768   |  [31m[1m         66923.7       [0m[0m  |  [31m[1m          19230.5          [0m[0m  |  [31m[1m   64593.4  [0m[0m  |  [31m[1m              63534.4            [0m[0m  |  [31m[1m                   67099.4                 [0m[0m  |  [31m[1m                     20382.5                      [0m[0m  |  [31m[1m                    63619.5                  [0m[0m
      256    x 768   |  [31m[1m         33807.3       [0m[0m  |  [31m[1m           9733.4          [0m[0m  |  [31m[1m   31098.7  [0m[0m  |  [31m[1m              30841.3            [0m[0m  |  [31m[1m                   33855.1                 [0m[0m  |  [31m[1m                      9724.2                      [0m[0m  |  [31m[1m                    31343.6                  [0m[0m
      128    x 768   |  [31m[1m         16785.2       [0m[0m  |  [31m[1m           4993.4          [0m[0m  |  [31m[1m   15519.8  [0m[0m  |  [31m[1m              15278.8            [0m[0m  |  [31m[1m                   16831.8                 [0m[0m  |  [31m[1m                      5074.4                      [0m[0m  |  [31m[1m                    15383.2                  [0m[0m
      64     x 768   |  [31m[1m          8625.7       [0m[0m  |  [31m[1m           2664.1          [0m[0m  |  [31m[1m    7885.7  [0m[0m  |  [31m[1m               7760.0            [0m[0m  |  [31m[1m                    8759.5                 [0m[0m  |  [31m[1m                      2574.9                      [0m[0m  |  [31m[1m                     7721.9                  [0m[0m
      32     x 768   |  [31m[1m          4529.9       [0m[0m  |  [31m[1m           1347.7          [0m[0m  |  [31m[1m    4008.9  [0m[0m  |  [31m[1m               3883.0            [0m[0m  |  [31m[1m                    4583.2                 [0m[0m  |  [31m[1m                      1361.8                      [0m[0m  |  [31m[1m                     3884.8                  [0m[0m
      16     x 768   |  [31m[1m          2464.4       [0m[0m  |  [31m[1m            755.5          [0m[0m  |  [31m[1m    2111.8  [0m[0m  |  [31m[1m               1966.7            [0m[0m  |  [31m[1m                    2475.5                 [0m[0m  |  [31m[1m                       755.1                      [0m[0m  |  [31m[1m                     1958.2                  [0m[0m
      8      x 768   |  [31m[1m          1427.3       [0m[0m  |  [2m[91m            448.3          [0m[0m  |  [2m[91m    1124.8  [0m[0m  |  [31m[1m               1002.4            [0m[0m  |  [31m[1m                    1436.4                 [0m[0m  |  [2m[91m                       450.6                      [0m[0m  |  [31m[1m                     1007.5                  [0m[0m
      4      x 768   |  [2m[91m           883.2       [0m[0m  |  [2m[91m            289.9          [0m[0m  |  [2m[91m     646.4  [0m[0m  |  [2m[91m                512.3            [0m[0m  |  [2m[91m                     872.8                 [0m[0m  |  [2m[91m                       290.7                      [0m[0m  |  [2m[91m                      497.9                  [0m[0m
      2      x 768   |  [2m[91m           625.3       [0m[0m  |  [2m[91m            215.7          [0m[0m  |       399.2    |                  270.8              |  [2m[91m                     606.7                 [0m[0m  |                         211.0                        |                        264.0                  
      1      x 768   |  [92m[1m           244.0       [0m[0m  |  [92m[1m            102.9          [0m[0m  |  [92m[1m     269.1  [0m[0m  |  [92m[1m                146.6            [0m[0m  |  [92m[1m                     243.6                 [0m[0m  |  [92m[1m                       112.1                      [0m[0m  |  [92m[1m                      141.4                  [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------- Sparsity 95 with 1 threads using compilation strategy script and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        264777.0       [0m[0m  |  [31m[1m          91073.0          [0m[0m  |  [31m[1m 1708074.8  [0m[0m  |  [31m[1m            1706112.0            [0m[0m  |  [31m[1m                  268144.9                 [0m[0m  |  [31m[1m                     91288.4                      [0m[0m  |  [31m[1m                  1712703.5                  [0m[0m
      1024   x 768   |  [31m[1m        132608.2       [0m[0m  |  [31m[1m          46335.7          [0m[0m  |  [31m[1m  855456.0  [0m[0m  |  [31m[1m             857033.4            [0m[0m  |  [31m[1m                  133726.6                 [0m[0m  |  [31m[1m                     46045.7                      [0m[0m  |  [31m[1m                   853439.2                  [0m[0m
      512    x 768   |  [31m[1m         66373.4       [0m[0m  |  [31m[1m          22730.8          [0m[0m  |  [31m[1m  428508.9  [0m[0m  |  [31m[1m             427486.2            [0m[0m  |  [31m[1m                   66473.9                 [0m[0m  |  [31m[1m                     22850.3                      [0m[0m  |  [31m[1m                   428322.0                  [0m[0m
      256    x 768   |  [31m[1m         33437.4       [0m[0m  |  [31m[1m          11550.9          [0m[0m  |  [31m[1m  218032.2  [0m[0m  |  [31m[1m             214361.6            [0m[0m  |  [31m[1m                   33707.5                 [0m[0m  |  [31m[1m                     11575.7                      [0m[0m  |  [31m[1m                   216201.3                  [0m[0m
      128    x 768   |  [31m[1m         16663.6       [0m[0m  |  [31m[1m           5840.7          [0m[0m  |  [31m[1m   74013.6  [0m[0m  |  [31m[1m              73774.7            [0m[0m  |  [31m[1m                   16816.8                 [0m[0m  |  [31m[1m                      5880.2                      [0m[0m  |  [31m[1m                    73510.7                  [0m[0m
      64     x 768   |  [31m[1m          8514.8       [0m[0m  |  [31m[1m           2992.2          [0m[0m  |  [31m[1m   35967.6  [0m[0m  |  [31m[1m              35706.1            [0m[0m  |  [31m[1m                    8712.7                 [0m[0m  |  [31m[1m                      3073.2                      [0m[0m  |  [31m[1m                    36218.9                  [0m[0m
      32     x 768   |  [31m[1m          4517.2       [0m[0m  |  [31m[1m           1608.3          [0m[0m  |  [31m[1m   17758.9  [0m[0m  |  [31m[1m              17495.8            [0m[0m  |  [31m[1m                    4580.2                 [0m[0m  |  [31m[1m                      1627.5                      [0m[0m  |  [31m[1m                    17776.1                  [0m[0m
      16     x 768   |  [31m[1m          2396.7       [0m[0m  |  [31m[1m            860.1          [0m[0m  |  [31m[1m    9099.2  [0m[0m  |  [31m[1m               8970.7            [0m[0m  |  [31m[1m                    2437.1                 [0m[0m  |  [31m[1m                       878.2                      [0m[0m  |  [31m[1m                     8881.3                  [0m[0m
      8      x 768   |  [31m[1m          1354.7       [0m[0m  |  [2m[91m            516.9          [0m[0m  |  [31m[1m    4643.2  [0m[0m  |  [31m[1m               4446.6            [0m[0m  |  [31m[1m                    1451.9                 [0m[0m  |  [2m[91m                       530.8                      [0m[0m  |  [31m[1m                     4492.4                  [0m[0m
      4      x 768   |  [2m[91m           840.7       [0m[0m  |  [2m[91m            338.7          [0m[0m  |  [2m[91m    2428.7  [0m[0m  |  [2m[91m               2300.0            [0m[0m  |  [2m[91m                     874.4                 [0m[0m  |  [2m[91m                       351.4                      [0m[0m  |  [2m[91m                     2270.3                  [0m[0m
      2      x 768   |  [2m[91m           586.2       [0m[0m  |  [2m[91m            243.1          [0m[0m  |      1334.1    |                 1175.8              |  [2m[91m                     590.2                 [0m[0m  |                         243.7                        |                       1155.2                  
      1      x 768   |  [92m[1m           223.7       [0m[0m  |  [92m[1m            110.2          [0m[0m  |  [92m[1m     721.3  [0m[0m  |  [92m[1m                591.9            [0m[0m  |  [92m[1m                     260.9                 [0m[0m  |  [92m[1m                       140.5                      [0m[0m  |  [92m[1m                      601.3                  [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------- Sparsity 90 with 1 threads using compilation strategy script and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        265351.8       [0m[0m  |  [31m[1m          101184.5         [0m[0m  |  [31m[1m 3394175.6  [0m[0m  |  [31m[1m            3443543.5            [0m[0m  |  [31m[1m                  266981.1                 [0m[0m  |  [31m[1m                     100622.7                     [0m[0m  |  [31m[1m                  3401728.8                  [0m[0m
      1024   x 768   |  [31m[1m        131290.4       [0m[0m  |  [31m[1m           50141.2         [0m[0m  |  [31m[1m 1696949.9  [0m[0m  |  [31m[1m            1710871.4            [0m[0m  |  [31m[1m                  133523.9                 [0m[0m  |  [31m[1m                      51044.1                     [0m[0m  |  [31m[1m                  1710407.9                  [0m[0m
      512    x 768   |  [31m[1m         66372.6       [0m[0m  |  [31m[1m           25157.7         [0m[0m  |  [31m[1m  857329.8  [0m[0m  |  [31m[1m             850271.0            [0m[0m  |  [31m[1m                   66484.5                 [0m[0m  |  [31m[1m                      25323.7                     [0m[0m  |  [31m[1m                   874790.5                  [0m[0m
      256    x 768   |  [31m[1m         33373.0       [0m[0m  |  [31m[1m           12734.9         [0m[0m  |  [31m[1m  429143.1  [0m[0m  |  [31m[1m             442647.4            [0m[0m  |  [31m[1m                   33576.0                 [0m[0m  |  [31m[1m                      12842.7                     [0m[0m  |  [31m[1m                   429535.5                  [0m[0m
      128    x 768   |  [31m[1m         16857.7       [0m[0m  |  [31m[1m            6467.4         [0m[0m  |  [31m[1m  214240.4  [0m[0m  |  [31m[1m             213660.5            [0m[0m  |  [31m[1m                   16863.7                 [0m[0m  |  [31m[1m                       6480.9                     [0m[0m  |  [31m[1m                   213834.3                  [0m[0m
      64     x 768   |  [31m[1m          8522.7       [0m[0m  |  [31m[1m            3308.5         [0m[0m  |  [31m[1m   73047.8  [0m[0m  |  [31m[1m              72885.3            [0m[0m  |  [31m[1m                    8655.2                 [0m[0m  |  [31m[1m                       3356.4                     [0m[0m  |  [31m[1m                    72612.7                  [0m[0m
      32     x 768   |  [31m[1m          4460.1       [0m[0m  |  [31m[1m            1764.6         [0m[0m  |  [31m[1m   36355.9  [0m[0m  |  [31m[1m              36042.7            [0m[0m  |  [31m[1m                    4541.5                 [0m[0m  |  [31m[1m                       1778.9                     [0m[0m  |  [31m[1m                    36770.1                  [0m[0m
      16     x 768   |  [31m[1m          2421.0       [0m[0m  |  [31m[1m             947.7         [0m[0m  |  [31m[1m   17794.0  [0m[0m  |  [31m[1m              17582.7            [0m[0m  |  [31m[1m                    2420.3                 [0m[0m  |  [31m[1m                        963.7                     [0m[0m  |  [31m[1m                    17657.9                  [0m[0m
      8      x 768   |  [31m[1m          1342.2       [0m[0m  |  [2m[91m             549.9         [0m[0m  |  [31m[1m    8941.2  [0m[0m  |  [31m[1m               8811.9            [0m[0m  |  [31m[1m                    1400.1                 [0m[0m  |  [2m[91m                        565.9                     [0m[0m  |  [31m[1m                     8851.7                  [0m[0m
      4      x 768   |  [2m[91m           797.9       [0m[0m  |  [2m[91m             344.4         [0m[0m  |  [2m[91m    4575.3  [0m[0m  |  [2m[91m               4495.6            [0m[0m  |  [2m[91m                     874.6                 [0m[0m  |  [2m[91m                        376.6                     [0m[0m  |  [2m[91m                     4510.0                  [0m[0m
      2      x 768   |  [2m[91m           584.7       [0m[0m  |  [2m[91m             255.6         [0m[0m  |      2399.5    |                 2266.8              |  [2m[91m                     605.0                 [0m[0m  |  [2m[91m                        264.7                     [0m[0m  |                       2265.8                  
      1      x 768   |  [92m[1m           226.7       [0m[0m  |  [92m[1m             118.1         [0m[0m  |  [92m[1m    1309.4  [0m[0m  |  [92m[1m               1170.4            [0m[0m  |  [92m[1m                     240.4                 [0m[0m  |  [92m[1m                        129.6                     [0m[0m  |  [92m[1m                     1156.9                  [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------- Sparsity 80 with 1 threads using compilation strategy script and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
1 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        265512.8       [0m[0m  |  [31m[1m          105948.2         [0m[0m  |  [31m[1m 6709779.0  [0m[0m  |  [31m[1m            6712427.1            [0m[0m  |  [31m[1m                  266063.0                 [0m[0m  |  [31m[1m                     107830.4                     [0m[0m  |  [31m[1m                  6729858.0                  [0m[0m
      1024   x 768   |  [31m[1m        132242.3       [0m[0m  |  [31m[1m           53214.8         [0m[0m  |  [31m[1m 3388774.4  [0m[0m  |  [31m[1m            3564455.8            [0m[0m  |  [31m[1m                  133157.2                 [0m[0m  |  [31m[1m                      53706.4                     [0m[0m  |  [31m[1m                  3372557.5                  [0m[0m
      512    x 768   |  [31m[1m         66400.6       [0m[0m  |  [31m[1m           26690.5         [0m[0m  |  [31m[1m 1686534.2  [0m[0m  |  [31m[1m            1690683.9            [0m[0m  |  [31m[1m                   66470.7                 [0m[0m  |  [31m[1m                      26671.6                     [0m[0m  |  [31m[1m                  1690130.7                  [0m[0m
      256    x 768   |  [31m[1m         33381.2       [0m[0m  |  [31m[1m           13420.2         [0m[0m  |  [31m[1m  844512.3  [0m[0m  |  [31m[1m             846952.6            [0m[0m  |  [31m[1m                   33811.6                 [0m[0m  |  [31m[1m                      13392.3                     [0m[0m  |  [31m[1m                   839684.5                  [0m[0m
      128    x 768   |  [31m[1m         16645.5       [0m[0m  |  [31m[1m            6820.1         [0m[0m  |  [31m[1m  420102.2  [0m[0m  |  [31m[1m             425594.0            [0m[0m  |  [31m[1m                   16791.2                 [0m[0m  |  [31m[1m                       6867.6                     [0m[0m  |  [31m[1m                   419804.5                  [0m[0m
      64     x 768   |  [31m[1m          8537.3       [0m[0m  |  [31m[1m            3484.0         [0m[0m  |  [31m[1m  209710.4  [0m[0m  |  [31m[1m             209089.1            [0m[0m  |  [31m[1m                    8656.1                 [0m[0m  |  [31m[1m                       3502.2                     [0m[0m  |  [31m[1m                   210221.0                  [0m[0m
      32     x 768   |  [31m[1m          4474.3       [0m[0m  |  [31m[1m            1845.5         [0m[0m  |  [31m[1m   72259.8  [0m[0m  |  [31m[1m              72663.8            [0m[0m  |  [31m[1m                    4511.7                 [0m[0m  |  [31m[1m                       1861.9                     [0m[0m  |  [31m[1m                    72092.3                  [0m[0m
      16     x 768   |  [31m[1m          2410.3       [0m[0m  |  [31m[1m            1028.1         [0m[0m  |  [31m[1m   35785.5  [0m[0m  |  [31m[1m              35558.2            [0m[0m  |  [31m[1m                    2465.7                 [0m[0m  |  [31m[1m                       1025.9                     [0m[0m  |  [31m[1m                    36287.2                  [0m[0m
      8      x 768   |  [31m[1m          1424.3       [0m[0m  |  [2m[91m             600.4         [0m[0m  |  [31m[1m   17600.4  [0m[0m  |  [31m[1m              17425.7            [0m[0m  |  [31m[1m                    1392.0                 [0m[0m  |  [2m[91m                        602.2                     [0m[0m  |  [31m[1m                    17660.4                  [0m[0m
      4      x 768   |  [2m[91m           796.0       [0m[0m  |  [2m[91m             358.7         [0m[0m  |  [2m[91m    8936.4  [0m[0m  |  [2m[91m               8806.1            [0m[0m  |  [2m[91m                     867.1                 [0m[0m  |  [2m[91m                        384.3                     [0m[0m  |  [2m[91m                     8782.8                  [0m[0m
      2      x 768   |  [2m[91m           587.5       [0m[0m  |  [2m[91m             295.4         [0m[0m  |      4692.2    |                 4576.9              |  [2m[91m                     619.7                 [0m[0m  |  [2m[91m                        271.8                     [0m[0m  |                       4551.3                  
      1      x 768   |  [92m[1m           257.8       [0m[0m  |  [92m[1m             120.5         [0m[0m  |  [92m[1m    2436.9  [0m[0m  |  [92m[1m               2313.8            [0m[0m  |  [92m[1m                     239.4                 [0m[0m  |  [92m[1m                        132.0                     [0m[0m  |  [92m[1m                     2300.0                  [0m[0m

Times are in microseconds (us).

Sparsity 99 with 1 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 1 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 1 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 1 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[------------------------------------------------------------------------------------------ Sparsity 99 with 1 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
1 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        271040.7       [0m[0m  |  [31m[1m          78057.9          [0m[0m  |  [31m[1m  366974.7  [0m[0m  |  [31m[1m             366065.7            [0m[0m  |  [31m[1m                 269934.1                 [0m[0m  |  [31m[1m                     77760.5                     [0m[0m  |  [31m[1m                  365888.0                  [0m[0m
      1024   x 768   |  [31m[1m        134428.1       [0m[0m  |  [31m[1m          38930.5          [0m[0m  |  [31m[1m  183840.7  [0m[0m  |  [31m[1m             181978.0            [0m[0m  |  [31m[1m                 134507.2                 [0m[0m  |  [31m[1m                     38783.9                     [0m[0m  |  [31m[1m                  180266.8                  [0m[0m
      512    x 768   |  [31m[1m         67552.8       [0m[0m  |  [31m[1m          19269.1          [0m[0m  |  [31m[1m   63563.6  [0m[0m  |  [31m[1m              63402.2            [0m[0m  |  [31m[1m                  72767.3                 [0m[0m  |  [31m[1m                     19810.6                     [0m[0m  |  [31m[1m                   63164.6                  [0m[0m
      256    x 768   |  [31m[1m         33802.1       [0m[0m  |  [31m[1m           9775.5          [0m[0m  |  [31m[1m   31363.5  [0m[0m  |  [31m[1m              31134.0            [0m[0m  |  [31m[1m                  33775.7                 [0m[0m  |  [31m[1m                      9726.1                     [0m[0m  |  [31m[1m                   31195.4                  [0m[0m
      128    x 768   |  [31m[1m         16736.3       [0m[0m  |  [31m[1m           4985.8          [0m[0m  |  [31m[1m   15326.9  [0m[0m  |  [31m[1m              15134.7            [0m[0m  |  [31m[1m                  16642.5                 [0m[0m  |  [31m[1m                      4993.4                     [0m[0m  |  [31m[1m                   15155.5                  [0m[0m
      64     x 768   |  [31m[1m          8810.6       [0m[0m  |  [31m[1m           2567.5          [0m[0m  |  [31m[1m    7874.5  [0m[0m  |  [31m[1m               7784.5            [0m[0m  |  [31m[1m                   8775.3                 [0m[0m  |  [31m[1m                      2573.9                     [0m[0m  |  [31m[1m                    7773.0                  [0m[0m
      32     x 768   |  [31m[1m          4516.0       [0m[0m  |  [31m[1m           1369.7          [0m[0m  |  [31m[1m    4003.8  [0m[0m  |  [31m[1m               3861.0            [0m[0m  |  [31m[1m                   4530.3                 [0m[0m  |  [31m[1m                      1386.5                     [0m[0m  |  [31m[1m                    3901.7                  [0m[0m
      16     x 768   |  [31m[1m          2461.1       [0m[0m  |  [31m[1m            760.9          [0m[0m  |  [31m[1m    2112.7  [0m[0m  |  [31m[1m               1964.1            [0m[0m  |  [31m[1m                   2452.4                 [0m[0m  |  [31m[1m                       765.5                     [0m[0m  |  [31m[1m                    1965.8                  [0m[0m
      8      x 768   |  [31m[1m          1423.2       [0m[0m  |  [2m[91m            453.3          [0m[0m  |  [2m[91m    1127.7  [0m[0m  |  [31m[1m               1035.8            [0m[0m  |  [31m[1m                   1458.8                 [0m[0m  |  [2m[91m                       483.4                     [0m[0m  |  [31m[1m                    1015.8                  [0m[0m
      4      x 768   |  [2m[91m           890.6       [0m[0m  |  [2m[91m            304.7          [0m[0m  |  [2m[91m     652.5  [0m[0m  |  [2m[91m                515.8            [0m[0m  |  [2m[91m                    903.3                 [0m[0m  |  [2m[91m                       319.3                     [0m[0m  |  [2m[91m                     521.7                  [0m[0m
      2      x 768   |  [2m[91m           640.3       [0m[0m  |  [2m[91m            230.2          [0m[0m  |       397.2    |                  265.2              |  [2m[91m                    633.2                 [0m[0m  |                         217.6                       |                       264.0                  
      1      x 768   |  [92m[1m           248.1       [0m[0m  |  [92m[1m            105.7          [0m[0m  |  [92m[1m     264.2  [0m[0m  |  [92m[1m                143.0            [0m[0m  |  [92m[1m                    262.1                 [0m[0m  |  [92m[1m                       118.7                     [0m[0m  |  [92m[1m                     144.9                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------ Sparsity 95 with 1 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
1 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        265859.7       [0m[0m  |  [31m[1m          91522.5          [0m[0m  |  [31m[1m 1700453.0  [0m[0m  |  [31m[1m            1706512.4            [0m[0m  |  [31m[1m                 267479.0                 [0m[0m  |  [31m[1m                     92669.1                     [0m[0m  |  [31m[1m                 1738109.5                  [0m[0m
      1024   x 768   |  [31m[1m        135240.0       [0m[0m  |  [31m[1m          46056.0          [0m[0m  |  [31m[1m  861235.5  [0m[0m  |  [31m[1m             859126.5            [0m[0m  |  [31m[1m                 134266.6                 [0m[0m  |  [31m[1m                     45776.9                     [0m[0m  |  [31m[1m                  858821.1                  [0m[0m
      512    x 768   |  [31m[1m         67533.1       [0m[0m  |  [31m[1m          22830.4          [0m[0m  |  [31m[1m  433334.1  [0m[0m  |  [31m[1m             430053.1            [0m[0m  |  [31m[1m                  67708.1                 [0m[0m  |  [31m[1m                     22821.3                     [0m[0m  |  [31m[1m                  431036.5                  [0m[0m
      256    x 768   |  [31m[1m         33660.5       [0m[0m  |  [31m[1m          11599.2          [0m[0m  |  [31m[1m  215465.9  [0m[0m  |  [31m[1m             214775.8            [0m[0m  |  [31m[1m                  33490.0                 [0m[0m  |  [31m[1m                     11555.1                     [0m[0m  |  [31m[1m                  214660.3                  [0m[0m
      128    x 768   |  [31m[1m         16787.6       [0m[0m  |  [31m[1m           5918.7          [0m[0m  |  [31m[1m   74686.3  [0m[0m  |  [31m[1m              74455.1            [0m[0m  |  [31m[1m                  16832.9                 [0m[0m  |  [31m[1m                      5991.1                     [0m[0m  |  [31m[1m                   72976.3                  [0m[0m
      64     x 768   |  [31m[1m          8681.8       [0m[0m  |  [31m[1m           3063.3          [0m[0m  |  [31m[1m   36138.7  [0m[0m  |  [31m[1m              36023.0            [0m[0m  |  [31m[1m                   8613.4                 [0m[0m  |  [31m[1m                      3046.7                     [0m[0m  |  [31m[1m                   36858.4                  [0m[0m
      32     x 768   |  [31m[1m          4487.6       [0m[0m  |  [31m[1m           1631.5          [0m[0m  |  [31m[1m   17990.5  [0m[0m  |  [31m[1m              17574.4            [0m[0m  |  [31m[1m                   4525.7                 [0m[0m  |  [31m[1m                      1632.3                     [0m[0m  |  [31m[1m                   17754.5                  [0m[0m
      16     x 768   |  [31m[1m          2443.2       [0m[0m  |  [31m[1m            893.4          [0m[0m  |  [31m[1m    9048.8  [0m[0m  |  [31m[1m               8918.1            [0m[0m  |  [31m[1m                   2446.9                 [0m[0m  |  [31m[1m                       928.8                     [0m[0m  |  [31m[1m                    8889.0                  [0m[0m
      8      x 768   |  [31m[1m          1403.5       [0m[0m  |  [2m[91m            518.1          [0m[0m  |  [31m[1m    4605.7  [0m[0m  |  [31m[1m               4478.5            [0m[0m  |  [31m[1m                   1404.9                 [0m[0m  |  [2m[91m                       555.2                     [0m[0m  |  [31m[1m                    4491.2                  [0m[0m
      4      x 768   |  [2m[91m           898.6       [0m[0m  |  [2m[91m            337.3          [0m[0m  |  [2m[91m    2398.5  [0m[0m  |  [2m[91m               2253.8            [0m[0m  |  [2m[91m                    883.3                 [0m[0m  |  [2m[91m                       351.4                     [0m[0m  |  [2m[91m                    2255.8                  [0m[0m
      2      x 768   |  [2m[91m           626.7       [0m[0m  |  [2m[91m            253.5          [0m[0m  |      1294.0    |                 1145.6              |  [2m[91m                    638.3                 [0m[0m  |                         251.9                       |                      1150.5                  
      1      x 768   |  [92m[1m           240.5       [0m[0m  |  [92m[1m            115.4          [0m[0m  |  [92m[1m     721.5  [0m[0m  |  [92m[1m                587.9            [0m[0m  |  [92m[1m                    251.2                 [0m[0m  |  [92m[1m                       127.6                     [0m[0m  |  [92m[1m                     591.7                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------ Sparsity 90 with 1 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
1 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        266169.1       [0m[0m  |  [31m[1m          101627.0         [0m[0m  |  [31m[1m 3407761.4  [0m[0m  |  [31m[1m            3519639.9            [0m[0m  |  [31m[1m                 268332.6                 [0m[0m  |  [31m[1m                     101536.5                    [0m[0m  |  [31m[1m                 3398777.2                  [0m[0m
      1024   x 768   |  [31m[1m        131934.2       [0m[0m  |  [31m[1m           50420.6         [0m[0m  |  [31m[1m 1704841.2  [0m[0m  |  [31m[1m            1711083.7            [0m[0m  |  [31m[1m                 131795.0                 [0m[0m  |  [31m[1m                      50536.7                    [0m[0m  |  [31m[1m                 1710568.0                  [0m[0m
      512    x 768   |  [31m[1m         66607.9       [0m[0m  |  [31m[1m           25044.7         [0m[0m  |  [31m[1m  856714.1  [0m[0m  |  [31m[1m             854107.6            [0m[0m  |  [31m[1m                  66718.8                 [0m[0m  |  [31m[1m                      25336.7                    [0m[0m  |  [31m[1m                  854479.5                  [0m[0m
      256    x 768   |  [31m[1m         32800.0       [0m[0m  |  [31m[1m           12722.7         [0m[0m  |  [31m[1m  433410.4  [0m[0m  |  [31m[1m             431750.7            [0m[0m  |  [31m[1m                  32969.7                 [0m[0m  |  [31m[1m                      12685.7                    [0m[0m  |  [31m[1m                  429446.0                  [0m[0m
      128    x 768   |  [31m[1m         16736.1       [0m[0m  |  [31m[1m            6521.1         [0m[0m  |  [31m[1m  220835.7  [0m[0m  |  [31m[1m             213796.3            [0m[0m  |  [31m[1m                  16677.8                 [0m[0m  |  [31m[1m                       6538.6                    [0m[0m  |  [31m[1m                  216398.7                  [0m[0m
      64     x 768   |  [31m[1m          8605.2       [0m[0m  |  [31m[1m            3367.5         [0m[0m  |  [31m[1m   76658.4  [0m[0m  |  [31m[1m              72855.5            [0m[0m  |  [31m[1m                   8657.5                 [0m[0m  |  [31m[1m                       3364.0                    [0m[0m  |  [31m[1m                   73173.9                  [0m[0m
      32     x 768   |  [31m[1m          4486.0       [0m[0m  |  [31m[1m            1753.6         [0m[0m  |  [31m[1m   36664.7  [0m[0m  |  [31m[1m              36170.5            [0m[0m  |  [31m[1m                   4446.7                 [0m[0m  |  [31m[1m                       1761.2                    [0m[0m  |  [31m[1m                   36429.9                  [0m[0m
      16     x 768   |  [31m[1m          2412.3       [0m[0m  |  [31m[1m            1057.5         [0m[0m  |  [31m[1m   18428.7  [0m[0m  |  [31m[1m              18112.0            [0m[0m  |  [31m[1m                   2477.1                 [0m[0m  |  [31m[1m                        976.1                    [0m[0m  |  [31m[1m                   18046.8                  [0m[0m
      8      x 768   |  [31m[1m          1404.6       [0m[0m  |  [2m[91m             570.9         [0m[0m  |  [31m[1m    9208.6  [0m[0m  |  [31m[1m               8907.3            [0m[0m  |  [31m[1m                   1435.4                 [0m[0m  |  [2m[91m                        603.9                    [0m[0m  |  [31m[1m                    8914.5                  [0m[0m
      4      x 768   |  [2m[91m           854.8       [0m[0m  |  [2m[91m             373.6         [0m[0m  |  [2m[91m    4642.5  [0m[0m  |  [2m[91m               4472.0            [0m[0m  |  [2m[91m                    866.0                 [0m[0m  |  [2m[91m                        392.7                    [0m[0m  |  [2m[91m                    4611.3                  [0m[0m
      2      x 768   |  [2m[91m           565.1       [0m[0m  |  [2m[91m             271.9         [0m[0m  |      2397.0    |                 2251.7              |  [2m[91m                    612.0                 [0m[0m  |  [2m[91m                        272.5                    [0m[0m  |                      2268.7                  
      1      x 768   |  [92m[1m           236.7       [0m[0m  |  [92m[1m             118.7         [0m[0m  |  [92m[1m    1290.3  [0m[0m  |  [92m[1m               1153.1            [0m[0m  |  [92m[1m                    250.3                 [0m[0m  |  [92m[1m                        131.5                    [0m[0m  |  [92m[1m                    1166.8                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------ Sparsity 80 with 1 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
1 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        264325.0       [0m[0m  |  [31m[1m          105391.1         [0m[0m  |  [31m[1m 6731819.0  [0m[0m  |  [31m[1m            6699633.0            [0m[0m  |  [31m[1m                 269176.6                 [0m[0m  |  [31m[1m                     107966.1                    [0m[0m  |  [31m[1m                 6981154.0                  [0m[0m
      1024   x 768   |  [31m[1m        132163.5       [0m[0m  |  [31m[1m           53699.8         [0m[0m  |  [31m[1m 3477745.8  [0m[0m  |  [31m[1m            3427500.5            [0m[0m  |  [31m[1m                 132405.7                 [0m[0m  |  [31m[1m                      54127.3                    [0m[0m  |  [31m[1m                 3396403.0                  [0m[0m
      512    x 768   |  [31m[1m         67757.1       [0m[0m  |  [31m[1m           26532.7         [0m[0m  |  [31m[1m 1709696.4  [0m[0m  |  [31m[1m            1719893.6            [0m[0m  |  [31m[1m                  66893.1                 [0m[0m  |  [31m[1m                      26554.0                    [0m[0m  |  [31m[1m                 1701753.2                  [0m[0m
      256    x 768   |  [31m[1m         33220.8       [0m[0m  |  [31m[1m           13537.1         [0m[0m  |  [31m[1m  853108.0  [0m[0m  |  [31m[1m             849679.4            [0m[0m  |  [31m[1m                  33612.3                 [0m[0m  |  [31m[1m                      13442.3                    [0m[0m  |  [31m[1m                  847339.3                  [0m[0m
      128    x 768   |  [31m[1m         16888.8       [0m[0m  |  [31m[1m            6897.0         [0m[0m  |  [31m[1m  429289.0  [0m[0m  |  [31m[1m             431622.2            [0m[0m  |  [31m[1m                  16840.4                 [0m[0m  |  [31m[1m                       6889.5                    [0m[0m  |  [31m[1m                  430439.6                  [0m[0m
      64     x 768   |  [31m[1m          8777.0       [0m[0m  |  [31m[1m            3521.2         [0m[0m  |  [31m[1m  213627.3  [0m[0m  |  [31m[1m             216647.6            [0m[0m  |  [31m[1m                   8718.6                 [0m[0m  |  [31m[1m                       3566.0                    [0m[0m  |  [31m[1m                  214156.2                  [0m[0m
      32     x 768   |  [31m[1m          4517.7       [0m[0m  |  [31m[1m            1865.5         [0m[0m  |  [31m[1m   75938.2  [0m[0m  |  [31m[1m              75398.9            [0m[0m  |  [31m[1m                   4542.0                 [0m[0m  |  [31m[1m                       1890.0                    [0m[0m  |  [31m[1m                   72747.7                  [0m[0m
      16     x 768   |  [31m[1m          2482.1       [0m[0m  |  [31m[1m            1040.2         [0m[0m  |  [31m[1m   36851.7  [0m[0m  |  [31m[1m              36898.4            [0m[0m  |  [31m[1m                   2481.1                 [0m[0m  |  [31m[1m                       1054.8                    [0m[0m  |  [31m[1m                   36550.8                  [0m[0m
      8      x 768   |  [31m[1m          1449.4       [0m[0m  |  [2m[91m             623.8         [0m[0m  |  [31m[1m   17809.8  [0m[0m  |  [31m[1m              17654.6            [0m[0m  |  [31m[1m                   1451.3                 [0m[0m  |  [2m[91m                        634.0                    [0m[0m  |  [31m[1m                   17702.4                  [0m[0m
      4      x 768   |  [2m[91m           881.7       [0m[0m  |  [2m[91m             396.4         [0m[0m  |  [2m[91m    8993.1  [0m[0m  |  [2m[91m               8801.0            [0m[0m  |  [2m[91m                    901.5                 [0m[0m  |  [2m[91m                        416.4                    [0m[0m  |  [2m[91m                    8808.5                  [0m[0m
      2      x 768   |  [2m[91m           636.8       [0m[0m  |  [2m[91m             296.7         [0m[0m  |      4758.6    |  [2m[91m               4557.9            [0m[0m  |  [2m[91m                    607.8                 [0m[0m  |  [2m[91m                        294.6                    [0m[0m  |                      4476.6                  
      1      x 768   |  [92m[1m           237.6       [0m[0m  |  [92m[1m             125.5         [0m[0m  |  [92m[1m    2396.2  [0m[0m  |  [92m[1m               2256.1            [0m[0m  |  [92m[1m                    249.7                 [0m[0m  |  [92m[1m                        135.9                    [0m[0m  |  [92m[1m                    2270.6                  [0m[0m

Times are in microseconds (us).

Sparsity 99 with 40 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 40 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 40 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 40 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[--------------------------------------------------------------------------------------------- Sparsity 99 with 40 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu. ---------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  Fine-grained + structured with backend inductor
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        20269.8        [0m[0m  |  [31m[1m           5874.5          [0m[0m  |  [31m[1m  37912.2   [0m[0m  |  [31m[1m             32528.0             [0m[0m  |  [31m[1m                   16774.4                   [0m[0m  |  [31m[1m                       3295.6                       [0m[0m  |  [31m[1m                     8023.4                    [0m[0m
      1024   x 768   |  [31m[1m         9942.0        [0m[0m  |  [31m[1m           1787.4          [0m[0m  |  [31m[1m  16519.9   [0m[0m  |  [31m[1m             15883.4             [0m[0m  |  [31m[1m                    5620.1                   [0m[0m  |  [31m[1m                       1893.1                       [0m[0m  |  [31m[1m                     4025.0                    [0m[0m
      512    x 768   |  [31m[1m         3104.2        [0m[0m  |  [31m[1m           1091.8          [0m[0m  |  [31m[1m   2468.7   [0m[0m  |  [31m[1m              2307.4             [0m[0m  |  [31m[1m                    3143.6                   [0m[0m  |  [31m[1m                       1161.9                       [0m[0m  |  [31m[1m                     2054.6                    [0m[0m
      256    x 768   |  [31m[1m         1897.6        [0m[0m  |  [31m[1m            637.7          [0m[0m  |  [31m[1m   1345.2   [0m[0m  |  [31m[1m              1232.3             [0m[0m  |  [31m[1m                    1876.2                   [0m[0m  |  [2m[91m                        718.6                       [0m[0m  |  [31m[1m                     1130.0                    [0m[0m
      128    x 768   |  [31m[1m         1228.3        [0m[0m  |  [2m[91m            411.5          [0m[0m  |  [2m[91m    797.6   [0m[0m  |  [31m[1m               652.9             [0m[0m  |  [31m[1m                    1350.8                   [0m[0m  |  [2m[91m                        622.3                       [0m[0m  |  [2m[91m                      770.0                    [0m[0m
      64     x 768   |  [31m[1m          569.8        [0m[0m  |  [2m[91m            238.9          [0m[0m  |  [2m[91m    615.5   [0m[0m  |  [2m[91m               427.8             [0m[0m  |  [2m[91m                     578.6                   [0m[0m  |                          321.7                         |  [2m[91m                      395.1                    [0m[0m
      32     x 768   |  [2m[91m          334.8        [0m[0m  |              171.6            |      466.5     |  [2m[91m               279.7             [0m[0m  |  [2m[91m                     417.2                   [0m[0m  |                          254.2                         |                        233.4                    
      16     x 768   |  [2m[91m          232.9        [0m[0m  |              135.9            |      371.8     |  [2m[91m               239.1             [0m[0m  |  [2m[91m                     283.3                   [0m[0m  |                          213.6                         |                        220.2                    
      8      x 768   |            159.7          |              119.4            |      303.9     |                 138.2               |                       208.1                     |                          186.5                         |                        218.1                    
      4      x 768   |            138.1          |  [34m[1m            107.3          [0m[0m  |      333.4     |                 127.8               |                       175.3                     |  [34m[1m                        172.5                       [0m[0m  |  [2m[91m                      531.5                    [0m[0m
      2      x 768   |  [34m[1m          110.2        [0m[0m  |  [34m[1m            103.7          [0m[0m  |  [34m[1m    273.2   [0m[0m  |                 114.7               |  [34m[1m                     143.7                   [0m[0m  |  [34m[1m                        166.4                       [0m[0m  |                        284.7                    
      1      x 768   |  [92m[1m          102.8        [0m[0m  |  [92m[1m             98.9          [0m[0m  |  [92m[1m    257.1   [0m[0m  |  [92m[1m                96.9             [0m[0m  |  [92m[1m                     132.4                   [0m[0m  |  [92m[1m                        162.8                       [0m[0m  |  [92m[1m                      159.5                    [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------- Sparsity 95 with 40 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu. ---------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  Fine-grained + structured with backend inductor
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        19713.8        [0m[0m  |  [31m[1m           6846.1          [0m[0m  |  [31m[1m  185447.9  [0m[0m  |  [31m[1m             182176.6            [0m[0m  |  [31m[1m                   19939.5                   [0m[0m  |  [31m[1m                       3942.0                       [0m[0m  |  [31m[1m                    41689.3                    [0m[0m
      1024   x 768   |  [31m[1m         9928.6        [0m[0m  |  [31m[1m           3593.9          [0m[0m  |  [31m[1m   94006.4  [0m[0m  |  [31m[1m              90807.6            [0m[0m  |  [31m[1m                    5655.1                   [0m[0m  |  [31m[1m                       2186.7                       [0m[0m  |  [31m[1m                    21133.6                    [0m[0m
      512    x 768   |  [31m[1m         3065.3        [0m[0m  |  [31m[1m           1235.5          [0m[0m  |  [31m[1m   41135.7  [0m[0m  |  [31m[1m              40670.5            [0m[0m  |  [31m[1m                    3096.6                   [0m[0m  |  [31m[1m                       1310.8                       [0m[0m  |  [31m[1m                    10558.6                    [0m[0m
      256    x 768   |  [31m[1m         1849.1        [0m[0m  |  [31m[1m            766.5          [0m[0m  |  [31m[1m   20870.2  [0m[0m  |  [31m[1m              20189.9            [0m[0m  |  [31m[1m                    3072.3                   [0m[0m  |  [31m[1m                        880.1                       [0m[0m  |  [31m[1m                     5794.7                    [0m[0m
      128    x 768   |  [31m[1m         1091.6        [0m[0m  |  [31m[1m            631.9          [0m[0m  |  [31m[1m    4919.4  [0m[0m  |  [31m[1m               4703.1            [0m[0m  |  [31m[1m                    1114.5                   [0m[0m  |  [2m[91m                        543.7                       [0m[0m  |  [2m[91m                     3353.9                    [0m[0m
      64     x 768   |  [31m[1m          537.5        [0m[0m  |  [2m[91m            254.6          [0m[0m  |  [31m[1m    1533.3  [0m[0m  |  [31m[1m               1371.8            [0m[0m  |  [2m[91m                     582.9                   [0m[0m  |  [2m[91m                        336.9                       [0m[0m  |  [2m[91m                     1779.4                    [0m[0m
      32     x 768   |  [2m[91m          353.3        [0m[0m  |              194.9            |  [2m[91m     900.1  [0m[0m  |  [31m[1m                740.4            [0m[0m  |  [2m[91m                     376.2                   [0m[0m  |                          275.2                         |                        930.3                    
      16     x 768   |  [2m[91m          226.4        [0m[0m  |              154.1            |       561.5    |  [31m[1m                634.2            [0m[0m  |                       271.2                     |                          240.5                         |                        896.3                    
      8      x 768   |            186.3          |              119.7            |       473.7    |  [2m[91m                293.1            [0m[0m  |                       197.4                     |                          189.8                         |                        884.2                    
      4      x 768   |            131.2          |              109.1            |       366.0    |                  190.9              |                       163.4                     |  [34m[1m                        173.9                       [0m[0m  |                        881.3                    
      2      x 768   |  [34m[1m          109.4        [0m[0m  |  [34m[1m            103.1          [0m[0m  |       339.8    |                  165.5              |  [34m[1m                     142.0                   [0m[0m  |  [92m[1m                        166.3                       [0m[0m  |                        881.2                    
      1      x 768   |  [92m[1m          103.2        [0m[0m  |  [92m[1m             98.5          [0m[0m  |  [92m[1m     292.3  [0m[0m  |  [92m[1m                106.3            [0m[0m  |  [92m[1m                     135.7                   [0m[0m  |                          186.3                         |  [92m[1m                      717.0                    [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------- Sparsity 90 with 40 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu. ---------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  Fine-grained + structured with backend inductor
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        11257.6        [0m[0m  |  [31m[1m           4169.3          [0m[0m  |  [31m[1m  303149.1  [0m[0m  |  [31m[1m             353128.4            [0m[0m  |  [31m[1m                   11583.4                   [0m[0m  |  [31m[1m                       4242.9                       [0m[0m  |  [31m[1m                    84742.9                    [0m[0m
      1024   x 768   |  [31m[1m         5622.5        [0m[0m  |  [31m[1m           3982.8          [0m[0m  |  [31m[1m  184007.7  [0m[0m  |  [31m[1m             186385.0            [0m[0m  |  [31m[1m                    5689.9                   [0m[0m  |  [31m[1m                       2348.6                       [0m[0m  |  [31m[1m                    42439.8                    [0m[0m
      512    x 768   |  [31m[1m         3115.8        [0m[0m  |  [31m[1m           1342.3          [0m[0m  |  [31m[1m   87029.1  [0m[0m  |  [31m[1m              82963.8            [0m[0m  |  [31m[1m                    3127.2                   [0m[0m  |  [31m[1m                       1400.2                       [0m[0m  |  [31m[1m                    21201.1                    [0m[0m
      256    x 768   |  [31m[1m         1833.1        [0m[0m  |  [31m[1m            769.8          [0m[0m  |  [31m[1m   41939.6  [0m[0m  |  [31m[1m              41566.2            [0m[0m  |  [31m[1m                    1861.4                   [0m[0m  |  [31m[1m                        840.7                       [0m[0m  |  [31m[1m                    11372.9                    [0m[0m
      128    x 768   |  [31m[1m         1072.9        [0m[0m  |  [31m[1m            498.9          [0m[0m  |  [31m[1m   21194.2  [0m[0m  |  [31m[1m              20787.4            [0m[0m  |  [31m[1m                    1113.8                   [0m[0m  |  [2m[91m                        579.3                       [0m[0m  |  [31m[1m                     6692.2                    [0m[0m
      64     x 768   |  [31m[1m          536.8        [0m[0m  |  [2m[91m            272.0          [0m[0m  |  [31m[1m    3025.1  [0m[0m  |  [31m[1m               2871.4            [0m[0m  |  [2m[91m                     583.7                   [0m[0m  |  [2m[91m                        369.3                       [0m[0m  |  [31m[1m                     2760.8                    [0m[0m
      32     x 768   |  [2m[91m          429.5        [0m[0m  |  [2m[91m            203.3          [0m[0m  |  [2m[91m    1501.6  [0m[0m  |  [31m[1m               1387.7            [0m[0m  |  [2m[91m                     367.0                   [0m[0m  |                          282.0                         |  [31m[1m                     1434.0                    [0m[0m
      16     x 768   |  [2m[91m          226.5        [0m[0m  |              168.1            |  [2m[91m     892.2  [0m[0m  |  [31m[1m                756.9            [0m[0m  |  [2m[91m                     266.7                   [0m[0m  |                          226.3                         |  [31m[1m                      758.7                    [0m[0m
      8      x 768   |            160.6          |              135.6            |       557.2    |  [2m[91m                397.1            [0m[0m  |                       206.0                     |                          200.4                         |  [2m[91m                      400.6                    [0m[0m
      4      x 768   |            129.1          |              111.5            |       471.8    |  [2m[91m                286.5            [0m[0m  |                       164.7                     |  [34m[1m                        175.7                       [0m[0m  |  [2m[91m                      235.7                    [0m[0m
      2      x 768   |  [34m[1m          111.9        [0m[0m  |  [34m[1m            102.5          [0m[0m  |  [34m[1m     320.4  [0m[0m  |                  169.2              |  [34m[1m                     145.0                   [0m[0m  |  [34m[1m                        167.4                       [0m[0m  |                        173.1                    
      1      x 768   |  [92m[1m          102.7        [0m[0m  |  [92m[1m             97.3          [0m[0m  |  [92m[1m     316.3  [0m[0m  |  [92m[1m                142.5            [0m[0m  |  [92m[1m                     132.4                   [0m[0m  |  [92m[1m                        165.7                       [0m[0m  |  [92m[1m                      109.5                    [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------- Sparsity 80 with 40 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu. ---------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  Fine-grained + structured with backend inductor
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        10672.6        [0m[0m  |  [31m[1m           4434.2          [0m[0m  |  [31m[1m  595660.4  [0m[0m  |  [31m[1m             679891.7            [0m[0m  |  [31m[1m                   10688.6                   [0m[0m  |  [31m[1m                       4445.3                       [0m[0m  |  [31m[1m                    167557.1                   [0m[0m
      1024   x 768   |  [31m[1m         5590.7        [0m[0m  |  [31m[1m           2384.1          [0m[0m  |  [31m[1m  350433.2  [0m[0m  |  [31m[1m             353414.5            [0m[0m  |  [31m[1m                    5947.9                   [0m[0m  |  [31m[1m                       2466.8                       [0m[0m  |  [31m[1m                     84520.9                   [0m[0m
      512    x 768   |  [31m[1m         5187.6        [0m[0m  |  [31m[1m           1402.1          [0m[0m  |  [31m[1m  183297.2  [0m[0m  |  [31m[1m             185508.4            [0m[0m  |  [31m[1m                    4045.0                   [0m[0m  |  [31m[1m                       1455.7                       [0m[0m  |  [31m[1m                     42295.8                   [0m[0m
      256    x 768   |  [31m[1m         1844.6        [0m[0m  |  [31m[1m            770.1          [0m[0m  |  [31m[1m   91796.7  [0m[0m  |  [31m[1m              94040.0            [0m[0m  |  [31m[1m                    1860.9                   [0m[0m  |  [31m[1m                        846.8                       [0m[0m  |  [31m[1m                     22706.6                   [0m[0m
      128    x 768   |  [31m[1m         1093.9        [0m[0m  |  [31m[1m            523.3          [0m[0m  |  [31m[1m   40992.4  [0m[0m  |  [31m[1m              41645.5            [0m[0m  |  [31m[1m                    1145.3                   [0m[0m  |  [2m[91m                        603.1                       [0m[0m  |  [31m[1m                     12950.2                   [0m[0m
      64     x 768   |  [31m[1m          623.8        [0m[0m  |  [2m[91m            280.4          [0m[0m  |  [31m[1m   20831.4  [0m[0m  |  [31m[1m              20899.8            [0m[0m  |  [2m[91m                     574.1                   [0m[0m  |  [2m[91m                        360.3                       [0m[0m  |  [31m[1m                      5283.1                   [0m[0m
      32     x 768   |  [2m[91m          384.2        [0m[0m  |  [2m[91m            211.1          [0m[0m  |  [31m[1m    3079.5  [0m[0m  |  [31m[1m               2946.5            [0m[0m  |  [2m[91m                     388.9                   [0m[0m  |                          290.1                         |  [31m[1m                      2753.3                   [0m[0m
      16     x 768   |  [2m[91m          228.3        [0m[0m  |              153.0            |  [2m[91m    1556.3  [0m[0m  |  [31m[1m               1463.4            [0m[0m  |  [2m[91m                     339.4                   [0m[0m  |                          233.4                         |  [31m[1m                      1407.4                   [0m[0m
      8      x 768   |            159.2          |              123.3            |  [2m[91m     985.8  [0m[0m  |  [2m[91m                909.1            [0m[0m  |                       200.0                     |                          197.6                         |  [31m[1m                       752.7                   [0m[0m
      4      x 768   |            129.8          |  [34m[1m            109.3          [0m[0m  |       623.8    |  [2m[91m                462.1            [0m[0m  |                       163.4                     |                          178.3                         |  [2m[91m                       401.4                   [0m[0m
      2      x 768   |            113.1          |  [34m[1m            102.2          [0m[0m  |       482.9    |                  302.5              |  [34m[1m                     142.4                   [0m[0m  |  [34m[1m                        169.3                       [0m[0m  |                         285.6                   
      1      x 768   |  [92m[1m          102.4        [0m[0m  |  [92m[1m            100.9          [0m[0m  |  [92m[1m     379.8  [0m[0m  |  [92m[1m                207.8            [0m[0m  |  [92m[1m                     135.1                   [0m[0m  |  [92m[1m                        162.0                       [0m[0m  |  [92m[1m                       150.4                   [0m[0m

Times are in microseconds (us).
/home/user/build/.venv/lib/python3.10/site-packages/torch/jit/_script.py:1241: UserWarning: `optimize` is deprecated and has no effect. Use `with torch.jit.optimized_execution() instead
  warnings.warn(

Sparsity 99 with 40 threads using compilation strategy script and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 40 threads using compilation strategy script and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 40 threads using compilation strategy script and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 40 threads using compilation strategy script and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[------------------------------------------------------------------------------------------- Sparsity 99 with 40 threads using compilation strategy script and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        10686.2        [0m[0m  |  [31m[1m           3170.6          [0m[0m  |  [31m[1m  32580.6   [0m[0m  |  [31m[1m             32515.5             [0m[0m  |  [31m[1m                  10903.7                  [0m[0m  |  [31m[1m                      3257.1                      [0m[0m  |  [31m[1m                   32736.3                   [0m[0m
      1024   x 768   |  [31m[1m         5585.6        [0m[0m  |  [31m[1m           1799.3          [0m[0m  |  [31m[1m  16412.9   [0m[0m  |  [31m[1m             16226.0             [0m[0m  |  [31m[1m                   5698.0                  [0m[0m  |  [31m[1m                      1803.1                      [0m[0m  |  [31m[1m                   15843.6                   [0m[0m
      512    x 768   |  [31m[1m         3100.9        [0m[0m  |  [31m[1m           1080.1          [0m[0m  |  [31m[1m   2340.1   [0m[0m  |  [31m[1m              2317.2             [0m[0m  |  [31m[1m                   3179.8                  [0m[0m  |  [31m[1m                      1099.2                      [0m[0m  |  [31m[1m                    2464.2                   [0m[0m
      256    x 768   |  [31m[1m         1841.6        [0m[0m  |  [31m[1m            619.9          [0m[0m  |  [31m[1m   1363.3   [0m[0m  |  [31m[1m              1174.8             [0m[0m  |  [31m[1m                   1922.9                  [0m[0m  |  [31m[1m                       637.6                      [0m[0m  |  [31m[1m                    1202.0                   [0m[0m
      128    x 768   |  [31m[1m         1100.2        [0m[0m  |  [2m[91m            411.4          [0m[0m  |  [2m[91m    814.9   [0m[0m  |  [31m[1m               643.2             [0m[0m  |  [31m[1m                   1170.8                  [0m[0m  |  [2m[91m                       428.7                      [0m[0m  |  [31m[1m                     664.2                   [0m[0m
      64     x 768   |  [31m[1m          543.5        [0m[0m  |  [2m[91m            231.9          [0m[0m  |  [2m[91m    605.7   [0m[0m  |  [2m[91m               424.0             [0m[0m  |  [31m[1m                    601.3                  [0m[0m  |  [2m[91m                       251.9                      [0m[0m  |  [2m[91m                     431.2                   [0m[0m
      32     x 768   |  [2m[91m          341.1        [0m[0m  |              173.1            |      448.8     |  [2m[91m               265.9             [0m[0m  |  [2m[91m                    382.3                  [0m[0m  |                         195.1                        |  [2m[91m                     289.6                   [0m[0m
      16     x 768   |  [2m[91m          228.5        [0m[0m  |              145.1            |      357.3     |  [2m[91m               187.5             [0m[0m  |  [2m[91m                    323.9                  [0m[0m  |                         164.2                        |  [2m[91m                     185.9                   [0m[0m
      8      x 768   |            180.7          |              116.3            |      300.5     |                 138.4               |                      208.3                    |                         121.3                        |                       133.1                   
      4      x 768   |            128.0          |  [34m[1m            108.3          [0m[0m  |  [34m[1m    275.6   [0m[0m  |                 118.7               |                      147.0                    |  [34m[1m                       107.6                      [0m[0m  |                       106.2                   
      2      x 768   |  [34m[1m          111.2        [0m[0m  |  [34m[1m            103.9          [0m[0m  |  [34m[1m    265.0   [0m[0m  |                 110.1               |                      121.7                    |  [92m[1m                       101.5                      [0m[0m  |                       103.6                   
      1      x 768   |  [92m[1m          105.1        [0m[0m  |  [92m[1m            100.1          [0m[0m  |  [92m[1m    253.5   [0m[0m  |  [92m[1m                86.4             [0m[0m  |  [92m[1m                    108.6                  [0m[0m  |  [92m[1m                       101.4                      [0m[0m  |  [92m[1m                      92.9                   [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------- Sparsity 95 with 40 threads using compilation strategy script and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        10821.5        [0m[0m  |  [31m[1m           3783.0          [0m[0m  |  [31m[1m  172908.0  [0m[0m  |  [31m[1m             168961.3            [0m[0m  |  [31m[1m                  10953.8                  [0m[0m  |  [31m[1m                      3855.9                      [0m[0m  |  [31m[1m                   184944.5                  [0m[0m
      1024   x 768   |  [31m[1m         5839.3        [0m[0m  |  [31m[1m           2067.9          [0m[0m  |  [31m[1m   94832.7  [0m[0m  |  [31m[1m              94004.4            [0m[0m  |  [31m[1m                   5748.9                  [0m[0m  |  [31m[1m                      2126.7                      [0m[0m  |  [31m[1m                    85848.0                  [0m[0m
      512    x 768   |  [31m[1m         3078.3        [0m[0m  |  [31m[1m           1223.4          [0m[0m  |  [31m[1m   40895.5  [0m[0m  |  [31m[1m              42693.3            [0m[0m  |  [31m[1m                   3287.0                  [0m[0m  |  [31m[1m                      1246.5                      [0m[0m  |  [31m[1m                    41024.8                  [0m[0m
      256    x 768   |  [31m[1m         1819.2        [0m[0m  |  [31m[1m            766.3          [0m[0m  |  [31m[1m   20950.9  [0m[0m  |  [31m[1m              20629.8            [0m[0m  |  [31m[1m                   1898.1                  [0m[0m  |  [31m[1m                       806.8                      [0m[0m  |  [31m[1m                    20694.0                  [0m[0m
      128    x 768   |  [31m[1m         1074.0        [0m[0m  |  [31m[1m            513.3          [0m[0m  |  [31m[1m    3398.8  [0m[0m  |  [31m[1m               3154.0            [0m[0m  |  [31m[1m                   1158.8                  [0m[0m  |  [2m[91m                       499.9                      [0m[0m  |  [31m[1m                     2879.2                  [0m[0m
      64     x 768   |  [31m[1m          541.7        [0m[0m  |  [2m[91m            279.3          [0m[0m  |  [31m[1m    1560.7  [0m[0m  |  [31m[1m               1363.1            [0m[0m  |  [31m[1m                    612.3                  [0m[0m  |  [2m[91m                       293.7                      [0m[0m  |  [31m[1m                     1393.3                  [0m[0m
      32     x 768   |  [2m[91m          348.5        [0m[0m  |              194.8            |  [2m[91m     909.2  [0m[0m  |  [31m[1m                744.0            [0m[0m  |  [2m[91m                    385.9                  [0m[0m  |  [2m[91m                       220.7                      [0m[0m  |  [31m[1m                      738.3                  [0m[0m
      16     x 768   |  [2m[91m          233.3        [0m[0m  |              143.2            |  [2m[91m     625.9  [0m[0m  |  [2m[91m                441.9            [0m[0m  |  [2m[91m                    274.5                  [0m[0m  |                         161.3                        |  [2m[91m                      397.8                  [0m[0m
      8      x 768   |            161.4          |              118.7            |       467.1    |  [2m[91m                287.1            [0m[0m  |                      204.4                    |                         127.1                        |  [2m[91m                      304.9                  [0m[0m
      4      x 768   |            141.0          |              112.3            |       364.4    |                  188.1              |                      149.5                    |                         111.1                        |                        189.4                  
      2      x 768   |  [34m[1m          114.1        [0m[0m  |  [34m[1m            103.9          [0m[0m  |  [34m[1m     298.9  [0m[0m  |  [34m[1m                127.1            [0m[0m  |                      124.9                    |  [34m[1m                       105.2                      [0m[0m  |                        127.8                  
      1      x 768   |  [92m[1m          104.6        [0m[0m  |  [92m[1m            100.4          [0m[0m  |  [92m[1m     276.0  [0m[0m  |  [92m[1m                117.5            [0m[0m  |  [92m[1m                    112.6                  [0m[0m  |  [92m[1m                       100.5                      [0m[0m  |  [92m[1m                      110.6                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------- Sparsity 90 with 40 threads using compilation strategy script and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        10608.6        [0m[0m  |  [31m[1m           4122.4          [0m[0m  |  [31m[1m  309477.6  [0m[0m  |  [31m[1m             355187.6            [0m[0m  |  [31m[1m                  10708.4                  [0m[0m  |  [31m[1m                      4257.8                      [0m[0m  |  [31m[1m                   330871.9                  [0m[0m
      1024   x 768   |  [31m[1m         5898.9        [0m[0m  |  [31m[1m           2289.1          [0m[0m  |  [31m[1m  164420.1  [0m[0m  |  [31m[1m             190026.0            [0m[0m  |  [31m[1m                   5719.2                  [0m[0m  |  [31m[1m                      2310.0                      [0m[0m  |  [31m[1m                   164438.2                  [0m[0m
      512    x 768   |  [31m[1m         3073.6        [0m[0m  |  [31m[1m           1345.3          [0m[0m  |  [31m[1m   84520.0  [0m[0m  |  [31m[1m              86883.9            [0m[0m  |  [31m[1m                   3192.1                  [0m[0m  |  [31m[1m                      1358.5                      [0m[0m  |  [31m[1m                    85142.3                  [0m[0m
      256    x 768   |  [31m[1m         3058.0        [0m[0m  |  [31m[1m           1288.5          [0m[0m  |  [31m[1m   41466.7  [0m[0m  |  [31m[1m              41311.9            [0m[0m  |  [31m[1m                   1960.6                  [0m[0m  |  [31m[1m                       810.2                      [0m[0m  |  [31m[1m                    41309.2                  [0m[0m
      128    x 768   |  [31m[1m         1108.0        [0m[0m  |  [2m[91m            509.9          [0m[0m  |  [31m[1m   20794.8  [0m[0m  |  [31m[1m              20374.0            [0m[0m  |  [31m[1m                   1181.2                  [0m[0m  |  [31m[1m                       559.5                      [0m[0m  |  [31m[1m                    23982.9                  [0m[0m
      64     x 768   |  [2m[91m          532.3        [0m[0m  |  [2m[91m            269.8          [0m[0m  |  [31m[1m    3045.8  [0m[0m  |  [31m[1m               2964.0            [0m[0m  |  [31m[1m                    763.3                  [0m[0m  |  [2m[91m                       344.1                      [0m[0m  |  [31m[1m                     2964.4                  [0m[0m
      32     x 768   |  [2m[91m          326.1        [0m[0m  |  [2m[91m            241.8          [0m[0m  |  [31m[1m    1511.9  [0m[0m  |  [31m[1m               1386.6            [0m[0m  |  [2m[91m                    380.9                  [0m[0m  |  [2m[91m                       227.4                      [0m[0m  |  [31m[1m                     1528.3                  [0m[0m
      16     x 768   |  [2m[91m          229.2        [0m[0m  |              149.0            |  [2m[91m     896.9  [0m[0m  |  [31m[1m                734.5            [0m[0m  |  [2m[91m                    267.2                  [0m[0m  |                         174.3                        |  [31m[1m                      728.6                  [0m[0m
      8      x 768   |            160.6          |              134.8            |       539.2    |  [2m[91m                392.5            [0m[0m  |                      201.3                    |                         125.9                        |  [2m[91m                      447.2                  [0m[0m
      4      x 768   |            142.6          |              117.5            |       538.2    |  [2m[91m                281.1            [0m[0m  |                      160.3                    |                         111.8                        |  [2m[91m                      317.5                  [0m[0m
      2      x 768   |            117.8          |  [34m[1m            104.6          [0m[0m  |       409.8    |                  196.6              |                      127.1                    |  [34m[1m                       106.2                      [0m[0m  |                        186.4                  
      1      x 768   |  [92m[1m          106.7        [0m[0m  |  [92m[1m            102.9          [0m[0m  |  [92m[1m     300.1  [0m[0m  |  [92m[1m                130.3            [0m[0m  |  [92m[1m                    111.6                  [0m[0m  |  [92m[1m                       100.1                      [0m[0m  |  [92m[1m                      128.4                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------- Sparsity 80 with 40 threads using compilation strategy script and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
40 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        10623.8        [0m[0m  |  [31m[1m           4353.6          [0m[0m  |  [31m[1m  578974.0  [0m[0m  |  [31m[1m             689947.4            [0m[0m  |  [31m[1m                  11015.5                  [0m[0m  |  [31m[1m                      4428.4                      [0m[0m  |  [31m[1m                   579218.7                  [0m[0m
      1024   x 768   |  [31m[1m         9922.1        [0m[0m  |  [31m[1m           2391.1          [0m[0m  |  [31m[1m  343763.6  [0m[0m  |  [31m[1m             359150.4            [0m[0m  |  [31m[1m                   5728.8                  [0m[0m  |  [31m[1m                      2420.7                      [0m[0m  |  [31m[1m                   305409.5                  [0m[0m
      512    x 768   |  [31m[1m         3076.5        [0m[0m  |  [31m[1m           1391.8          [0m[0m  |  [31m[1m  163841.7  [0m[0m  |  [31m[1m             169719.9            [0m[0m  |  [31m[1m                   3146.3                  [0m[0m  |  [31m[1m                      1404.5                      [0m[0m  |  [31m[1m                   168225.7                  [0m[0m
      256    x 768   |  [31m[1m         1821.0        [0m[0m  |  [31m[1m            774.1          [0m[0m  |  [31m[1m   99032.4  [0m[0m  |  [31m[1m              94692.2            [0m[0m  |  [31m[1m                   1948.2                  [0m[0m  |  [31m[1m                       901.4                      [0m[0m  |  [31m[1m                    85034.0                  [0m[0m
      128    x 768   |  [31m[1m         1072.9        [0m[0m  |  [31m[1m            525.4          [0m[0m  |  [31m[1m   41996.2  [0m[0m  |  [31m[1m              41546.4            [0m[0m  |  [31m[1m                   1167.9                  [0m[0m  |  [31m[1m                       549.9                      [0m[0m  |  [31m[1m                    42069.4                  [0m[0m
      64     x 768   |  [31m[1m          530.3        [0m[0m  |  [2m[91m            287.5          [0m[0m  |  [31m[1m   21524.8  [0m[0m  |  [31m[1m              20544.9            [0m[0m  |  [31m[1m                    766.7                  [0m[0m  |  [2m[91m                       368.9                      [0m[0m  |  [31m[1m                    24149.7                  [0m[0m
      32     x 768   |  [2m[91m          331.3        [0m[0m  |  [2m[91m            212.7          [0m[0m  |  [31m[1m    3201.3  [0m[0m  |  [31m[1m               2927.4            [0m[0m  |  [2m[91m                    382.3                  [0m[0m  |  [2m[91m                       255.1                      [0m[0m  |  [31m[1m                     4752.5                  [0m[0m
      16     x 768   |  [2m[91m          228.2        [0m[0m  |              170.4            |  [2m[91m    1551.0  [0m[0m  |  [31m[1m               1394.8            [0m[0m  |  [2m[91m                    271.6                  [0m[0m  |                         172.2                        |  [31m[1m                     1454.2                  [0m[0m
      8      x 768   |            184.2          |              128.8            |  [2m[91m     978.3  [0m[0m  |  [2m[91m                866.5            [0m[0m  |                      206.8                    |                         136.1                        |  [2m[91m                      816.1                  [0m[0m
      4      x 768   |            128.5          |  [34m[1m            111.3          [0m[0m  |       614.6    |  [2m[91m                455.0            [0m[0m  |                      147.3                    |                         112.9                        |  [2m[91m                      486.0                  [0m[0m
      2      x 768   |            117.3          |  [34m[1m            105.2          [0m[0m  |       454.8    |                  298.2              |                      128.2                    |  [34m[1m                       107.2                      [0m[0m  |                        298.8                  
      1      x 768   |  [92m[1m          105.2        [0m[0m  |  [92m[1m            103.5          [0m[0m  |  [92m[1m     378.2  [0m[0m  |  [92m[1m                208.5            [0m[0m  |  [92m[1m                    109.9                  [0m[0m  |  [92m[1m                       100.4                      [0m[0m  |  [92m[1m                      201.5                  [0m[0m

Times are in microseconds (us).

Sparsity 99 with 40 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 40 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 40 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 40 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[------------------------------------------------------------------------------------------ Sparsity 99 with 40 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu. ------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
40 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        10665.9        [0m[0m  |  [31m[1m           3228.0          [0m[0m  |  [31m[1m  37496.2   [0m[0m  |  [31m[1m             32409.9             [0m[0m  |  [31m[1m                 10870.9                  [0m[0m  |  [31m[1m                      3190.9                     [0m[0m  |  [31m[1m                  32263.1                   [0m[0m
      1024   x 768   |  [31m[1m         5598.6        [0m[0m  |  [31m[1m           1766.6          [0m[0m  |  [31m[1m  16022.2   [0m[0m  |  [31m[1m             15787.5             [0m[0m  |  [31m[1m                  5603.8                  [0m[0m  |  [31m[1m                      1787.0                     [0m[0m  |  [31m[1m                  16278.4                   [0m[0m
      512    x 768   |  [31m[1m         3047.1        [0m[0m  |  [31m[1m           1089.3          [0m[0m  |  [31m[1m   2466.8   [0m[0m  |  [31m[1m              2241.8             [0m[0m  |  [31m[1m                  3086.5                  [0m[0m  |  [31m[1m                      1205.3                     [0m[0m  |  [31m[1m                   2358.4                   [0m[0m
      256    x 768   |  [31m[1m         1832.1        [0m[0m  |  [31m[1m            634.0          [0m[0m  |  [31m[1m   1297.4   [0m[0m  |  [31m[1m              1251.2             [0m[0m  |  [31m[1m                  2889.7                  [0m[0m  |  [31m[1m                       635.6                     [0m[0m  |  [31m[1m                   1245.4                   [0m[0m
      128    x 768   |  [31m[1m         1482.7        [0m[0m  |  [2m[91m            403.1          [0m[0m  |  [2m[91m    808.6   [0m[0m  |  [31m[1m               654.3             [0m[0m  |  [31m[1m                  1102.7                  [0m[0m  |  [2m[91m                       438.7                     [0m[0m  |  [31m[1m                    663.3                   [0m[0m
      64     x 768   |  [31m[1m          574.4        [0m[0m  |  [2m[91m            235.1          [0m[0m  |  [2m[91m    560.5   [0m[0m  |  [2m[91m               391.7             [0m[0m  |  [2m[91m                   535.5                  [0m[0m  |  [2m[91m                       246.2                     [0m[0m  |  [2m[91m                    388.5                   [0m[0m
      32     x 768   |  [2m[91m          336.4        [0m[0m  |              173.2            |      461.5     |  [2m[91m               275.2             [0m[0m  |  [2m[91m                   349.0                  [0m[0m  |                         183.8                       |  [2m[91m                    307.0                   [0m[0m
      16     x 768   |  [2m[91m          228.2        [0m[0m  |              157.7            |      329.2     |                 175.0               |  [2m[91m                   291.5                  [0m[0m  |                         161.5                       |  [2m[91m                    190.6                   [0m[0m
      8      x 768   |            162.9          |              121.7            |  [34m[1m    267.2   [0m[0m  |                 124.4               |                     175.2                    |                         127.6                       |                      139.7                   
      4      x 768   |            139.5          |  [34m[1m            109.0          [0m[0m  |  [34m[1m    277.4   [0m[0m  |                 116.1               |                     142.7                    |                         119.2                       |                      117.9                   
      2      x 768   |  [34m[1m          114.4        [0m[0m  |  [34m[1m            106.4          [0m[0m  |  [34m[1m    263.0   [0m[0m  |                 144.1               |  [34m[1m                   122.0                  [0m[0m  |  [34m[1m                       111.6                     [0m[0m  |                      105.1                   
      1      x 768   |  [92m[1m          105.7        [0m[0m  |  [92m[1m            103.0          [0m[0m  |  [92m[1m    254.6   [0m[0m  |  [92m[1m                97.0             [0m[0m  |  [92m[1m                   113.5                  [0m[0m  |  [92m[1m                       107.9                     [0m[0m  |  [92m[1m                     83.4                   [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------ Sparsity 95 with 40 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu. ------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
40 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        10501.0        [0m[0m  |  [31m[1m           3783.5          [0m[0m  |  [31m[1m  171871.1  [0m[0m  |  [31m[1m             160112.7            [0m[0m  |  [31m[1m                 10738.1                  [0m[0m  |  [31m[1m                      3796.0                     [0m[0m  |  [31m[1m                  172298.9                  [0m[0m
      1024   x 768   |  [31m[1m         5586.0        [0m[0m  |  [31m[1m           2121.0          [0m[0m  |  [31m[1m   81698.7  [0m[0m  |  [31m[1m              79114.5            [0m[0m  |  [31m[1m                  5611.8                  [0m[0m  |  [31m[1m                      2114.6                     [0m[0m  |  [31m[1m                   79324.4                  [0m[0m
      512    x 768   |  [31m[1m         3089.8        [0m[0m  |  [31m[1m           1244.7          [0m[0m  |  [31m[1m   40098.8  [0m[0m  |  [31m[1m              39364.9            [0m[0m  |  [31m[1m                  3088.4                  [0m[0m  |  [31m[1m                      1306.6                     [0m[0m  |  [31m[1m                   39823.4                  [0m[0m
      256    x 768   |  [31m[1m         1825.7        [0m[0m  |  [31m[1m            964.3          [0m[0m  |  [31m[1m   20486.4  [0m[0m  |  [31m[1m              20208.3            [0m[0m  |  [31m[1m                  1842.9                  [0m[0m  |  [31m[1m                       797.5                     [0m[0m  |  [31m[1m                   20090.1                  [0m[0m
      128    x 768   |  [31m[1m         1087.5        [0m[0m  |  [2m[91m            469.7          [0m[0m  |  [31m[1m    3019.7  [0m[0m  |  [31m[1m               2795.9            [0m[0m  |  [31m[1m                  1100.4                  [0m[0m  |  [2m[91m                       480.7                     [0m[0m  |  [31m[1m                    2887.3                  [0m[0m
      64     x 768   |  [2m[91m          523.8        [0m[0m  |  [2m[91m            258.0          [0m[0m  |  [31m[1m    1486.6  [0m[0m  |  [31m[1m               1384.6            [0m[0m  |  [2m[91m                   573.7                  [0m[0m  |  [2m[91m                       268.8                     [0m[0m  |  [31m[1m                    1378.6                  [0m[0m
      32     x 768   |  [2m[91m          340.2        [0m[0m  |              199.0            |  [31m[1m    1472.6  [0m[0m  |  [31m[1m                683.8            [0m[0m  |  [2m[91m                   351.0                  [0m[0m  |                         208.9                       |  [31m[1m                     710.5                  [0m[0m
      16     x 768   |  [2m[91m          231.3        [0m[0m  |              160.2            |  [2m[91m     554.0  [0m[0m  |  [2m[91m                388.9            [0m[0m  |  [2m[91m                   245.3                  [0m[0m  |                         163.8                       |  [2m[91m                     487.7                  [0m[0m
      8      x 768   |            163.6          |              123.1            |       471.5    |  [2m[91m                294.6            [0m[0m  |                     176.5                    |                         136.8                       |  [2m[91m                     311.3                  [0m[0m
      4      x 768   |            139.7          |  [34m[1m            109.5          [0m[0m  |       359.3    |                  183.8              |                     141.0                    |  [34m[1m                       119.1                     [0m[0m  |                       211.6                  
      2      x 768   |            116.0          |  [34m[1m            106.5          [0m[0m  |       299.8    |                  138.0              |  [34m[1m                   125.2                  [0m[0m  |  [34m[1m                       113.5                     [0m[0m  |                       145.1                  
      1      x 768   |  [92m[1m          105.1        [0m[0m  |  [92m[1m            103.5          [0m[0m  |  [92m[1m     271.8  [0m[0m  |  [92m[1m                109.1            [0m[0m  |  [92m[1m                   116.6                  [0m[0m  |  [92m[1m                       111.5                     [0m[0m  |  [92m[1m                     118.7                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------ Sparsity 90 with 40 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu. ------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
40 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        10636.3        [0m[0m  |  [31m[1m           6453.4          [0m[0m  |  [31m[1m  351649.5  [0m[0m  |  [31m[1m             351042.0            [0m[0m  |  [31m[1m                 10768.5                  [0m[0m  |  [31m[1m                      7621.4                     [0m[0m  |  [31m[1m                  347004.4                  [0m[0m
      1024   x 768   |  [31m[1m         5570.0        [0m[0m  |  [31m[1m           2302.6          [0m[0m  |  [31m[1m  160163.3  [0m[0m  |  [31m[1m             160232.3            [0m[0m  |  [31m[1m                  5632.2                  [0m[0m  |  [31m[1m                      2300.9                     [0m[0m  |  [31m[1m                  180893.6                  [0m[0m
      512    x 768   |  [31m[1m         3084.9        [0m[0m  |  [31m[1m           1321.2          [0m[0m  |  [31m[1m   90589.5  [0m[0m  |  [31m[1m              88310.8            [0m[0m  |  [31m[1m                  3083.8                  [0m[0m  |  [31m[1m                      1362.2                     [0m[0m  |  [31m[1m                   90194.3                  [0m[0m
      256    x 768   |  [31m[1m         2832.1        [0m[0m  |  [31m[1m           1109.9          [0m[0m  |  [31m[1m   40191.1  [0m[0m  |  [31m[1m              39726.1            [0m[0m  |  [31m[1m                  1840.9                  [0m[0m  |  [31m[1m                       807.8                     [0m[0m  |  [31m[1m                   40355.1                  [0m[0m
      128    x 768   |  [31m[1m         1088.5        [0m[0m  |  [2m[91m            501.6          [0m[0m  |  [31m[1m   19935.9  [0m[0m  |  [31m[1m              19927.5            [0m[0m  |  [31m[1m                  1104.0                  [0m[0m  |  [2m[91m                       518.4                     [0m[0m  |  [31m[1m                   23106.6                  [0m[0m
      64     x 768   |  [2m[91m          527.8        [0m[0m  |  [2m[91m            275.8          [0m[0m  |  [31m[1m    3079.3  [0m[0m  |  [31m[1m               2937.9            [0m[0m  |  [2m[91m                   539.2                  [0m[0m  |  [2m[91m                       288.5                     [0m[0m  |  [31m[1m                    2974.6                  [0m[0m
      32     x 768   |  [2m[91m          337.9        [0m[0m  |  [2m[91m            212.4          [0m[0m  |  [31m[1m    1575.2  [0m[0m  |  [31m[1m               1417.4            [0m[0m  |  [2m[91m                   444.1                  [0m[0m  |                         219.1                       |  [31m[1m                    1422.4                  [0m[0m
      16     x 768   |  [2m[91m          248.4        [0m[0m  |              168.8            |  [2m[91m     889.9  [0m[0m  |  [31m[1m                716.4            [0m[0m  |  [2m[91m                   249.6                  [0m[0m  |                         181.8                       |  [31m[1m                     737.3                  [0m[0m
      8      x 768   |            161.3          |              126.1            |  [2m[91m     548.3  [0m[0m  |  [2m[91m                395.9            [0m[0m  |                     174.7                    |                         136.0                       |  [2m[91m                     393.3                  [0m[0m
      4      x 768   |            135.9          |              118.2            |       424.2    |  [2m[91m                270.7            [0m[0m  |                     154.1                    |                         123.6                       |  [2m[91m                     301.8                  [0m[0m
      2      x 768   |  [34m[1m          114.8        [0m[0m  |  [34m[1m            107.4          [0m[0m  |       430.1    |                  171.5              |                     126.9                    |  [34m[1m                       117.0                     [0m[0m  |                       188.5                  
      1      x 768   |  [92m[1m          109.1        [0m[0m  |  [92m[1m            102.6          [0m[0m  |  [92m[1m     270.9  [0m[0m  |  [92m[1m                130.8            [0m[0m  |  [92m[1m                   114.3                  [0m[0m  |  [92m[1m                       111.1                     [0m[0m  |  [92m[1m                     133.5                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------ Sparsity 80 with 40 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu. ------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
40 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        10898.2        [0m[0m  |  [31m[1m           4398.1          [0m[0m  |  [31m[1m  693843.2  [0m[0m  |  [31m[1m             663563.4            [0m[0m  |  [31m[1m                 10848.7                  [0m[0m  |  [31m[1m                      4380.9                     [0m[0m  |  [31m[1m                  668517.2                  [0m[0m
      1024   x 768   |  [31m[1m         5625.8        [0m[0m  |  [31m[1m           2383.6          [0m[0m  |  [31m[1m  300010.9  [0m[0m  |  [31m[1m             349531.9            [0m[0m  |  [31m[1m                  5827.8                  [0m[0m  |  [31m[1m                      2398.1                     [0m[0m  |  [31m[1m                  294509.2                  [0m[0m
      512    x 768   |  [31m[1m         3098.9        [0m[0m  |  [31m[1m           1380.0          [0m[0m  |  [31m[1m  180433.0  [0m[0m  |  [31m[1m             183094.7            [0m[0m  |  [31m[1m                  3131.3                  [0m[0m  |  [31m[1m                      1416.6                     [0m[0m  |  [31m[1m                  180553.9                  [0m[0m
      256    x 768   |  [31m[1m         1823.1        [0m[0m  |  [31m[1m            770.1          [0m[0m  |  [31m[1m   81131.9  [0m[0m  |  [31m[1m              89831.6            [0m[0m  |  [31m[1m                  1856.2                  [0m[0m  |  [31m[1m                       789.1                     [0m[0m  |  [31m[1m                   89830.3                  [0m[0m
      128    x 768   |  [31m[1m         1587.0        [0m[0m  |  [31m[1m            620.7          [0m[0m  |  [31m[1m   39446.8  [0m[0m  |  [31m[1m              46569.6            [0m[0m  |  [31m[1m                  1224.6                  [0m[0m  |  [31m[1m                       605.0                     [0m[0m  |  [31m[1m                   38979.8                  [0m[0m
      64     x 768   |  [2m[91m          533.7        [0m[0m  |  [2m[91m            321.2          [0m[0m  |  [31m[1m   19909.0  [0m[0m  |  [31m[1m              20097.0            [0m[0m  |  [2m[91m                   549.4                  [0m[0m  |  [2m[91m                       296.0                     [0m[0m  |  [31m[1m                   19814.2                  [0m[0m
      32     x 768   |  [2m[91m          344.5        [0m[0m  |  [2m[91m            228.2          [0m[0m  |  [31m[1m    3130.8  [0m[0m  |  [31m[1m               2944.5            [0m[0m  |  [2m[91m                   397.5                  [0m[0m  |  [2m[91m                       264.1                     [0m[0m  |  [31m[1m                    5168.6                  [0m[0m
      16     x 768   |  [2m[91m          234.2        [0m[0m  |              155.2            |  [2m[91m    1653.4  [0m[0m  |  [31m[1m               1405.1            [0m[0m  |  [2m[91m                   246.2                  [0m[0m  |                         174.4                       |  [31m[1m                    1413.3                  [0m[0m
      8      x 768   |            165.9          |              131.6            |  [2m[91m     983.4  [0m[0m  |  [2m[91m                823.7            [0m[0m  |                     176.2                    |                         138.2                       |  [2m[91m                     852.0                  [0m[0m
      4      x 768   |            138.3          |              118.8            |       652.1    |  [2m[91m                470.6            [0m[0m  |                     153.6                    |                         131.2                       |  [2m[91m                     479.5                  [0m[0m
      2      x 768   |            122.0          |  [34m[1m            106.5          [0m[0m  |       482.0    |                  300.3              |  [34m[1m                   125.8                  [0m[0m  |  [34m[1m                       116.4                     [0m[0m  |                       320.9                  
      1      x 768   |  [92m[1m          108.8        [0m[0m  |  [92m[1m            104.0          [0m[0m  |  [92m[1m     355.4  [0m[0m  |  [92m[1m                209.4            [0m[0m  |  [92m[1m                   118.3                  [0m[0m  |  [92m[1m                       114.3                     [0m[0m  |  [92m[1m                     208.8                  [0m[0m

Times are in microseconds (us).

Sparsity 99 with 80 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 80 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 80 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 80 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[--------------------------------------------------------------------------------------------- Sparsity 99 with 80 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu. ---------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  Fine-grained + structured with backend inductor
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        11989.3        [0m[0m  |  [31m[1m           8781.5          [0m[0m  |  [31m[1m  35053.1   [0m[0m  |  [31m[1m              35908.0            [0m[0m  |  [31m[1m                   48387.5                   [0m[0m  |  [31m[1m                       3526.0                       [0m[0m  |  [31m[1m                    11410.9                    [0m[0m
      1024   x 768   |  [31m[1m        10083.1        [0m[0m  |  [31m[1m           8212.0          [0m[0m  |  [31m[1m  17388.1   [0m[0m  |  [31m[1m              17564.5            [0m[0m  |  [31m[1m                   16869.1                   [0m[0m  |  [31m[1m                       4571.9                       [0m[0m  |  [31m[1m                     5720.3                    [0m[0m
      512    x 768   |  [31m[1m         9014.8        [0m[0m  |  [31m[1m           2159.7          [0m[0m  |  [31m[1m   3331.4   [0m[0m  |  [31m[1m               3003.1            [0m[0m  |  [31m[1m                   10963.5                   [0m[0m  |  [31m[1m                       1947.5                       [0m[0m  |  [31m[1m                     2629.1                    [0m[0m
      256    x 768   |  [31m[1m         4738.4        [0m[0m  |  [2m[91m            695.0          [0m[0m  |  [2m[91m   1519.4   [0m[0m  |  [31m[1m             139986.0            [0m[0m  |  [31m[1m                    4513.0                   [0m[0m  |  [2m[91m                        773.4                       [0m[0m  |  [31m[1m                     1583.6                    [0m[0m
      128    x 768   |  [31m[1m         5150.0        [0m[0m  |  [31m[1m           2586.7          [0m[0m  |  [2m[91m   1342.0   [0m[0m  |  [31m[1m               1252.9            [0m[0m  |  [2m[91m                    1791.9                   [0m[0m  |  [31m[1m                       2459.5                       [0m[0m  |  [2m[91m                      714.8                    [0m[0m
      64     x 768   |  [2m[91m          821.9        [0m[0m  |  [31m[1m           2394.4          [0m[0m  |  [2m[91m   1127.0   [0m[0m  |  [2m[91m                606.2            [0m[0m  |  [31m[1m                    2119.7                   [0m[0m  |  [31m[1m                       4203.3                       [0m[0m  |  [2m[91m                      426.3                    [0m[0m
      32     x 768   |  [31m[1m         1723.2        [0m[0m  |  [31m[1m           3234.1          [0m[0m  |  [2m[91m    700.8   [0m[0m  |  [2m[91m                464.2            [0m[0m  |  [2m[91m                    1411.0                   [0m[0m  |  [31m[1m                       2586.1                       [0m[0m  |                        314.2                    
      16     x 768   |  [2m[91m          703.7        [0m[0m  |  [2m[91m            632.4          [0m[0m  |      564.8     |  [2m[91m                361.8            [0m[0m  |                       736.8                     |  [31m[1m                       1688.8                       [0m[0m  |                        282.4                    
      8      x 768   |  [31m[1m         2066.7        [0m[0m  |  [2m[91m            546.0          [0m[0m  |      549.0     |                  276.0              |                       549.4                     |  [2m[91m                        537.8                       [0m[0m  |                        218.9                    
      4      x 768   |  [31m[1m         2399.5        [0m[0m  |  [2m[91m            440.1          [0m[0m  |      456.9     |                  253.0              |                       648.5                     |  [31m[1m                       1480.1                       [0m[0m  |  [2m[91m                      555.2                    [0m[0m
      2      x 768   |  [34m[1m          175.1        [0m[0m  |  [2m[91m            474.8          [0m[0m  |      397.0     |                  237.5              |                       442.4                     |                          467.6                         |                        285.5                    
      1      x 768   |  [92m[1m          169.0        [0m[0m  |  [92m[1m            163.5          [0m[0m  |  [92m[1m    326.9   [0m[0m  |  [92m[1m                155.5            [0m[0m  |  [92m[1m                     384.3                   [0m[0m  |  [92m[1m                        234.2                       [0m[0m  |  [92m[1m                      160.3                    [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------- Sparsity 95 with 80 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu. ---------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  Fine-grained + structured with backend inductor
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        17076.7        [0m[0m  |  [31m[1m           8055.6          [0m[0m  |  [31m[1m  174066.1  [0m[0m  |  [31m[1m             193463.9            [0m[0m  |  [31m[1m                   23296.3                   [0m[0m  |  [31m[1m                      19303.7                       [0m[0m  |  [31m[1m                    56888.1                    [0m[0m
      1024   x 768   |  [31m[1m        23376.2        [0m[0m  |  [31m[1m           3011.4          [0m[0m  |  [31m[1m   88714.5  [0m[0m  |  [31m[1m              80511.8            [0m[0m  |  [31m[1m                   30118.8                   [0m[0m  |  [31m[1m                       3848.7                       [0m[0m  |  [31m[1m                    28099.0                    [0m[0m
      512    x 768   |  [31m[1m        10979.3        [0m[0m  |  [2m[91m           1319.3          [0m[0m  |  [31m[1m   42372.7  [0m[0m  |  [31m[1m              42033.2            [0m[0m  |  [31m[1m                   29181.9                   [0m[0m  |  [31m[1m                       2920.9                       [0m[0m  |  [31m[1m                    14102.8                    [0m[0m
      256    x 768   |  [31m[1m         8572.4        [0m[0m  |  [2m[91m            787.0          [0m[0m  |  [31m[1m   22110.3  [0m[0m  |  [31m[1m              27477.2            [0m[0m  |  [31m[1m                    7736.1                   [0m[0m  |  [31m[1m                       1820.7                       [0m[0m  |  [31m[1m                     7254.5                    [0m[0m
      128    x 768   |  [31m[1m         4620.0        [0m[0m  |  [31m[1m           2803.0          [0m[0m  |  [31m[1m    3294.7  [0m[0m  |  [31m[1m               3925.9            [0m[0m  |  [2m[91m                     916.3                   [0m[0m  |  [31m[1m                       2731.4                       [0m[0m  |  [31m[1m                     4323.2                    [0m[0m
      64     x 768   |  [2m[91m          680.1        [0m[0m  |  [92m[1m            325.7          [0m[0m  |  [31m[1m    2862.5  [0m[0m  |  [31m[1m               2241.7            [0m[0m  |                       599.5                     |  [31m[1m                       2359.7                       [0m[0m  |  [2m[91m                     2094.7                    [0m[0m
      32     x 768   |  [2m[91m         1355.3        [0m[0m  |  [31m[1m           2590.8          [0m[0m  |  [2m[91m    1147.7  [0m[0m  |  [2m[91m                974.4            [0m[0m  |  [2m[91m                    1788.1                   [0m[0m  |  [31m[1m                       2867.0                       [0m[0m  |                        940.2                    
      16     x 768   |  [92m[1m          293.3        [0m[0m  |  [2m[91m            947.2          [0m[0m  |  [2m[91m    1250.7  [0m[0m  |  [2m[91m                797.0            [0m[0m  |  [92m[1m                     362.4                   [0m[0m  |  [31m[1m                       1828.9                       [0m[0m  |                        954.1                    
      8      x 768   |  [2m[91m          602.7        [0m[0m  |              367.4            |       551.9    |                  378.1              |  [2m[91m                    1133.7                   [0m[0m  |  [92m[1m                        265.7                       [0m[0m  |                        929.5                    
      4      x 768   |            583.2          |  [2m[91m           1362.8          [0m[0m  |  [2m[91m     771.0  [0m[0m  |  [34m[1m                337.4            [0m[0m  |                       722.0                     |  [2m[91m                        676.2                       [0m[0m  |                        890.0                    
      2      x 768   |  [2m[91m          700.6        [0m[0m  |  [2m[91m           1163.7          [0m[0m  |       469.4    |  [92m[1m                313.3            [0m[0m  |                       558.0                     |  [2m[91m                       1065.6                       [0m[0m  |                        891.3                    
      1      x 768   |            431.9          |              560.3            |  [92m[1m     353.7  [0m[0m  |                  360.1              |  [31m[1m                    2339.4                   [0m[0m  |  [31m[1m                       2717.1                       [0m[0m  |  [92m[1m                      730.5                    [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------- Sparsity 90 with 80 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu. ---------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  Fine-grained + structured with backend inductor
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        28799.6        [0m[0m  |  [31m[1m          12825.6          [0m[0m  |  [31m[1m  381283.8  [0m[0m  |  [31m[1m             323587.6            [0m[0m  |  [31m[1m                   12259.8                   [0m[0m  |  [31m[1m                       4435.8                       [0m[0m  |  [31m[1m                    85296.4                    [0m[0m
      1024   x 768   |  [31m[1m         6724.4        [0m[0m  |  [31m[1m           3354.9          [0m[0m  |  [31m[1m  191600.1  [0m[0m  |  [31m[1m             218266.9            [0m[0m  |  [31m[1m                   26017.6                   [0m[0m  |  [31m[1m                       3077.1                       [0m[0m  |  [31m[1m                    57682.8                    [0m[0m
      512    x 768   |  [31m[1m        10393.3        [0m[0m  |  [31m[1m           2130.6          [0m[0m  |  [31m[1m   86230.0  [0m[0m  |  [31m[1m             115547.0            [0m[0m  |  [31m[1m                   22971.6                   [0m[0m  |  [31m[1m                       2653.6                       [0m[0m  |  [31m[1m                    29760.2                    [0m[0m
      256    x 768   |  [31m[1m         2370.3        [0m[0m  |  [31m[1m           2499.8          [0m[0m  |  [31m[1m   50215.8  [0m[0m  |  [31m[1m              47823.4            [0m[0m  |  [2m[91m                    2183.8                   [0m[0m  |  [31m[1m                       2766.3                       [0m[0m  |  [31m[1m                    14774.6                    [0m[0m
      128    x 768   |  [31m[1m         4500.5        [0m[0m  |  [31m[1m           3991.7          [0m[0m  |  [31m[1m   22228.9  [0m[0m  |  [31m[1m              21926.9            [0m[0m  |  [31m[1m                    9960.6                   [0m[0m  |                          823.6                         |  [31m[1m                     6918.6                    [0m[0m
      64     x 768   |  [31m[1m         1211.1        [0m[0m  |  [31m[1m            882.5          [0m[0m  |  [31m[1m    4710.5  [0m[0m  |  [31m[1m               2926.3            [0m[0m  |  [31m[1m                    4502.6                   [0m[0m  |  [2m[91m                       1093.5                       [0m[0m  |  [31m[1m                     3700.9                    [0m[0m
      32     x 768   |  [31m[1m         1067.6        [0m[0m  |  [2m[91m            811.6          [0m[0m  |  [2m[91m    2622.5  [0m[0m  |  [31m[1m               2006.0            [0m[0m  |                       653.7                     |  [2m[91m                       1035.0                       [0m[0m  |  [31m[1m                     1839.7                    [0m[0m
      16     x 768   |  [31m[1m         2994.2        [0m[0m  |  [2m[91m            716.9          [0m[0m  |  [2m[91m    1850.7  [0m[0m  |  [2m[91m               1294.8            [0m[0m  |                       834.6                     |                          721.3                         |  [31m[1m                      843.2                    [0m[0m
      8      x 768   |  [31m[1m         1562.2        [0m[0m  |              195.2            |      1021.2    |                  627.3              |  [34m[1m                     515.2                   [0m[0m  |  [2m[91m                       1227.8                       [0m[0m  |  [2m[91m                      522.9                    [0m[0m
      4      x 768   |  [2m[91m          626.3        [0m[0m  |  [34m[1m            171.9          [0m[0m  |       743.1    |                  589.4              |  [31m[1m                    2608.7                   [0m[0m  |  [92m[1m                        478.3                       [0m[0m  |  [2m[91m                      248.7                    [0m[0m
      2      x 768   |  [31m[1m         3270.1        [0m[0m  |  [92m[1m            164.7          [0m[0m  |  [34m[1m     553.8  [0m[0m  |  [92m[1m                362.4            [0m[0m  |  [92m[1m                     477.5                   [0m[0m  |  [31m[1m                       2394.0                       [0m[0m  |                        190.9                    
      1      x 768   |  [92m[1m          166.5        [0m[0m  |  [2m[91m            373.5          [0m[0m  |  [92m[1m     531.6  [0m[0m  |                  444.0              |  [31m[1m                    2450.2                   [0m[0m  |  [31m[1m                       4796.6                       [0m[0m  |  [92m[1m                      117.0                    [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------- Sparsity 80 with 80 threads using compilation strategy inductor and dtype torch.bfloat16 on device cpu. ---------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  Fine-grained + structured with backend inductor
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        14332.9        [0m[0m  |  [31m[1m           5442.6          [0m[0m  |  [31m[1m  582574.9  [0m[0m  |  [31m[1m             581679.1            [0m[0m  |  [31m[1m                   19380.6                   [0m[0m  |  [31m[1m                       4737.9                       [0m[0m  |  [31m[1m                    219859.4                   [0m[0m
      1024   x 768   |  [31m[1m         7856.8        [0m[0m  |  [31m[1m           3875.6          [0m[0m  |  [31m[1m  337071.3  [0m[0m  |  [31m[1m             319289.1            [0m[0m  |  [31m[1m                    7524.0                   [0m[0m  |  [31m[1m                       3035.0                       [0m[0m  |  [31m[1m                    107004.0                   [0m[0m
      512    x 768   |  [31m[1m        13299.4        [0m[0m  |  [31m[1m           3203.2          [0m[0m  |  [31m[1m  187888.9  [0m[0m  |  [31m[1m             193605.2            [0m[0m  |  [31m[1m                    5686.3                   [0m[0m  |  [31m[1m                       1631.3                       [0m[0m  |  [31m[1m                     57878.5                   [0m[0m
      256    x 768   |  [31m[1m         4520.8        [0m[0m  |  [2m[91m            869.5          [0m[0m  |  [31m[1m   92571.9  [0m[0m  |  [31m[1m              95338.3            [0m[0m  |  [31m[1m                   10882.7                   [0m[0m  |  [2m[91m                        956.2                       [0m[0m  |  [31m[1m                     30745.6                   [0m[0m
      128    x 768   |  [31m[1m         4464.7        [0m[0m  |  [2m[91m           1060.5          [0m[0m  |  [31m[1m  143963.4  [0m[0m  |  [31m[1m              60878.5            [0m[0m  |  [2m[91m                    1421.3                   [0m[0m  |  [31m[1m                      55732.5                       [0m[0m  |  [31m[1m                     16615.0                   [0m[0m
      64     x 768   |  [2m[91m         2837.6        [0m[0m  |              623.9            |  [31m[1m   23044.1  [0m[0m  |  [31m[1m              25785.1            [0m[0m  |                       599.6                     |  [2m[91m                       1154.3                       [0m[0m  |  [31m[1m                      7414.2                   [0m[0m
      32     x 768   |  [2m[91m         1759.0        [0m[0m  |  [31m[1m           2871.1          [0m[0m  |  [31m[1m    3321.8  [0m[0m  |  [31m[1m               4471.5            [0m[0m  |                       561.4                     |                          451.6                         |  [31m[1m                      3787.8                   [0m[0m
      16     x 768   |  [34m[1m          696.4        [0m[0m  |              724.8            |  [2m[91m    2016.3  [0m[0m  |  [31m[1m               2193.4            [0m[0m  |  [92m[1m                     335.8                   [0m[0m  |  [2m[91m                       1198.5                       [0m[0m  |  [31m[1m                      1811.5                   [0m[0m
      8      x 768   |            975.6          |              479.9            |  [2m[91m    1455.0  [0m[0m  |  [31m[1m               2021.8            [0m[0m  |  [31m[1m                    2632.4                   [0m[0m  |  [92m[1m                        266.9                       [0m[0m  |  [31m[1m                      1013.6                   [0m[0m
      4      x 768   |  [92m[1m          638.4        [0m[0m  |  [92m[1m            388.1          [0m[0m  |      1108.2    |  [2m[91m                818.4            [0m[0m  |  [2m[91m                     994.7                   [0m[0m  |  [2m[91m                        536.0                       [0m[0m  |  [2m[91m                       532.5                   [0m[0m
      2      x 768   |  [2m[91m         2094.6        [0m[0m  |              613.5            |       793.1    |                  492.4              |  [2m[91m                     895.5                   [0m[0m  |                          473.1                         |                         296.7                   
      1      x 768   |  [2m[91m         1572.4        [0m[0m  |  [31m[1m           3705.3          [0m[0m  |  [92m[1m     639.1  [0m[0m  |  [92m[1m                347.1            [0m[0m  |                       503.9                     |  [2m[91m                        578.4                       [0m[0m  |  [92m[1m                       171.0                   [0m[0m

Times are in microseconds (us).
/home/user/build/.venv/lib/python3.10/site-packages/torch/jit/_script.py:1241: UserWarning: `optimize` is deprecated and has no effect. Use `with torch.jit.optimized_execution() instead
  warnings.warn(

Sparsity 99 with 80 threads using compilation strategy script and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 80 threads using compilation strategy script and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 80 threads using compilation strategy script and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 80 threads using compilation strategy script and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[------------------------------------------------------------------------------------------- Sparsity 99 with 80 threads using compilation strategy script and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        55149.4        [0m[0m  |  [31m[1m           3366.7          [0m[0m  |  [31m[1m  35955.5   [0m[0m  |  [31m[1m             36041.2             [0m[0m  |  [31m[1m                  17017.2                  [0m[0m  |  [31m[1m                     13262.8                      [0m[0m  |  [31m[1m                   35680.6                   [0m[0m
      1024   x 768   |  [31m[1m         6810.4        [0m[0m  |  [31m[1m           4788.5          [0m[0m  |  [31m[1m  21988.5   [0m[0m  |  [31m[1m             27687.8             [0m[0m  |  [31m[1m                   9868.9                  [0m[0m  |  [31m[1m                      1931.3                      [0m[0m  |  [31m[1m                   17642.9                   [0m[0m
      512    x 768   |  [31m[1m        10995.9        [0m[0m  |  [31m[1m          29501.6          [0m[0m  |  [31m[1m   3422.3   [0m[0m  |  [31m[1m              2388.9             [0m[0m  |  [31m[1m                   4118.1                  [0m[0m  |  [31m[1m                      1543.5                      [0m[0m  |  [31m[1m                    3509.8                   [0m[0m
      256    x 768   |  [31m[1m         8957.5        [0m[0m  |  [31m[1m          12839.3          [0m[0m  |  [31m[1m   1865.1   [0m[0m  |  [31m[1m              1822.6             [0m[0m  |  [31m[1m                   2821.6                  [0m[0m  |  [31m[1m                      2198.8                      [0m[0m  |  [31m[1m                    1681.7                   [0m[0m
      128    x 768   |  [31m[1m         3553.4        [0m[0m  |  [2m[91m            878.7          [0m[0m  |  [31m[1m   2463.4   [0m[0m  |  [31m[1m              1039.1             [0m[0m  |  [31m[1m                   2263.5                  [0m[0m  |  [2m[91m                       477.0                      [0m[0m  |  [31m[1m                    1118.3                   [0m[0m
      64     x 768   |  [31m[1m         2484.3        [0m[0m  |  [2m[91m            533.9          [0m[0m  |  [2m[91m    844.1   [0m[0m  |  [31m[1m               758.6             [0m[0m  |  [2m[91m                   1457.5                  [0m[0m  |  [2m[91m                       380.0                      [0m[0m  |  [31m[1m                     740.2                   [0m[0m
      32     x 768   |  [31m[1m         4901.7        [0m[0m  |              235.4            |      674.1     |  [2m[91m               524.0             [0m[0m  |  [2m[91m                   1247.2                  [0m[0m  |  [2m[91m                       733.2                      [0m[0m  |  [2m[91m                     600.5                   [0m[0m
      16     x 768   |  [2m[91m          599.6        [0m[0m  |  [2m[91m            420.1          [0m[0m  |      551.6     |  [2m[91m               347.4             [0m[0m  |  [31m[1m                   1855.0                  [0m[0m  |  [2m[91m                       369.9                      [0m[0m  |  [2m[91m                     441.7                   [0m[0m
      8      x 768   |  [31m[1m         2137.6        [0m[0m  |  [92m[1m            181.9          [0m[0m  |      540.1     |  [2m[91m               328.2             [0m[0m  |  [92m[1m                    301.2                  [0m[0m  |  [34m[1m                       188.6                      [0m[0m  |  [2m[91m                     271.1                   [0m[0m
      4      x 768   |  [92m[1m          191.8        [0m[0m  |              361.1            |      443.4     |                 242.0               |  [2m[91m                   1164.1                  [0m[0m  |  [92m[1m                       172.9                      [0m[0m  |                       235.2                   
      2      x 768   |            304.7          |  [2m[91m            486.0          [0m[0m  |      410.3     |                 199.2               |                      413.4                    |  [2m[91m                       538.6                      [0m[0m  |                       211.1                   
      1      x 768   |  [2m[91m          466.9        [0m[0m  |  [2m[91m            528.2          [0m[0m  |  [92m[1m    337.4   [0m[0m  |  [92m[1m               149.5             [0m[0m  |                      424.3                    |  [31m[1m                       868.4                      [0m[0m  |  [92m[1m                     123.0                   [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------- Sparsity 95 with 80 threads using compilation strategy script and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        15014.4        [0m[0m  |  [31m[1m           7641.7          [0m[0m  |  [31m[1m  247963.6  [0m[0m  |  [31m[1m             188018.2            [0m[0m  |  [31m[1m                  32939.7                  [0m[0m  |  [31m[1m                     13356.5                      [0m[0m  |  [31m[1m                   174367.3                  [0m[0m
      1024   x 768   |  [31m[1m         7693.2        [0m[0m  |  [31m[1m           5973.6          [0m[0m  |  [31m[1m  170168.7  [0m[0m  |  [31m[1m              93081.3            [0m[0m  |  [31m[1m                   9382.9                  [0m[0m  |  [31m[1m                      5732.5                      [0m[0m  |  [31m[1m                    83398.6                  [0m[0m
      512    x 768   |  [31m[1m        14682.1        [0m[0m  |  [31m[1m           5322.6          [0m[0m  |  [31m[1m   58506.7  [0m[0m  |  [31m[1m              89077.1            [0m[0m  |  [31m[1m                   6334.7                  [0m[0m  |  [31m[1m                      5998.0                      [0m[0m  |  [31m[1m                    50014.9                  [0m[0m
      256    x 768   |  [31m[1m         8227.3        [0m[0m  |  [31m[1m           3274.0          [0m[0m  |  [31m[1m   23222.2  [0m[0m  |  [31m[1m              28927.9            [0m[0m  |  [31m[1m                   3298.8                  [0m[0m  |  [2m[91m                       898.1                      [0m[0m  |  [31m[1m                    24539.2                  [0m[0m
      128    x 768   |  [31m[1m         1793.4        [0m[0m  |  [31m[1m           2013.2          [0m[0m  |  [31m[1m    3079.4  [0m[0m  |  [31m[1m               4143.5            [0m[0m  |  [31m[1m                   6131.5                  [0m[0m  |  [2m[91m                      1666.4                      [0m[0m  |  [31m[1m                     3959.0                  [0m[0m
      64     x 768   |  [31m[1m         1687.8        [0m[0m  |  [31m[1m          11702.7          [0m[0m  |  [2m[91m    1699.4  [0m[0m  |  [31m[1m               1541.0            [0m[0m  |  [31m[1m                   2982.3                  [0m[0m  |  [2m[91m                      1063.4                      [0m[0m  |  [31m[1m                     1526.1                  [0m[0m
      32     x 768   |  [31m[1m         1751.7        [0m[0m  |              275.0            |  [2m[91m    1157.8  [0m[0m  |  [31m[1m               1887.3            [0m[0m  |  [2m[91m                    784.3                  [0m[0m  |                         738.8                        |  [2m[91m                      963.0                  [0m[0m
      16     x 768   |            294.5          |  [2m[91m            491.7          [0m[0m  |  [2m[91m     983.8  [0m[0m  |  [2m[91m                622.9            [0m[0m  |                      453.3                    |  [2m[91m                       846.3                      [0m[0m  |  [2m[91m                      804.5                  [0m[0m
      8      x 768   |  [92m[1m          230.8        [0m[0m  |  [2m[91m            586.6          [0m[0m  |       790.8    |  [2m[91m                548.4            [0m[0m  |                      301.3                    |                         511.4                        |  [2m[91m                     1043.2                  [0m[0m
      4      x 768   |  [2m[91m          627.0        [0m[0m  |  [31m[1m           1147.7          [0m[0m  |       686.6    |                  324.5              |  [2m[91m                    474.3                  [0m[0m  |  [92m[1m                       417.0                      [0m[0m  |                        340.7                  
      2      x 768   |            375.1          |  [2m[91m            459.1          [0m[0m  |       465.7    |                  274.6              |  [2m[91m                   1074.1                  [0m[0m  |                         522.1                        |  [92m[1m                      251.4                  [0m[0m
      1      x 768   |            443.1          |  [92m[1m            166.0          [0m[0m  |  [92m[1m     422.2  [0m[0m  |  [92m[1m                237.6            [0m[0m  |  [92m[1m                    234.8                  [0m[0m  |  [2m[91m                      1237.5                      [0m[0m  |  [92m[1m                      250.7                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------- Sparsity 90 with 80 threads using compilation strategy script and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        12245.1        [0m[0m  |  [31m[1m          12587.3          [0m[0m  |  [31m[1m  316497.6  [0m[0m  |  [31m[1m             306694.1            [0m[0m  |  [31m[1m                  13915.0                  [0m[0m  |  [31m[1m                      4853.4                      [0m[0m  |  [31m[1m                   311365.8                  [0m[0m
      1024   x 768   |  [31m[1m        11674.6        [0m[0m  |  [31m[1m           3153.6          [0m[0m  |  [31m[1m  191015.7  [0m[0m  |  [31m[1m             226444.1            [0m[0m  |  [31m[1m                  10336.6                  [0m[0m  |  [31m[1m                      3988.4                      [0m[0m  |  [31m[1m                   171106.0                  [0m[0m
      512    x 768   |  [31m[1m        10659.1        [0m[0m  |  [31m[1m          15299.7          [0m[0m  |  [31m[1m   87943.5  [0m[0m  |  [31m[1m             106990.8            [0m[0m  |  [31m[1m                   6879.5                  [0m[0m  |  [31m[1m                      2625.4                      [0m[0m  |  [31m[1m                    84272.3                  [0m[0m
      256    x 768   |  [31m[1m         5945.8        [0m[0m  |  [31m[1m           1816.8          [0m[0m  |  [31m[1m   46963.2  [0m[0m  |  [31m[1m              50899.3            [0m[0m  |  [31m[1m                  10111.0                  [0m[0m  |  [31m[1m                      3735.2                      [0m[0m  |  [31m[1m                    45184.6                  [0m[0m
      128    x 768   |  [31m[1m         2918.1        [0m[0m  |  [31m[1m           1327.5          [0m[0m  |  [31m[1m   34483.0  [0m[0m  |  [31m[1m              28360.4            [0m[0m  |  [31m[1m                   1627.0                  [0m[0m  |  [31m[1m                      2275.5                      [0m[0m  |  [31m[1m                    29853.6                  [0m[0m
      64     x 768   |  [31m[1m         3314.6        [0m[0m  |  [31m[1m           2031.4          [0m[0m  |  [31m[1m    4539.4  [0m[0m  |  [31m[1m               2923.4            [0m[0m  |  [31m[1m                   2087.2                  [0m[0m  |  [2m[91m                       402.5                      [0m[0m  |  [31m[1m                     3904.8                  [0m[0m
      32     x 768   |  [31m[1m         3092.3        [0m[0m  |  [31m[1m           1323.8          [0m[0m  |  [2m[91m    1981.6  [0m[0m  |  [2m[91m               1522.0            [0m[0m  |  [31m[1m                   1276.7                  [0m[0m  |  [2m[91m                       882.1                      [0m[0m  |  [31m[1m                     2038.5                  [0m[0m
      16     x 768   |  [31m[1m         3550.7        [0m[0m  |  [2m[91m            594.9          [0m[0m  |  [2m[91m    1250.0  [0m[0m  |  [2m[91m               1378.8            [0m[0m  |  [31m[1m                   1031.0                  [0m[0m  |  [2m[91m                       418.3                      [0m[0m  |  [31m[1m                     1422.9                  [0m[0m
      8      x 768   |            228.0          |  [31m[1m           1194.2          [0m[0m  |      1093.6    |  [2m[91m                799.9            [0m[0m  |                      306.7                    |  [2m[91m                       505.4                      [0m[0m  |  [2m[91m                     1025.4                  [0m[0m
      4      x 768   |  [2m[91m          572.9        [0m[0m  |  [34m[1m            174.2          [0m[0m  |      1096.3    |                  555.3              |  [2m[91m                    726.0                  [0m[0m  |  [92m[1m                       179.8                      [0m[0m  |  [2m[91m                      567.8                  [0m[0m
      2      x 768   |  [31m[1m         1216.2        [0m[0m  |  [2m[91m            465.2          [0m[0m  |       628.2    |                  432.1              |  [31m[1m                   1098.1                  [0m[0m  |  [31m[1m                      2109.2                      [0m[0m  |                        418.7                  
      1      x 768   |  [92m[1m          170.8        [0m[0m  |  [92m[1m            165.7          [0m[0m  |  [92m[1m     560.9  [0m[0m  |  [92m[1m                312.8            [0m[0m  |  [92m[1m                    199.3                  [0m[0m  |  [2m[91m                       388.8                      [0m[0m  |  [92m[1m                      261.9                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------- Sparsity 80 with 80 threads using compilation strategy script and dtype torch.bfloat16 on device cpu. -------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend script  |  Structured sparsity compiled with backend - script  |  Fine-grained + structured with backend script
80 threads: -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        30063.5        [0m[0m  |  [31m[1m          17450.2          [0m[0m  |  [31m[1m  593178.4  [0m[0m  |  [31m[1m             563705.0            [0m[0m  |  [31m[1m                  14776.2                  [0m[0m  |  [31m[1m                      6426.5                      [0m[0m  |  [31m[1m                   613869.7                  [0m[0m
      1024   x 768   |  [31m[1m        10149.9        [0m[0m  |  [31m[1m           3855.1          [0m[0m  |  [31m[1m  321132.3  [0m[0m  |  [31m[1m             316206.1            [0m[0m  |  [31m[1m                   8964.8                  [0m[0m  |  [31m[1m                     10261.2                      [0m[0m  |  [31m[1m                   319716.0                  [0m[0m
      512    x 768   |  [31m[1m        11380.0        [0m[0m  |  [31m[1m           2895.4          [0m[0m  |  [31m[1m  168979.4  [0m[0m  |  [31m[1m             161997.0            [0m[0m  |  [31m[1m                  21572.9                  [0m[0m  |  [31m[1m                      3819.5                      [0m[0m  |  [31m[1m                   248902.5                  [0m[0m
      256    x 768   |  [31m[1m         2094.2        [0m[0m  |  [31m[1m           2015.0          [0m[0m  |  [31m[1m  143363.1  [0m[0m  |  [31m[1m              86133.0            [0m[0m  |  [31m[1m                   2267.9                  [0m[0m  |  [31m[1m                      3294.3                      [0m[0m  |  [31m[1m                    85412.2                  [0m[0m
      128    x 768   |  [31m[1m         9043.2        [0m[0m  |  [31m[1m           1268.5          [0m[0m  |  [31m[1m   43425.1  [0m[0m  |  [31m[1m              41998.7            [0m[0m  |  [31m[1m                   1925.6                  [0m[0m  |  [2m[91m                       514.9                      [0m[0m  |  [31m[1m                    45855.0                  [0m[0m
      64     x 768   |  [31m[1m         2811.8        [0m[0m  |  [2m[91m            343.1          [0m[0m  |  [31m[1m   22636.3  [0m[0m  |  [31m[1m              22392.4            [0m[0m  |  [31m[1m                   1695.7                  [0m[0m  |  [31m[1m                      1102.1                      [0m[0m  |  [31m[1m                    22743.7                  [0m[0m
      32     x 768   |  [2m[91m          727.2        [0m[0m  |  [31m[1m           2956.0          [0m[0m  |  [31m[1m    4467.1  [0m[0m  |  [31m[1m               3897.9            [0m[0m  |  [31m[1m                   2888.5                  [0m[0m  |  [2m[91m                       845.7                      [0m[0m  |  [31m[1m                     3112.9                  [0m[0m
      16     x 768   |            288.4          |              214.2            |  [2m[91m    2164.6  [0m[0m  |  [31m[1m              21153.4            [0m[0m  |  [2m[91m                    939.0                  [0m[0m  |  [2m[91m                      1032.1                      [0m[0m  |  [2m[91m                     1483.4                  [0m[0m
      8      x 768   |  [31m[1m         1309.3        [0m[0m  |  [2m[91m            470.5          [0m[0m  |      1576.4    |  [31m[1m               2363.0            [0m[0m  |  [31m[1m                   2562.8                  [0m[0m  |                         230.6                        |  [2m[91m                     1490.8                  [0m[0m
      4      x 768   |  [34m[1m          191.8        [0m[0m  |  [2m[91m            592.0          [0m[0m  |      1367.0    |  [2m[91m                844.7            [0m[0m  |  [92m[1m                    213.0                  [0m[0m  |  [92m[1m                       206.5                      [0m[0m  |  [2m[91m                      812.6                  [0m[0m
      2      x 768   |  [92m[1m          189.8        [0m[0m  |  [34m[1m            168.1          [0m[0m  |  [92m[1m     852.5  [0m[0m  |  [34m[1m                403.3            [0m[0m  |  [31m[1m                   1638.3                  [0m[0m  |  [31m[1m                      2236.9                      [0m[0m  |                        560.8                  
      1      x 768   |            219.6          |  [92m[1m            165.7          [0m[0m  |      1131.0    |  [92m[1m                386.0            [0m[0m  |  [31m[1m                   2370.6                  [0m[0m  |                         398.9                        |  [92m[1m                      373.6                  [0m[0m

Times are in microseconds (us).

Sparsity 99 with 80 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 95 with 80 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 90 with 80 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
Sparsity 80 with 80 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu.
Benchmarking 2048   x 768 ...
Benchmarking 1024   x 768 ...
Benchmarking 512    x 768 ...
Benchmarking 256    x 768 ...
Benchmarking 128    x 768 ...
Benchmarking 64     x 768 ...
Benchmarking 32     x 768 ...
Benchmarking 16     x 768 ...
Benchmarking 8      x 768 ...
Benchmarking 4      x 768 ...
Benchmarking 2      x 768 ...
Benchmarking 1      x 768 ...
[------------------------------------------------------------------------------------------ Sparsity 99 with 80 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu. ------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
80 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        17411.6        [0m[0m  |  [31m[1m           5413.3          [0m[0m  |  [31m[1m  42152.1   [0m[0m  |  [31m[1m             34405.5             [0m[0m  |  [31m[1m                 17336.4                  [0m[0m  |  [31m[1m                     10901.6                     [0m[0m  |  [31m[1m                  34018.2                   [0m[0m
      1024   x 768   |  [31m[1m         6899.9        [0m[0m  |  [31m[1m           3086.2          [0m[0m  |  [31m[1m  21204.0   [0m[0m  |  [31m[1m             20534.9             [0m[0m  |  [31m[1m                 11608.1                  [0m[0m  |  [31m[1m                     12489.8                     [0m[0m  |  [31m[1m                  19482.4                   [0m[0m
      512    x 768   |  [31m[1m        10141.8        [0m[0m  |  [31m[1m           4127.8          [0m[0m  |  [31m[1m   2657.0   [0m[0m  |  [31m[1m              2351.7             [0m[0m  |  [31m[1m                  7250.8                  [0m[0m  |  [31m[1m                      2790.8                     [0m[0m  |  [31m[1m                   3576.9                   [0m[0m
      256    x 768   |  [31m[1m        10205.4        [0m[0m  |  [2m[91m            686.7          [0m[0m  |  [2m[91m   1542.0   [0m[0m  |  [31m[1m              1846.2             [0m[0m  |  [31m[1m                 42555.7                  [0m[0m  |  [31m[1m                     20591.5                     [0m[0m  |  [31m[1m                   1377.7                   [0m[0m
      128    x 768   |  [31m[1m         1334.5        [0m[0m  |  [31m[1m           3065.0          [0m[0m  |  [2m[91m   1317.3   [0m[0m  |  [31m[1m               902.5             [0m[0m  |  [31m[1m                  3002.8                  [0m[0m  |  [31m[1m                      2338.9                     [0m[0m  |  [31m[1m                   1251.9                   [0m[0m
      64     x 768   |  [31m[1m         1620.5        [0m[0m  |  [2m[91m            503.1          [0m[0m  |  [31m[1m   4337.2   [0m[0m  |  [2m[91m               751.5             [0m[0m  |  [31m[1m                  1420.7                  [0m[0m  |  [34m[1m                       364.6                     [0m[0m  |  [31m[1m                    868.3                   [0m[0m
      32     x 768   |  [31m[1m         1220.6        [0m[0m  |              236.4            |      761.2     |  [31m[1m              1066.8             [0m[0m  |  [2m[91m                   621.0                  [0m[0m  |  [2m[91m                      1046.8                     [0m[0m  |  [2m[91m                    633.1                   [0m[0m
      16     x 768   |  [31m[1m         2105.8        [0m[0m  |  [2m[91m            389.0          [0m[0m  |      566.4     |  [2m[91m               355.9             [0m[0m  |  [31m[1m                  2697.8                  [0m[0m  |  [31m[1m                      2058.0                     [0m[0m  |  [31m[1m                   2309.6                   [0m[0m
      8      x 768   |            233.5          |  [31m[1m           1442.6          [0m[0m  |      546.5     |                 275.7               |                     244.2                    |  [92m[1m                       337.2                     [0m[0m  |  [31m[1m                   2512.7                   [0m[0m
      4      x 768   |  [31m[1m         1958.0        [0m[0m  |              328.6            |  [34m[1m    463.8   [0m[0m  |                 297.6               |                     209.0                    |  [2m[91m                       687.2                     [0m[0m  |                      207.1                   
      2      x 768   |  [34m[1m          177.7        [0m[0m  |  [92m[1m            167.3          [0m[0m  |  [2m[91m   2113.2   [0m[0m  |                 210.5               |  [92m[1m                   185.6                  [0m[0m  |                         588.5                       |                      266.5                   
      1      x 768   |  [92m[1m          170.8        [0m[0m  |  [2m[91m            404.2          [0m[0m  |  [92m[1m    441.0   [0m[0m  |  [92m[1m               168.1             [0m[0m  |  [31m[1m                  1028.7                  [0m[0m  |  [31m[1m                      3106.7                     [0m[0m  |  [92m[1m                    158.3                   [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------ Sparsity 95 with 80 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu. ------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
80 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        13077.8        [0m[0m  |  [31m[1m          11534.8          [0m[0m  |  [31m[1m  177378.9  [0m[0m  |  [31m[1m             171076.4            [0m[0m  |  [31m[1m                 15861.1                  [0m[0m  |  [31m[1m                      4071.2                     [0m[0m  |  [31m[1m                  235276.0                  [0m[0m
      1024   x 768   |  [31m[1m         7167.4        [0m[0m  |  [31m[1m           2456.3          [0m[0m  |  [31m[1m   88997.8  [0m[0m  |  [31m[1m              88341.1            [0m[0m  |  [31m[1m                  6046.1                  [0m[0m  |  [31m[1m                      4652.3                     [0m[0m  |  [31m[1m                   88381.2                  [0m[0m
      512    x 768   |  [31m[1m         5509.9        [0m[0m  |  [31m[1m           1518.0          [0m[0m  |  [31m[1m   49758.5  [0m[0m  |  [31m[1m              50132.6            [0m[0m  |  [31m[1m                 10591.1                  [0m[0m  |  [31m[1m                      1870.8                     [0m[0m  |  [31m[1m                   43718.3                  [0m[0m
      256    x 768   |  [31m[1m         5494.0        [0m[0m  |  [31m[1m           2586.1          [0m[0m  |  [31m[1m   26418.9  [0m[0m  |  [31m[1m              22741.3            [0m[0m  |  [31m[1m                  2161.0                  [0m[0m  |  [31m[1m                      2328.7                     [0m[0m  |  [31m[1m                   25656.9                  [0m[0m
      128    x 768   |  [2m[91m         1334.0        [0m[0m  |  [31m[1m           1268.2          [0m[0m  |  [31m[1m    3049.3  [0m[0m  |  [31m[1m               3778.1            [0m[0m  |  [31m[1m                  7058.5                  [0m[0m  |  [2m[91m                       448.4                     [0m[0m  |  [31m[1m                    6102.7                  [0m[0m
      64     x 768   |  [2m[91m         2036.5        [0m[0m  |  [2m[91m            980.5          [0m[0m  |  [31m[1m    3235.0  [0m[0m  |  [31m[1m               2107.8            [0m[0m  |  [31m[1m                 40118.9                  [0m[0m  |  [31m[1m                      3092.2                     [0m[0m  |  [31m[1m                    1523.6                  [0m[0m
      32     x 768   |  [2m[91m         1618.5        [0m[0m  |  [2m[91m           1022.1          [0m[0m  |  [2m[91m    1328.2  [0m[0m  |  [2m[91m                966.9            [0m[0m  |  [31m[1m                  2855.4                  [0m[0m  |                         294.9                       |  [2m[91m                     968.8                  [0m[0m
      16     x 768   |  [31m[1m         2448.1        [0m[0m  |  [92m[1m            208.9          [0m[0m  |      1007.9    |  [2m[91m                685.9            [0m[0m  |  [31m[1m                  1215.5                  [0m[0m  |  [2m[91m                       519.0                     [0m[0m  |  [2m[91m                    1130.9                  [0m[0m
      8      x 768   |  [2m[91m         1341.5        [0m[0m  |              405.6            |      1131.4    |  [2m[91m                521.7            [0m[0m  |                     243.2                    |  [31m[1m                      1472.3                     [0m[0m  |                       470.0                  
      4      x 768   |  [31m[1m         2767.5        [0m[0m  |  [31m[1m           3917.4          [0m[0m  |  [92m[1m     604.7  [0m[0m  |  [34m[1m                252.0            [0m[0m  |  [92m[1m                   205.9                  [0m[0m  |  [92m[1m                       182.1                     [0m[0m  |                       451.9                  
      2      x 768   |  [92m[1m          420.2        [0m[0m  |              369.8            |      1105.6    |  [34m[1m                255.8            [0m[0m  |  [2m[91m                   860.3                  [0m[0m  |  [2m[91m                       386.6                     [0m[0m  |  [34m[1m                     306.2                  [0m[0m
      1      x 768   |  [31m[1m         3712.6        [0m[0m  |  [2m[91m            548.1          [0m[0m  |  [2m[91m    1989.3  [0m[0m  |  [92m[1m                241.0            [0m[0m  |                     384.6                    |  [31m[1m                      4655.9                     [0m[0m  |  [92m[1m                     285.7                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------ Sparsity 90 with 80 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu. ------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
80 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        17753.9        [0m[0m  |  [31m[1m          32066.6          [0m[0m  |  [31m[1m  324430.6  [0m[0m  |  [31m[1m             337002.2            [0m[0m  |  [31m[1m                 28109.2                  [0m[0m  |  [31m[1m                      6025.7                     [0m[0m  |  [31m[1m                  332337.2                  [0m[0m
      1024   x 768   |  [31m[1m         7449.5        [0m[0m  |  [31m[1m           4094.9          [0m[0m  |  [31m[1m  175461.4  [0m[0m  |  [31m[1m             181265.5            [0m[0m  |  [31m[1m                  6567.6                  [0m[0m  |  [31m[1m                      3531.7                     [0m[0m  |  [31m[1m                  186992.0                  [0m[0m
      512    x 768   |  [31m[1m         3638.0        [0m[0m  |  [31m[1m           4692.1          [0m[0m  |  [31m[1m   97055.3  [0m[0m  |  [31m[1m              81212.4            [0m[0m  |  [31m[1m                  3839.9                  [0m[0m  |  [31m[1m                      4538.5                     [0m[0m  |  [31m[1m                   85267.8                  [0m[0m
      256    x 768   |  [31m[1m         6305.5        [0m[0m  |  [31m[1m           1372.8          [0m[0m  |  [31m[1m   41684.5  [0m[0m  |  [31m[1m              40838.8            [0m[0m  |  [31m[1m                 13076.4                  [0m[0m  |  [2m[91m                      1485.7                     [0m[0m  |  [31m[1m                   47232.4                  [0m[0m
      128    x 768   |  [2m[91m         1356.1        [0m[0m  |  [2m[91m            624.3          [0m[0m  |  [31m[1m   80903.4  [0m[0m  |  [31m[1m              21759.0            [0m[0m  |  [31m[1m                  2008.9                  [0m[0m  |  [31m[1m                      2526.7                     [0m[0m  |  [31m[1m                   21817.7                  [0m[0m
      64     x 768   |  [31m[1m         6869.4        [0m[0m  |  [2m[91m            547.0          [0m[0m  |  [31m[1m   29794.1  [0m[0m  |  [31m[1m               2846.3            [0m[0m  |  [31m[1m                  2015.1                  [0m[0m  |  [92m[1m                       370.7                     [0m[0m  |  [31m[1m                    3040.0                  [0m[0m
      32     x 768   |  [2m[91m         1124.2        [0m[0m  |  [2m[91m            684.0          [0m[0m  |  [2m[91m    1755.1  [0m[0m  |  [31m[1m               1538.0            [0m[0m  |  [31m[1m                  3611.5                  [0m[0m  |                         643.4                       |  [31m[1m                    1603.2                  [0m[0m
      16     x 768   |  [31m[1m         3390.2        [0m[0m  |  [2m[91m            638.1          [0m[0m  |  [2m[91m    1209.1  [0m[0m  |  [31m[1m               4769.5            [0m[0m  |  [2m[91m                   723.4                  [0m[0m  |  [34m[1m                       395.9                     [0m[0m  |  [2m[91m                    1085.7                  [0m[0m
      8      x 768   |  [2m[91m         1699.8        [0m[0m  |  [34m[1m            184.7          [0m[0m  |       848.1    |  [2m[91m                794.7            [0m[0m  |                     241.3                    |                         636.8                       |  [2m[91m                     655.9                  [0m[0m
      4      x 768   |  [2m[91m         1366.6        [0m[0m  |  [92m[1m            173.2          [0m[0m  |       705.7    |  [2m[91m                469.9            [0m[0m  |                     205.7                    |  [31m[1m                      2194.4                     [0m[0m  |                       516.9                  
      2      x 768   |  [92m[1m          346.4        [0m[0m  |  [2m[91m            372.2          [0m[0m  |  [2m[91m    2016.7  [0m[0m  |                  254.7              |  [34m[1m                   184.5                  [0m[0m  |  [31m[1m                      2094.2                     [0m[0m  |                       370.3                  
      1      x 768   |  [2m[91m         1555.3        [0m[0m  |              321.9            |  [92m[1m     478.1  [0m[0m  |  [92m[1m                203.4            [0m[0m  |  [92m[1m                   181.1                  [0m[0m  |                         562.9                       |  [92m[1m                     268.6                  [0m[0m

Times are in microseconds (us).

[------------------------------------------------------------------------------------------ Sparsity 80 with 80 threads using compilation strategy trace and dtype torch.bfloat16 on device cpu. ------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend trace  |  Structured sparsity compiled with backend - trace  |  Fine-grained + structured with backend trace
80 threads: --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m        36354.4        [0m[0m  |  [31m[1m           4769.1          [0m[0m  |  [31m[1m  593091.5  [0m[0m  |  [31m[1m             583572.6            [0m[0m  |  [31m[1m                 13842.5                  [0m[0m  |  [31m[1m                      8304.1                     [0m[0m  |  [31m[1m                  588455.5                  [0m[0m
      1024   x 768   |  [31m[1m        15225.5        [0m[0m  |  [31m[1m           3705.9          [0m[0m  |  [31m[1m  361920.7  [0m[0m  |  [31m[1m             329146.6            [0m[0m  |  [31m[1m                  8556.2                  [0m[0m  |  [31m[1m                     20161.1                     [0m[0m  |  [31m[1m                  315285.5                  [0m[0m
      512    x 768   |  [31m[1m         8670.3        [0m[0m  |  [31m[1m           9245.6          [0m[0m  |  [31m[1m  201240.9  [0m[0m  |  [31m[1m             245292.5            [0m[0m  |  [31m[1m                  4410.7                  [0m[0m  |  [31m[1m                      7409.6                     [0m[0m  |  [31m[1m                  174433.0                  [0m[0m
      256    x 768   |  [31m[1m         8201.8        [0m[0m  |  [31m[1m            936.5          [0m[0m  |  [31m[1m  103567.2  [0m[0m  |  [31m[1m              87127.9            [0m[0m  |  [31m[1m                  7818.1                  [0m[0m  |  [31m[1m                      1967.3                     [0m[0m  |  [31m[1m                  174323.3                  [0m[0m
      128    x 768   |  [31m[1m         1726.8        [0m[0m  |  [31m[1m           1226.8          [0m[0m  |  [31m[1m   50176.0  [0m[0m  |  [31m[1m              41988.5            [0m[0m  |  [31m[1m                  2528.9                  [0m[0m  |  [2m[91m                       484.4                     [0m[0m  |  [31m[1m                   43045.1                  [0m[0m
      64     x 768   |  [31m[1m         2473.2        [0m[0m  |  [2m[91m            578.0          [0m[0m  |  [31m[1m   26218.9  [0m[0m  |  [31m[1m              24867.3            [0m[0m  |  [2m[91m                   555.3                  [0m[0m  |  [31m[1m                      2058.6                     [0m[0m  |  [31m[1m                   26554.5                  [0m[0m
      32     x 768   |  [2m[91m          382.1        [0m[0m  |              282.7            |  [31m[1m    5687.8  [0m[0m  |  [31m[1m               3899.7            [0m[0m  |  [31m[1m                  1857.6                  [0m[0m  |  [31m[1m                      2847.4                     [0m[0m  |  [2m[91m                    3164.7                  [0m[0m
      16     x 768   |  [31m[1m        10859.0        [0m[0m  |              256.2            |  [2m[91m    1651.7  [0m[0m  |  [2m[91m               1456.3            [0m[0m  |                     314.8                    |  [31m[1m                     27429.3                     [0m[0m  |  [2m[91m                    1669.4                  [0m[0m
      8      x 768   |  [31m[1m         1045.7        [0m[0m  |              191.3            |  [2m[91m    1572.7  [0m[0m  |  [2m[91m               1398.0            [0m[0m  |                     242.1                    |                         199.0                       |                       888.3                  
      4      x 768   |  [31m[1m         2199.8        [0m[0m  |              209.0            |      1078.7    |                  594.0              |                     208.7                    |  [34m[1m                       182.9                     [0m[0m  |                      1270.5                  
      2      x 768   |  [2m[91m          455.5        [0m[0m  |  [34m[1m            171.1          [0m[0m  |  [92m[1m     778.6  [0m[0m  |  [92m[1m                416.7            [0m[0m  |  [34m[1m                   186.4                  [0m[0m  |  [34m[1m                       179.0                     [0m[0m  |  [92m[1m                     662.6                  [0m[0m
      1      x 768   |  [92m[1m          170.9        [0m[0m  |  [92m[1m            169.0          [0m[0m  |      1300.3    |  [34m[1m                433.7            [0m[0m  |  [92m[1m                   176.9                  [0m[0m  |  [92m[1m                       173.3                     [0m[0m  |  [34m[1m                     676.2                  [0m[0m

Times are in microseconds (us).
