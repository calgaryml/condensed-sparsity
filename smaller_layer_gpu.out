/home/user/condensed-sparsity/src/condensed_sparsity/v2/condensed_linear.py:168: UserWarning: Sparse CSR tensor support is in beta state. If you miss a functionality in the sparse tensor support, please submit a feature request to https://github.com/pytorch/pytorch/issues. (Triggered internally at ../aten/src/ATen/SparseCsrTensorImpl.cpp:54.)
  torch.clone(self.weight.detach().type(dtype).to_sparse_csr()),
Sparsity 90 with 1 threads using compilation strategy inductor and dtype torch.float32 on device cuda.
Benchmarking 2048   x 3072...
/home/user/build/.venv/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:90: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
[2023-09-26 22:27:18,588] torch._inductor.utils: [WARNING] not enough cuda cores to use max_autotune mode
[2023-09-26 22:27:21,842] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:27:24,035] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:27:52,428] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:27:55,598] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:28:23,895] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:28:26,446] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:28:53,685] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:28:55,936] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:29:28,828] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:29:32,141] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:30:02,938] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:30:05,454] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:30:33,710] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:30:35,958] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:31:06,209] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:31:09,821] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:31:41,537] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:31:44,901] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:32:17,394] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:32:20,435] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:32:53,384] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:32:56,420] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:33:29,340] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-26 22:33:32,515] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
Benchmarking 1024   x 3072...
Benchmarking 512    x 3072...
Benchmarking 256    x 3072...
Benchmarking 128    x 3072...
Benchmarking 64     x 3072...
Benchmarking 32     x 3072...
Benchmarking 16     x 3072...
Benchmarking 8      x 3072...
Benchmarking 4      x 3072...
Benchmarking 2      x 3072...
Benchmarking 1      x 3072...
[------------------------------------------------------------------------------------------------------------------------------------------------------------------- Sparsity 90 with 1 threads using compilation strategy inductor and dtype torch.float32 on device cuda. -------------------------------------------------------------------------------------------------------------------------------------------------------------------]
                     |  Dense benchmark - eager  |  Structured sparsity - eager  |  structured + csr - eager  |  csr only - eager  |  Vmap - eager  |  Fine-grained + structured - eager  |  Dense benchmark - Compiled - backend inductor  |  Structured sparsity compiled with backend - inductor  |  structured + csr with backend inductor  |  csr only compiled with backend - inductor  |  Fine-grained + structured with backend inductor
1 threads: -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 3072  |  [31m[1m         984.6         [0m[0m  |  [31m[1m           471.3           [0m[0m  |  [31m[1m        11751.2         [0m[0m  |  [31m[1m    11764.9     [0m[0m  |  [31m[1m  24073.0   [0m[0m  |  [31m[1m             24055.3             [0m[0m  |  [31m[1m                    993.5                    [0m[0m  |  [31m[1m                       590.0                        [0m[0m  |  [31m[1m               11975.9                [0m[0m  |  [31m[1m                 12098.1                 [0m[0m  |  [31m[1m                     6981.8                    [0m[0m
      1024   x 3072  |  [31m[1m         547.7         [0m[0m  |  [31m[1m           272.1           [0m[0m  |  [31m[1m         6110.9         [0m[0m  |  [31m[1m     6115.9     [0m[0m  |  [31m[1m  12064.4   [0m[0m  |  [31m[1m             12053.3             [0m[0m  |  [31m[1m                    569.5                    [0m[0m  |  [31m[1m                       336.6                        [0m[0m  |  [31m[1m                6169.7                [0m[0m  |  [31m[1m                  6196.3                 [0m[0m  |  [31m[1m                     3612.9                    [0m[0m
      512    x 3072  |  [31m[1m         271.1         [0m[0m  |  [31m[1m           146.3           [0m[0m  |  [31m[1m         3127.7         [0m[0m  |  [31m[1m     3130.6     [0m[0m  |  [31m[1m   6034.3   [0m[0m  |  [31m[1m              6034.4             [0m[0m  |  [2m[91m                    279.7                    [0m[0m  |  [2m[91m                       179.0                        [0m[0m  |  [31m[1m                3129.5                [0m[0m  |  [31m[1m                  3133.8                 [0m[0m  |  [31m[1m                     1844.9                    [0m[0m
      256    x 3072  |  [2m[91m         144.1         [0m[0m  |  [2m[91m            90.0           [0m[0m  |  [31m[1m         1579.6         [0m[0m  |  [31m[1m     1593.0     [0m[0m  |  [31m[1m   3031.2   [0m[0m  |  [31m[1m              3029.2             [0m[0m  |  [2m[91m                    145.0                    [0m[0m  |                         107.0                          |  [31m[1m                1591.6                [0m[0m  |  [31m[1m                  1594.2                 [0m[0m  |  [31m[1m                      975.4                    [0m[0m
      128    x 3072  |  [2m[91m          96.6         [0m[0m  |  [2m[91m            51.2           [0m[0m  |  [31m[1m          800.9         [0m[0m  |  [31m[1m      800.0     [0m[0m  |  [31m[1m   1528.3   [0m[0m  |  [31m[1m              1526.7             [0m[0m  |                       97.0                      |  [34m[1m                        63.5                        [0m[0m  |  [31m[1m                 804.9                [0m[0m  |  [31m[1m                   807.3                 [0m[0m  |  [31m[1m                      490.8                    [0m[0m
      64     x 3072  |            52.2           |  [2m[91m            41.6           [0m[0m  |  [31m[1m          352.4         [0m[0m  |  [31m[1m      353.1     [0m[0m  |  [2m[91m    772.5   [0m[0m  |  [31m[1m               774.6             [0m[0m  |  [34m[1m                     70.7                    [0m[0m  |  [34m[1m                        63.3                        [0m[0m  |  [31m[1m                 352.8                [0m[0m  |  [31m[1m                   353.4                 [0m[0m  |  [2m[91m                      239.6                    [0m[0m
      32     x 3072  |  [34m[1m          42.0         [0m[0m  |  [2m[91m            42.0           [0m[0m  |  [2m[91m          147.8         [0m[0m  |  [2m[91m      149.0     [0m[0m  |  [2m[91m    397.4   [0m[0m  |  [31m[1m               397.7             [0m[0m  |  [34m[1m                     71.3                    [0m[0m  |  [92m[1m                        62.5                        [0m[0m  |  [2m[91m                 148.0                [0m[0m  |  [2m[91m                   149.2                 [0m[0m  |  [2m[91m                      128.4                    [0m[0m
      16     x 3072  |  [34m[1m          43.2         [0m[0m  |  [2m[91m            44.6           [0m[0m  |  [2m[91m           87.9         [0m[0m  |  [2m[91m       88.7     [0m[0m  |      209.4     |  [2m[91m               211.0             [0m[0m  |  [34m[1m                     72.2                    [0m[0m  |  [92m[1m                        62.9                        [0m[0m  |                    87.9                  |                      88.7                   |                         75.1                    
      8      x 3072  |  [34m[1m          43.3         [0m[0m  |  [2m[91m            44.6           [0m[0m  |             66.5           |         66.9       |  [34m[1m    186.5   [0m[0m  |  [2m[91m               112.2             [0m[0m  |  [34m[1m                     74.9                    [0m[0m  |  [34m[1m                        63.6                        [0m[0m  |                    65.8                  |                      66.9                   |  [92m[1m                       63.3                    [0m[0m
      4      x 3072  |  [34m[1m          44.7         [0m[0m  |  [2m[91m            42.9           [0m[0m  |             60.4           |         60.7       |  [92m[1m    185.7   [0m[0m  |                  59.9               |  [34m[1m                     72.7                    [0m[0m  |  [92m[1m                        63.0                        [0m[0m  |  [92m[1m                  59.3                [0m[0m  |  [34m[1m                    59.6                 [0m[0m  |  [34m[1m                       64.0                    [0m[0m
      2      x 3072  |  [34m[1m          44.4         [0m[0m  |  [92m[1m            20.1           [0m[0m  |             58.3           |         58.5       |  [92m[1m    185.8   [0m[0m  |  [34m[1m                49.5             [0m[0m  |  [34m[1m                     74.7                    [0m[0m  |  [92m[1m                        62.5                        [0m[0m  |  [92m[1m                  59.3                [0m[0m  |  [92m[1m                    58.8                 [0m[0m  |  [34m[1m                       64.1                    [0m[0m
      1      x 3072  |  [92m[1m          41.1         [0m[0m  |              24.1             |  [92m[1m           36.0         [0m[0m  |  [92m[1m       36.1     [0m[0m  |  [92m[1m    184.3   [0m[0m  |  [92m[1m                48.5             [0m[0m  |  [92m[1m                     69.2                    [0m[0m  |  [92m[1m                        62.9                        [0m[0m  |  [34m[1m                  61.7                [0m[0m  |  [34m[1m                    60.0                 [0m[0m  |  [92m[1m                       63.8                    [0m[0m

Times are in microseconds (us).
