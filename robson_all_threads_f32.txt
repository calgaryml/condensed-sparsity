/home/user/condensed-sparsity/src/condensed_sparsity/v2/condensed_linear.py:142: UserWarning: Sparse CSR tensor support is in beta state. If you miss a functionality in the sparse tensor support, please submit a feature request to https://github.com/pytorch/pytorch/issues. (Triggered internally at ../aten/src/ATen/SparseCsrTensorImpl.cpp:54.)
  torch.clone(self.weight.detach().type(dtype).to_sparse_csr()),
/home/user/build/.venv/lib/python3.10/site-packages/torch/jit/_script.py:1241: UserWarning: `optimize` is deprecated and has no effect. Use `with torch.jit.optimized_execution() instead
  warnings.warn(
Benchmarking batch size 2048 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 512 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 256 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 128 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 64 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 32 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 16 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 8 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 4 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 2 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 1 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 2048 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 512 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 256 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 128 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 64 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 32 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 16 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 8 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 4 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 2 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 1 with sparsity 80 num_threads 1 with compiler script using backend script
[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 1 threads  -----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend script  |  Fine-grained + structured sparsity @ 90 with backend script  |  Dense benchmark - Compiled - backend script
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               64097.4               [0m[0m  |  [31m[1m 4219443.7  [0m[0m  |  [31m[1m        164007.6       [0m[0m  |  [31m[1m                  64404.7                   [0m[0m  |  [31m[1m                         4229245.0                         [0m[0m  |  [31m[1m                  168323.1                 [0m[0m
      1024   x 768   |  [31m[1m               31654.9               [0m[0m  |  [31m[1m 2124665.5  [0m[0m  |  [31m[1m         83147.7       [0m[0m  |  [31m[1m                  32064.8                   [0m[0m  |  [31m[1m                         2110423.2                         [0m[0m  |  [31m[1m                   85070.0                 [0m[0m
      512    x 768   |  [31m[1m               16097.5               [0m[0m  |  [31m[1m 1067490.4  [0m[0m  |  [31m[1m         42462.8       [0m[0m  |  [31m[1m                  16003.3                   [0m[0m  |  [31m[1m                         1061729.0                         [0m[0m  |  [31m[1m                   43046.6                 [0m[0m
      256    x 768   |  [31m[1m                8241.1               [0m[0m  |  [31m[1m  452691.7  [0m[0m  |  [31m[1m         21567.8       [0m[0m  |  [31m[1m                   8217.8                   [0m[0m  |  [31m[1m                          535603.5                         [0m[0m  |  [31m[1m                   21699.9                 [0m[0m
      128    x 768   |  [31m[1m                4245.1               [0m[0m  |  [31m[1m  189738.9  [0m[0m  |  [31m[1m         11065.4       [0m[0m  |  [31m[1m                   4336.6                   [0m[0m  |  [31m[1m                          281275.4                         [0m[0m  |  [31m[1m                   10807.0                 [0m[0m
      64     x 768   |  [31m[1m                2315.7               [0m[0m  |  [31m[1m   95493.3  [0m[0m  |  [31m[1m          5998.4       [0m[0m  |  [31m[1m                   2239.6                   [0m[0m  |  [31m[1m                          136212.1                         [0m[0m  |  [31m[1m                    5500.9                 [0m[0m
      32     x 768   |  [31m[1m                1322.1               [0m[0m  |  [31m[1m   48577.1  [0m[0m  |  [31m[1m          3474.4       [0m[0m  |  [31m[1m                   1218.5                   [0m[0m  |  [31m[1m                           50189.2                         [0m[0m  |  [31m[1m                    2921.2                 [0m[0m
      16     x 768   |  [2m[91m                 878.1               [0m[0m  |  [31m[1m   23923.5  [0m[0m  |  [2m[91m          2196.7       [0m[0m  |  [2m[91m                    530.1                   [0m[0m  |  [31m[1m                           23401.9                         [0m[0m  |  [2m[91m                    1455.3                 [0m[0m
      8      x 768   |  [2m[91m                 478.3               [0m[0m  |  [31m[1m   11616.5  [0m[0m  |  [2m[91m          1475.8       [0m[0m  |                      280.2                     |  [31m[1m                           11463.1                         [0m[0m  |                       739.1                 
      4      x 768   |                   324.0                 |  [2m[91m    5863.8  [0m[0m  |  [2m[91m          1014.2       [0m[0m  |  [34m[1m                    229.3                   [0m[0m  |  [2m[91m                            5756.7                         [0m[0m  |  [34m[1m                     573.4                 [0m[0m
      2      x 768   |  [34m[1m                 190.8               [0m[0m  |      3012.7    |  [34m[1m           502.0       [0m[0m  |  [34m[1m                    226.9                   [0m[0m  |                              2879.8                           |  [34m[1m                     549.0                 [0m[0m
      1      x 768   |  [92m[1m                 175.9               [0m[0m  |  [92m[1m    1634.2  [0m[0m  |  [92m[1m           494.3       [0m[0m  |  [92m[1m                    217.4                   [0m[0m  |  [92m[1m                            1471.6                         [0m[0m  |  [92m[1m                     525.4                 [0m[0m

Times are in microseconds (us).

[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 1 threads  -----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend script  |  Fine-grained + structured sparsity @ 80 with backend script  |  Dense benchmark - Compiled - backend script
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               66848.3               [0m[0m  |  [31m[1m 8458657.3  [0m[0m  |  [31m[1m        163111.9       [0m[0m  |  [31m[1m                  67123.3                   [0m[0m  |  [31m[1m                         8506028.6                         [0m[0m  |  [31m[1m                  166832.3                 [0m[0m
      1024   x 768   |  [31m[1m               33855.0               [0m[0m  |  [31m[1m 4195024.3  [0m[0m  |  [31m[1m         84673.9       [0m[0m  |  [31m[1m                  33522.1                   [0m[0m  |  [31m[1m                         4199855.2                         [0m[0m  |  [31m[1m                   84487.3                 [0m[0m
      512    x 768   |  [31m[1m               16997.3               [0m[0m  |  [31m[1m 2116318.3  [0m[0m  |  [31m[1m         42491.9       [0m[0m  |  [31m[1m                  16780.0                   [0m[0m  |  [31m[1m                         2112606.7                         [0m[0m  |  [31m[1m                   43801.5                 [0m[0m
      256    x 768   |  [31m[1m                8979.1               [0m[0m  |  [31m[1m 1070577.8  [0m[0m  |  [31m[1m         23859.5       [0m[0m  |  [31m[1m                   8748.3                   [0m[0m  |  [31m[1m                         1060591.0                         [0m[0m  |  [31m[1m                   22390.7                 [0m[0m
      128    x 768   |  [31m[1m                4584.9               [0m[0m  |  [31m[1m  541413.8  [0m[0m  |  [31m[1m         11458.2       [0m[0m  |  [31m[1m                   4164.9                   [0m[0m  |  [31m[1m                          540936.7                         [0m[0m  |  [31m[1m                   10820.4                 [0m[0m
      64     x 768   |  [31m[1m                2399.3               [0m[0m  |  [31m[1m  267688.0  [0m[0m  |  [31m[1m          6137.3       [0m[0m  |  [31m[1m                   2161.7                   [0m[0m  |  [31m[1m                          270183.0                         [0m[0m  |  [31m[1m                    5284.8                 [0m[0m
      32     x 768   |  [31m[1m                1378.6               [0m[0m  |  [31m[1m   95148.1  [0m[0m  |  [31m[1m          3442.2       [0m[0m  |  [2m[91m                   1065.1                   [0m[0m  |  [31m[1m                          134868.9                         [0m[0m  |  [31m[1m                    2732.3                 [0m[0m
      16     x 768   |  [2m[91m                 877.4               [0m[0m  |  [31m[1m   47558.3  [0m[0m  |  [2m[91m          2204.6       [0m[0m  |  [2m[91m                    562.2                   [0m[0m  |  [31m[1m                           57483.7                         [0m[0m  |  [2m[91m                    1376.2                 [0m[0m
      8      x 768   |  [2m[91m                 582.5               [0m[0m  |  [31m[1m   24036.1  [0m[0m  |  [2m[91m          1551.4       [0m[0m  |                      296.0                     |  [31m[1m                           23483.1                         [0m[0m  |                       808.7                 
      4      x 768   |                   351.5                 |  [2m[91m   12231.3  [0m[0m  |  [2m[91m           975.7       [0m[0m  |                      242.2                     |  [2m[91m                           11795.4                         [0m[0m  |                       587.5                 
      2      x 768   |                   204.8                 |      6009.0    |             562.3         |                      240.9                     |                              5740.2                           |  [34m[1m                     559.6                 [0m[0m
      1      x 768   |  [92m[1m                 181.9               [0m[0m  |  [92m[1m    3035.4  [0m[0m  |  [92m[1m           487.7       [0m[0m  |  [92m[1m                    214.6                   [0m[0m  |  [92m[1m                            2879.3                         [0m[0m  |  [92m[1m                     512.1                 [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 512 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 256 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 128 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 64 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 32 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 16 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 8 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 4 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 2 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 1 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 2048 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 512 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 256 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 128 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 64 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 32 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 16 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 8 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 4 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 2 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 1 with sparsity 80 num_threads 1 with compiler script using backend script
[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 1 threads  -----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend script  |  Fine-grained + structured sparsity @ 90 with backend script  |  Dense benchmark - Compiled - backend script
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                393.6                [0m[0m  |  [31m[1m  23947.2   [0m[0m  |  [31m[1m         1034.1        [0m[0m  |  [31m[1m                   432.7                    [0m[0m  |  [31m[1m                          16704.8                          [0m[0m  |  [31m[1m                   1058.5                  [0m[0m
      1024   x 768   |  [31m[1m                212.5                [0m[0m  |  [31m[1m  11967.2   [0m[0m  |  [31m[1m          539.8        [0m[0m  |  [31m[1m                   227.4                    [0m[0m  |  [31m[1m                           8369.3                          [0m[0m  |  [31m[1m                    540.9                  [0m[0m
      512    x 768   |  [31m[1m                115.4                [0m[0m  |  [31m[1m   5979.2   [0m[0m  |  [31m[1m          263.6        [0m[0m  |  [2m[91m                   117.3                    [0m[0m  |  [31m[1m                           4218.5                          [0m[0m  |  [31m[1m                    283.0                  [0m[0m
      256    x 768   |  [2m[91m                 76.3                [0m[0m  |  [31m[1m   3006.3   [0m[0m  |  [2m[91m          140.4        [0m[0m  |  [2m[91m                    74.0                    [0m[0m  |  [31m[1m                           2126.4                          [0m[0m  |  [31m[1m                    152.2                  [0m[0m
      128    x 768   |  [2m[91m                 42.6                [0m[0m  |  [31m[1m   1515.0   [0m[0m  |             78.2          |                      45.1                      |  [31m[1m                           1085.0                          [0m[0m  |  [2m[91m                     93.4                  [0m[0m
      64     x 768   |  [2m[91m                 42.8                [0m[0m  |  [2m[91m    767.5   [0m[0m  |             50.7          |                      35.3                      |  [31m[1m                            554.6                          [0m[0m  |                       49.8                  
      32     x 768   |  [2m[91m                 43.6                [0m[0m  |  [2m[91m    395.7   [0m[0m  |  [34m[1m           42.0        [0m[0m  |                      28.7                      |  [2m[91m                            298.3                          [0m[0m  |                       42.1                  
      16     x 768   |  [2m[91m                 45.5                [0m[0m  |      208.7     |  [34m[1m           40.9        [0m[0m  |                      28.2                      |  [2m[91m                            166.9                          [0m[0m  |                       37.1                  
      8      x 768   |  [2m[91m                 45.9                [0m[0m  |  [92m[1m    190.6   [0m[0m  |  [34m[1m           43.0        [0m[0m  |  [34m[1m                    24.9                    [0m[0m  |                              103.6                            |                       32.4                  
      4      x 768   |  [2m[91m                 45.9                [0m[0m  |  [92m[1m    190.1   [0m[0m  |  [92m[1m           40.2        [0m[0m  |  [34m[1m                    25.1                    [0m[0m  |  [34m[1m                             68.6                          [0m[0m  |                       31.2                  
      2      x 768   |  [92m[1m                 20.3                [0m[0m  |  [92m[1m    189.2   [0m[0m  |  [34m[1m           40.6        [0m[0m  |  [34m[1m                    25.2                    [0m[0m  |  [34m[1m                             65.6                          [0m[0m  |                       31.0                  
      1      x 768   |                   25.7                  |  [92m[1m    188.8   [0m[0m  |  [34m[1m           41.0        [0m[0m  |  [92m[1m                    24.2                    [0m[0m  |  [92m[1m                             64.0                          [0m[0m  |  [92m[1m                     27.5                  [0m[0m

Times are in microseconds (us).

[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 1 threads  -----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend script  |  Fine-grained + structured sparsity @ 80 with backend script  |  Dense benchmark - Compiled - backend script
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                513.7                [0m[0m  |  [31m[1m  66655.2   [0m[0m  |  [31m[1m         1151.0        [0m[0m  |  [31m[1m                   524.2                    [0m[0m  |  [31m[1m                          44377.9                          [0m[0m  |  [31m[1m                   1137.4                  [0m[0m
      1024   x 768   |  [31m[1m                267.9                [0m[0m  |  [31m[1m  33351.1   [0m[0m  |  [31m[1m          612.8        [0m[0m  |  [31m[1m                   277.5                    [0m[0m  |  [31m[1m                          22200.9                          [0m[0m  |  [31m[1m                    578.8                  [0m[0m
      512    x 768   |  [31m[1m                139.1                [0m[0m  |  [31m[1m  16682.7   [0m[0m  |  [31m[1m          291.6        [0m[0m  |  [31m[1m                   143.8                    [0m[0m  |  [31m[1m                          11148.7                          [0m[0m  |  [31m[1m                    298.6                  [0m[0m
      256    x 768   |  [2m[91m                 83.8                [0m[0m  |  [31m[1m   8336.5   [0m[0m  |  [2m[91m          150.4        [0m[0m  |  [2m[91m                    84.0                    [0m[0m  |  [31m[1m                           5608.7                          [0m[0m  |  [31m[1m                    159.5                  [0m[0m
      128    x 768   |  [2m[91m                 48.0                [0m[0m  |  [31m[1m   4183.6   [0m[0m  |  [2m[91m           81.8        [0m[0m  |                      45.2                      |  [31m[1m                           2818.2                          [0m[0m  |  [2m[91m                     98.1                  [0m[0m
      64     x 768   |                   39.3                  |  [31m[1m   2101.2   [0m[0m  |             52.8          |                      36.9                      |  [31m[1m                           1428.5                          [0m[0m  |                       51.1                  
      32     x 768   |  [2m[91m                 42.4                [0m[0m  |  [31m[1m   1060.8   [0m[0m  |  [34m[1m           41.7        [0m[0m  |                      29.5                      |  [31m[1m                            730.4                          [0m[0m  |                       42.5                  
      16     x 768   |  [2m[91m                 45.0                [0m[0m  |  [2m[91m    538.0   [0m[0m  |  [34m[1m           42.4        [0m[0m  |                      28.5                      |  [31m[1m                            384.8                          [0m[0m  |                       36.8                  
      8      x 768   |  [2m[91m                 44.6                [0m[0m  |      277.0     |  [34m[1m           41.7        [0m[0m  |  [34m[1m                    25.3                    [0m[0m  |  [2m[91m                            212.3                          [0m[0m  |                       32.5                  
      4      x 768   |                   40.7                  |  [34m[1m    192.6   [0m[0m  |  [34m[1m           43.0        [0m[0m  |  [34m[1m                    25.1                    [0m[0m  |                              125.0                            |                       31.5                  
      2      x 768   |  [92m[1m                 20.5                [0m[0m  |  [92m[1m    189.8   [0m[0m  |  [34m[1m           41.3        [0m[0m  |  [34m[1m                    25.1                    [0m[0m  |                               82.6                            |                       31.0                  
      1      x 768   |                   25.8                  |  [92m[1m    188.2   [0m[0m  |  [92m[1m           40.7        [0m[0m  |  [92m[1m                    24.6                    [0m[0m  |  [92m[1m                             64.4                          [0m[0m  |  [92m[1m                     27.4                  [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 2048 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 80 num_threads 1 with compiler trace using backend trace
[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 1 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend trace  |  Fine-grained + structured sparsity @ 90 with backend trace  |  Dense benchmark - Compiled - backend trace
1 threads: -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               63945.5               [0m[0m  |  [31m[1m 4233120.6  [0m[0m  |  [31m[1m        167425.7       [0m[0m  |  [31m[1m                  64187.1                  [0m[0m  |  [31m[1m                        4193129.0                         [0m[0m  |  [31m[1m                 179416.3                 [0m[0m
      1024   x 768   |  [31m[1m               32766.9               [0m[0m  |  [31m[1m 2091836.8  [0m[0m  |  [31m[1m         83634.3       [0m[0m  |  [31m[1m                  32365.3                  [0m[0m  |  [31m[1m                        2114860.1                         [0m[0m  |  [31m[1m                  84479.1                 [0m[0m
      512    x 768   |  [31m[1m               16635.1               [0m[0m  |  [31m[1m 1067015.1  [0m[0m  |  [31m[1m         43052.0       [0m[0m  |  [31m[1m                  16509.5                  [0m[0m  |  [31m[1m                        1054214.8                         [0m[0m  |  [31m[1m                  42660.7                 [0m[0m
      256    x 768   |  [31m[1m                8162.9               [0m[0m  |  [31m[1m  535718.4  [0m[0m  |  [31m[1m         21317.7       [0m[0m  |  [31m[1m                   8217.1                  [0m[0m  |  [31m[1m                         524721.0                         [0m[0m  |  [31m[1m                  21659.9                 [0m[0m
      128    x 768   |  [31m[1m                4363.8               [0m[0m  |  [31m[1m  268698.2  [0m[0m  |  [31m[1m         11315.1       [0m[0m  |  [31m[1m                   4290.1                  [0m[0m  |  [31m[1m                         264454.6                         [0m[0m  |  [31m[1m                  11207.1                 [0m[0m
      64     x 768   |  [31m[1m                2288.7               [0m[0m  |  [31m[1m  133943.9  [0m[0m  |  [31m[1m          6104.6       [0m[0m  |  [31m[1m                   2297.8                  [0m[0m  |  [31m[1m                         133046.5                         [0m[0m  |  [31m[1m                   6125.2                 [0m[0m
      32     x 768   |  [31m[1m                1283.6               [0m[0m  |  [31m[1m   56797.3  [0m[0m  |  [31m[1m          3523.5       [0m[0m  |  [31m[1m                   1332.1                  [0m[0m  |  [31m[1m                          57400.9                         [0m[0m  |  [31m[1m                   3475.4                 [0m[0m
      16     x 768   |  [2m[91m                 830.1               [0m[0m  |  [31m[1m   24239.9  [0m[0m  |  [2m[91m          2196.7       [0m[0m  |  [2m[91m                    852.2                  [0m[0m  |  [31m[1m                          23612.0                         [0m[0m  |  [2m[91m                   2272.0                 [0m[0m
      8      x 768   |  [2m[91m                 551.4               [0m[0m  |  [31m[1m   11748.8  [0m[0m  |  [2m[91m          1523.6       [0m[0m  |  [2m[91m                    579.1                  [0m[0m  |  [31m[1m                          11800.0                         [0m[0m  |  [2m[91m                   1543.5                 [0m[0m
      4      x 768   |                   327.7                 |  [2m[91m    5890.1  [0m[0m  |  [2m[91m           981.9       [0m[0m  |                      357.6                    |  [2m[91m                           5778.3                         [0m[0m  |                     1014.4                 
      2      x 768   |  [34m[1m                 184.9               [0m[0m  |      3025.1    |  [34m[1m           487.6       [0m[0m  |                      211.1                    |  [2m[91m                           2990.3                         [0m[0m  |  [34m[1m                    546.6                 [0m[0m
      1      x 768   |  [92m[1m                 169.4               [0m[0m  |  [92m[1m    1646.3  [0m[0m  |  [92m[1m           479.6       [0m[0m  |  [92m[1m                    184.1                  [0m[0m  |  [92m[1m                           1470.1                         [0m[0m  |  [92m[1m                    508.7                 [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 1 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend trace  |  Fine-grained + structured sparsity @ 80 with backend trace  |  Dense benchmark - Compiled - backend trace
1 threads: -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               67075.4               [0m[0m  |  [31m[1m 8406891.1  [0m[0m  |  [31m[1m        167668.2       [0m[0m  |  [31m[1m                  67050.4                  [0m[0m  |  [31m[1m                        8395541.8                         [0m[0m  |  [31m[1m                 171114.5                 [0m[0m
      1024   x 768   |  [31m[1m               33425.4               [0m[0m  |  [31m[1m 4223037.8  [0m[0m  |  [31m[1m         84221.7       [0m[0m  |  [31m[1m                  33615.1                  [0m[0m  |  [31m[1m                        4245146.4                         [0m[0m  |  [31m[1m                  84029.6                 [0m[0m
      512    x 768   |  [31m[1m               17187.6               [0m[0m  |  [31m[1m 2094396.7  [0m[0m  |  [31m[1m         42770.2       [0m[0m  |  [31m[1m                  17038.2                  [0m[0m  |  [31m[1m                        2095203.6                         [0m[0m  |  [31m[1m                  43639.8                 [0m[0m
      256    x 768   |  [31m[1m                8661.2               [0m[0m  |  [31m[1m 1054839.2  [0m[0m  |  [31m[1m         21205.1       [0m[0m  |  [31m[1m                   8586.2                  [0m[0m  |  [31m[1m                        1040278.9                         [0m[0m  |  [31m[1m                  21698.7                 [0m[0m
      128    x 768   |  [31m[1m                4509.0               [0m[0m  |  [31m[1m  524191.9  [0m[0m  |  [31m[1m         11443.5       [0m[0m  |  [31m[1m                   4481.3                  [0m[0m  |  [31m[1m                         523907.7                         [0m[0m  |  [31m[1m                  11292.7                 [0m[0m
      64     x 768   |  [31m[1m                2438.3               [0m[0m  |  [31m[1m  261597.7  [0m[0m  |  [31m[1m          6050.5       [0m[0m  |  [31m[1m                   2456.6                  [0m[0m  |  [31m[1m                         266477.9                         [0m[0m  |  [31m[1m                   6443.6                 [0m[0m
      32     x 768   |  [31m[1m                1396.4               [0m[0m  |  [31m[1m  130876.5  [0m[0m  |  [31m[1m          3437.5       [0m[0m  |  [31m[1m                   1416.9                  [0m[0m  |  [31m[1m                         131208.0                         [0m[0m  |  [31m[1m                   3514.1                 [0m[0m
      16     x 768   |  [31m[1m                 857.7               [0m[0m  |  [31m[1m   46999.8  [0m[0m  |  [2m[91m          2216.5       [0m[0m  |  [2m[91m                    912.7                  [0m[0m  |  [31m[1m                          56685.1                         [0m[0m  |  [2m[91m                   2184.2                 [0m[0m
      8      x 768   |  [2m[91m                 514.6               [0m[0m  |  [31m[1m   24002.2  [0m[0m  |  [2m[91m          1416.1       [0m[0m  |  [2m[91m                    540.3                  [0m[0m  |  [31m[1m                          23471.1                         [0m[0m  |  [2m[91m                   1399.7                 [0m[0m
      4      x 768   |                   329.9                 |  [2m[91m   11830.3  [0m[0m  |             925.8         |                      350.6                    |  [2m[91m                          11566.5                         [0m[0m  |                      941.4                 
      2      x 768   |  [34m[1m                 173.4               [0m[0m  |      5871.8    |  [34m[1m           528.9       [0m[0m  |                      226.1                    |  [2m[91m                           5893.8                         [0m[0m  |  [34m[1m                    534.9                 [0m[0m
      1      x 768   |  [92m[1m                 165.8               [0m[0m  |  [92m[1m    3063.8  [0m[0m  |  [92m[1m           503.7       [0m[0m  |  [92m[1m                    204.6                  [0m[0m  |  [92m[1m                           2907.7                         [0m[0m  |  [92m[1m                    510.9                 [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 2048 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 80 num_threads 1 with compiler trace using backend trace
[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 1 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend trace  |  Fine-grained + structured sparsity @ 90 with backend trace  |  Dense benchmark - Compiled - backend trace
1 threads: -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                392.9                [0m[0m  |  [31m[1m  23924.6   [0m[0m  |  [31m[1m         1031.8        [0m[0m  |  [31m[1m                   399.7                   [0m[0m  |  [31m[1m                         16702.7                          [0m[0m  |  [31m[1m                  1032.6                  [0m[0m
      1024   x 768   |  [31m[1m                211.9                [0m[0m  |  [31m[1m  11962.6   [0m[0m  |  [31m[1m          541.4        [0m[0m  |  [31m[1m                   216.4                   [0m[0m  |  [31m[1m                          8379.6                          [0m[0m  |  [31m[1m                   547.4                  [0m[0m
      512    x 768   |  [31m[1m                117.2                [0m[0m  |  [31m[1m   5985.4   [0m[0m  |  [31m[1m          265.0        [0m[0m  |  [2m[91m                   117.7                   [0m[0m  |  [31m[1m                          4161.6                          [0m[0m  |  [31m[1m                   267.9                  [0m[0m
      256    x 768   |  [2m[91m                 76.7                [0m[0m  |  [31m[1m   3000.2   [0m[0m  |  [2m[91m          142.1        [0m[0m  |  [2m[91m                    77.4                   [0m[0m  |  [31m[1m                          2018.3                          [0m[0m  |  [2m[91m                   142.4                  [0m[0m
      128    x 768   |  [2m[91m                 42.8                [0m[0m  |  [31m[1m   1513.7   [0m[0m  |             78.9          |                      47.9                     |  [31m[1m                          1002.6                          [0m[0m  |                      79.3                  
      64     x 768   |  [2m[91m                 42.5                [0m[0m  |  [2m[91m    765.2   [0m[0m  |             51.1          |  [2m[91m                    51.6                   [0m[0m  |  [31m[1m                           504.0                          [0m[0m  |  [34m[1m                    51.5                  [0m[0m
      32     x 768   |  [2m[91m                 43.5                [0m[0m  |  [2m[91m    390.1   [0m[0m  |  [34m[1m           41.2        [0m[0m  |  [2m[91m                    52.4                   [0m[0m  |  [31m[1m                           262.4                          [0m[0m  |  [34m[1m                    51.1                  [0m[0m
      16     x 768   |  [2m[91m                 46.4                [0m[0m  |      209.8     |  [34m[1m           41.5        [0m[0m  |  [2m[91m                    55.2                   [0m[0m  |  [2m[91m                           133.3                          [0m[0m  |  [34m[1m                    50.4                  [0m[0m
      8      x 768   |  [2m[91m                 46.3                [0m[0m  |  [34m[1m    190.6   [0m[0m  |  [34m[1m           42.2        [0m[0m  |  [2m[91m                    57.3                   [0m[0m  |                              73.8                            |  [34m[1m                    50.8                  [0m[0m
      4      x 768   |  [2m[91m                 44.8                [0m[0m  |  [34m[1m    189.4   [0m[0m  |  [92m[1m           41.0        [0m[0m  |  [2m[91m                    54.6                   [0m[0m  |  [34m[1m                            48.2                          [0m[0m  |  [34m[1m                    50.0                  [0m[0m
      2      x 768   |  [92m[1m                 20.7                [0m[0m  |  [34m[1m    189.5   [0m[0m  |  [92m[1m           40.7        [0m[0m  |  [92m[1m                    25.7                   [0m[0m  |  [34m[1m                            48.4                          [0m[0m  |  [92m[1m                    49.4                  [0m[0m
      1      x 768   |                   25.8                  |  [92m[1m    185.2   [0m[0m  |  [92m[1m           40.6        [0m[0m  |                      31.4                     |  [92m[1m                            47.2                          [0m[0m  |  [34m[1m                    50.6                  [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 1 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend trace  |  Fine-grained + structured sparsity @ 80 with backend trace  |  Dense benchmark - Compiled - backend trace
1 threads: -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                528.7                [0m[0m  |  [31m[1m  66622.8   [0m[0m  |  [31m[1m         1190.5        [0m[0m  |  [31m[1m                   534.8                   [0m[0m  |  [31m[1m                         44577.9                          [0m[0m  |  [31m[1m                  1200.0                  [0m[0m
      1024   x 768   |  [31m[1m                273.4                [0m[0m  |  [31m[1m  33358.0   [0m[0m  |  [31m[1m          634.7        [0m[0m  |  [31m[1m                   286.0                   [0m[0m  |  [31m[1m                         22332.3                          [0m[0m  |  [31m[1m                   639.3                  [0m[0m
      512    x 768   |  [31m[1m                139.3                [0m[0m  |  [31m[1m  16702.5   [0m[0m  |  [31m[1m          300.9        [0m[0m  |  [31m[1m                   141.3                   [0m[0m  |  [31m[1m                         11223.2                          [0m[0m  |  [31m[1m                   303.9                  [0m[0m
      256    x 768   |  [2m[91m                 84.7                [0m[0m  |  [31m[1m   8342.7   [0m[0m  |  [2m[91m          152.6        [0m[0m  |  [2m[91m                    86.5                   [0m[0m  |  [31m[1m                          5637.4                          [0m[0m  |  [2m[91m                   152.1                  [0m[0m
      128    x 768   |  [2m[91m                 48.7                [0m[0m  |  [31m[1m   4183.4   [0m[0m  |  [2m[91m           82.9        [0m[0m  |  [2m[91m                    52.2                   [0m[0m  |  [31m[1m                          2822.4                          [0m[0m  |                      82.2                  
      64     x 768   |                   38.5                  |  [31m[1m   2101.7   [0m[0m  |             53.1          |                      48.9                     |  [31m[1m                          1417.7                          [0m[0m  |  [34m[1m                    53.2                  [0m[0m
      32     x 768   |  [2m[91m                 42.8                [0m[0m  |  [31m[1m   1059.7   [0m[0m  |  [34m[1m           42.1        [0m[0m  |  [2m[91m                    53.5                   [0m[0m  |  [31m[1m                           713.6                          [0m[0m  |  [34m[1m                    52.1                  [0m[0m
      16     x 768   |  [2m[91m                 45.4                [0m[0m  |  [2m[91m    538.9   [0m[0m  |  [34m[1m           41.7        [0m[0m  |  [2m[91m                    53.9                   [0m[0m  |  [31m[1m                           359.5                          [0m[0m  |  [34m[1m                    50.8                  [0m[0m
      8      x 768   |  [2m[91m                 44.5                [0m[0m  |      277.2     |  [34m[1m           42.0        [0m[0m  |  [2m[91m                    54.2                   [0m[0m  |  [2m[91m                           185.1                          [0m[0m  |  [34m[1m                    50.7                  [0m[0m
      4      x 768   |                   40.3                  |  [34m[1m    191.8   [0m[0m  |  [92m[1m           40.4        [0m[0m  |                      49.9                     |  [2m[91m                            96.7                          [0m[0m  |  [92m[1m                    49.2                  [0m[0m
      2      x 768   |  [92m[1m                 20.5                [0m[0m  |  [34m[1m    189.2   [0m[0m  |  [92m[1m           40.2        [0m[0m  |  [92m[1m                    25.5                   [0m[0m  |                              54.3                            |  [34m[1m                    50.1                  [0m[0m
      1      x 768   |                   25.6                  |  [92m[1m    185.5   [0m[0m  |  [34m[1m           40.9        [0m[0m  |                      30.9                     |  [92m[1m                            47.2                          [0m[0m  |  [34m[1m                    51.7                  [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 2048 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 1 threads  --------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               64511.3               [0m[0m  |  [31m[1m 4214135.0  [0m[0m  |  [31m[1m        167174.4       [0m[0m  |  [31m[1m                   65422.1                    [0m[0m  |  [31m[1m                           108470.0                          [0m[0m  |  [31m[1m                   185623.0                  [0m[0m
      1024   x 768   |  [31m[1m               35041.4               [0m[0m  |  [31m[1m 2129970.7  [0m[0m  |  [31m[1m         84038.7       [0m[0m  |  [31m[1m                   32534.6                    [0m[0m  |  [31m[1m                            55121.8                          [0m[0m  |  [31m[1m                    83883.3                  [0m[0m
      512    x 768   |  [31m[1m               16825.1               [0m[0m  |  [31m[1m 1052784.0  [0m[0m  |  [31m[1m         42026.2       [0m[0m  |  [31m[1m                   16239.6                    [0m[0m  |  [31m[1m                            27481.6                          [0m[0m  |  [31m[1m                    43512.7                  [0m[0m
      256    x 768   |  [31m[1m                8444.5               [0m[0m  |  [31m[1m  440815.6  [0m[0m  |  [31m[1m         21625.9       [0m[0m  |  [31m[1m                    8360.6                    [0m[0m  |  [31m[1m                            14162.8                          [0m[0m  |  [31m[1m                    22062.2                  [0m[0m
      128    x 768   |  [31m[1m                4350.4               [0m[0m  |  [31m[1m  195542.1  [0m[0m  |  [31m[1m         11145.1       [0m[0m  |  [31m[1m                    4398.4                    [0m[0m  |  [31m[1m                             7190.3                          [0m[0m  |  [31m[1m                    11224.4                  [0m[0m
      64     x 768   |  [31m[1m                2287.3               [0m[0m  |  [31m[1m   95542.3  [0m[0m  |  [31m[1m          6032.7       [0m[0m  |  [31m[1m                    2409.1                    [0m[0m  |  [31m[1m                             3976.0                          [0m[0m  |  [31m[1m                     6239.7                  [0m[0m
      32     x 768   |  [31m[1m                1329.7               [0m[0m  |  [31m[1m   47491.9  [0m[0m  |  [31m[1m          3425.7       [0m[0m  |  [31m[1m                    1452.2                    [0m[0m  |  [31m[1m                             2032.1                          [0m[0m  |  [31m[1m                     3662.1                  [0m[0m
      16     x 768   |  [31m[1m                 842.9               [0m[0m  |  [31m[1m   24362.4  [0m[0m  |  [2m[91m          2197.1       [0m[0m  |  [2m[91m                     957.1                    [0m[0m  |  [31m[1m                             1036.0                          [0m[0m  |  [2m[91m                     2236.4                  [0m[0m
      8      x 768   |  [2m[91m                 512.8               [0m[0m  |  [31m[1m   11891.1  [0m[0m  |  [2m[91m          1527.3       [0m[0m  |  [2m[91m                     608.5                    [0m[0m  |  [2m[91m                              559.0                          [0m[0m  |  [2m[91m                     1415.1                  [0m[0m
      4      x 768   |                   283.8                 |  [2m[91m    5863.9  [0m[0m  |             972.3         |                       414.3                      |  [2m[91m                              332.3                          [0m[0m  |                        913.4                  
      2      x 768   |  [34m[1m                 163.6               [0m[0m  |      3075.1    |  [34m[1m           538.3       [0m[0m  |  [34m[1m                     284.2                    [0m[0m  |                                204.8                            |  [34m[1m                      515.8                  [0m[0m
      1      x 768   |  [92m[1m                 159.4               [0m[0m  |  [92m[1m    1651.6  [0m[0m  |  [92m[1m           511.3       [0m[0m  |  [92m[1m                     271.4                    [0m[0m  |  [92m[1m                              137.3                          [0m[0m  |  [92m[1m                      481.5                  [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 1 threads  --------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               67915.3               [0m[0m  |  [31m[1m 8534199.4  [0m[0m  |  [31m[1m        165477.9       [0m[0m  |  [31m[1m                   69789.8                    [0m[0m  |  [31m[1m                           223826.8                          [0m[0m  |  [31m[1m                   168815.7                  [0m[0m
      1024   x 768   |  [31m[1m               33105.3               [0m[0m  |  [31m[1m 4186299.2  [0m[0m  |  [31m[1m         83957.7       [0m[0m  |  [31m[1m                   34041.1                    [0m[0m  |  [31m[1m                           111077.4                          [0m[0m  |  [31m[1m                    84895.7                  [0m[0m
      512    x 768   |  [31m[1m               16997.3               [0m[0m  |  [31m[1m 2096732.5  [0m[0m  |  [31m[1m         42514.9       [0m[0m  |  [31m[1m                   18381.9                    [0m[0m  |  [31m[1m                            55902.5                          [0m[0m  |  [31m[1m                    43826.6                  [0m[0m
      256    x 768   |  [31m[1m                8714.0               [0m[0m  |  [31m[1m 1059793.7  [0m[0m  |  [31m[1m         21613.0       [0m[0m  |  [31m[1m                    8899.1                    [0m[0m  |  [31m[1m                            28568.2                          [0m[0m  |  [31m[1m                    22891.3                  [0m[0m
      128    x 768   |  [31m[1m                4472.7               [0m[0m  |  [31m[1m  442910.4  [0m[0m  |  [31m[1m         11483.1       [0m[0m  |  [31m[1m                    4544.3                    [0m[0m  |  [31m[1m                            14503.5                          [0m[0m  |  [31m[1m                    11074.2                  [0m[0m
      64     x 768   |  [31m[1m                2402.8               [0m[0m  |  [31m[1m  187924.9  [0m[0m  |  [31m[1m          6301.5       [0m[0m  |  [31m[1m                    2511.6                    [0m[0m  |  [31m[1m                             7931.8                          [0m[0m  |  [31m[1m                     6566.2                  [0m[0m
      32     x 768   |  [31m[1m                1406.5               [0m[0m  |  [31m[1m   95873.1  [0m[0m  |  [31m[1m          3471.8       [0m[0m  |  [31m[1m                    1460.3                    [0m[0m  |  [31m[1m                             4028.4                          [0m[0m  |  [31m[1m                     3651.1                  [0m[0m
      16     x 768   |  [31m[1m                 861.3               [0m[0m  |  [31m[1m   47830.6  [0m[0m  |  [2m[91m          2188.8       [0m[0m  |  [2m[91m                     985.3                    [0m[0m  |  [31m[1m                             1884.9                          [0m[0m  |  [2m[91m                     2261.9                  [0m[0m
      8      x 768   |  [2m[91m                 515.7               [0m[0m  |  [31m[1m   23859.6  [0m[0m  |  [2m[91m          1394.4       [0m[0m  |  [2m[91m                     642.5                    [0m[0m  |  [2m[91m                             1016.6                          [0m[0m  |  [2m[91m                     1483.7                  [0m[0m
      4      x 768   |                   321.1                 |  [2m[91m   12148.5  [0m[0m  |             942.8         |                       452.8                      |  [2m[91m                              567.9                          [0m[0m  |  [2m[91m                      959.3                  [0m[0m
      2      x 768   |                   187.8                 |      5994.8    |  [34m[1m           525.8       [0m[0m  |  [34m[1m                     295.7                    [0m[0m  |                                353.2                            |  [34m[1m                      503.4                  [0m[0m
      1      x 768   |  [92m[1m                 169.5               [0m[0m  |  [92m[1m    3041.9  [0m[0m  |  [92m[1m           507.9       [0m[0m  |  [92m[1m                     286.0                    [0m[0m  |  [92m[1m                              207.1                          [0m[0m  |  [92m[1m                      463.4                  [0m[0m

Times are in microseconds (us).
/home/user/build/.venv/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:90: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
[2023-09-21 19:01:26,448] torch._inductor.utils: [WARNING] not enough cuda cores to use max_autotune mode

Benchmarking batch size 2048 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 2048 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 1 threads  --------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                393.3                [0m[0m  |  [31m[1m  23887.6   [0m[0m  |  [31m[1m         1032.2        [0m[0m  |  [31m[1m                    429.8                     [0m[0m  |  [31m[1m                            6318.2                           [0m[0m  |  [31m[1m                    1036.5                   [0m[0m
      1024   x 768   |  [31m[1m                214.8                [0m[0m  |  [31m[1m  11964.9   [0m[0m  |  [31m[1m          547.8        [0m[0m  |  [2m[91m                    234.5                     [0m[0m  |  [31m[1m                            3173.9                           [0m[0m  |  [31m[1m                     554.0                   [0m[0m
      512    x 768   |  [31m[1m                117.3                [0m[0m  |  [31m[1m   5949.0   [0m[0m  |  [31m[1m          268.8        [0m[0m  |  [2m[91m                    129.2                     [0m[0m  |  [31m[1m                            1607.9                           [0m[0m  |  [2m[91m                     269.2                   [0m[0m
      256    x 768   |  [2m[91m                 76.8                [0m[0m  |  [31m[1m   3003.5   [0m[0m  |  [2m[91m          142.6        [0m[0m  |                       84.6                       |  [31m[1m                             831.1                           [0m[0m  |  [2m[91m                     142.4                   [0m[0m
      128    x 768   |  [2m[91m                 42.9                [0m[0m  |  [31m[1m   1505.7   [0m[0m  |  [2m[91m           79.7        [0m[0m  |  [34m[1m                     64.5                     [0m[0m  |  [31m[1m                             413.6                           [0m[0m  |                        80.0                   
      64     x 768   |  [2m[91m                 41.6                [0m[0m  |  [2m[91m    767.7   [0m[0m  |             51.4          |  [34m[1m                     66.5                     [0m[0m  |  [2m[91m                             212.4                           [0m[0m  |  [92m[1m                      68.9                   [0m[0m
      32     x 768   |  [2m[91m                 42.3                [0m[0m  |  [2m[91m    390.8   [0m[0m  |  [34m[1m           41.5        [0m[0m  |  [92m[1m                     64.2                     [0m[0m  |                               116.5                             |  [34m[1m                      72.6                   [0m[0m
      16     x 768   |  [2m[91m                 44.2                [0m[0m  |      209.8     |  [34m[1m           41.4        [0m[0m  |  [92m[1m                     64.2                     [0m[0m  |  [92m[1m                              65.1                           [0m[0m  |  [34m[1m                      69.8                   [0m[0m
      8      x 768   |  [2m[91m                 44.5                [0m[0m  |  [34m[1m    188.3   [0m[0m  |  [34m[1m           41.5        [0m[0m  |  [92m[1m                     63.7                     [0m[0m  |  [34m[1m                              65.8                           [0m[0m  |  [34m[1m                      69.6                   [0m[0m
      4      x 768   |  [2m[91m                 48.0                [0m[0m  |  [92m[1m    184.9   [0m[0m  |  [92m[1m           39.3        [0m[0m  |  [34m[1m                     64.4                     [0m[0m  |  [34m[1m                              66.2                           [0m[0m  |  [34m[1m                      72.1                   [0m[0m
      2      x 768   |  [92m[1m                 19.8                [0m[0m  |  [34m[1m    192.6   [0m[0m  |  [34m[1m           40.3        [0m[0m  |  [34m[1m                     64.7                     [0m[0m  |  [92m[1m                              65.2                           [0m[0m  |  [34m[1m                      69.9                   [0m[0m
      1      x 768   |                   26.3                  |  [92m[1m    185.7   [0m[0m  |  [92m[1m           39.0        [0m[0m  |  [92m[1m                     64.0                     [0m[0m  |  [34m[1m                              66.9                           [0m[0m  |  [34m[1m                      72.1                   [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 1 threads  --------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                503.4                [0m[0m  |  [31m[1m  66723.1   [0m[0m  |  [31m[1m         1147.2        [0m[0m  |  [31m[1m                    528.4                     [0m[0m  |  [31m[1m                           15313.7                           [0m[0m  |  [31m[1m                    1152.8                   [0m[0m
      1024   x 768   |  [31m[1m                264.1                [0m[0m  |  [31m[1m  33354.0   [0m[0m  |  [31m[1m          617.8        [0m[0m  |  [2m[91m                    278.8                     [0m[0m  |  [31m[1m                            7765.2                           [0m[0m  |  [31m[1m                     622.8                   [0m[0m
      512    x 768   |  [31m[1m                138.7                [0m[0m  |  [31m[1m  16709.2   [0m[0m  |  [31m[1m          291.1        [0m[0m  |  [2m[91m                    149.0                     [0m[0m  |  [31m[1m                            3810.3                           [0m[0m  |  [2m[91m                     295.7                   [0m[0m
      256    x 768   |  [2m[91m                 84.3                [0m[0m  |  [31m[1m   8348.4   [0m[0m  |  [2m[91m          151.1        [0m[0m  |                       91.3                       |  [31m[1m                            1878.8                           [0m[0m  |  [2m[91m                     150.0                   [0m[0m
      128    x 768   |  [2m[91m                 48.5                [0m[0m  |  [31m[1m   4188.4   [0m[0m  |  [2m[91m           82.2        [0m[0m  |  [34m[1m                     66.5                     [0m[0m  |  [31m[1m                             935.7                           [0m[0m  |                        82.7                   
      64     x 768   |                   38.5                  |  [31m[1m   2098.7   [0m[0m  |             53.1          |  [92m[1m                     63.9                     [0m[0m  |  [31m[1m                             496.4                           [0m[0m  |  [92m[1m                      68.7                   [0m[0m
      32     x 768   |                   40.6                  |  [31m[1m   1058.8   [0m[0m  |  [34m[1m           41.2        [0m[0m  |  [34m[1m                     66.3                     [0m[0m  |  [2m[91m                             246.5                           [0m[0m  |  [34m[1m                      72.8                   [0m[0m
      16     x 768   |  [2m[91m                 44.6                [0m[0m  |  [2m[91m    538.1   [0m[0m  |  [34m[1m           40.8        [0m[0m  |  [92m[1m                     64.5                     [0m[0m  |                               124.6                             |  [34m[1m                      71.4                   [0m[0m
      8      x 768   |  [2m[91m                 44.1                [0m[0m  |      276.6     |  [34m[1m           40.6        [0m[0m  |  [34m[1m                     65.9                     [0m[0m  |                                75.0                             |  [34m[1m                      71.9                   [0m[0m
      4      x 768   |                   40.2                  |  [34m[1m    187.9   [0m[0m  |  [34m[1m           39.8        [0m[0m  |  [34m[1m                     66.7                     [0m[0m  |  [92m[1m                              67.4                           [0m[0m  |  [92m[1m                      69.3                   [0m[0m
      2      x 768   |  [92m[1m                 20.9                [0m[0m  |  [34m[1m    188.2   [0m[0m  |  [92m[1m           38.8        [0m[0m  |  [92m[1m                     64.1                     [0m[0m  |  [92m[1m                              66.8                           [0m[0m  |  [34m[1m                      71.8                   [0m[0m
      1      x 768   |                   24.8                  |  [92m[1m    182.9   [0m[0m  |  [34m[1m           39.5        [0m[0m  |  [92m[1m                     64.2                     [0m[0m  |  [34m[1m                              68.9                           [0m[0m  |  [34m[1m                      74.0                   [0m[0m

Times are in microseconds (us).
/home/user/build/.venv/lib/python3.10/site-packages/torch/jit/_script.py:1241: UserWarning: `optimize` is deprecated and has no effect. Use `with torch.jit.optimized_execution() instead
  warnings.warn(

Benchmarking batch size 2048 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 512 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 256 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 128 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 64 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 32 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 16 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 8 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 4 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 2 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 1 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 2048 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 512 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 256 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 128 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 64 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 32 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 16 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 8 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 4 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 2 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 1 with sparsity 80 num_threads 12 with compiler script using backend script
[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 12 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend script  |  Fine-grained + structured sparsity @ 90 with backend script  |  Dense benchmark - Compiled - backend script
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                6635.1               [0m[0m  |  [31m[1m  622054.0  [0m[0m  |  [31m[1m        17176.9        [0m[0m  |  [31m[1m                   6755.6                   [0m[0m  |  [31m[1m                          620862.9                         [0m[0m  |  [31m[1m                  17692.9                  [0m[0m
      1024   x 768   |  [31m[1m                3569.2               [0m[0m  |  [31m[1m  326371.5  [0m[0m  |  [31m[1m         8948.6        [0m[0m  |  [31m[1m                   3585.5                   [0m[0m  |  [31m[1m                          323675.1                         [0m[0m  |  [31m[1m                   9236.7                  [0m[0m
      512    x 768   |  [31m[1m                1887.5               [0m[0m  |  [31m[1m  168299.6  [0m[0m  |  [31m[1m         4544.1        [0m[0m  |  [31m[1m                   1874.8                   [0m[0m  |  [31m[1m                          162113.0                         [0m[0m  |  [31m[1m                   4755.5                  [0m[0m
      256    x 768   |  [31m[1m                1031.3               [0m[0m  |  [31m[1m   91636.2  [0m[0m  |  [31m[1m         2604.6        [0m[0m  |  [31m[1m                   1064.0                   [0m[0m  |  [31m[1m                           84592.9                         [0m[0m  |  [31m[1m                   2408.5                  [0m[0m
      128    x 768   |  [31m[1m                 629.0               [0m[0m  |  [31m[1m   41808.5  [0m[0m  |  [31m[1m         1655.7        [0m[0m  |  [31m[1m                    647.2                   [0m[0m  |  [31m[1m                           41901.2                         [0m[0m  |  [31m[1m                   1363.3                  [0m[0m
      64     x 768   |  [31m[1m                 416.8               [0m[0m  |  [31m[1m   11027.9  [0m[0m  |  [31m[1m         1033.0        [0m[0m  |  [31m[1m                    344.0                   [0m[0m  |  [31m[1m                           21676.9                         [0m[0m  |  [31m[1m                    693.2                  [0m[0m
      32     x 768   |  [31m[1m                 316.7               [0m[0m  |  [31m[1m    5875.2  [0m[0m  |  [31m[1m          780.0        [0m[0m  |  [2m[91m                    201.1                   [0m[0m  |  [31m[1m                            8186.1                         [0m[0m  |  [2m[91m                    397.5                  [0m[0m
      16     x 768   |  [31m[1m                 261.9               [0m[0m  |  [31m[1m    3046.8  [0m[0m  |  [31m[1m          638.5        [0m[0m  |  [2m[91m                    134.9                   [0m[0m  |  [31m[1m                            2731.8                         [0m[0m  |                      179.9                  
      8      x 768   |                    64.5                 |  [2m[91m    1578.9  [0m[0m  |  [2m[91m          145.0        [0m[0m  |                       61.4                     |  [31m[1m                            1365.0                         [0m[0m  |                      120.8                  
      4      x 768   |                    46.1                 |  [2m[91m     895.8  [0m[0m  |             94.0          |  [34m[1m                     47.5                   [0m[0m  |  [2m[91m                             856.9                         [0m[0m  |  [34m[1m                     99.8                  [0m[0m
      2      x 768   |  [34m[1m                  34.3               [0m[0m  |       551.6    |  [34m[1m           60.5        [0m[0m  |  [92m[1m                     44.8                   [0m[0m  |                               355.0                           |  [92m[1m                     92.0                  [0m[0m
      1      x 768   |  [92m[1m                  32.9               [0m[0m  |  [92m[1m     401.1  [0m[0m  |  [92m[1m           56.5        [0m[0m  |                       49.8                     |  [92m[1m                             220.9                         [0m[0m  |                      102.6                  

Times are in microseconds (us).

[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 12 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend script  |  Fine-grained + structured sparsity @ 80 with backend script  |  Dense benchmark - Compiled - backend script
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                6940.1               [0m[0m  |  [31m[1m 1229228.4  [0m[0m  |  [31m[1m        17198.5        [0m[0m  |  [31m[1m                   7090.3                   [0m[0m  |  [31m[1m                         1315215.1                         [0m[0m  |  [31m[1m                  17704.1                  [0m[0m
      1024   x 768   |  [31m[1m                3686.2               [0m[0m  |  [31m[1m  632547.1  [0m[0m  |  [31m[1m         8933.4        [0m[0m  |  [31m[1m                   3689.5                   [0m[0m  |  [31m[1m                          634609.8                         [0m[0m  |  [31m[1m                   9205.2                  [0m[0m
      512    x 768   |  [31m[1m                1937.8               [0m[0m  |  [31m[1m  320764.3  [0m[0m  |  [31m[1m         4593.0        [0m[0m  |  [31m[1m                   1923.6                   [0m[0m  |  [31m[1m                          323428.0                         [0m[0m  |  [31m[1m                   4723.4                  [0m[0m
      256    x 768   |  [31m[1m                1206.6               [0m[0m  |  [31m[1m  168400.3  [0m[0m  |  [31m[1m         2590.8        [0m[0m  |  [31m[1m                   1098.5                   [0m[0m  |  [31m[1m                          169366.3                         [0m[0m  |  [31m[1m                   2419.5                  [0m[0m
      128    x 768   |  [31m[1m                 711.4               [0m[0m  |  [31m[1m   94371.7  [0m[0m  |  [31m[1m         1665.0        [0m[0m  |  [31m[1m                    651.6                   [0m[0m  |  [31m[1m                           87151.8                         [0m[0m  |  [31m[1m                   1330.7                  [0m[0m
      64     x 768   |  [31m[1m                 474.7               [0m[0m  |  [31m[1m   43016.1  [0m[0m  |  [31m[1m         1032.5        [0m[0m  |  [31m[1m                    326.2                   [0m[0m  |  [31m[1m                           42367.2                         [0m[0m  |  [31m[1m                    679.6                  [0m[0m
      32     x 768   |  [31m[1m                 361.5               [0m[0m  |  [31m[1m   22367.8  [0m[0m  |  [31m[1m          775.3        [0m[0m  |  [2m[91m                    191.0                   [0m[0m  |  [31m[1m                           22071.6                         [0m[0m  |  [2m[91m                    397.6                  [0m[0m
      16     x 768   |  [31m[1m                 296.6               [0m[0m  |  [31m[1m    5772.2  [0m[0m  |  [31m[1m          635.9        [0m[0m  |  [2m[91m                    105.8                   [0m[0m  |  [31m[1m                            5436.4                         [0m[0m  |                      180.6                  
      8      x 768   |  [2m[91m                  70.2               [0m[0m  |  [31m[1m    3163.6  [0m[0m  |  [2m[91m          133.8        [0m[0m  |                       66.8                     |  [31m[1m                            2831.0                         [0m[0m  |                      120.2                  
      4      x 768   |                    48.2                 |  [2m[91m    1596.4  [0m[0m  |             88.9          |  [34m[1m                     49.1                   [0m[0m  |  [2m[91m                            1403.5                         [0m[0m  |  [34m[1m                    102.3                  [0m[0m
      2      x 768   |  [34m[1m                  35.8               [0m[0m  |       893.1    |  [34m[1m           60.6        [0m[0m  |  [92m[1m                     46.0                   [0m[0m  |                               685.6                           |  [92m[1m                     98.0                  [0m[0m
      1      x 768   |  [92m[1m                  34.6               [0m[0m  |  [92m[1m     538.2  [0m[0m  |  [92m[1m           57.0        [0m[0m  |  [34m[1m                     47.5                   [0m[0m  |  [92m[1m                             353.6                         [0m[0m  |  [34m[1m                    105.4                  [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 512 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 256 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 128 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 64 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 32 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 16 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 8 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 4 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 2 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 1 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 2048 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 512 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 256 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 128 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 64 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 32 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 16 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 8 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 4 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 2 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 1 with sparsity 80 num_threads 12 with compiler script using backend script
[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 12 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend script  |  Fine-grained + structured sparsity @ 90 with backend script  |  Dense benchmark - Compiled - backend script
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                394.8                [0m[0m  |  [31m[1m  23914.8   [0m[0m  |  [31m[1m         1034.0        [0m[0m  |  [31m[1m                   436.6                    [0m[0m  |  [31m[1m                          16683.6                          [0m[0m  |  [31m[1m                   1065.1                  [0m[0m
      1024   x 768   |  [31m[1m                211.9                [0m[0m  |  [31m[1m  11958.8   [0m[0m  |  [31m[1m          545.6        [0m[0m  |  [31m[1m                   228.5                    [0m[0m  |  [31m[1m                           8340.9                          [0m[0m  |  [31m[1m                    550.6                  [0m[0m
      512    x 768   |  [31m[1m                116.0                [0m[0m  |  [31m[1m   5989.7   [0m[0m  |  [31m[1m          266.6        [0m[0m  |  [31m[1m                   119.0                    [0m[0m  |  [31m[1m                           4159.5                          [0m[0m  |  [31m[1m                    287.3                  [0m[0m
      256    x 768   |  [2m[91m                 77.0                [0m[0m  |  [31m[1m   3006.2   [0m[0m  |  [2m[91m          142.3        [0m[0m  |  [2m[91m                    75.0                    [0m[0m  |  [31m[1m                           2040.3                          [0m[0m  |  [31m[1m                    154.5                  [0m[0m
      128    x 768   |  [2m[91m                 43.1                [0m[0m  |  [31m[1m   1514.5   [0m[0m  |             79.2          |                      45.6                      |  [31m[1m                           1017.4                          [0m[0m  |  [2m[91m                     94.6                  [0m[0m
      64     x 768   |  [2m[91m                 43.0                [0m[0m  |  [2m[91m    763.8   [0m[0m  |             51.1          |                      35.7                      |  [31m[1m                            503.6                          [0m[0m  |                       50.1                  
      32     x 768   |  [2m[91m                 42.5                [0m[0m  |  [2m[91m    394.4   [0m[0m  |  [34m[1m           41.2        [0m[0m  |                      28.4                      |  [31m[1m                            259.8                          [0m[0m  |                       42.0                  
      16     x 768   |  [2m[91m                 45.5                [0m[0m  |      207.7     |  [34m[1m           41.5        [0m[0m  |                      28.2                      |  [2m[91m                            134.3                          [0m[0m  |                       36.6                  
      8      x 768   |  [2m[91m                 46.4                [0m[0m  |  [34m[1m    186.9   [0m[0m  |  [34m[1m           42.9        [0m[0m  |  [34m[1m                    24.5                    [0m[0m  |                               73.4                            |                       32.6                  
      4      x 768   |  [2m[91m                 45.0                [0m[0m  |  [34m[1m    187.1   [0m[0m  |  [92m[1m           40.2        [0m[0m  |  [34m[1m                    24.8                    [0m[0m  |  [34m[1m                             42.6                          [0m[0m  |                       31.4                  
      2      x 768   |  [92m[1m                 19.9                [0m[0m  |  [92m[1m    183.7   [0m[0m  |  [92m[1m           39.9        [0m[0m  |  [34m[1m                    24.8                    [0m[0m  |  [34m[1m                             43.0                          [0m[0m  |                       30.9                  
      1      x 768   |                   24.7                  |  [34m[1m    186.3   [0m[0m  |  [34m[1m           41.1        [0m[0m  |  [92m[1m                    23.8                    [0m[0m  |  [92m[1m                             41.8                          [0m[0m  |  [92m[1m                     27.4                  [0m[0m

Times are in microseconds (us).

[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 12 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend script  |  Fine-grained + structured sparsity @ 80 with backend script  |  Dense benchmark - Compiled - backend script
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                533.8                [0m[0m  |  [31m[1m  66700.9   [0m[0m  |  [31m[1m         1202.6        [0m[0m  |  [31m[1m                   548.3                    [0m[0m  |  [31m[1m                          44761.7                          [0m[0m  |  [31m[1m                   1179.3                  [0m[0m
      1024   x 768   |  [31m[1m                280.2                [0m[0m  |  [31m[1m  33350.6   [0m[0m  |  [31m[1m          640.7        [0m[0m  |  [31m[1m                   289.6                    [0m[0m  |  [31m[1m                          22418.7                          [0m[0m  |  [31m[1m                    593.2                  [0m[0m
      512    x 768   |  [31m[1m                140.0                [0m[0m  |  [31m[1m  16700.9   [0m[0m  |  [31m[1m          303.0        [0m[0m  |  [31m[1m                   147.8                    [0m[0m  |  [31m[1m                          11246.9                          [0m[0m  |  [31m[1m                    300.8                  [0m[0m
      256    x 768   |  [2m[91m                 85.6                [0m[0m  |  [31m[1m   8350.0   [0m[0m  |  [2m[91m          153.2        [0m[0m  |  [2m[91m                    87.2                    [0m[0m  |  [31m[1m                           5634.9                          [0m[0m  |  [31m[1m                    163.8                  [0m[0m
      128    x 768   |  [2m[91m                 49.1                [0m[0m  |  [31m[1m   4184.8   [0m[0m  |  [2m[91m           83.0        [0m[0m  |                      45.7                      |  [31m[1m                           2818.6                          [0m[0m  |  [2m[91m                    100.2                  [0m[0m
      64     x 768   |                   38.5                  |  [31m[1m   2102.4   [0m[0m  |             53.5          |                      37.8                      |  [31m[1m                           1417.9                          [0m[0m  |                       51.4                  
      32     x 768   |  [2m[91m                 42.2                [0m[0m  |  [31m[1m   1061.0   [0m[0m  |  [34m[1m           41.5        [0m[0m  |                      28.2                      |  [31m[1m                            712.9                          [0m[0m  |                       42.4                  
      16     x 768   |  [2m[91m                 45.8                [0m[0m  |  [2m[91m    538.4   [0m[0m  |  [92m[1m           39.5        [0m[0m  |                      27.9                      |  [31m[1m                            361.3                          [0m[0m  |                       37.0                  
      8      x 768   |  [2m[91m                 43.8                [0m[0m  |      276.9     |  [34m[1m           41.2        [0m[0m  |  [34m[1m                    24.6                    [0m[0m  |  [2m[91m                            184.9                          [0m[0m  |                       32.5                  
      4      x 768   |  [2m[91m                 40.3                [0m[0m  |  [34m[1m    187.4   [0m[0m  |  [34m[1m           40.9        [0m[0m  |  [34m[1m                    24.7                    [0m[0m  |  [2m[91m                             96.6                          [0m[0m  |                       31.5                  
      2      x 768   |  [92m[1m                 19.8                [0m[0m  |  [34m[1m    189.4   [0m[0m  |  [34m[1m           40.4        [0m[0m  |  [92m[1m                    24.4                    [0m[0m  |                               53.9                            |                       30.9                  
      1      x 768   |                   24.7                  |  [92m[1m    182.5   [0m[0m  |  [34m[1m           40.7        [0m[0m  |  [92m[1m                    24.6                    [0m[0m  |  [92m[1m                             42.0                          [0m[0m  |  [92m[1m                     27.5                  [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 2048 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 80 num_threads 12 with compiler trace using backend trace
[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 12 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend trace  |  Fine-grained + structured sparsity @ 90 with backend trace  |  Dense benchmark - Compiled - backend trace
12 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                6612.2               [0m[0m  |  [31m[1m  628121.0  [0m[0m  |  [31m[1m        17304.6        [0m[0m  |  [31m[1m                   6724.2                  [0m[0m  |  [31m[1m                         663384.0                         [0m[0m  |  [31m[1m                 17500.6                  [0m[0m
      1024   x 768   |  [31m[1m                3567.4               [0m[0m  |  [31m[1m  346475.1  [0m[0m  |  [31m[1m         8965.3        [0m[0m  |  [31m[1m                   3640.6                  [0m[0m  |  [31m[1m                         327987.8                         [0m[0m  |  [31m[1m                  9132.8                  [0m[0m
      512    x 768   |  [31m[1m                1903.9               [0m[0m  |  [31m[1m  164998.7  [0m[0m  |  [31m[1m         4550.4        [0m[0m  |  [31m[1m                   1913.2                  [0m[0m  |  [31m[1m                         168440.6                         [0m[0m  |  [31m[1m                  4678.9                  [0m[0m
      256    x 768   |  [31m[1m                1036.0               [0m[0m  |  [31m[1m   84892.1  [0m[0m  |  [31m[1m         2605.3        [0m[0m  |  [31m[1m                   1051.0                  [0m[0m  |  [31m[1m                          84527.3                         [0m[0m  |  [31m[1m                  2665.3                  [0m[0m
      128    x 768   |  [31m[1m                 632.4               [0m[0m  |  [31m[1m   42858.7  [0m[0m  |  [31m[1m         1548.4        [0m[0m  |  [31m[1m                    642.1                  [0m[0m  |  [31m[1m                          41869.5                         [0m[0m  |  [31m[1m                  1576.4                  [0m[0m
      64     x 768   |  [31m[1m                 419.0               [0m[0m  |  [31m[1m   22083.8  [0m[0m  |  [31m[1m         1034.4        [0m[0m  |  [31m[1m                    427.7                  [0m[0m  |  [31m[1m                          21850.3                         [0m[0m  |  [31m[1m                  1063.3                  [0m[0m
      32     x 768   |  [31m[1m                 319.1               [0m[0m  |  [31m[1m    8699.5  [0m[0m  |  [31m[1m          781.8        [0m[0m  |  [31m[1m                    328.0                  [0m[0m  |  [31m[1m                           7978.0                         [0m[0m  |  [31m[1m                   780.3                  [0m[0m
      16     x 768   |  [31m[1m                 258.2               [0m[0m  |  [31m[1m    3057.7  [0m[0m  |  [31m[1m          645.4        [0m[0m  |  [31m[1m                    271.4                  [0m[0m  |  [31m[1m                           2739.2                         [0m[0m  |  [31m[1m                   653.7                  [0m[0m
      8      x 768   |  [2m[91m                  66.1               [0m[0m  |  [2m[91m    1589.5  [0m[0m  |  [2m[91m          139.4        [0m[0m  |                       74.7                    |  [31m[1m                           1390.7                         [0m[0m  |  [2m[91m                   149.9                  [0m[0m
      4      x 768   |                    45.3                 |  [2m[91m     887.6  [0m[0m  |             89.0          |                       54.4                    |  [2m[91m                            695.7                         [0m[0m  |                     104.5                  
      2      x 768   |  [34m[1m                  35.7               [0m[0m  |       539.6    |  [34m[1m           56.2        [0m[0m  |  [34m[1m                     41.7                  [0m[0m  |                              353.0                           |  [34m[1m                    73.2                  [0m[0m
      1      x 768   |  [92m[1m                  32.9               [0m[0m  |  [92m[1m     394.5  [0m[0m  |  [92m[1m           55.6        [0m[0m  |  [92m[1m                     41.1                  [0m[0m  |  [92m[1m                            225.0                         [0m[0m  |  [92m[1m                    68.1                  [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 12 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend trace  |  Fine-grained + structured sparsity @ 80 with backend trace  |  Dense benchmark - Compiled - backend trace
12 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                6939.0               [0m[0m  |  [31m[1m 1238411.0  [0m[0m  |  [31m[1m        17143.4        [0m[0m  |  [31m[1m                   7014.9                  [0m[0m  |  [31m[1m                        1258089.8                         [0m[0m  |  [31m[1m                 17684.6                  [0m[0m
      1024   x 768   |  [31m[1m                3686.0               [0m[0m  |  [31m[1m  628363.2  [0m[0m  |  [31m[1m         8933.3        [0m[0m  |  [31m[1m                   3726.6                  [0m[0m  |  [31m[1m                         698154.7                         [0m[0m  |  [31m[1m                  9158.5                  [0m[0m
      512    x 768   |  [31m[1m                1960.6               [0m[0m  |  [31m[1m  321233.5  [0m[0m  |  [31m[1m         4564.2        [0m[0m  |  [31m[1m                   1964.9                  [0m[0m  |  [31m[1m                         339028.9                         [0m[0m  |  [31m[1m                  4629.8                  [0m[0m
      256    x 768   |  [31m[1m                1195.1               [0m[0m  |  [31m[1m  167563.3  [0m[0m  |  [31m[1m         2586.4        [0m[0m  |  [31m[1m                   1183.5                  [0m[0m  |  [31m[1m                         163763.6                         [0m[0m  |  [31m[1m                  2660.0                  [0m[0m
      128    x 768   |  [31m[1m                 723.2               [0m[0m  |  [31m[1m   82886.4  [0m[0m  |  [31m[1m         1558.3        [0m[0m  |  [31m[1m                    733.5                  [0m[0m  |  [31m[1m                          81886.1                         [0m[0m  |  [31m[1m                  1558.8                  [0m[0m
      64     x 768   |  [31m[1m                 474.9               [0m[0m  |  [31m[1m   42403.3  [0m[0m  |  [31m[1m         1050.3        [0m[0m  |  [31m[1m                    495.7                  [0m[0m  |  [31m[1m                          41450.9                         [0m[0m  |  [31m[1m                  1051.1                  [0m[0m
      32     x 768   |  [31m[1m                 361.1               [0m[0m  |  [31m[1m   21387.7  [0m[0m  |  [31m[1m          766.1        [0m[0m  |  [31m[1m                    369.6                  [0m[0m  |  [31m[1m                          21855.1                         [0m[0m  |  [31m[1m                   790.1                  [0m[0m
      16     x 768   |  [31m[1m                 295.3               [0m[0m  |  [31m[1m    5889.4  [0m[0m  |  [31m[1m          636.1        [0m[0m  |  [31m[1m                    307.8                  [0m[0m  |  [31m[1m                           7927.6                         [0m[0m  |  [31m[1m                   649.7                  [0m[0m
      8      x 768   |  [2m[91m                  69.3               [0m[0m  |  [31m[1m    3138.9  [0m[0m  |  [2m[91m          136.1        [0m[0m  |                       79.1                    |  [31m[1m                           2777.8                         [0m[0m  |  [2m[91m                   150.3                  [0m[0m
      4      x 768   |                    48.2                 |  [2m[91m    1597.5  [0m[0m  |             85.0          |                       56.9                    |  [2m[91m                           1359.3                         [0m[0m  |                     100.9                  
      2      x 768   |  [34m[1m                  35.5               [0m[0m  |       878.7    |  [34m[1m           56.8        [0m[0m  |  [34m[1m                     43.1                  [0m[0m  |                              701.9                           |                      74.7                  
      1      x 768   |  [92m[1m                  33.9               [0m[0m  |  [92m[1m     544.8  [0m[0m  |  [92m[1m           56.1        [0m[0m  |  [92m[1m                     40.9                  [0m[0m  |  [92m[1m                            352.3                         [0m[0m  |  [92m[1m                    67.8                  [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 2048 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 80 num_threads 12 with compiler trace using backend trace
[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 12 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend trace  |  Fine-grained + structured sparsity @ 90 with backend trace  |  Dense benchmark - Compiled - backend trace
12 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                397.3                [0m[0m  |  [31m[1m  23943.1   [0m[0m  |  [31m[1m         1031.2        [0m[0m  |  [31m[1m                   397.1                   [0m[0m  |  [31m[1m                         16655.4                          [0m[0m  |  [31m[1m                  1037.5                  [0m[0m
      1024   x 768   |  [31m[1m                211.0                [0m[0m  |  [31m[1m  11986.2   [0m[0m  |  [31m[1m          545.3        [0m[0m  |  [31m[1m                   218.6                   [0m[0m  |  [31m[1m                          8267.2                          [0m[0m  |  [31m[1m                   550.7                  [0m[0m
      512    x 768   |  [31m[1m                116.6                [0m[0m  |  [31m[1m   5995.6   [0m[0m  |  [31m[1m          267.6        [0m[0m  |  [2m[91m                   117.7                   [0m[0m  |  [31m[1m                          4144.0                          [0m[0m  |  [31m[1m                   270.2                  [0m[0m
      256    x 768   |  [2m[91m                 76.9                [0m[0m  |  [31m[1m   3005.9   [0m[0m  |  [2m[91m          142.6        [0m[0m  |  [2m[91m                    77.4                   [0m[0m  |  [31m[1m                          1993.2                          [0m[0m  |  [2m[91m                   143.6                  [0m[0m
      128    x 768   |  [2m[91m                 42.8                [0m[0m  |  [31m[1m   1515.9   [0m[0m  |  [2m[91m           79.3        [0m[0m  |                      47.4                     |  [31m[1m                           996.8                          [0m[0m  |                      79.9                  
      64     x 768   |  [2m[91m                 42.5                [0m[0m  |  [2m[91m    763.8   [0m[0m  |             51.3          |  [2m[91m                    50.3                   [0m[0m  |  [31m[1m                           508.7                          [0m[0m  |  [34m[1m                    51.4                  [0m[0m
      32     x 768   |  [2m[91m                 43.0                [0m[0m  |  [2m[91m    395.5   [0m[0m  |  [34m[1m           40.7        [0m[0m  |  [2m[91m                    51.8                   [0m[0m  |  [31m[1m                           259.9                          [0m[0m  |  [34m[1m                    49.8                  [0m[0m
      16     x 768   |  [2m[91m                 43.9                [0m[0m  |      207.3     |  [34m[1m           41.0        [0m[0m  |  [2m[91m                    55.4                   [0m[0m  |  [2m[91m                           136.3                          [0m[0m  |  [34m[1m                    49.7                  [0m[0m
      8      x 768   |  [2m[91m                 44.2                [0m[0m  |  [34m[1m    188.0   [0m[0m  |  [34m[1m           40.6        [0m[0m  |  [2m[91m                    52.8                   [0m[0m  |                              73.7                            |  [34m[1m                    49.7                  [0m[0m
      4      x 768   |  [2m[91m                 44.7                [0m[0m  |  [34m[1m    195.2   [0m[0m  |  [34m[1m           40.0        [0m[0m  |  [2m[91m                    55.5                   [0m[0m  |  [34m[1m                            48.3                          [0m[0m  |  [34m[1m                    49.1                  [0m[0m
      2      x 768   |  [92m[1m                 19.5                [0m[0m  |  [92m[1m    186.5   [0m[0m  |  [92m[1m           38.7        [0m[0m  |  [92m[1m                    25.0                   [0m[0m  |  [92m[1m                            47.4                          [0m[0m  |  [92m[1m                    48.5                  [0m[0m
      1      x 768   |                   25.5                  |  [92m[1m    185.2   [0m[0m  |  [34m[1m           39.2        [0m[0m  |                      30.6                     |  [92m[1m                            47.0                          [0m[0m  |  [34m[1m                    49.5                  [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 12 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend trace  |  Fine-grained + structured sparsity @ 80 with backend trace  |  Dense benchmark - Compiled - backend trace
12 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                533.8                [0m[0m  |  [31m[1m  66743.3   [0m[0m  |  [31m[1m         1193.4        [0m[0m  |  [31m[1m                   538.0                   [0m[0m  |  [31m[1m                         44682.3                          [0m[0m  |  [31m[1m                  1201.0                  [0m[0m
      1024   x 768   |  [31m[1m                275.1                [0m[0m  |  [31m[1m  33332.9   [0m[0m  |  [31m[1m          637.1        [0m[0m  |  [31m[1m                   286.3                   [0m[0m  |  [31m[1m                         22356.4                          [0m[0m  |  [31m[1m                   640.5                  [0m[0m
      512    x 768   |  [31m[1m                140.5                [0m[0m  |  [31m[1m  16675.2   [0m[0m  |  [31m[1m          302.6        [0m[0m  |  [31m[1m                   141.3                   [0m[0m  |  [31m[1m                         11244.9                          [0m[0m  |  [31m[1m                   305.4                  [0m[0m
      256    x 768   |  [2m[91m                 85.2                [0m[0m  |  [31m[1m   8348.5   [0m[0m  |  [2m[91m          153.9        [0m[0m  |  [2m[91m                    87.1                   [0m[0m  |  [31m[1m                          5640.9                          [0m[0m  |  [2m[91m                   152.7                  [0m[0m
      128    x 768   |  [2m[91m                 48.8                [0m[0m  |  [31m[1m   4183.3   [0m[0m  |  [2m[91m           82.9        [0m[0m  |  [2m[91m                    50.7                   [0m[0m  |  [31m[1m                          2827.1                          [0m[0m  |                      82.8                  
      64     x 768   |                   37.2                  |  [31m[1m   2100.4   [0m[0m  |             53.5          |                      46.4                     |  [31m[1m                          1419.2                          [0m[0m  |                      53.5                  
      32     x 768   |  [2m[91m                 41.3                [0m[0m  |  [31m[1m   1060.5   [0m[0m  |  [34m[1m           41.0        [0m[0m  |  [2m[91m                    51.5                   [0m[0m  |  [31m[1m                           714.7                          [0m[0m  |  [34m[1m                    51.0                  [0m[0m
      16     x 768   |  [2m[91m                 43.7                [0m[0m  |  [2m[91m    537.8   [0m[0m  |  [34m[1m           41.3        [0m[0m  |  [2m[91m                    52.9                   [0m[0m  |  [31m[1m                           359.6                          [0m[0m  |  [34m[1m                    50.1                  [0m[0m
      8      x 768   |  [2m[91m                 43.1                [0m[0m  |      277.3     |  [34m[1m           40.2        [0m[0m  |  [2m[91m                    52.1                   [0m[0m  |  [2m[91m                           184.8                          [0m[0m  |  [34m[1m                    50.1                  [0m[0m
      4      x 768   |                   39.6                  |  [34m[1m    188.5   [0m[0m  |  [92m[1m           38.8        [0m[0m  |                      48.7                     |  [2m[91m                            96.3                          [0m[0m  |  [34m[1m                    49.5                  [0m[0m
      2      x 768   |  [92m[1m                 20.1                [0m[0m  |  [34m[1m    189.0   [0m[0m  |  [92m[1m           39.0        [0m[0m  |  [92m[1m                    25.1                   [0m[0m  |                              53.5                            |  [92m[1m                    48.2                  [0m[0m
      1      x 768   |                   25.1                  |  [92m[1m    182.5   [0m[0m  |  [34m[1m           39.8        [0m[0m  |                      29.8                     |  [92m[1m                            46.4                          [0m[0m  |  [34m[1m                    49.3                  [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 2048 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 12 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                6606.5               [0m[0m  |  [31m[1m  656613.2  [0m[0m  |  [31m[1m        17264.5        [0m[0m  |  [31m[1m                    6823.2                    [0m[0m  |  [31m[1m                           109564.1                          [0m[0m  |  [31m[1m                   17469.4                   [0m[0m
      1024   x 768   |  [31m[1m                3548.7               [0m[0m  |  [31m[1m  321402.4  [0m[0m  |  [31m[1m         8955.6        [0m[0m  |  [31m[1m                    3683.6                    [0m[0m  |  [31m[1m                            55100.5                          [0m[0m  |  [31m[1m                    9047.3                   [0m[0m
      512    x 768   |  [31m[1m                2018.1               [0m[0m  |  [31m[1m  163403.0  [0m[0m  |  [31m[1m         4551.6        [0m[0m  |  [31m[1m                    2008.4                    [0m[0m  |  [31m[1m                            27797.7                          [0m[0m  |  [31m[1m                    5469.5                   [0m[0m
      256    x 768   |  [31m[1m                1029.4               [0m[0m  |  [31m[1m   82023.4  [0m[0m  |  [31m[1m         2592.5        [0m[0m  |  [31m[1m                    1147.9                    [0m[0m  |  [31m[1m                            14142.7                          [0m[0m  |  [31m[1m                    2668.0                   [0m[0m
      128    x 768   |  [31m[1m                 626.7               [0m[0m  |  [31m[1m   41599.1  [0m[0m  |  [31m[1m         1547.7        [0m[0m  |  [31m[1m                     747.1                    [0m[0m  |  [31m[1m                             7198.3                          [0m[0m  |  [31m[1m                    1609.2                   [0m[0m
      64     x 768   |  [31m[1m                 417.9               [0m[0m  |  [31m[1m   21642.3  [0m[0m  |  [31m[1m         1032.4        [0m[0m  |  [2m[91m                     521.8                    [0m[0m  |  [31m[1m                             3956.2                          [0m[0m  |  [31m[1m                    1102.2                   [0m[0m
      32     x 768   |  [31m[1m                 315.0               [0m[0m  |  [31m[1m    5673.8  [0m[0m  |  [31m[1m          777.3        [0m[0m  |  [2m[91m                     407.7                    [0m[0m  |  [31m[1m                             2028.3                          [0m[0m  |  [31m[1m                     816.1                   [0m[0m
      16     x 768   |  [31m[1m                 261.0               [0m[0m  |  [31m[1m    3042.3  [0m[0m  |  [31m[1m          642.7        [0m[0m  |  [2m[91m                     347.1                    [0m[0m  |  [31m[1m                             1002.6                          [0m[0m  |  [31m[1m                     677.8                   [0m[0m
      8      x 768   |                    64.6                 |  [2m[91m    1573.9  [0m[0m  |  [2m[91m          132.3        [0m[0m  |                       146.3                      |  [2m[91m                              552.3                          [0m[0m  |                       175.3                   
      4      x 768   |                    44.8                 |  [2m[91m     890.9  [0m[0m  |             87.3          |                       126.8                      |  [2m[91m                              326.7                          [0m[0m  |                       130.2                   
      2      x 768   |  [34m[1m                  33.9               [0m[0m  |       538.0    |  [34m[1m           59.2        [0m[0m  |  [92m[1m                     113.7                    [0m[0m  |                                206.9                            |  [34m[1m                      97.0                   [0m[0m
      1      x 768   |  [92m[1m                  32.8               [0m[0m  |  [92m[1m     402.8  [0m[0m  |  [92m[1m           56.0        [0m[0m  |  [92m[1m                     112.8                    [0m[0m  |  [92m[1m                              137.5                          [0m[0m  |  [92m[1m                      91.9                   [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 12 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                7013.8               [0m[0m  |  [31m[1m 1229192.4  [0m[0m  |  [31m[1m        17135.0        [0m[0m  |  [31m[1m                    7126.1                    [0m[0m  |  [31m[1m                           220614.0                          [0m[0m  |  [31m[1m                   17317.6                   [0m[0m
      1024   x 768   |  [31m[1m                3654.2               [0m[0m  |  [31m[1m  626548.0  [0m[0m  |  [31m[1m         8947.3        [0m[0m  |  [31m[1m                    3795.6                    [0m[0m  |  [31m[1m                           112758.8                          [0m[0m  |  [31m[1m                    9040.9                   [0m[0m
      512    x 768   |  [31m[1m                1935.0               [0m[0m  |  [31m[1m  320262.5  [0m[0m  |  [31m[1m         4581.1        [0m[0m  |  [31m[1m                    2062.5                    [0m[0m  |  [31m[1m                            55867.8                          [0m[0m  |  [31m[1m                    4670.0                   [0m[0m
      256    x 768   |  [31m[1m                1228.1               [0m[0m  |  [31m[1m  167756.6  [0m[0m  |  [31m[1m         2598.9        [0m[0m  |  [31m[1m                    1302.7                    [0m[0m  |  [31m[1m                            28468.5                          [0m[0m  |  [31m[1m                    2672.3                   [0m[0m
      128    x 768   |  [31m[1m                 721.6               [0m[0m  |  [31m[1m   82637.1  [0m[0m  |  [31m[1m         1559.4        [0m[0m  |  [31m[1m                     827.4                    [0m[0m  |  [31m[1m                            14320.0                          [0m[0m  |  [31m[1m                    1618.7                   [0m[0m
      64     x 768   |  [31m[1m                 483.3               [0m[0m  |  [31m[1m   41712.0  [0m[0m  |  [31m[1m         1053.1        [0m[0m  |  [31m[1m                     586.9                    [0m[0m  |  [31m[1m                             7982.9                          [0m[0m  |  [31m[1m                    1094.4                   [0m[0m
      32     x 768   |  [31m[1m                 355.3               [0m[0m  |  [31m[1m   21643.8  [0m[0m  |  [31m[1m          767.4        [0m[0m  |  [2m[91m                     453.3                    [0m[0m  |  [31m[1m                             4068.7                          [0m[0m  |  [31m[1m                     813.3                   [0m[0m
      16     x 768   |  [31m[1m                 295.7               [0m[0m  |  [31m[1m    5822.0  [0m[0m  |  [31m[1m          640.8        [0m[0m  |  [2m[91m                     388.6                    [0m[0m  |  [31m[1m                             1896.0                          [0m[0m  |  [31m[1m                     674.7                   [0m[0m
      8      x 768   |  [2m[91m                  70.2               [0m[0m  |  [31m[1m    3073.8  [0m[0m  |  [2m[91m          136.6        [0m[0m  |                       158.0                      |  [2m[91m                             1019.5                          [0m[0m  |                       179.6                   
      4      x 768   |                    48.8                 |  [2m[91m    1623.3  [0m[0m  |             89.6          |                       136.1                      |  [2m[91m                              585.8                          [0m[0m  |                       131.7                   
      2      x 768   |  [34m[1m                  35.8               [0m[0m  |       893.7    |  [34m[1m           58.8        [0m[0m  |  [34m[1m                     119.5                    [0m[0m  |                                361.3                            |  [34m[1m                      97.9                   [0m[0m
      1      x 768   |  [92m[1m                  33.8               [0m[0m  |  [92m[1m     549.9  [0m[0m  |  [92m[1m           55.9        [0m[0m  |  [92m[1m                     113.3                    [0m[0m  |  [92m[1m                              204.7                          [0m[0m  |  [92m[1m                      93.3                   [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 2048 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 12 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                391.5                [0m[0m  |  [31m[1m  23937.1   [0m[0m  |  [31m[1m         1033.2        [0m[0m  |  [31m[1m                    429.7                     [0m[0m  |  [31m[1m                            6295.8                           [0m[0m  |  [31m[1m                    1031.7                   [0m[0m
      1024   x 768   |  [31m[1m                214.0                [0m[0m  |  [31m[1m  12002.6   [0m[0m  |  [31m[1m          546.6        [0m[0m  |  [2m[91m                    233.3                     [0m[0m  |  [31m[1m                            3158.0                           [0m[0m  |  [31m[1m                     553.5                   [0m[0m
      512    x 768   |  [31m[1m                116.6                [0m[0m  |  [31m[1m   6007.6   [0m[0m  |  [31m[1m          268.3        [0m[0m  |  [2m[91m                    128.7                     [0m[0m  |  [31m[1m                            1632.4                           [0m[0m  |  [2m[91m                     269.9                   [0m[0m
      256    x 768   |  [2m[91m                 76.9                [0m[0m  |  [31m[1m   2988.1   [0m[0m  |  [2m[91m          142.2        [0m[0m  |                       84.6                       |  [31m[1m                             815.8                           [0m[0m  |  [2m[91m                     142.0                   [0m[0m
      128    x 768   |  [2m[91m                 43.0                [0m[0m  |  [31m[1m   1506.2   [0m[0m  |  [2m[91m           79.4        [0m[0m  |  [34m[1m                     66.0                     [0m[0m  |  [31m[1m                             413.9                           [0m[0m  |                        79.8                   
      64     x 768   |  [2m[91m                 42.4                [0m[0m  |  [2m[91m    767.5   [0m[0m  |             51.3          |  [34m[1m                     65.1                     [0m[0m  |  [2m[91m                             212.0                           [0m[0m  |  [92m[1m                      68.2                   [0m[0m
      32     x 768   |  [2m[91m                 41.7                [0m[0m  |  [2m[91m    390.5   [0m[0m  |  [34m[1m           41.5        [0m[0m  |  [92m[1m                     64.4                     [0m[0m  |                               117.8                             |  [34m[1m                      71.9                   [0m[0m
      16     x 768   |  [2m[91m                 44.9                [0m[0m  |      210.1     |  [34m[1m           40.3        [0m[0m  |  [92m[1m                     64.4                     [0m[0m  |  [92m[1m                              65.0                           [0m[0m  |  [34m[1m                      70.4                   [0m[0m
      8      x 768   |  [2m[91m                 45.3                [0m[0m  |  [34m[1m    188.6   [0m[0m  |  [34m[1m           41.0        [0m[0m  |  [92m[1m                     64.2                     [0m[0m  |  [92m[1m                              64.7                           [0m[0m  |  [34m[1m                      69.4                   [0m[0m
      4      x 768   |  [2m[91m                 42.9                [0m[0m  |  [92m[1m    185.9   [0m[0m  |  [92m[1m           38.8        [0m[0m  |  [34m[1m                     66.3                     [0m[0m  |  [34m[1m                              66.5                           [0m[0m  |  [34m[1m                      71.4                   [0m[0m
      2      x 768   |  [92m[1m                 19.9                [0m[0m  |  [92m[1m    186.8   [0m[0m  |  [34m[1m           39.2        [0m[0m  |  [92m[1m                     64.5                     [0m[0m  |  [92m[1m                              64.4                           [0m[0m  |  [92m[1m                      68.8                   [0m[0m
      1      x 768   |                   25.1                  |  [92m[1m    186.9   [0m[0m  |  [34m[1m           42.3        [0m[0m  |  [34m[1m                     65.7                     [0m[0m  |  [92m[1m                              64.9                           [0m[0m  |  [92m[1m                      68.4                   [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 12 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                502.9                [0m[0m  |  [31m[1m  66676.9   [0m[0m  |  [31m[1m         1138.2        [0m[0m  |  [31m[1m                    527.4                     [0m[0m  |  [31m[1m                           15193.2                           [0m[0m  |  [31m[1m                    1125.0                   [0m[0m
      1024   x 768   |  [31m[1m                263.3                [0m[0m  |  [31m[1m  33350.8   [0m[0m  |  [31m[1m          612.2        [0m[0m  |  [2m[91m                    275.4                     [0m[0m  |  [31m[1m                            7806.9                           [0m[0m  |  [31m[1m                     619.2                   [0m[0m
      512    x 768   |  [31m[1m                138.4                [0m[0m  |  [31m[1m  16691.4   [0m[0m  |  [31m[1m          291.0        [0m[0m  |  [2m[91m                    149.7                     [0m[0m  |  [31m[1m                            3816.9                           [0m[0m  |  [2m[91m                     296.4                   [0m[0m
      256    x 768   |  [2m[91m                 83.9                [0m[0m  |  [31m[1m   8345.4   [0m[0m  |  [2m[91m          149.7        [0m[0m  |                       90.4                       |  [31m[1m                            1882.5                           [0m[0m  |  [2m[91m                     148.9                   [0m[0m
      128    x 768   |  [2m[91m                 48.7                [0m[0m  |  [31m[1m   4182.6   [0m[0m  |  [2m[91m           82.6        [0m[0m  |  [34m[1m                     68.1                     [0m[0m  |  [31m[1m                             927.8                           [0m[0m  |                        82.6                   
      64     x 768   |                   38.2                  |  [31m[1m   2103.8   [0m[0m  |             53.0          |  [34m[1m                     66.6                     [0m[0m  |  [31m[1m                             495.5                           [0m[0m  |  [92m[1m                      67.1                   [0m[0m
      32     x 768   |  [2m[91m                 41.9                [0m[0m  |  [31m[1m   1059.5   [0m[0m  |  [34m[1m           41.1        [0m[0m  |  [34m[1m                     65.1                     [0m[0m  |  [2m[91m                             248.8                           [0m[0m  |  [34m[1m                      71.8                   [0m[0m
      16     x 768   |  [2m[91m                 43.8                [0m[0m  |  [2m[91m    537.3   [0m[0m  |  [34m[1m           41.0        [0m[0m  |  [34m[1m                     64.4                     [0m[0m  |                               124.8                             |  [34m[1m                      72.9                   [0m[0m
      8      x 768   |  [2m[91m                 43.1                [0m[0m  |      276.8     |  [34m[1m           41.1        [0m[0m  |  [34m[1m                     64.7                     [0m[0m  |                                74.9                             |  [34m[1m                      69.9                   [0m[0m
      4      x 768   |  [2m[91m                 39.5                [0m[0m  |  [92m[1m    185.8   [0m[0m  |  [92m[1m           38.7        [0m[0m  |  [34m[1m                     64.3                     [0m[0m  |  [92m[1m                              64.0                           [0m[0m  |  [34m[1m                      68.3                   [0m[0m
      2      x 768   |  [92m[1m                 19.5                [0m[0m  |  [34m[1m    188.7   [0m[0m  |  [34m[1m           39.6        [0m[0m  |  [92m[1m                     63.6                     [0m[0m  |  [34m[1m                              64.5                           [0m[0m  |  [34m[1m                      71.6                   [0m[0m
      1      x 768   |                   24.7                  |  [92m[1m    184.1   [0m[0m  |  [34m[1m           39.2        [0m[0m  |  [92m[1m                     63.9                     [0m[0m  |  [92m[1m                              63.7                           [0m[0m  |  [34m[1m                      69.5                   [0m[0m

Times are in microseconds (us).
/home/user/build/.venv/lib/python3.10/site-packages/torch/jit/_script.py:1241: UserWarning: `optimize` is deprecated and has no effect. Use `with torch.jit.optimized_execution() instead
  warnings.warn(

Benchmarking batch size 2048 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 2048 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler script using backend script
[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend script  |  Fine-grained + structured sparsity @ 90 with backend script  |  Dense benchmark - Compiled - backend script
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               10975.6               [0m[0m  |  [31m[1m  633039.0  [0m[0m  |  [31m[1m        25738.0        [0m[0m  |  [31m[1m                  10919.6                   [0m[0m  |  [31m[1m                          646942.8                         [0m[0m  |  [31m[1m                  25851.0                  [0m[0m
      1024   x 768   |  [31m[1m                6085.5               [0m[0m  |  [31m[1m  332427.6  [0m[0m  |  [31m[1m        13990.4        [0m[0m  |  [31m[1m                   6198.4                   [0m[0m  |  [31m[1m                          342665.7                         [0m[0m  |  [31m[1m                  13854.2                  [0m[0m
      512    x 768   |  [31m[1m                4419.2               [0m[0m  |  [31m[1m  180295.4  [0m[0m  |  [31m[1m         7649.3        [0m[0m  |  [31m[1m                   4407.8                   [0m[0m  |  [31m[1m                          180999.9                         [0m[0m  |  [31m[1m                   7522.4                  [0m[0m
      256    x 768   |  [31m[1m                2766.8               [0m[0m  |  [31m[1m  102296.4  [0m[0m  |  [31m[1m         4808.5        [0m[0m  |  [31m[1m                   3048.7                   [0m[0m  |  [31m[1m                          100978.7                         [0m[0m  |  [31m[1m                   5067.1                  [0m[0m
      128    x 768   |  [31m[1m                3472.7               [0m[0m  |  [31m[1m   57440.8  [0m[0m  |  [31m[1m         3397.5        [0m[0m  |  [31m[1m                   2177.8                   [0m[0m  |  [31m[1m                           56772.9                         [0m[0m  |  [31m[1m                   3697.7                  [0m[0m
      64     x 768   |  [31m[1m                3112.3               [0m[0m  |  [31m[1m   32819.8  [0m[0m  |  [31m[1m         2378.1        [0m[0m  |  [31m[1m                   2155.1                   [0m[0m  |  [31m[1m                           32409.3                         [0m[0m  |  [31m[1m                   2931.0                  [0m[0m
      32     x 768   |  [31m[1m                2771.5               [0m[0m  |  [31m[1m   13577.6  [0m[0m  |  [31m[1m         1767.2        [0m[0m  |  [31m[1m                   1873.3                   [0m[0m  |  [31m[1m                           15949.3                         [0m[0m  |  [31m[1m                   2562.7                  [0m[0m
      16     x 768   |  [31m[1m                1914.9               [0m[0m  |  [2m[91m    7964.4  [0m[0m  |  [31m[1m         1501.9        [0m[0m  |  [2m[91m                    553.0                   [0m[0m  |  [31m[1m                            7153.3                         [0m[0m  |  [2m[91m                    633.2                  [0m[0m
      8      x 768   |                   239.7                 |  [2m[91m    5078.8  [0m[0m  |            448.9          |  [31m[1m                   1580.1                   [0m[0m  |  [2m[91m                            4769.9                         [0m[0m  |                      464.4                  
      4      x 768   |                   211.4                 |  [2m[91m    3261.2  [0m[0m  |            361.2          |  [31m[1m                   1364.8                   [0m[0m  |  [2m[91m                            2725.7                         [0m[0m  |  [34m[1m                    335.4                  [0m[0m
      2      x 768   |  [34m[1m                 184.0               [0m[0m  |      2173.9    |  [34m[1m          267.4        [0m[0m  |  [31m[1m                   1286.1                   [0m[0m  |                              1682.2                           |  [34m[1m                    334.3                  [0m[0m
      1      x 768   |  [92m[1m                 180.2               [0m[0m  |  [92m[1m    1615.0  [0m[0m  |  [92m[1m          254.0        [0m[0m  |  [92m[1m                    222.6                   [0m[0m  |  [92m[1m                            1067.1                         [0m[0m  |  [92m[1m                    307.6                  [0m[0m

Times are in microseconds (us).

[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend script  |  Fine-grained + structured sparsity @ 80 with backend script  |  Dense benchmark - Compiled - backend script
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               11283.4               [0m[0m  |  [31m[1m 1226860.8  [0m[0m  |  [31m[1m        25429.2        [0m[0m  |  [31m[1m                  11751.3                   [0m[0m  |  [31m[1m                         1240987.5                         [0m[0m  |  [31m[1m                  25874.5                  [0m[0m
      1024   x 768   |  [31m[1m                6532.2               [0m[0m  |  [31m[1m  636199.9  [0m[0m  |  [31m[1m        14011.2        [0m[0m  |  [31m[1m                   6346.3                   [0m[0m  |  [31m[1m                          626207.5                         [0m[0m  |  [31m[1m                  13652.7                  [0m[0m
      512    x 768   |  [31m[1m                4655.8               [0m[0m  |  [31m[1m  332525.8  [0m[0m  |  [31m[1m         7522.9        [0m[0m  |  [31m[1m                   4545.0                   [0m[0m  |  [31m[1m                          352594.4                         [0m[0m  |  [31m[1m                   7533.5                  [0m[0m
      256    x 768   |  [31m[1m                2850.6               [0m[0m  |  [31m[1m  183080.8  [0m[0m  |  [31m[1m         4878.1        [0m[0m  |  [31m[1m                   3123.7                   [0m[0m  |  [31m[1m                          182667.8                         [0m[0m  |  [31m[1m                   5105.1                  [0m[0m
      128    x 768   |  [31m[1m                3500.5               [0m[0m  |  [31m[1m  101703.8  [0m[0m  |  [31m[1m         3484.2        [0m[0m  |  [31m[1m                   2160.8                   [0m[0m  |  [31m[1m                          100065.0                         [0m[0m  |  [31m[1m                   3707.2                  [0m[0m
      64     x 768   |  [31m[1m                2954.5               [0m[0m  |  [31m[1m   58285.9  [0m[0m  |  [31m[1m         2340.6        [0m[0m  |  [31m[1m                   2378.1                   [0m[0m  |  [31m[1m                           56101.5                         [0m[0m  |  [31m[1m                   3036.8                  [0m[0m
      32     x 768   |  [31m[1m                2979.6               [0m[0m  |  [31m[1m   18055.5  [0m[0m  |  [31m[1m         1762.8        [0m[0m  |  [31m[1m                   1970.4                   [0m[0m  |  [31m[1m                           30999.6                         [0m[0m  |  [31m[1m                   2583.3                  [0m[0m
      16     x 768   |  [31m[1m                2049.0               [0m[0m  |  [2m[91m    9515.8  [0m[0m  |  [31m[1m         1503.4        [0m[0m  |  [2m[91m                    574.4                   [0m[0m  |  [31m[1m                           13436.1                         [0m[0m  |  [2m[91m                    637.7                  [0m[0m
      8      x 768   |                   254.6                 |  [2m[91m    7635.5  [0m[0m  |            434.7          |  [31m[1m                   1585.7                   [0m[0m  |  [2m[91m                            7052.5                         [0m[0m  |                      456.8                  
      4      x 768   |                   217.2                 |  [2m[91m    5214.3  [0m[0m  |            353.2          |  [31m[1m                   1436.0                   [0m[0m  |  [2m[91m                            4884.1                         [0m[0m  |                      348.7                  
      2      x 768   |  [34m[1m                 195.8               [0m[0m  |      3289.0    |  [34m[1m          260.6        [0m[0m  |  [31m[1m                   1207.1                   [0m[0m  |                              2719.0                           |                      338.8                  
      1      x 768   |  [92m[1m                 180.0               [0m[0m  |  [92m[1m    2168.8  [0m[0m  |  [92m[1m          249.4        [0m[0m  |  [92m[1m                    233.9                   [0m[0m  |  [92m[1m                            1665.6                         [0m[0m  |  [92m[1m                    300.7                  [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 2048 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler script using backend script
[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend script  |  Fine-grained + structured sparsity @ 90 with backend script  |  Dense benchmark - Compiled - backend script
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                397.9                [0m[0m  |  [31m[1m  23928.4   [0m[0m  |  [31m[1m         1033.5        [0m[0m  |  [31m[1m                   438.0                    [0m[0m  |  [31m[1m                          16652.0                          [0m[0m  |  [31m[1m                   1069.4                  [0m[0m
      1024   x 768   |  [31m[1m                215.5                [0m[0m  |  [31m[1m  11975.6   [0m[0m  |  [31m[1m          552.5        [0m[0m  |  [31m[1m                   230.8                    [0m[0m  |  [31m[1m                           8315.9                          [0m[0m  |  [31m[1m                    554.4                  [0m[0m
      512    x 768   |  [31m[1m                117.7                [0m[0m  |  [31m[1m   5986.6   [0m[0m  |  [31m[1m          273.2        [0m[0m  |  [31m[1m                   120.6                    [0m[0m  |  [31m[1m                           4013.3                          [0m[0m  |  [31m[1m                    290.5                  [0m[0m
      256    x 768   |  [2m[91m                 77.5                [0m[0m  |  [31m[1m   2982.7   [0m[0m  |  [2m[91m          143.3        [0m[0m  |  [2m[91m                    75.5                    [0m[0m  |  [31m[1m                           2016.2                          [0m[0m  |  [31m[1m                    154.7                  [0m[0m
      128    x 768   |  [2m[91m                 44.0                [0m[0m  |  [31m[1m   1501.1   [0m[0m  |  [2m[91m           79.5        [0m[0m  |                      46.0                      |  [31m[1m                           1014.6                          [0m[0m  |  [2m[91m                     95.5                  [0m[0m
      64     x 768   |  [2m[91m                 43.2                [0m[0m  |  [2m[91m    760.2   [0m[0m  |             51.6          |                      36.1                      |  [31m[1m                            512.4                          [0m[0m  |                       50.2                  
      32     x 768   |  [2m[91m                 41.9                [0m[0m  |  [2m[91m    392.1   [0m[0m  |  [34m[1m           42.5        [0m[0m  |                      27.7                      |  [31m[1m                            260.8                          [0m[0m  |                       42.0                  
      16     x 768   |  [2m[91m                 45.4                [0m[0m  |      207.0     |  [34m[1m           40.2        [0m[0m  |                      28.2                      |  [2m[91m                            134.8                          [0m[0m  |                       36.8                  
      8      x 768   |  [2m[91m                 44.0                [0m[0m  |  [34m[1m    188.3   [0m[0m  |  [34m[1m           41.9        [0m[0m  |  [34m[1m                    24.5                    [0m[0m  |                               73.7                            |                       32.4                  
      4      x 768   |  [2m[91m                 44.2                [0m[0m  |  [92m[1m    186.3   [0m[0m  |  [34m[1m           39.7        [0m[0m  |  [34m[1m                    24.9                    [0m[0m  |  [34m[1m                             43.7                          [0m[0m  |                       31.5                  
      2      x 768   |  [92m[1m                 20.1                [0m[0m  |  [34m[1m    186.5   [0m[0m  |  [92m[1m           39.3        [0m[0m  |  [34m[1m                    24.2                    [0m[0m  |  [34m[1m                             42.4                          [0m[0m  |                       31.0                  
      1      x 768   |                   24.9                  |  [92m[1m    184.6   [0m[0m  |  [34m[1m           41.1        [0m[0m  |  [92m[1m                    23.7                    [0m[0m  |  [92m[1m                             41.1                          [0m[0m  |  [92m[1m                     27.4                  [0m[0m

Times are in microseconds (us).

[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend script  |  Fine-grained + structured sparsity @ 80 with backend script  |  Dense benchmark - Compiled - backend script
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                526.0                [0m[0m  |  [31m[1m  66641.6   [0m[0m  |  [31m[1m         1179.9        [0m[0m  |  [31m[1m                   538.8                    [0m[0m  |  [31m[1m                          44623.1                          [0m[0m  |  [31m[1m                   1142.6                  [0m[0m
      1024   x 768   |  [31m[1m                280.2                [0m[0m  |  [31m[1m  33351.0   [0m[0m  |  [31m[1m          634.6        [0m[0m  |  [31m[1m                   287.3                    [0m[0m  |  [31m[1m                          22407.8                          [0m[0m  |  [31m[1m                    589.4                  [0m[0m
      512    x 768   |  [31m[1m                142.6                [0m[0m  |  [31m[1m  16713.7   [0m[0m  |  [31m[1m          297.6        [0m[0m  |  [31m[1m                   147.9                    [0m[0m  |  [31m[1m                          11169.9                          [0m[0m  |  [31m[1m                    302.7                  [0m[0m
      256    x 768   |  [2m[91m                 85.2                [0m[0m  |  [31m[1m   8353.7   [0m[0m  |  [2m[91m          150.3        [0m[0m  |  [2m[91m                    83.9                    [0m[0m  |  [31m[1m                           5623.8                          [0m[0m  |  [31m[1m                    161.0                  [0m[0m
      128    x 768   |  [2m[91m                 49.1                [0m[0m  |  [31m[1m   4189.3   [0m[0m  |  [2m[91m           82.6        [0m[0m  |                      45.6                      |  [31m[1m                           2826.4                          [0m[0m  |  [2m[91m                     99.9                  [0m[0m
      64     x 768   |                   37.8                  |  [31m[1m   2105.2   [0m[0m  |             53.8          |                      37.7                      |  [31m[1m                           1415.4                          [0m[0m  |                       51.5                  
      32     x 768   |  [2m[91m                 43.1                [0m[0m  |  [31m[1m   1059.1   [0m[0m  |  [34m[1m           40.2        [0m[0m  |                      28.6                      |  [31m[1m                            714.0                          [0m[0m  |                       42.3                  
      16     x 768   |  [2m[91m                 43.9                [0m[0m  |  [2m[91m    537.2   [0m[0m  |  [34m[1m           42.8        [0m[0m  |                      27.9                      |  [31m[1m                            362.3                          [0m[0m  |                       36.9                  
      8      x 768   |  [2m[91m                 45.5                [0m[0m  |      277.4     |  [34m[1m           41.5        [0m[0m  |  [34m[1m                    24.7                    [0m[0m  |  [2m[91m                            185.0                          [0m[0m  |                       32.2                  
      4      x 768   |                   40.1                  |  [92m[1m    190.0   [0m[0m  |  [92m[1m           39.4        [0m[0m  |  [34m[1m                    24.8                    [0m[0m  |  [2m[91m                             96.9                          [0m[0m  |                       31.7                  
      2      x 768   |  [92m[1m                 20.0                [0m[0m  |  [92m[1m    190.7   [0m[0m  |  [92m[1m           39.3        [0m[0m  |  [34m[1m                    24.3                    [0m[0m  |                               53.5                            |                       31.2                  
      1      x 768   |                   25.1                  |  [34m[1m    192.5   [0m[0m  |  [34m[1m           40.5        [0m[0m  |  [92m[1m                    23.5                    [0m[0m  |  [92m[1m                             42.1                          [0m[0m  |  [92m[1m                     27.5                  [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 2048 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler trace using backend trace
[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend trace  |  Fine-grained + structured sparsity @ 90 with backend trace  |  Dense benchmark - Compiled - backend trace
32 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               10979.8               [0m[0m  |  [31m[1m  626910.6  [0m[0m  |  [31m[1m        25681.6        [0m[0m  |  [31m[1m                  10921.5                  [0m[0m  |  [31m[1m                         647182.3                         [0m[0m  |  [31m[1m                 25510.1                  [0m[0m
      1024   x 768   |  [31m[1m                6310.2               [0m[0m  |  [31m[1m  339143.0  [0m[0m  |  [31m[1m        13878.9        [0m[0m  |  [31m[1m                   6349.3                  [0m[0m  |  [31m[1m                         333066.7                         [0m[0m  |  [31m[1m                 13788.3                  [0m[0m
      512    x 768   |  [31m[1m                4566.7               [0m[0m  |  [31m[1m  185578.5  [0m[0m  |  [31m[1m         7721.5        [0m[0m  |  [31m[1m                   4640.6                  [0m[0m  |  [31m[1m                         189086.6                         [0m[0m  |  [31m[1m                  7851.9                  [0m[0m
      256    x 768   |  [31m[1m                2674.5               [0m[0m  |  [31m[1m  104605.2  [0m[0m  |  [31m[1m         4990.7        [0m[0m  |  [31m[1m                   2782.5                  [0m[0m  |  [31m[1m                         103839.9                         [0m[0m  |  [31m[1m                  5155.5                  [0m[0m
      128    x 768   |  [31m[1m                3635.8               [0m[0m  |  [31m[1m   59513.9  [0m[0m  |  [31m[1m         3424.1        [0m[0m  |  [31m[1m                   3584.2                  [0m[0m  |  [31m[1m                          59274.5                         [0m[0m  |  [31m[1m                  3520.7                  [0m[0m
      64     x 768   |  [31m[1m                3248.9               [0m[0m  |  [31m[1m   33907.1  [0m[0m  |  [31m[1m         2325.2        [0m[0m  |  [31m[1m                   3192.8                  [0m[0m  |  [31m[1m                          36094.9                         [0m[0m  |  [31m[1m                  2434.3                  [0m[0m
      32     x 768   |  [31m[1m                3032.8               [0m[0m  |  [31m[1m   19021.1  [0m[0m  |  [31m[1m         1744.8        [0m[0m  |  [31m[1m                   3039.5                  [0m[0m  |  [31m[1m                          17567.5                         [0m[0m  |  [31m[1m                  1819.6                  [0m[0m
      16     x 768   |  [31m[1m                2055.4               [0m[0m  |  [2m[91m    8094.5  [0m[0m  |  [31m[1m         1516.2        [0m[0m  |  [31m[1m                   2140.5                  [0m[0m  |  [31m[1m                           7386.3                         [0m[0m  |  [31m[1m                  1571.8                  [0m[0m
      8      x 768   |                   250.4                 |  [2m[91m    5107.4  [0m[0m  |            439.5          |                      276.7                    |  [2m[91m                           4723.8                         [0m[0m  |                     455.5                  
      4      x 768   |                   210.8                 |      3243.7    |            354.0          |                      235.4                    |  [2m[91m                           2767.4                         [0m[0m  |                     385.6                  
      2      x 768   |  [34m[1m                 190.3               [0m[0m  |      2149.3    |  [34m[1m          264.2        [0m[0m  |  [34m[1m                    212.7                  [0m[0m  |                             1687.7                           |  [34m[1m                   291.5                  [0m[0m
      1      x 768   |  [92m[1m                 182.3               [0m[0m  |  [92m[1m    1633.0  [0m[0m  |  [92m[1m          248.3        [0m[0m  |  [92m[1m                    204.7                  [0m[0m  |  [92m[1m                           1100.7                         [0m[0m  |  [92m[1m                   277.8                  [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend trace  |  Fine-grained + structured sparsity @ 80 with backend trace  |  Dense benchmark - Compiled - backend trace
32 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               11031.8               [0m[0m  |  [31m[1m 1270253.8  [0m[0m  |  [31m[1m        25044.9        [0m[0m  |  [31m[1m                  11321.1                  [0m[0m  |  [31m[1m                        1217548.3                         [0m[0m  |  [31m[1m                 25326.8                  [0m[0m
      1024   x 768   |  [31m[1m                6616.1               [0m[0m  |  [31m[1m  628250.0  [0m[0m  |  [31m[1m        13423.0        [0m[0m  |  [31m[1m                   6575.9                  [0m[0m  |  [31m[1m                         638124.3                         [0m[0m  |  [31m[1m                 13936.2                  [0m[0m
      512    x 768   |  [31m[1m                4795.9               [0m[0m  |  [31m[1m  333870.8  [0m[0m  |  [31m[1m         7701.5        [0m[0m  |  [31m[1m                   4858.3                  [0m[0m  |  [31m[1m                         339058.4                         [0m[0m  |  [31m[1m                  7677.4                  [0m[0m
      256    x 768   |  [31m[1m                2933.5               [0m[0m  |  [31m[1m  180795.6  [0m[0m  |  [31m[1m         5100.4        [0m[0m  |  [31m[1m                   2953.0                  [0m[0m  |  [31m[1m                         183838.6                         [0m[0m  |  [31m[1m                  5263.8                  [0m[0m
      128    x 768   |  [31m[1m                3499.1               [0m[0m  |  [31m[1m  104971.2  [0m[0m  |  [31m[1m         3422.9        [0m[0m  |  [31m[1m                   3662.1                  [0m[0m  |  [31m[1m                         102757.5                         [0m[0m  |  [31m[1m                  3510.2                  [0m[0m
      64     x 768   |  [31m[1m                3139.2               [0m[0m  |  [31m[1m   56302.1  [0m[0m  |  [31m[1m         2340.9        [0m[0m  |  [31m[1m                   3438.7                  [0m[0m  |  [31m[1m                          58491.3                         [0m[0m  |  [31m[1m                  2444.2                  [0m[0m
      32     x 768   |  [31m[1m                2900.3               [0m[0m  |  [31m[1m   33591.7  [0m[0m  |  [31m[1m         1779.2        [0m[0m  |  [31m[1m                   2979.1                  [0m[0m  |  [31m[1m                          33428.4                         [0m[0m  |  [31m[1m                  1778.4                  [0m[0m
      16     x 768   |  [31m[1m                2027.3               [0m[0m  |  [2m[91m    9879.8  [0m[0m  |  [31m[1m         1502.6        [0m[0m  |  [31m[1m                   2133.8                  [0m[0m  |  [31m[1m                          13859.4                         [0m[0m  |  [31m[1m                  1544.8                  [0m[0m
      8      x 768   |                   265.9                 |  [2m[91m    8140.4  [0m[0m  |            438.8          |                      289.3                    |  [2m[91m                           7580.8                         [0m[0m  |                     470.3                  
      4      x 768   |                   226.5                 |  [2m[91m    5257.2  [0m[0m  |            356.2          |                      244.8                    |  [2m[91m                           4837.8                         [0m[0m  |                     383.6                  
      2      x 768   |  [34m[1m                 190.7               [0m[0m  |      3285.0    |  [34m[1m          261.4        [0m[0m  |  [34m[1m                    217.2                  [0m[0m  |                             2797.1                           |  [34m[1m                   295.4                  [0m[0m
      1      x 768   |  [92m[1m                 180.6               [0m[0m  |  [92m[1m    2164.2  [0m[0m  |  [92m[1m          251.9        [0m[0m  |  [92m[1m                    206.8                  [0m[0m  |  [92m[1m                           1685.9                         [0m[0m  |  [92m[1m                   278.9                  [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 2048 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler trace using backend trace
[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend trace  |  Fine-grained + structured sparsity @ 90 with backend trace  |  Dense benchmark - Compiled - backend trace
32 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                394.3                [0m[0m  |  [31m[1m  23931.5   [0m[0m  |  [31m[1m         1028.9        [0m[0m  |  [31m[1m                   400.6                   [0m[0m  |  [31m[1m                         16708.7                          [0m[0m  |  [31m[1m                  1040.1                  [0m[0m
      1024   x 768   |  [31m[1m                212.8                [0m[0m  |  [31m[1m  11949.3   [0m[0m  |  [31m[1m          551.9        [0m[0m  |  [31m[1m                   217.2                   [0m[0m  |  [31m[1m                          8317.2                          [0m[0m  |  [31m[1m                   554.3                  [0m[0m
      512    x 768   |  [31m[1m                117.7                [0m[0m  |  [31m[1m   5986.2   [0m[0m  |  [31m[1m          266.9        [0m[0m  |  [2m[91m                   119.0                   [0m[0m  |  [31m[1m                          4064.3                          [0m[0m  |  [31m[1m                   272.1                  [0m[0m
      256    x 768   |  [2m[91m                 77.1                [0m[0m  |  [31m[1m   2977.7   [0m[0m  |  [2m[91m          142.7        [0m[0m  |  [2m[91m                    77.7                   [0m[0m  |  [31m[1m                          2080.3                          [0m[0m  |  [2m[91m                   142.6                  [0m[0m
      128    x 768   |  [2m[91m                 43.7                [0m[0m  |  [31m[1m   1502.3   [0m[0m  |  [2m[91m           79.4        [0m[0m  |                      47.9                     |  [31m[1m                          1025.8                          [0m[0m  |                      79.6                  
      64     x 768   |  [2m[91m                 41.7                [0m[0m  |  [2m[91m    762.5   [0m[0m  |             51.6          |  [2m[91m                    52.0                   [0m[0m  |  [31m[1m                           511.0                          [0m[0m  |  [34m[1m                    51.8                  [0m[0m
      32     x 768   |  [2m[91m                 42.3                [0m[0m  |  [2m[91m    390.5   [0m[0m  |  [34m[1m           41.2        [0m[0m  |  [2m[91m                    53.0                   [0m[0m  |  [31m[1m                           261.1                          [0m[0m  |  [34m[1m                    50.3                  [0m[0m
      16     x 768   |  [2m[91m                 45.2                [0m[0m  |      209.0     |  [34m[1m           42.0        [0m[0m  |  [2m[91m                    53.9                   [0m[0m  |  [2m[91m                           133.2                          [0m[0m  |  [34m[1m                    49.9                  [0m[0m
      8      x 768   |  [2m[91m                 44.4                [0m[0m  |  [92m[1m    184.6   [0m[0m  |  [34m[1m           40.6        [0m[0m  |  [2m[91m                    56.0                   [0m[0m  |                              73.5                            |  [34m[1m                    50.2                  [0m[0m
      4      x 768   |  [2m[91m                 45.0                [0m[0m  |  [34m[1m    186.7   [0m[0m  |  [34m[1m           40.2        [0m[0m  |  [2m[91m                    55.4                   [0m[0m  |  [34m[1m                            48.1                          [0m[0m  |  [92m[1m                    48.8                  [0m[0m
      2      x 768   |  [92m[1m                 19.7                [0m[0m  |  [34m[1m    193.1   [0m[0m  |  [34m[1m           39.8        [0m[0m  |  [92m[1m                    25.2                   [0m[0m  |  [34m[1m                            48.0                          [0m[0m  |  [34m[1m                    50.4                  [0m[0m
      1      x 768   |                   24.9                  |  [34m[1m    187.5   [0m[0m  |  [92m[1m           38.8        [0m[0m  |                      31.0                     |  [92m[1m                            46.9                          [0m[0m  |  [34m[1m                    50.0                  [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend trace  |  Fine-grained + structured sparsity @ 80 with backend trace  |  Dense benchmark - Compiled - backend trace
32 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                525.3                [0m[0m  |  [31m[1m  66740.8   [0m[0m  |  [31m[1m         1163.5        [0m[0m  |  [31m[1m                   529.0                   [0m[0m  |  [31m[1m                         44609.1                          [0m[0m  |  [31m[1m                  1193.7                  [0m[0m
      1024   x 768   |  [31m[1m                278.8                [0m[0m  |  [31m[1m  33385.0   [0m[0m  |  [31m[1m          636.2        [0m[0m  |  [31m[1m                   283.9                   [0m[0m  |  [31m[1m                         22474.2                          [0m[0m  |  [31m[1m                   639.4                  [0m[0m
      512    x 768   |  [31m[1m                140.6                [0m[0m  |  [31m[1m  16683.3   [0m[0m  |  [31m[1m          302.9        [0m[0m  |  [31m[1m                   141.5                   [0m[0m  |  [31m[1m                         11213.2                          [0m[0m  |  [31m[1m                   301.7                  [0m[0m
      256    x 768   |  [2m[91m                 85.3                [0m[0m  |  [31m[1m   8342.4   [0m[0m  |  [2m[91m          149.1        [0m[0m  |  [2m[91m                    85.5                   [0m[0m  |  [31m[1m                          5642.2                          [0m[0m  |  [2m[91m                   151.2                  [0m[0m
      128    x 768   |  [2m[91m                 48.6                [0m[0m  |  [31m[1m   4181.8   [0m[0m  |  [2m[91m           82.6        [0m[0m  |  [2m[91m                    52.3                   [0m[0m  |  [31m[1m                          2829.0                          [0m[0m  |                      82.8                  
      64     x 768   |                   37.7                  |  [31m[1m   2100.1   [0m[0m  |             53.6          |                      49.1                     |  [31m[1m                          1410.7                          [0m[0m  |  [34m[1m                    53.9                  [0m[0m
      32     x 768   |  [2m[91m                 42.5                [0m[0m  |  [31m[1m   1059.6   [0m[0m  |  [34m[1m           41.0        [0m[0m  |  [2m[91m                    51.4                   [0m[0m  |  [31m[1m                           713.0                          [0m[0m  |  [34m[1m                    50.5                  [0m[0m
      16     x 768   |  [2m[91m                 43.4                [0m[0m  |  [2m[91m    537.9   [0m[0m  |  [34m[1m           40.8        [0m[0m  |  [2m[91m                    54.1                   [0m[0m  |  [31m[1m                           361.7                          [0m[0m  |  [34m[1m                    51.2                  [0m[0m
      8      x 768   |  [2m[91m                 44.6                [0m[0m  |      277.6     |  [34m[1m           40.9        [0m[0m  |  [2m[91m                    55.1                   [0m[0m  |  [2m[91m                           184.7                          [0m[0m  |  [34m[1m                    50.8                  [0m[0m
      4      x 768   |  [2m[91m                 40.1                [0m[0m  |  [34m[1m    189.5   [0m[0m  |  [92m[1m           39.1        [0m[0m  |                      49.2                     |  [2m[91m                            97.2                          [0m[0m  |  [92m[1m                    49.6                  [0m[0m
      2      x 768   |  [92m[1m                 19.9                [0m[0m  |  [92m[1m    186.2   [0m[0m  |  [34m[1m           40.0        [0m[0m  |  [92m[1m                    25.4                   [0m[0m  |                              53.4                            |  [34m[1m                    50.5                  [0m[0m
      1      x 768   |                   24.5                  |  [92m[1m    187.7   [0m[0m  |  [34m[1m           40.5        [0m[0m  |                      30.3                     |  [92m[1m                            46.9                          [0m[0m  |  [92m[1m                    49.7                  [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2048 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               10863.0               [0m[0m  |  [31m[1m  636526.1  [0m[0m  |  [31m[1m        25889.6        [0m[0m  |  [31m[1m                   11298.1                    [0m[0m  |  [31m[1m                           119524.7                          [0m[0m  |  [31m[1m                   25474.1                   [0m[0m
      1024   x 768   |  [31m[1m                6178.1               [0m[0m  |  [31m[1m  334868.0  [0m[0m  |  [31m[1m        13972.6        [0m[0m  |  [31m[1m                    6702.5                    [0m[0m  |  [31m[1m                            58557.2                          [0m[0m  |  [31m[1m                   13980.0                   [0m[0m
      512    x 768   |  [31m[1m                4443.9               [0m[0m  |  [31m[1m  178144.7  [0m[0m  |  [31m[1m         7652.2        [0m[0m  |  [31m[1m                    4828.8                    [0m[0m  |  [31m[1m                            28410.7                          [0m[0m  |  [31m[1m                    7733.3                   [0m[0m
      256    x 768   |  [31m[1m                2727.9               [0m[0m  |  [31m[1m  102115.0  [0m[0m  |  [31m[1m         4734.0        [0m[0m  |  [31m[1m                    2985.0                    [0m[0m  |  [31m[1m                            14039.6                          [0m[0m  |  [31m[1m                    5105.3                   [0m[0m
      128    x 768   |  [31m[1m                3482.5               [0m[0m  |  [31m[1m   45160.8  [0m[0m  |  [31m[1m         3379.0        [0m[0m  |  [31m[1m                    3519.9                    [0m[0m  |  [31m[1m                             7566.3                          [0m[0m  |  [31m[1m                    3631.8                   [0m[0m
      64     x 768   |  [31m[1m                2939.1               [0m[0m  |  [31m[1m   23840.3  [0m[0m  |  [31m[1m         2378.2        [0m[0m  |  [31m[1m                    3398.2                    [0m[0m  |  [31m[1m                             4050.2                          [0m[0m  |  [31m[1m                    2512.4                   [0m[0m
      32     x 768   |  [31m[1m                2812.4               [0m[0m  |  [31m[1m   13569.5  [0m[0m  |  [31m[1m         1755.3        [0m[0m  |  [31m[1m                    2998.2                    [0m[0m  |  [31m[1m                             2030.1                          [0m[0m  |  [31m[1m                    1898.9                   [0m[0m
      16     x 768   |  [31m[1m                1996.3               [0m[0m  |  [2m[91m    7872.3  [0m[0m  |  [31m[1m         1512.2        [0m[0m  |  [31m[1m                    1972.7                    [0m[0m  |  [31m[1m                             1005.6                          [0m[0m  |  [2m[91m                    1614.0                   [0m[0m
      8      x 768   |                   238.2                 |  [2m[91m    5059.5  [0m[0m  |            436.4          |  [34m[1m                     378.5                    [0m[0m  |  [2m[91m                              586.7                          [0m[0m  |                       527.4                   
      4      x 768   |                   207.5                 |  [2m[91m    3312.2  [0m[0m  |            358.8          |  [34m[1m                     374.9                    [0m[0m  |  [2m[91m                              331.7                          [0m[0m  |                       437.3                   
      2      x 768   |  [34m[1m                 190.8               [0m[0m  |      2199.2    |  [34m[1m          264.4        [0m[0m  |  [34m[1m                     366.2                    [0m[0m  |                                201.4                            |  [34m[1m                     338.0                   [0m[0m
      1      x 768   |  [92m[1m                 181.8               [0m[0m  |  [92m[1m    1612.1  [0m[0m  |  [92m[1m          250.0        [0m[0m  |  [92m[1m                     349.5                    [0m[0m  |  [92m[1m                              138.5                          [0m[0m  |  [92m[1m                     327.9                   [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               11250.0               [0m[0m  |  [31m[1m 1256245.9  [0m[0m  |  [31m[1m        25849.2        [0m[0m  |  [31m[1m                   11646.3                    [0m[0m  |  [31m[1m                           272162.7                          [0m[0m  |  [31m[1m                   25682.2                   [0m[0m
      1024   x 768   |  [31m[1m                6428.7               [0m[0m  |  [31m[1m  623190.4  [0m[0m  |  [31m[1m        13648.3        [0m[0m  |  [31m[1m                    6827.3                    [0m[0m  |  [31m[1m                           113581.8                          [0m[0m  |  [31m[1m                   14223.7                   [0m[0m
      512    x 768   |  [31m[1m                4551.3               [0m[0m  |  [31m[1m  334378.0  [0m[0m  |  [31m[1m         7685.6        [0m[0m  |  [31m[1m                    5007.3                    [0m[0m  |  [31m[1m                            62537.6                          [0m[0m  |  [31m[1m                    7747.6                   [0m[0m
      256    x 768   |  [31m[1m                2877.9               [0m[0m  |  [31m[1m  182203.8  [0m[0m  |  [31m[1m         4923.0        [0m[0m  |  [31m[1m                    3192.8                    [0m[0m  |  [31m[1m                            34073.0                          [0m[0m  |  [31m[1m                    5175.5                   [0m[0m
      128    x 768   |  [31m[1m                3486.3               [0m[0m  |  [31m[1m  103943.8  [0m[0m  |  [31m[1m         3374.2        [0m[0m  |  [31m[1m                    3632.3                    [0m[0m  |  [31m[1m                            14399.8                          [0m[0m  |  [31m[1m                    3481.0                   [0m[0m
      64     x 768   |  [31m[1m                3273.8               [0m[0m  |  [31m[1m   47606.4  [0m[0m  |  [31m[1m         2337.1        [0m[0m  |  [31m[1m                    3388.4                    [0m[0m  |  [31m[1m                             8602.8                          [0m[0m  |  [31m[1m                    2519.5                   [0m[0m
      32     x 768   |  [31m[1m                2923.7               [0m[0m  |  [31m[1m   23999.9  [0m[0m  |  [31m[1m         1772.3        [0m[0m  |  [31m[1m                    3158.5                    [0m[0m  |  [31m[1m                             4048.2                          [0m[0m  |  [31m[1m                    1896.2                   [0m[0m
      16     x 768   |  [31m[1m                2068.5               [0m[0m  |  [2m[91m    9610.4  [0m[0m  |  [31m[1m         1495.3        [0m[0m  |  [31m[1m                    2000.2                    [0m[0m  |  [31m[1m                             1866.8                          [0m[0m  |  [2m[91m                    1637.8                   [0m[0m
      8      x 768   |                   254.2                 |  [2m[91m    7787.8  [0m[0m  |            440.9          |                       421.2                      |  [31m[1m                             1042.0                          [0m[0m  |                       527.5                   
      4      x 768   |                   222.7                 |  [2m[91m    5138.1  [0m[0m  |            354.9          |                       392.0                      |  [2m[91m                              620.3                          [0m[0m  |                       437.5                   
      2      x 768   |                   205.3                 |      3291.4    |  [34m[1m          266.4        [0m[0m  |  [34m[1m                     376.6                    [0m[0m  |                                356.4                            |  [34m[1m                     341.1                   [0m[0m
      1      x 768   |  [92m[1m                 182.9               [0m[0m  |  [92m[1m    2137.0  [0m[0m  |  [92m[1m          253.1        [0m[0m  |  [92m[1m                     350.1                    [0m[0m  |  [92m[1m                              203.4                          [0m[0m  |  [92m[1m                     331.8                   [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2048 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                398.6                [0m[0m  |  [31m[1m  23927.2   [0m[0m  |  [31m[1m         1034.2        [0m[0m  |  [31m[1m                    429.6                     [0m[0m  |  [31m[1m                            6306.5                           [0m[0m  |  [31m[1m                    1047.7                   [0m[0m
      1024   x 768   |  [31m[1m                219.1                [0m[0m  |  [31m[1m  11949.1   [0m[0m  |  [31m[1m          552.7        [0m[0m  |  [2m[91m                    233.8                     [0m[0m  |  [31m[1m                            3166.8                           [0m[0m  |  [31m[1m                     558.2                   [0m[0m
      512    x 768   |  [31m[1m                117.4                [0m[0m  |  [31m[1m   5931.8   [0m[0m  |  [31m[1m          268.0        [0m[0m  |  [2m[91m                    129.6                     [0m[0m  |  [31m[1m                            1621.8                           [0m[0m  |  [2m[91m                     273.7                   [0m[0m
      256    x 768   |  [2m[91m                 76.9                [0m[0m  |  [31m[1m   2998.7   [0m[0m  |  [2m[91m          143.5        [0m[0m  |                       84.8                       |  [31m[1m                             822.4                           [0m[0m  |  [2m[91m                     142.7                   [0m[0m
      128    x 768   |  [2m[91m                 43.5                [0m[0m  |  [31m[1m   1504.4   [0m[0m  |  [2m[91m           79.6        [0m[0m  |  [92m[1m                     64.2                     [0m[0m  |  [31m[1m                             418.4                           [0m[0m  |                        80.0                   
      64     x 768   |  [2m[91m                 42.8                [0m[0m  |  [2m[91m    768.3   [0m[0m  |             51.5          |  [92m[1m                     64.2                     [0m[0m  |  [2m[91m                             212.7                           [0m[0m  |  [92m[1m                      68.6                   [0m[0m
      32     x 768   |  [2m[91m                 42.9                [0m[0m  |  [2m[91m    393.8   [0m[0m  |  [34m[1m           40.7        [0m[0m  |  [92m[1m                     64.7                     [0m[0m  |                               119.9                             |  [34m[1m                      73.5                   [0m[0m
      16     x 768   |  [2m[91m                 45.0                [0m[0m  |      208.3     |  [34m[1m           40.8        [0m[0m  |  [92m[1m                     64.7                     [0m[0m  |  [34m[1m                              68.3                           [0m[0m  |  [34m[1m                      73.0                   [0m[0m
      8      x 768   |  [2m[91m                 44.4                [0m[0m  |  [34m[1m    201.1   [0m[0m  |  [34m[1m           42.7        [0m[0m  |  [34m[1m                     66.1                     [0m[0m  |  [34m[1m                              66.6                           [0m[0m  |  [34m[1m                      71.1                   [0m[0m
      4      x 768   |  [2m[91m                 45.2                [0m[0m  |  [92m[1m    186.6   [0m[0m  |  [34m[1m           40.0        [0m[0m  |  [34m[1m                     65.2                     [0m[0m  |  [92m[1m                              64.8                           [0m[0m  |  [92m[1m                      68.7                   [0m[0m
      2      x 768   |  [92m[1m                 19.7                [0m[0m  |  [34m[1m    189.4   [0m[0m  |  [92m[1m           39.3        [0m[0m  |  [92m[1m                     64.4                     [0m[0m  |  [34m[1m                              65.9                           [0m[0m  |  [92m[1m                      69.3                   [0m[0m
      1      x 768   |                   25.3                  |  [92m[1m    184.8   [0m[0m  |  [34m[1m           40.6        [0m[0m  |  [34m[1m                     64.9                     [0m[0m  |  [92m[1m                              65.3                           [0m[0m  |  [34m[1m                      70.3                   [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                499.9                [0m[0m  |  [31m[1m  66667.5   [0m[0m  |  [31m[1m         1137.2        [0m[0m  |  [31m[1m                    525.9                     [0m[0m  |  [31m[1m                           15263.3                           [0m[0m  |  [31m[1m                    1144.8                   [0m[0m
      1024   x 768   |  [31m[1m                268.8                [0m[0m  |  [31m[1m  33338.1   [0m[0m  |  [31m[1m          613.3        [0m[0m  |  [2m[91m                    281.6                     [0m[0m  |  [31m[1m                            7725.5                           [0m[0m  |  [31m[1m                     619.8                   [0m[0m
      512    x 768   |  [31m[1m                138.8                [0m[0m  |  [31m[1m  16688.8   [0m[0m  |  [31m[1m          294.1        [0m[0m  |  [2m[91m                    150.4                     [0m[0m  |  [31m[1m                            3888.8                           [0m[0m  |  [2m[91m                     295.1                   [0m[0m
      256    x 768   |  [2m[91m                 83.6                [0m[0m  |  [31m[1m   8349.8   [0m[0m  |  [2m[91m          147.7        [0m[0m  |                       90.3                       |  [31m[1m                            1870.1                           [0m[0m  |  [2m[91m                     149.0                   [0m[0m
      128    x 768   |  [2m[91m                 48.4                [0m[0m  |  [31m[1m   4186.8   [0m[0m  |  [2m[91m           82.1        [0m[0m  |  [34m[1m                     66.1                     [0m[0m  |  [31m[1m                             941.7                           [0m[0m  |                        82.5                   
      64     x 768   |                   38.8                  |  [31m[1m   2104.0   [0m[0m  |             53.5          |  [34m[1m                     65.1                     [0m[0m  |  [31m[1m                             491.9                           [0m[0m  |  [92m[1m                      68.2                   [0m[0m
      32     x 768   |  [2m[91m                 41.4                [0m[0m  |  [31m[1m   1060.0   [0m[0m  |  [34m[1m           41.2        [0m[0m  |  [34m[1m                     66.0                     [0m[0m  |  [2m[91m                             246.1                           [0m[0m  |                        77.6                   
      16     x 768   |  [2m[91m                 44.9                [0m[0m  |  [2m[91m    537.1   [0m[0m  |  [34m[1m           41.5        [0m[0m  |  [34m[1m                     64.9                     [0m[0m  |                               125.7                             |  [34m[1m                      73.5                   [0m[0m
      8      x 768   |  [2m[91m                 43.6                [0m[0m  |      277.6     |  [34m[1m           41.5        [0m[0m  |  [92m[1m                     64.1                     [0m[0m  |                                74.8                             |  [34m[1m                      70.9                   [0m[0m
      4      x 768   |                   39.7                  |  [34m[1m    186.6   [0m[0m  |  [34m[1m           40.3        [0m[0m  |  [92m[1m                     64.5                     [0m[0m  |  [92m[1m                              64.8                           [0m[0m  |  [92m[1m                      68.7                   [0m[0m
      2      x 768   |  [92m[1m                 19.9                [0m[0m  |  [92m[1m    184.3   [0m[0m  |  [92m[1m           39.2        [0m[0m  |  [34m[1m                     66.2                     [0m[0m  |  [34m[1m                              66.5                           [0m[0m  |  [34m[1m                      69.6                   [0m[0m
      1      x 768   |                   24.9                  |  [92m[1m    185.0   [0m[0m  |  [34m[1m           41.4        [0m[0m  |  [34m[1m                     65.4                     [0m[0m  |  [34m[1m                              65.7                           [0m[0m  |  [34m[1m                      71.8                   [0m[0m

Times are in microseconds (us).
