/home/user/condensed-sparsity/src/condensed_sparsity/v2/condensed_linear.py:142: UserWarning: Sparse CSR tensor support is in beta state. If you miss a functionality in the sparse tensor support, please submit a feature request to https://github.com/pytorch/pytorch/issues. (Triggered internally at ../aten/src/ATen/SparseCsrTensorImpl.cpp:54.)
  torch.clone(self.weight.detach().type(dtype).to_sparse_csr()),
/home/user/build/.venv/lib/python3.10/site-packages/torch/jit/_script.py:1241: UserWarning: `optimize` is deprecated and has no effect. Use `with torch.jit.optimized_execution() instead
  warnings.warn(
Benchmarking batch size 2048 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 512 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 256 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 128 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 64 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 32 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 16 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 8 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 4 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 2 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 1 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 2048 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 512 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 256 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 128 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 64 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 32 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 16 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 8 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 4 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 2 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 1 with sparsity 80 num_threads 1 with compiler script using backend script
[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 1 threads  -----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend script  |  Fine-grained + structured sparsity @ 90 with backend script  |  Dense benchmark - Compiled - backend script
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               45035.8               [0m[0m  |  [31m[1m 5044032.7  [0m[0m  |  [31m[1m        115032.5       [0m[0m  |  [31m[1m                  44379.0                   [0m[0m  |  [31m[1m                         4642869.4                         [0m[0m  |  [31m[1m                  119846.6                 [0m[0m
      1024   x 768   |  [31m[1m               22471.2               [0m[0m  |  [31m[1m 2321497.4  [0m[0m  |  [31m[1m         57348.1       [0m[0m  |  [31m[1m                  22181.1                   [0m[0m  |  [31m[1m                         2395284.6                         [0m[0m  |  [31m[1m                   59986.8                 [0m[0m
      512    x 768   |  [31m[1m               11292.5               [0m[0m  |  [31m[1m 1154057.6  [0m[0m  |  [31m[1m         28500.1       [0m[0m  |  [31m[1m                  11180.1                   [0m[0m  |  [31m[1m                         1148598.5                         [0m[0m  |  [31m[1m                   29149.8                 [0m[0m
      256    x 768   |  [31m[1m                5714.6               [0m[0m  |  [31m[1m  582485.9  [0m[0m  |  [31m[1m         15904.0       [0m[0m  |  [31m[1m                   6255.6                   [0m[0m  |  [31m[1m                          591258.4                         [0m[0m  |  [31m[1m                   16003.9                 [0m[0m
      128    x 768   |  [31m[1m                3179.5               [0m[0m  |  [31m[1m  237477.0  [0m[0m  |  [31m[1m          8236.9       [0m[0m  |  [31m[1m                   3194.2                   [0m[0m  |  [31m[1m                          293206.4                         [0m[0m  |  [31m[1m                    8403.5                 [0m[0m
      64     x 768   |  [31m[1m                1739.4               [0m[0m  |  [31m[1m   93772.0  [0m[0m  |  [31m[1m          4458.2       [0m[0m  |  [31m[1m                   1567.4                   [0m[0m  |  [31m[1m                          146784.0                         [0m[0m  |  [31m[1m                    5719.3                 [0m[0m
      32     x 768   |  [31m[1m                 954.6               [0m[0m  |  [31m[1m   44612.8  [0m[0m  |  [31m[1m          2429.3       [0m[0m  |  [31m[1m                    919.5                   [0m[0m  |  [31m[1m                           57880.2                         [0m[0m  |  [31m[1m                    2967.8                 [0m[0m
      16     x 768   |  [2m[91m                 588.8               [0m[0m  |  [31m[1m   20294.4  [0m[0m  |  [2m[91m          1542.8       [0m[0m  |  [2m[91m                    662.9                   [0m[0m  |  [31m[1m                           20355.8                         [0m[0m  |  [2m[91m                    1522.8                 [0m[0m
      8      x 768   |  [2m[91m                 440.6               [0m[0m  |  [31m[1m    9856.5  [0m[0m  |  [2m[91m          1108.1       [0m[0m  |  [2m[91m                    451.2                   [0m[0m  |  [31m[1m                            9670.4                         [0m[0m  |  [2m[91m                     990.0                 [0m[0m
      4      x 768   |  [2m[91m                 336.7               [0m[0m  |  [2m[91m    5074.5  [0m[0m  |  [2m[91m           848.8       [0m[0m  |                      259.0                     |  [2m[91m                            4744.9                         [0m[0m  |                       479.2                 
      2      x 768   |  [2m[91m                 304.5               [0m[0m  |      2604.8    |  [2m[91m           773.9       [0m[0m  |                      260.9                     |                              2423.9                           |                       467.3                 
      1      x 768   |  [92m[1m                 138.9               [0m[0m  |  [92m[1m    1440.5  [0m[0m  |  [92m[1m           317.6       [0m[0m  |  [92m[1m                    133.9                   [0m[0m  |  [92m[1m                            1244.4                         [0m[0m  |  [92m[1m                     334.2                 [0m[0m

Times are in microseconds (us).

[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 1 threads  -----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend script  |  Fine-grained + structured sparsity @ 80 with backend script  |  Dense benchmark - Compiled - backend script
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               45182.0               [0m[0m  |  [31m[1m 9525673.4  [0m[0m  |  [31m[1m        116985.1       [0m[0m  |  [31m[1m                  46308.9                   [0m[0m  |  [31m[1m                         10284070.5                        [0m[0m  |  [31m[1m                  117983.9                 [0m[0m
      1024   x 768   |  [31m[1m               22980.1               [0m[0m  |  [31m[1m 5140376.7  [0m[0m  |  [31m[1m         56166.2       [0m[0m  |  [31m[1m                  22576.8                   [0m[0m  |  [31m[1m                          4858511.3                        [0m[0m  |  [31m[1m                   60168.5                 [0m[0m
      512    x 768   |  [31m[1m               11371.1               [0m[0m  |  [31m[1m 2320176.5  [0m[0m  |  [31m[1m         29054.4       [0m[0m  |  [31m[1m                  11594.8                   [0m[0m  |  [31m[1m                          2683315.2                        [0m[0m  |  [31m[1m                   29304.3                 [0m[0m
      256    x 768   |  [31m[1m                6381.3               [0m[0m  |  [31m[1m 1324558.0  [0m[0m  |  [31m[1m         16010.6       [0m[0m  |  [31m[1m                   6432.3                   [0m[0m  |  [31m[1m                          1360498.8                        [0m[0m  |  [31m[1m                   16098.2                 [0m[0m
      128    x 768   |  [31m[1m                3488.8               [0m[0m  |  [31m[1m  581210.1  [0m[0m  |  [31m[1m          8505.0       [0m[0m  |  [31m[1m                   3316.9                   [0m[0m  |  [31m[1m                           581202.7                        [0m[0m  |  [31m[1m                    8316.5                 [0m[0m
      64     x 768   |  [31m[1m                1791.0               [0m[0m  |  [31m[1m  294881.1  [0m[0m  |  [31m[1m          4492.7       [0m[0m  |  [31m[1m                   1585.4                   [0m[0m  |  [31m[1m                           343157.6                        [0m[0m  |  [31m[1m                    5458.5                 [0m[0m
      32     x 768   |  [31m[1m                1136.2               [0m[0m  |  [31m[1m  149091.8  [0m[0m  |  [31m[1m          2449.2       [0m[0m  |  [31m[1m                    870.7                   [0m[0m  |  [31m[1m                           152095.9                        [0m[0m  |  [31m[1m                    3012.0                 [0m[0m
      16     x 768   |  [2m[91m                 626.2               [0m[0m  |  [31m[1m   47974.3  [0m[0m  |  [2m[91m          1549.5       [0m[0m  |  [2m[91m                    556.6                   [0m[0m  |  [31m[1m                            58061.6                        [0m[0m  |  [2m[91m                    1496.5                 [0m[0m
      8      x 768   |  [2m[91m                 450.8               [0m[0m  |  [31m[1m   19976.9  [0m[0m  |  [2m[91m          1102.5       [0m[0m  |  [2m[91m                    396.5                   [0m[0m  |  [31m[1m                            20142.2                        [0m[0m  |  [2m[91m                    1007.5                 [0m[0m
      4      x 768   |  [2m[91m                 353.1               [0m[0m  |  [2m[91m    9669.8  [0m[0m  |  [2m[91m           856.3       [0m[0m  |                      243.4                     |  [2m[91m                             9560.7                        [0m[0m  |                       495.8                 
      2      x 768   |  [2m[91m                 333.6               [0m[0m  |      4937.6    |  [2m[91m           782.0       [0m[0m  |                      226.9                     |  [2m[91m                             4736.2                        [0m[0m  |                       468.8                 
      1      x 768   |  [92m[1m                 147.5               [0m[0m  |  [92m[1m    2568.2  [0m[0m  |  [92m[1m           318.1       [0m[0m  |  [92m[1m                    142.6                   [0m[0m  |  [92m[1m                             2307.7                        [0m[0m  |  [92m[1m                     337.2                 [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 512 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 256 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 128 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 64 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 32 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 16 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 8 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 4 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 2 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 1 with sparsity 90 num_threads 1 with compiler script using backend script
Benchmarking batch size 2048 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 512 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 256 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 128 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 64 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 32 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 16 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 8 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 4 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 2 with sparsity 80 num_threads 1 with compiler script using backend script
Benchmarking batch size 1 with sparsity 80 num_threads 1 with compiler script using backend script
[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 1 threads  -----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend script  |  Fine-grained + structured sparsity @ 90 with backend script  |  Dense benchmark - Compiled - backend script
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                270.9                [0m[0m  |  [31m[1m  11531.3   [0m[0m  |  [31m[1m         643.1         [0m[0m  |  [2m[91m                   222.2                    [0m[0m  |  [31m[1m                           9110.5                          [0m[0m  |  [31m[1m                   647.5                   [0m[0m
      1024   x 768   |  [2m[91m                147.2                [0m[0m  |  [31m[1m   5863.5   [0m[0m  |  [31m[1m         328.6         [0m[0m  |                     131.5                      |  [31m[1m                           4547.0                          [0m[0m  |  [31m[1m                   337.1                   [0m[0m
      512    x 768   |                   72.1                  |  [31m[1m   2934.6   [0m[0m  |  [2m[91m         167.7         [0m[0m  |                      76.4                      |  [31m[1m                           2309.5                          [0m[0m  |  [2m[91m                   187.9                   [0m[0m
      256    x 768   |                   66.6                  |  [2m[91m   1483.0   [0m[0m  |            91.3           |  [34m[1m                    71.5                    [0m[0m  |  [31m[1m                           1146.2                          [0m[0m  |                      93.6                   
      128    x 768   |                   63.2                  |  [2m[91m    759.8   [0m[0m  |  [34m[1m          66.9         [0m[0m  |                      74.8                      |  [2m[91m                            587.9                          [0m[0m  |                      75.8                   
      64     x 768   |                   67.5                  |      367.9     |  [34m[1m          67.8         [0m[0m  |                      74.4                      |  [2m[91m                            308.6                          [0m[0m  |                      75.9                   
      32     x 768   |                   68.0                  |  [34m[1m    340.9   [0m[0m  |  [34m[1m          69.0         [0m[0m  |                      73.9                      |                              181.0                            |                      76.9                   
      16     x 768   |                   71.1                  |  [34m[1m    342.2   [0m[0m  |  [34m[1m          72.2         [0m[0m  |                      76.4                      |  [34m[1m                            137.6                          [0m[0m  |                      76.3                   
      8      x 768   |                   71.4                  |  [34m[1m    341.0   [0m[0m  |            72.5           |                      76.1                      |  [34m[1m                            137.1                          [0m[0m  |                      75.2                   
      4      x 768   |                   73.6                  |  [34m[1m    358.0   [0m[0m  |  [92m[1m          65.7         [0m[0m  |                      77.4                      |  [34m[1m                            137.0                          [0m[0m  |  [34m[1m                    69.4                   [0m[0m
      2      x 768   |  [92m[1m                 54.1                [0m[0m  |  [34m[1m    340.0   [0m[0m  |  [92m[1m          66.1         [0m[0m  |  [34m[1m                    69.2                    [0m[0m  |  [34m[1m                            137.2                          [0m[0m  |  [34m[1m                    69.2                   [0m[0m
      1      x 768   |                   62.5                  |  [92m[1m    333.6   [0m[0m  |  [92m[1m          66.0         [0m[0m  |  [92m[1m                    66.8                    [0m[0m  |  [92m[1m                            135.6                          [0m[0m  |  [92m[1m                    67.2                   [0m[0m

Times are in microseconds (us).

[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 1 threads  -----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend script  |  Fine-grained + structured sparsity @ 80 with backend script  |  Dense benchmark - Compiled - backend script
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                297.8                [0m[0m  |  [31m[1m  26774.7   [0m[0m  |  [31m[1m         682.8         [0m[0m  |  [2m[91m                   232.1                    [0m[0m  |  [31m[1m                          20094.2                          [0m[0m  |  [31m[1m                   662.6                   [0m[0m
      1024   x 768   |  [2m[91m                153.6                [0m[0m  |  [31m[1m  13510.2   [0m[0m  |  [31m[1m         339.6         [0m[0m  |  [2m[91m                   139.9                    [0m[0m  |  [31m[1m                          10081.0                          [0m[0m  |  [31m[1m                   342.5                   [0m[0m
      512    x 768   |                   76.9                  |  [31m[1m   6685.8   [0m[0m  |  [2m[91m         171.9         [0m[0m  |                      79.6                      |  [31m[1m                           5079.2                          [0m[0m  |  [2m[91m                   193.0                   [0m[0m
      256    x 768   |                   47.9                  |  [31m[1m   3399.2   [0m[0m  |            93.6           |                      55.6                      |  [31m[1m                           2559.4                          [0m[0m  |                      96.1                   
      128    x 768   |                   48.5                  |  [31m[1m   1705.0   [0m[0m  |            58.5           |                      56.4                      |  [31m[1m                           1297.1                          [0m[0m  |                      56.1                   
      64     x 768   |                   51.7                  |  [2m[91m    863.4   [0m[0m  |  [34m[1m          51.1         [0m[0m  |                      54.5                      |  [31m[1m                            669.0                          [0m[0m  |                      55.2                   
      32     x 768   |                   52.8                  |      447.0     |  [34m[1m          52.3         [0m[0m  |                      54.7                      |  [2m[91m                            354.9                          [0m[0m  |                      56.2                   
      16     x 768   |                   55.4                  |  [34m[1m    288.4   [0m[0m  |            54.6           |                      54.0                      |                              202.2                            |                      55.7                   
      8      x 768   |                   55.9                  |  [34m[1m    291.7   [0m[0m  |            55.3           |                      54.0                      |                              128.9                            |                      55.4                   
      4      x 768   |                   55.1                  |  [92m[1m    286.9   [0m[0m  |  [92m[1m          48.4         [0m[0m  |  [34m[1m                    49.1                    [0m[0m  |  [34m[1m                            111.8                          [0m[0m  |  [34m[1m                    50.0                   [0m[0m
      2      x 768   |  [92m[1m                 39.3                [0m[0m  |  [34m[1m    289.0   [0m[0m  |  [34m[1m          49.8         [0m[0m  |  [34m[1m                    49.1                    [0m[0m  |  [34m[1m                            112.0                          [0m[0m  |  [34m[1m                    49.1                   [0m[0m
      1      x 768   |                   47.0                  |  [92m[1m    284.7   [0m[0m  |  [34m[1m          51.2         [0m[0m  |  [92m[1m                    47.9                    [0m[0m  |  [92m[1m                            110.3                          [0m[0m  |  [92m[1m                    48.1                   [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 2048 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 80 num_threads 1 with compiler trace using backend trace
[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 1 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend trace  |  Fine-grained + structured sparsity @ 90 with backend trace  |  Dense benchmark - Compiled - backend trace
1 threads: -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               43961.3               [0m[0m  |  [31m[1m 4633296.6  [0m[0m  |  [31m[1m        114015.0       [0m[0m  |  [31m[1m                  45410.5                  [0m[0m  |  [31m[1m                        4886117.2                         [0m[0m  |  [31m[1m                 118010.0                 [0m[0m
      1024   x 768   |  [31m[1m               22388.2               [0m[0m  |  [31m[1m 2316340.0  [0m[0m  |  [31m[1m         57395.2       [0m[0m  |  [31m[1m                  22343.2                  [0m[0m  |  [31m[1m                        2309308.5                         [0m[0m  |  [31m[1m                  59914.0                 [0m[0m
      512    x 768   |  [31m[1m               11218.6               [0m[0m  |  [31m[1m 1163200.2  [0m[0m  |  [31m[1m         28421.7       [0m[0m  |  [31m[1m                  11287.6                  [0m[0m  |  [31m[1m                        1169910.4                         [0m[0m  |  [31m[1m                  28880.7                 [0m[0m
      256    x 768   |  [31m[1m                6149.5               [0m[0m  |  [31m[1m  575269.0  [0m[0m  |  [31m[1m         14390.7       [0m[0m  |  [31m[1m                   6223.4                  [0m[0m  |  [31m[1m                         587117.6                         [0m[0m  |  [31m[1m                  14450.2                 [0m[0m
      128    x 768   |  [31m[1m                3157.0               [0m[0m  |  [31m[1m  291477.9  [0m[0m  |  [31m[1m          8405.9       [0m[0m  |  [31m[1m                   3184.8                  [0m[0m  |  [31m[1m                         291294.4                         [0m[0m  |  [31m[1m                   8196.5                 [0m[0m
      64     x 768   |  [31m[1m                1709.5               [0m[0m  |  [31m[1m  149500.3  [0m[0m  |  [31m[1m          4337.4       [0m[0m  |  [31m[1m                   1717.3                  [0m[0m  |  [31m[1m                         149159.4                         [0m[0m  |  [31m[1m                   4489.5                 [0m[0m
      32     x 768   |  [31m[1m                 942.4               [0m[0m  |  [31m[1m   43813.2  [0m[0m  |  [31m[1m          2433.8       [0m[0m  |  [31m[1m                    948.3                  [0m[0m  |  [31m[1m                          55392.2                         [0m[0m  |  [31m[1m                   2451.6                 [0m[0m
      16     x 768   |  [2m[91m                 584.2               [0m[0m  |  [31m[1m   19537.1  [0m[0m  |  [31m[1m          1509.5       [0m[0m  |  [2m[91m                    600.3                  [0m[0m  |  [31m[1m                          20483.3                         [0m[0m  |  [2m[91m                   1512.0                 [0m[0m
      8      x 768   |  [2m[91m                 421.9               [0m[0m  |  [31m[1m    9841.2  [0m[0m  |  [2m[91m          1102.4       [0m[0m  |  [2m[91m                    438.5                  [0m[0m  |  [31m[1m                           9605.2                         [0m[0m  |  [2m[91m                   1095.6                 [0m[0m
      4      x 768   |  [2m[91m                 331.0               [0m[0m  |  [2m[91m    5027.3  [0m[0m  |  [2m[91m           834.9       [0m[0m  |  [2m[91m                    349.5                  [0m[0m  |  [2m[91m                           4772.5                         [0m[0m  |  [2m[91m                    846.3                 [0m[0m
      2      x 768   |  [2m[91m                 295.8               [0m[0m  |      2575.4    |  [2m[91m           752.3       [0m[0m  |  [2m[91m                    308.6                  [0m[0m  |                             2458.0                           |  [2m[91m                    797.8                 [0m[0m
      1      x 768   |  [92m[1m                 132.8               [0m[0m  |  [92m[1m    1442.1  [0m[0m  |  [92m[1m           297.4       [0m[0m  |  [92m[1m                    149.5                  [0m[0m  |  [92m[1m                           1257.7                         [0m[0m  |  [92m[1m                    320.0                 [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 1 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend trace  |  Fine-grained + structured sparsity @ 80 with backend trace  |  Dense benchmark - Compiled - backend trace
1 threads: -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               44264.1               [0m[0m  |  [31m[1m 9380944.0  [0m[0m  |  [31m[1m        117629.6       [0m[0m  |  [31m[1m                  46303.2                  [0m[0m  |  [31m[1m                        9451986.4                         [0m[0m  |  [31m[1m                 116502.3                 [0m[0m
      1024   x 768   |  [31m[1m               22891.1               [0m[0m  |  [31m[1m 4624595.6  [0m[0m  |  [31m[1m         58046.8       [0m[0m  |  [31m[1m                  22693.8                  [0m[0m  |  [31m[1m                        4665264.7                         [0m[0m  |  [31m[1m                  58742.5                 [0m[0m
      512    x 768   |  [31m[1m               11607.6               [0m[0m  |  [31m[1m 2304883.3  [0m[0m  |  [31m[1m         29760.6       [0m[0m  |  [31m[1m                  11567.7                  [0m[0m  |  [31m[1m                        2302271.5                         [0m[0m  |  [31m[1m                  28796.8                 [0m[0m
      256    x 768   |  [31m[1m                6451.3               [0m[0m  |  [31m[1m 1166566.6  [0m[0m  |  [31m[1m         16005.0       [0m[0m  |  [31m[1m                   6421.6                  [0m[0m  |  [31m[1m                        1498578.4                         [0m[0m  |  [31m[1m                  15879.9                 [0m[0m
      128    x 768   |  [31m[1m                3375.8               [0m[0m  |  [31m[1m  674431.7  [0m[0m  |  [31m[1m          8390.9       [0m[0m  |  [31m[1m                   3329.3                  [0m[0m  |  [31m[1m                         679109.7                         [0m[0m  |  [31m[1m                   8338.0                 [0m[0m
      64     x 768   |  [31m[1m                1814.2               [0m[0m  |  [31m[1m  316170.0  [0m[0m  |  [31m[1m          4469.1       [0m[0m  |  [31m[1m                   1834.9                  [0m[0m  |  [31m[1m                         342788.9                         [0m[0m  |  [31m[1m                   4445.1                 [0m[0m
      32     x 768   |  [31m[1m                 992.9               [0m[0m  |  [31m[1m  164542.6  [0m[0m  |  [31m[1m          2466.6       [0m[0m  |  [31m[1m                   1003.5                  [0m[0m  |  [31m[1m                         175811.5                         [0m[0m  |  [31m[1m                   2493.2                 [0m[0m
      16     x 768   |  [2m[91m                 615.1               [0m[0m  |  [31m[1m   49431.6  [0m[0m  |  [31m[1m          1550.6       [0m[0m  |  [2m[91m                    643.4                  [0m[0m  |  [31m[1m                          58443.1                         [0m[0m  |  [31m[1m                   1547.8                 [0m[0m
      8      x 768   |  [2m[91m                 459.3               [0m[0m  |  [31m[1m   20383.8  [0m[0m  |  [2m[91m          1114.0       [0m[0m  |  [2m[91m                    462.9                  [0m[0m  |  [31m[1m                          19866.9                         [0m[0m  |  [2m[91m                   1125.3                 [0m[0m
      4      x 768   |  [2m[91m                 365.8               [0m[0m  |  [2m[91m   10150.2  [0m[0m  |  [2m[91m           875.0       [0m[0m  |  [2m[91m                    379.9                  [0m[0m  |  [2m[91m                           9487.4                         [0m[0m  |  [2m[91m                    859.7                 [0m[0m
      2      x 768   |  [2m[91m                 314.7               [0m[0m  |      4970.8    |  [2m[91m           782.7       [0m[0m  |  [2m[91m                    327.3                  [0m[0m  |  [2m[91m                           4814.3                         [0m[0m  |  [2m[91m                    781.2                 [0m[0m
      1      x 768   |  [92m[1m                 128.7               [0m[0m  |  [92m[1m    2574.3  [0m[0m  |  [92m[1m           292.4       [0m[0m  |  [92m[1m                    139.1                  [0m[0m  |  [92m[1m                           2406.8                         [0m[0m  |  [92m[1m                    302.3                 [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 90 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 2048 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 80 num_threads 1 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 80 num_threads 1 with compiler trace using backend trace
[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 1 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend trace  |  Fine-grained + structured sparsity @ 90 with backend trace  |  Dense benchmark - Compiled - backend trace
1 threads: -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                279.1                [0m[0m  |  [31m[1m  11687.8   [0m[0m  |  [31m[1m         654.0         [0m[0m  |  [2m[91m                   282.8                   [0m[0m  |  [31m[1m                          9617.7                          [0m[0m  |  [31m[1m                  647.3                   [0m[0m
      1024   x 768   |  [2m[91m                146.7                [0m[0m  |  [31m[1m   5862.0   [0m[0m  |  [31m[1m         326.4         [0m[0m  |  [2m[91m                   146.1                   [0m[0m  |  [31m[1m                          4776.8                          [0m[0m  |  [2m[91m                  330.1                   [0m[0m
      512    x 768   |                   74.7                  |  [31m[1m   2972.4   [0m[0m  |  [2m[91m         168.2         [0m[0m  |                      84.6                     |  [31m[1m                          2440.8                          [0m[0m  |  [2m[91m                  167.8                   [0m[0m
      256    x 768   |                   67.5                  |  [2m[91m   1486.7   [0m[0m  |            91.5           |                      83.5                     |  [31m[1m                          1208.4                          [0m[0m  |                     91.9                   
      128    x 768   |                   65.2                  |  [2m[91m    762.4   [0m[0m  |  [34m[1m          67.7         [0m[0m  |                      79.4                     |  [31m[1m                           596.6                          [0m[0m  |  [34m[1m                   84.6                   [0m[0m
      64     x 768   |                   68.3                  |  [34m[1m    369.4   [0m[0m  |  [34m[1m          67.7         [0m[0m  |                      85.1                     |  [2m[91m                           291.6                          [0m[0m  |  [34m[1m                   84.1                   [0m[0m
      32     x 768   |                   68.5                  |  [34m[1m    345.1   [0m[0m  |  [34m[1m          68.9         [0m[0m  |                      85.2                     |                             148.9                            |  [34m[1m                   86.2                   [0m[0m
      16     x 768   |                   71.6                  |  [34m[1m    341.6   [0m[0m  |            72.8           |                      88.3                     |  [34m[1m                           113.7                          [0m[0m  |  [34m[1m                   89.2                   [0m[0m
      8      x 768   |                   72.4                  |  [34m[1m    339.9   [0m[0m  |            72.0           |                      88.9                     |  [34m[1m                           114.3                          [0m[0m  |  [34m[1m                   88.9                   [0m[0m
      4      x 768   |                   71.8                  |  [34m[1m    341.0   [0m[0m  |  [92m[1m          65.6         [0m[0m  |                      88.9                     |  [34m[1m                           114.0                          [0m[0m  |  [92m[1m                   83.0                   [0m[0m
      2      x 768   |  [92m[1m                 53.2                [0m[0m  |  [92m[1m    336.5   [0m[0m  |  [92m[1m          65.3         [0m[0m  |  [92m[1m                    70.2                   [0m[0m  |  [34m[1m                           113.7                          [0m[0m  |  [92m[1m                   82.4                   [0m[0m
      1      x 768   |                   62.1                  |  [92m[1m    337.7   [0m[0m  |  [34m[1m          66.9         [0m[0m  |                      79.0                     |  [92m[1m                           112.3                          [0m[0m  |  [92m[1m                   83.1                   [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 1 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend trace  |  Fine-grained + structured sparsity @ 80 with backend trace  |  Dense benchmark - Compiled - backend trace
1 threads: -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                291.1                [0m[0m  |  [31m[1m  26706.3   [0m[0m  |  [31m[1m         680.6         [0m[0m  |  [31m[1m                   306.2                   [0m[0m  |  [31m[1m                         20385.2                          [0m[0m  |  [31m[1m                  681.6                   [0m[0m
      1024   x 768   |  [2m[91m                155.4                [0m[0m  |  [31m[1m  13338.8   [0m[0m  |  [31m[1m         338.1         [0m[0m  |  [2m[91m                   155.6                   [0m[0m  |  [31m[1m                         10274.5                          [0m[0m  |  [31m[1m                  338.4                   [0m[0m
      512    x 768   |                   77.2                  |  [31m[1m   6696.4   [0m[0m  |  [2m[91m         172.4         [0m[0m  |                      84.1                     |  [31m[1m                          5167.8                          [0m[0m  |  [2m[91m                  172.6                   [0m[0m
      256    x 768   |                   64.4                  |  [31m[1m   3373.5   [0m[0m  |            93.7           |                      61.5                     |  [31m[1m                          2599.6                          [0m[0m  |                     94.0                   
      128    x 768   |                   49.9                  |  [31m[1m   1729.0   [0m[0m  |            58.3           |                      63.5                     |  [31m[1m                          1316.2                          [0m[0m  |  [34m[1m                   65.7                   [0m[0m
      64     x 768   |                   51.8                  |  [2m[91m    867.2   [0m[0m  |  [34m[1m          51.5         [0m[0m  |                      66.0                     |  [31m[1m                           670.7                          [0m[0m  |  [34m[1m                   65.5                   [0m[0m
      32     x 768   |                   52.5                  |      442.0     |  [34m[1m          52.8         [0m[0m  |                      66.4                     |  [2m[91m                           328.3                          [0m[0m  |  [34m[1m                   67.5                   [0m[0m
      16     x 768   |                   55.7                  |  [34m[1m    289.8   [0m[0m  |            55.0           |                      69.4                     |                             168.7                            |                     71.3                   
      8      x 768   |                   56.0                  |  [34m[1m    291.4   [0m[0m  |            55.3           |                      69.4                     |  [34m[1m                            90.4                          [0m[0m  |                     71.1                   
      4      x 768   |                   55.7                  |  [34m[1m    288.1   [0m[0m  |  [92m[1m          48.7         [0m[0m  |                      70.0                     |  [34m[1m                            89.8                          [0m[0m  |  [92m[1m                   64.9                   [0m[0m
      2      x 768   |  [92m[1m                 39.5                [0m[0m  |  [34m[1m    284.6   [0m[0m  |  [34m[1m          49.4         [0m[0m  |  [92m[1m                    53.0                   [0m[0m  |  [34m[1m                            89.1                          [0m[0m  |  [92m[1m                   64.3                   [0m[0m
      1      x 768   |                   46.4                  |  [92m[1m    278.5   [0m[0m  |  [34m[1m          49.6         [0m[0m  |                      60.5                     |  [92m[1m                            88.2                          [0m[0m  |  [34m[1m                   66.4                   [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 2048 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 1 threads  --------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               46338.5               [0m[0m  |  [31m[1m 4626131.6  [0m[0m  |  [31m[1m        115574.9       [0m[0m  |  [31m[1m                   45557.7                    [0m[0m  |  [31m[1m                           17664.8                           [0m[0m  |  [31m[1m                   115954.8                  [0m[0m
      1024   x 768   |  [31m[1m               22384.8               [0m[0m  |  [31m[1m 2314332.0  [0m[0m  |  [31m[1m         57424.5       [0m[0m  |  [31m[1m                   22326.4                    [0m[0m  |  [31m[1m                            8915.9                           [0m[0m  |  [31m[1m                    58030.8                  [0m[0m
      512    x 768   |  [31m[1m               11288.3               [0m[0m  |  [31m[1m 1151701.5  [0m[0m  |  [31m[1m         28707.2       [0m[0m  |  [31m[1m                   11780.5                    [0m[0m  |  [31m[1m                            4485.7                           [0m[0m  |  [31m[1m                    29154.2                  [0m[0m
      256    x 768   |  [31m[1m                5899.8               [0m[0m  |  [31m[1m  590026.8  [0m[0m  |  [31m[1m         14711.9       [0m[0m  |  [31m[1m                    5919.6                    [0m[0m  |  [31m[1m                            2314.1                           [0m[0m  |  [31m[1m                    15723.7                  [0m[0m
      128    x 768   |  [31m[1m                3184.5               [0m[0m  |  [31m[1m  185309.1  [0m[0m  |  [31m[1m          8492.7       [0m[0m  |  [31m[1m                    3288.6                    [0m[0m  |  [31m[1m                            1181.9                           [0m[0m  |  [31m[1m                     8250.1                  [0m[0m
      64     x 768   |  [31m[1m                1716.0               [0m[0m  |  [31m[1m  103964.6  [0m[0m  |  [31m[1m          4391.2       [0m[0m  |  [31m[1m                    1824.6                    [0m[0m  |  [31m[1m                             672.4                           [0m[0m  |  [31m[1m                     4527.6                  [0m[0m
      32     x 768   |  [31m[1m                 960.2               [0m[0m  |  [31m[1m   49282.0  [0m[0m  |  [31m[1m          2497.4       [0m[0m  |  [2m[91m                    1035.3                    [0m[0m  |  [2m[91m                             381.0                           [0m[0m  |  [31m[1m                     2534.2                  [0m[0m
      16     x 768   |  [2m[91m                 594.5               [0m[0m  |  [31m[1m   20305.0  [0m[0m  |  [31m[1m          1533.3       [0m[0m  |  [2m[91m                     670.4                    [0m[0m  |                               211.6                             |  [2m[91m                     1536.8                  [0m[0m
      8      x 768   |  [2m[91m                 427.0               [0m[0m  |  [31m[1m    9795.0  [0m[0m  |  [2m[91m          1087.8       [0m[0m  |  [2m[91m                     488.8                    [0m[0m  |                               166.1                             |  [2m[91m                     1128.5                  [0m[0m
      4      x 768   |  [2m[91m                 332.3               [0m[0m  |  [2m[91m    5048.8  [0m[0m  |  [2m[91m           836.0       [0m[0m  |                       400.8                      |                               127.9                             |  [2m[91m                      862.8                  [0m[0m
      2      x 768   |  [2m[91m                 291.1               [0m[0m  |      2555.5    |  [2m[91m           743.5       [0m[0m  |                       356.4                      |  [92m[1m                             114.3                           [0m[0m  |  [2m[91m                      815.5                  [0m[0m
      1      x 768   |  [92m[1m                 140.8               [0m[0m  |  [92m[1m    1451.6  [0m[0m  |  [92m[1m           293.0       [0m[0m  |  [92m[1m                     210.5                    [0m[0m  |  [92m[1m                             113.3                           [0m[0m  |  [92m[1m                      318.7                  [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 1 threads  --------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m               44275.0               [0m[0m  |  [31m[1m 10234219.2 [0m[0m  |  [31m[1m        116037.2       [0m[0m  |  [31m[1m                   45114.6                    [0m[0m  |  [31m[1m                           35862.0                           [0m[0m  |  [31m[1m                   116282.2                  [0m[0m
      1024   x 768   |  [31m[1m               22776.9               [0m[0m  |  [31m[1m  5176901.1 [0m[0m  |  [31m[1m         57897.7       [0m[0m  |  [31m[1m                   22447.3                    [0m[0m  |  [31m[1m                           18169.5                           [0m[0m  |  [31m[1m                    57010.0                  [0m[0m
      512    x 768   |  [31m[1m               11490.1               [0m[0m  |  [31m[1m  2328037.1 [0m[0m  |  [31m[1m         28775.1       [0m[0m  |  [31m[1m                   11470.2                    [0m[0m  |  [31m[1m                            9090.2                           [0m[0m  |  [31m[1m                    28779.0                  [0m[0m
      256    x 768   |  [31m[1m                6326.8               [0m[0m  |  [31m[1m  1152063.3 [0m[0m  |  [31m[1m         15806.8       [0m[0m  |  [31m[1m                    6441.8                    [0m[0m  |  [31m[1m                            4569.6                           [0m[0m  |  [31m[1m                    16129.8                  [0m[0m
      128    x 768   |  [31m[1m                3317.3               [0m[0m  |  [31m[1m   573318.2 [0m[0m  |  [31m[1m          8229.6       [0m[0m  |  [31m[1m                    3362.0                    [0m[0m  |  [31m[1m                            2339.9                           [0m[0m  |  [31m[1m                     8221.1                  [0m[0m
      64     x 768   |  [31m[1m                1808.2               [0m[0m  |  [31m[1m   185023.9 [0m[0m  |  [31m[1m          4516.2       [0m[0m  |  [31m[1m                    1903.3                    [0m[0m  |  [31m[1m                            1189.4                           [0m[0m  |  [31m[1m                     4490.0                  [0m[0m
      32     x 768   |  [31m[1m                 989.2               [0m[0m  |  [31m[1m    89782.1 [0m[0m  |  [31m[1m          2513.4       [0m[0m  |  [31m[1m                    1077.4                    [0m[0m  |  [31m[1m                             653.6                           [0m[0m  |  [31m[1m                     2468.0                  [0m[0m
      16     x 768   |  [2m[91m                 619.7               [0m[0m  |  [31m[1m    44384.6 [0m[0m  |  [31m[1m          1539.1       [0m[0m  |  [2m[91m                     712.1                    [0m[0m  |  [2m[91m                             325.0                           [0m[0m  |  [2m[91m                     1570.5                  [0m[0m
      8      x 768   |  [2m[91m                 468.4               [0m[0m  |  [31m[1m    19701.9 [0m[0m  |  [2m[91m          1117.7       [0m[0m  |  [2m[91m                     542.5                    [0m[0m  |  [2m[91m                             241.1                           [0m[0m  |  [2m[91m                     1154.7                  [0m[0m
      4      x 768   |  [2m[91m                 357.7               [0m[0m  |  [2m[91m     9743.7 [0m[0m  |  [2m[91m           844.7       [0m[0m  |  [2m[91m                     432.4                    [0m[0m  |                               151.8                             |  [2m[91m                      890.5                  [0m[0m
      2      x 768   |  [2m[91m                 323.7               [0m[0m  |       4905.3   |  [2m[91m           765.7       [0m[0m  |                       382.7                      |                               129.7                             |  [2m[91m                      779.0                  [0m[0m
      1      x 768   |  [92m[1m                 131.0               [0m[0m  |  [92m[1m     2505.6 [0m[0m  |  [92m[1m           295.7       [0m[0m  |  [92m[1m                     198.6                    [0m[0m  |  [92m[1m                             106.2                           [0m[0m  |  [92m[1m                      329.2                  [0m[0m

Times are in microseconds (us).
/home/user/build/.venv/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:90: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
AUTOTUNE bias_addmm(2048x1145, 2048x768, 768x1145)
  bias_addmm 0.2222s 100.0%
  addmm 0.2273s 97.7%
  triton_mm_7 0.3963s 56.1%
  triton_mm_4 0.4393s 50.6%
  triton_mm_2 0.4393s 50.6%
  triton_mm_1 0.4475s 49.7%
  triton_mm_3 0.4475s 49.7%
  triton_mm_0 0.5878s 37.8%
  triton_mm_10 0.6523s 34.1%
  triton_mm_11 0.9892s 22.5%
AUTOTUNE bias_addmm(1024x1145, 1024x768, 768x1145)
  addmm 0.1188s 100.0%
  bias_addmm 0.1198s 99.1%
  triton_mm_19 0.2028s 58.6%
  triton_mm_14 0.2222s 53.5%
  triton_mm_16 0.2222s 53.5%
  triton_mm_13 0.2284s 52.0%
  triton_mm_15 0.2284s 52.0%
  triton_mm_12 0.3103s 38.3%
  triton_mm_22 0.3338s 35.6%
  triton_mm_20 0.5130s 23.2%
AUTOTUNE bias_addmm(512x1145, 512x768, 768x1145)
  bias_addmm 0.0676s 100.0%
  addmm 0.0696s 97.1%
  triton_mm_26 0.1126s 60.0%
  triton_mm_28 0.1137s 59.5%
  triton_mm_27 0.1157s 58.4%
  triton_mm_25 0.1198s 56.4%
  triton_mm_24 0.1566s 43.2%
  triton_mm_34 0.1710s 39.5%
  triton_mm_31 0.1864s 36.3%
  triton_mm_32 0.2621s 25.8%
AUTOTUNE bias_addmm(256x1145, 256x768, 768x1145)
  bias_addmm 0.0430s 100.0%
  addmm 0.0451s 95.5%
  triton_mm_36 0.0993s 43.3%
  triton_mm_38 0.1085s 39.6%
  triton_mm_46 0.1096s 39.3%
  triton_mm_40 0.1096s 39.3%
  triton_mm_39 0.1116s 38.5%
  triton_mm_37 0.1188s 36.2%
  triton_mm_44 0.1362s 31.6%
  triton_mm_47 0.1423s 30.2%
AUTOTUNE bias_addmm(128x1145, 128x768, 768x1145)
  bias_addmm 0.0297s 100.0%
  addmm 0.0307s 96.7%
  triton_mm_59 0.0788s 37.7%
  triton_mm_54 0.0809s 36.7%
  triton_mm_53 0.0809s 36.7%
  triton_mm_57 0.0850s 34.9%
  triton_mm_48 0.0952s 31.2%
  triton_mm_58 0.1055s 28.2%
  triton_mm_52 0.1065s 27.9%
  triton_mm_49 0.1096s 27.1%
AUTOTUNE bias_addmm(64x1145, 64x768, 768x1145)
  bias_addmm 0.0225s 100.0%
  addmm 0.0266s 84.6%
  triton_mm_69 0.0461s 48.9%
  triton_mm_71 0.0615s 36.6%
  triton_mm_66 0.0788s 28.6%
  triton_mm_65 0.0799s 28.2%
  triton_mm_60 0.0942s 23.9%
  triton_mm_70 0.1044s 21.6%
  triton_mm_64 0.1075s 21.0%
  triton_mm_62 0.1075s 21.0%
AUTOTUNE bias_addmm(32x1145, 32x768, 768x1145)
  bias_addmm 0.0164s 100.0%
  addmm 0.0195s 84.2%
  triton_mm_81 0.0440s 37.2%
  triton_mm_83 0.0614s 26.7%
  triton_mm_78 0.0787s 20.8%
  triton_mm_77 0.0788s 20.8%
  triton_mm_72 0.0942s 17.4%
  triton_mm_82 0.1044s 15.7%
  triton_mm_74 0.1065s 15.4%
  triton_mm_76 0.1075s 15.2%
AUTOTUNE bias_addmm(16x1145, 16x768, 768x1145)
  bias_addmm 0.0174s 100.0%
  addmm 0.0195s 89.5%
  triton_mm_93 0.0451s 38.6%
  triton_mm_95 0.0614s 28.3%
  triton_mm_89 0.0778s 22.4%
  triton_mm_90 0.0778s 22.4%
  triton_mm_84 0.0942s 18.5%
  triton_mm_94 0.1044s 16.7%
  triton_mm_86 0.1065s 16.3%
  triton_mm_88 0.1075s 16.2%
AUTOTUNE bias_addmm(8x1145, 8x768, 768x1145)
  bias_addmm 0.0164s 100.0%
  addmm 0.0184s 88.9%
  triton_mm_105 0.0451s 36.4%
  triton_mm_107 0.0614s 26.7%
  triton_mm_101 0.0778s 21.1%
  triton_mm_102 0.0778s 21.1%
  triton_mm_96 0.0942s 17.4%
  triton_mm_106 0.1044s 15.7%
  triton_mm_100 0.1065s 15.4%
  triton_mm_99 0.1085s 15.1%
AUTOTUNE bias_addmm(4x1145, 4x768, 768x1145)
  bias_addmm 0.0164s 100.0%
  addmm 0.0184s 88.9%
  triton_mm_117 0.0451s 36.4%
  triton_mm_119 0.0614s 26.7%
  triton_mm_114 0.0778s 21.1%
  triton_mm_113 0.0778s 21.1%
  triton_mm_108 0.0942s 17.4%
  triton_mm_118 0.1034s 15.8%
  triton_mm_110 0.1065s 15.4%
  triton_mm_112 0.1065s 15.4%
AUTOTUNE bias_addmm(2x1145, 2x768, 768x1145)
  bias_addmm 0.0123s 100.0%
  addmm 0.0143s 85.7%
  triton_mm_129 0.0440s 27.9%
  triton_mm_131 0.0614s 20.0%
  triton_mm_126 0.0768s 16.0%
  triton_mm_125 0.0778s 15.8%
  triton_mm_120 0.0942s 13.0%
  triton_mm_130 0.1024s 12.0%
  triton_mm_121 0.1055s 11.7%
  triton_mm_123 0.1055s 11.7%
AUTOTUNE bias_addmm(1x1145, 1x768, 768x1145)
  addmm 0.0123s 100.0%
  bias_addmm 0.0164s 75.0%
  triton_mm_141 0.0451s 27.3%
  triton_mm_143 0.0614s 20.0%
  triton_mm_138 0.0778s 15.8%
  triton_mm_137 0.0778s 15.8%
  triton_mm_132 0.0942s 13.0%
  triton_mm_142 0.1024s 12.0%
  triton_mm_133 0.1055s 11.7%
  triton_mm_134 0.1065s 11.5%
AUTOTUNE bias_addmm(2048x1224, 2048x768, 768x1224)
  addmm 0.2386s 100.0%
  bias_addmm 0.2509s 95.1%
  triton_mm_151 0.4055s 58.8%
  triton_mm_148 0.4444s 53.7%
  triton_mm_146 0.4444s 53.7%
  triton_mm_147 0.4475s 53.3%
  triton_mm_145 0.4506s 53.0%
  triton_mm_144 0.6144s 38.8%
  triton_mm_154 0.6698s 35.6%
  triton_mm_152 1.0025s 23.8%
AUTOTUNE bias_addmm(1024x1224, 1024x768, 768x1224)
  addmm 0.1229s 100.0%
  bias_addmm 0.1239s 99.2%
  triton_mm_163 0.2058s 59.7%
  triton_mm_159 0.2243s 54.8%
  triton_mm_160 0.2243s 54.8%
  triton_mm_157 0.2243s 54.8%
  triton_mm_158 0.2273s 54.1%
  triton_mm_156 0.3185s 38.6%
  triton_mm_166 0.3389s 36.3%
  triton_mm_164 0.5120s 24.0%
AUTOTUNE bias_addmm(512x1224, 512x768, 768x1224)
  bias_addmm 0.0655s 100.0%
  addmm 0.0696s 94.1%
  triton_mm_169 0.1137s 57.7%
  triton_mm_171 0.1137s 57.7%
  triton_mm_172 0.1147s 57.1%
  triton_mm_170 0.1157s 56.6%
  triton_mm_168 0.1608s 40.8%
  triton_mm_178 0.1741s 37.6%
  triton_mm_175 0.1905s 34.4%
  triton_mm_176 0.2632s 24.9%
AUTOTUNE bias_addmm(256x1224, 256x768, 768x1224)
  bias_addmm 0.0410s 100.0%
  addmm 0.0461s 88.9%
  triton_mm_180 0.0993s 41.2%
  triton_mm_182 0.1085s 37.7%
  triton_mm_183 0.1085s 37.7%
  triton_mm_190 0.1096s 37.4%
  triton_mm_184 0.1096s 37.4%
  triton_mm_181 0.1147s 35.7%
  triton_mm_188 0.1372s 29.9%
  triton_mm_191 0.1434s 28.6%
AUTOTUNE bias_addmm(128x1224, 128x768, 768x1224)
  bias_addmm 0.0297s 100.0%
  addmm 0.0307s 96.7%
  triton_mm_203 0.0799s 37.2%
  triton_mm_198 0.0809s 36.7%
  triton_mm_197 0.0809s 36.7%
  triton_mm_201 0.0860s 34.5%
  triton_mm_192 0.0954s 31.1%
  triton_mm_202 0.1064s 27.9%
  triton_mm_194 0.1065s 27.9%
  triton_mm_195 0.1065s 27.9%
AUTOTUNE bias_addmm(64x1224, 64x768, 768x1224)
  bias_addmm 0.0225s 100.0%
  addmm 0.0256s 88.0%
  triton_mm_213 0.0461s 48.9%
  triton_mm_215 0.0625s 36.1%
  triton_mm_210 0.0788s 28.6%
  triton_mm_209 0.0788s 28.6%
  triton_mm_204 0.0952s 23.7%
  triton_mm_214 0.1044s 21.6%
  triton_mm_207 0.1055s 21.4%
  triton_mm_205 0.1055s 21.4%
AUTOTUNE bias_addmm(32x1224, 32x768, 768x1224)
  bias_addmm 0.0174s 100.0%
  addmm 0.0195s 89.5%
  triton_mm_225 0.0451s 38.6%
  triton_mm_227 0.0614s 28.3%
  triton_mm_222 0.0788s 22.1%
  triton_mm_221 0.0788s 22.1%
  triton_mm_216 0.0942s 18.5%
  triton_mm_226 0.1044s 16.7%
  triton_mm_217 0.1055s 16.5%
  triton_mm_219 0.1055s 16.5%
AUTOTUNE bias_addmm(16x1224, 16x768, 768x1224)
  bias_addmm 0.0174s 100.0%
  addmm 0.0195s 89.5%
  triton_mm_237 0.0451s 38.6%
  triton_mm_239 0.0614s 28.3%
  triton_mm_234 0.0778s 22.4%
  triton_mm_233 0.0778s 22.4%
  triton_mm_228 0.0942s 18.5%
  triton_mm_238 0.1044s 16.7%
  triton_mm_231 0.1055s 16.5%
  triton_mm_232 0.1075s 16.2%
AUTOTUNE bias_addmm(8x1224, 8x768, 768x1224)
  bias_addmm 0.0164s 100.0%
  addmm 0.0184s 88.9%
  triton_mm_249 0.0451s 36.4%
  triton_mm_251 0.0614s 26.7%
  triton_mm_246 0.0778s 21.1%
  triton_mm_245 0.0788s 20.8%
  triton_mm_240 0.0963s 17.0%
  triton_mm_250 0.1034s 15.8%
  triton_mm_241 0.1065s 15.4%
  triton_mm_243 0.1065s 15.4%
AUTOTUNE bias_addmm(4x1224, 4x768, 768x1224)
  bias_addmm 0.0164s 100.0%
  addmm 0.0195s 84.2%
  triton_mm_261 0.0450s 36.4%
  triton_mm_263 0.0614s 26.7%
  triton_mm_257 0.0799s 20.5%
  triton_mm_258 0.0799s 20.5%
  triton_mm_252 0.0963s 17.0%
  triton_mm_262 0.1034s 15.8%
  triton_mm_255 0.1075s 15.2%
  triton_mm_254 0.1085s 15.1%
AUTOTUNE bias_addmm(2x1224, 2x768, 768x1224)
  bias_addmm 0.0123s 100.0%
  addmm 0.0154s 80.0%
  triton_mm_273 0.0451s 27.3%
  triton_mm_275 0.0614s 20.0%
  triton_mm_270 0.0778s 15.8%
  triton_mm_269 0.0778s 15.8%
  triton_mm_264 0.0942s 13.0%
  triton_mm_274 0.1024s 12.0%
  triton_mm_267 0.1044s 11.8%
  triton_mm_266 0.1065s 11.5%
AUTOTUNE bias_addmm(1x1224, 1x768, 768x1224)
  addmm 0.0123s 100.0%
  bias_addmm 0.0164s 75.0%
  triton_mm_285 0.0451s 27.3%
  triton_mm_287 0.0604s 20.3%
  triton_mm_282 0.0778s 15.8%
  triton_mm_281 0.0788s 15.6%
  triton_mm_276 0.0942s 13.0%
  triton_mm_286 0.1024s 12.0%
  triton_mm_278 0.1075s 11.4%
  triton_mm_280 0.1075s 11.4%

Benchmarking batch size 2048 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 2048 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 1 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 1 threads  --------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                275.3                [0m[0m  |  [31m[1m  11697.4   [0m[0m  |  [31m[1m         653.1         [0m[0m  |  [2m[91m                    291.2                     [0m[0m  |  [31m[1m                            3871.9                           [0m[0m  |  [31m[1m                    640.8                    [0m[0m
      1024   x 768   |  [2m[91m                141.8                [0m[0m  |  [31m[1m   5818.1   [0m[0m  |  [31m[1m         329.3         [0m[0m  |                      146.2                       |  [31m[1m                            1948.7                           [0m[0m  |  [2m[91m                    328.5                    [0m[0m
      512    x 768   |                   71.9                  |  [31m[1m   2985.3   [0m[0m  |  [2m[91m         168.3         [0m[0m  |  [34m[1m                    110.4                     [0m[0m  |  [31m[1m                             986.9                           [0m[0m  |  [2m[91m                    169.1                    [0m[0m
      256    x 768   |                   52.1                  |  [31m[1m   1478.2   [0m[0m  |            92.2           |  [34m[1m                    105.7                     [0m[0m  |  [2m[91m                             502.8                           [0m[0m  |                       93.2                    
      128    x 768   |  [34m[1m                 46.8                [0m[0m  |  [2m[91m    749.4   [0m[0m  |            57.7           |  [34m[1m                    104.5                     [0m[0m  |  [2m[91m                             261.8                           [0m[0m  |  [34m[1m                     85.3                    [0m[0m
      64     x 768   |                   51.0                  |      378.2     |  [34m[1m          50.9         [0m[0m  |                      127.4                       |                               136.3                             |  [34m[1m                     89.4                    [0m[0m
      32     x 768   |                   53.8                  |  [34m[1m    294.7   [0m[0m  |            54.1           |  [34m[1m                    109.0                     [0m[0m  |  [92m[1m                             103.0                           [0m[0m  |  [34m[1m                     86.3                    [0m[0m
      16     x 768   |                   54.7                  |  [34m[1m    287.8   [0m[0m  |            54.9           |  [34m[1m                    109.9                     [0m[0m  |  [34m[1m                             111.9                           [0m[0m  |                       95.5                    
      8      x 768   |                   58.3                  |  [34m[1m    302.0   [0m[0m  |            59.7           |                      126.2                       |                               125.2                             |                      107.0                    
      4      x 768   |                   71.2                  |      338.7     |            65.1           |                      130.3                       |                               126.5                             |                      104.6                    
      2      x 768   |                   54.7                  |      335.8     |            66.3           |  [92m[1m                    101.3                     [0m[0m  |  [92m[1m                             103.1                           [0m[0m  |  [92m[1m                     81.8                    [0m[0m
      1      x 768   |  [92m[1m                 46.0                [0m[0m  |  [92m[1m    274.6   [0m[0m  |  [92m[1m          48.8         [0m[0m  |  [34m[1m                    103.6                     [0m[0m  |  [34m[1m                             105.3                           [0m[0m  |  [34m[1m                     83.8                    [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 1 threads  --------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
1 threads: ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                301.1                [0m[0m  |  [31m[1m  26892.3   [0m[0m  |  [31m[1m         685.3         [0m[0m  |  [2m[91m                    287.9                     [0m[0m  |  [31m[1m                            7876.6                           [0m[0m  |  [31m[1m                    666.2                    [0m[0m
      1024   x 768   |  [2m[91m                157.8                [0m[0m  |  [31m[1m  13422.3   [0m[0m  |  [31m[1m         338.1         [0m[0m  |                      154.1                       |  [31m[1m                            3934.4                           [0m[0m  |  [2m[91m                    335.7                    [0m[0m
      512    x 768   |  [2m[91m                 76.9                [0m[0m  |  [31m[1m   6700.5   [0m[0m  |  [2m[91m         172.4         [0m[0m  |  [34m[1m                    109.5                     [0m[0m  |  [31m[1m                            1975.6                           [0m[0m  |  [2m[91m                    172.6                    [0m[0m
      256    x 768   |                   48.0                  |  [31m[1m   3381.7   [0m[0m  |            93.8           |  [34m[1m                    105.5                     [0m[0m  |  [31m[1m                             996.0                           [0m[0m  |                       93.8                    
      128    x 768   |                   48.1                  |  [31m[1m   1690.7   [0m[0m  |            58.5           |  [34m[1m                    105.6                     [0m[0m  |  [2m[91m                             502.1                           [0m[0m  |  [34m[1m                     86.4                    [0m[0m
      64     x 768   |                   52.4                  |  [2m[91m    860.0   [0m[0m  |  [34m[1m          51.1         [0m[0m  |  [34m[1m                    105.7                     [0m[0m  |  [2m[91m                             254.3                           [0m[0m  |  [34m[1m                     85.6                    [0m[0m
      32     x 768   |                   51.3                  |      439.0     |  [34m[1m          50.7         [0m[0m  |  [34m[1m                    106.6                     [0m[0m  |                               131.1                             |  [34m[1m                     86.2                    [0m[0m
      16     x 768   |                   56.6                  |  [34m[1m    298.9   [0m[0m  |            56.3           |  [34m[1m                    107.5                     [0m[0m  |  [34m[1m                             105.6                           [0m[0m  |                       90.8                    
      8      x 768   |                   56.2                  |  [34m[1m    287.4   [0m[0m  |            56.1           |                      125.0                       |                               126.4                             |                      108.8                    
      4      x 768   |                   71.7                  |      349.9     |  [34m[1m          50.4         [0m[0m  |                      125.8                       |  [34m[1m                             105.6                           [0m[0m  |  [92m[1m                     82.7                    [0m[0m
      2      x 768   |  [92m[1m                 38.1                [0m[0m  |  [34m[1m    283.2   [0m[0m  |  [92m[1m          48.4         [0m[0m  |  [92m[1m                    103.8                     [0m[0m  |  [34m[1m                             104.4                           [0m[0m  |  [92m[1m                     82.4                    [0m[0m
      1      x 768   |                   46.3                  |  [92m[1m    278.6   [0m[0m  |  [34m[1m          50.6         [0m[0m  |  [92m[1m                    103.2                     [0m[0m  |  [92m[1m                             102.7                           [0m[0m  |  [34m[1m                     83.4                    [0m[0m

Times are in microseconds (us).
/home/user/build/.venv/lib/python3.10/site-packages/torch/jit/_script.py:1241: UserWarning: `optimize` is deprecated and has no effect. Use `with torch.jit.optimized_execution() instead
  warnings.warn(

Benchmarking batch size 2048 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 512 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 256 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 128 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 64 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 32 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 16 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 8 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 4 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 2 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 1 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 2048 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 512 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 256 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 128 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 64 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 32 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 16 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 8 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 4 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 2 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 1 with sparsity 80 num_threads 12 with compiler script using backend script
[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 12 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend script  |  Fine-grained + structured sparsity @ 90 with backend script  |  Dense benchmark - Compiled - backend script
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                5593.3               [0m[0m  |  [31m[1m  743393.3  [0m[0m  |  [31m[1m        13777.1        [0m[0m  |  [31m[1m                   5657.2                   [0m[0m  |  [31m[1m                          792304.0                         [0m[0m  |  [31m[1m                  17104.8                  [0m[0m
      1024   x 768   |  [31m[1m                3099.4               [0m[0m  |  [31m[1m  363804.8  [0m[0m  |  [31m[1m         6743.4        [0m[0m  |  [31m[1m                   2773.9                   [0m[0m  |  [31m[1m                          380129.7                         [0m[0m  |  [31m[1m                   7047.1                  [0m[0m
      512    x 768   |  [31m[1m                1502.6               [0m[0m  |  [31m[1m  183028.7  [0m[0m  |  [31m[1m         3608.4        [0m[0m  |  [31m[1m                   1450.6                   [0m[0m  |  [31m[1m                          190875.8                         [0m[0m  |  [31m[1m                   3595.7                  [0m[0m
      256    x 768   |  [31m[1m                1010.4               [0m[0m  |  [31m[1m   77927.9  [0m[0m  |  [31m[1m         1798.3        [0m[0m  |  [31m[1m                   1041.7                   [0m[0m  |  [31m[1m                           96063.6                         [0m[0m  |  [31m[1m                   2065.9                  [0m[0m
      128    x 768   |  [31m[1m                 469.2               [0m[0m  |  [31m[1m   24513.1  [0m[0m  |  [31m[1m         1050.7        [0m[0m  |  [31m[1m                    435.3                   [0m[0m  |  [31m[1m                           48571.3                         [0m[0m  |  [31m[1m                   1369.7                  [0m[0m
      64     x 768   |  [31m[1m                 309.7               [0m[0m  |  [31m[1m   12417.5  [0m[0m  |  [31m[1m          558.9        [0m[0m  |  [2m[91m                    253.9                   [0m[0m  |  [31m[1m                           22694.3                         [0m[0m  |  [31m[1m                    632.9                  [0m[0m
      32     x 768   |  [2m[91m                 179.4               [0m[0m  |  [31m[1m    4792.1  [0m[0m  |  [31m[1m          313.8        [0m[0m  |  [2m[91m                    147.8                   [0m[0m  |  [31m[1m                            4310.2                         [0m[0m  |  [2m[91m                    332.9                  [0m[0m
      16     x 768   |  [2m[91m                 128.6               [0m[0m  |  [31m[1m    2258.1  [0m[0m  |  [31m[1m          321.2        [0m[0m  |  [2m[91m                    151.6                   [0m[0m  |  [31m[1m                            2097.4                         [0m[0m  |  [2m[91m                    190.6                  [0m[0m
      8      x 768   |  [2m[91m                  92.0               [0m[0m  |  [2m[91m    1389.3  [0m[0m  |  [2m[91m          155.1        [0m[0m  |                       86.3                     |  [2m[91m                            1066.6                         [0m[0m  |  [2m[91m                    161.8                  [0m[0m
      4      x 768   |                    76.1                 |       784.8    |  [2m[91m          119.3        [0m[0m  |                       79.8                     |  [2m[91m                             574.4                         [0m[0m  |                       88.9                  
      2      x 768   |                    64.8                 |       577.3    |  [2m[91m          116.6        [0m[0m  |  [34m[1m                     62.9                   [0m[0m  |                               358.3                           |  [34m[1m                     82.9                  [0m[0m
      1      x 768   |  [92m[1m                  41.1               [0m[0m  |  [92m[1m     444.5  [0m[0m  |  [92m[1m           57.2        [0m[0m  |  [92m[1m                     59.7                   [0m[0m  |  [92m[1m                             242.9                         [0m[0m  |  [92m[1m                     78.6                  [0m[0m

Times are in microseconds (us).

[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 12 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend script  |  Fine-grained + structured sparsity @ 80 with backend script  |  Dense benchmark - Compiled - backend script
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                5771.4               [0m[0m  |  [31m[1m 1650551.2  [0m[0m  |  [31m[1m        13705.1        [0m[0m  |  [31m[1m                   5440.2                   [0m[0m  |  [31m[1m                         1507872.8                         [0m[0m  |  [31m[1m                  14182.9                  [0m[0m
      1024   x 768   |  [31m[1m                3033.0               [0m[0m  |  [31m[1m  765685.5  [0m[0m  |  [31m[1m         6906.0        [0m[0m  |  [31m[1m                   2796.8                   [0m[0m  |  [31m[1m                          746707.3                         [0m[0m  |  [31m[1m                   7012.9                  [0m[0m
      512    x 768   |  [31m[1m                1578.5               [0m[0m  |  [31m[1m  369408.7  [0m[0m  |  [31m[1m         3611.3        [0m[0m  |  [31m[1m                   1487.2                   [0m[0m  |  [31m[1m                          369942.0                         [0m[0m  |  [31m[1m                   3623.3                  [0m[0m
      256    x 768   |  [31m[1m                 891.6               [0m[0m  |  [31m[1m  212349.2  [0m[0m  |  [31m[1m         1843.1        [0m[0m  |  [31m[1m                    928.7                   [0m[0m  |  [31m[1m                          194075.2                         [0m[0m  |  [31m[1m                   1844.1                  [0m[0m
      128    x 768   |  [31m[1m                 478.4               [0m[0m  |  [31m[1m  109357.0  [0m[0m  |  [31m[1m          962.7        [0m[0m  |  [31m[1m                    401.3                   [0m[0m  |  [31m[1m                          107057.2                         [0m[0m  |  [31m[1m                   1244.9                  [0m[0m
      64     x 768   |  [31m[1m                 293.9               [0m[0m  |  [31m[1m   38987.5  [0m[0m  |  [31m[1m          600.2        [0m[0m  |  [2m[91m                    237.9                   [0m[0m  |  [31m[1m                           54606.6                         [0m[0m  |  [31m[1m                    631.6                  [0m[0m
      32     x 768   |  [2m[91m                 182.1               [0m[0m  |  [31m[1m   11461.6  [0m[0m  |  [2m[91m          295.2        [0m[0m  |  [2m[91m                    149.3                   [0m[0m  |  [31m[1m                           26630.9                         [0m[0m  |  [2m[91m                    335.7                  [0m[0m
      16     x 768   |  [2m[91m                 126.0               [0m[0m  |  [31m[1m    4860.3  [0m[0m  |  [2m[91m          206.8        [0m[0m  |                      112.8                     |  [31m[1m                            5120.0                         [0m[0m  |  [2m[91m                    199.9                  [0m[0m
      8      x 768   |  [2m[91m                  92.5               [0m[0m  |  [2m[91m    2170.6  [0m[0m  |  [2m[91m          151.2        [0m[0m  |                       84.5                     |  [31m[1m                            1956.9                         [0m[0m  |  [2m[91m                    232.4                  [0m[0m
      4      x 768   |                    74.4                 |  [2m[91m    1242.8  [0m[0m  |            121.4          |                       68.4                     |  [2m[91m                            1039.7                         [0m[0m  |                       93.6                  
      2      x 768   |                    65.6                 |       789.9    |            108.0          |  [92m[1m                     57.2                   [0m[0m  |  [2m[91m                             671.3                         [0m[0m  |  [34m[1m                     82.1                  [0m[0m
      1      x 768   |  [92m[1m                  41.0               [0m[0m  |  [92m[1m     546.0  [0m[0m  |  [92m[1m           70.9        [0m[0m  |  [92m[1m                     57.7                   [0m[0m  |  [92m[1m                             320.6                         [0m[0m  |  [92m[1m                     76.0                  [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 512 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 256 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 128 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 64 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 32 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 16 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 8 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 4 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 2 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 1 with sparsity 90 num_threads 12 with compiler script using backend script
Benchmarking batch size 2048 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 512 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 256 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 128 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 64 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 32 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 16 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 8 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 4 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 2 with sparsity 80 num_threads 12 with compiler script using backend script
Benchmarking batch size 1 with sparsity 80 num_threads 12 with compiler script using backend script
[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 12 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend script  |  Fine-grained + structured sparsity @ 90 with backend script  |  Dense benchmark - Compiled - backend script
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                279.3                [0m[0m  |  [31m[1m  11634.3   [0m[0m  |  [31m[1m         651.3         [0m[0m  |  [2m[91m                   224.1                    [0m[0m  |  [31m[1m                           9670.7                          [0m[0m  |  [31m[1m                   645.8                   [0m[0m
      1024   x 768   |  [2m[91m                141.4                [0m[0m  |  [31m[1m   5872.4   [0m[0m  |  [31m[1m         328.3         [0m[0m  |  [2m[91m                   131.4                    [0m[0m  |  [31m[1m                           4802.6                          [0m[0m  |  [31m[1m                   341.1                   [0m[0m
      512    x 768   |                   72.2                  |  [31m[1m   2935.1   [0m[0m  |  [2m[91m         167.8         [0m[0m  |                      74.9                      |  [31m[1m                           2416.1                          [0m[0m  |  [2m[91m                   189.7                   [0m[0m
      256    x 768   |                   52.9                  |  [31m[1m   1488.2   [0m[0m  |            91.8           |                      52.8                      |  [31m[1m                           1192.3                          [0m[0m  |                      94.0                   
      128    x 768   |                   49.0                  |  [2m[91m    740.9   [0m[0m  |            58.3           |                      52.9                      |  [31m[1m                            593.7                          [0m[0m  |                      59.4                   
      64     x 768   |                   55.3                  |      370.2     |            53.8           |                      56.9                      |  [2m[91m                            289.5                          [0m[0m  |                      58.0                   
      32     x 768   |                   53.3                  |  [34m[1m    301.0   [0m[0m  |            54.2           |                      53.3                      |                              150.8                            |                      54.2                   
      16     x 768   |                   55.4                  |  [34m[1m    309.5   [0m[0m  |            58.8           |                      58.2                      |  [34m[1m                             85.9                          [0m[0m  |                      58.4                   
      8      x 768   |                   56.9                  |  [92m[1m    293.2   [0m[0m  |            56.6           |                      56.4                      |  [34m[1m                             83.0                          [0m[0m  |                      52.5                   
      4      x 768   |                   54.2                  |  [34m[1m    299.6   [0m[0m  |  [34m[1m          48.9         [0m[0m  |                      54.0                      |  [34m[1m                             79.9                          [0m[0m  |  [34m[1m                    48.1                   [0m[0m
      2      x 768   |  [92m[1m                 38.4                [0m[0m  |  [34m[1m    301.1   [0m[0m  |  [92m[1m          48.4         [0m[0m  |  [34m[1m                    50.6                    [0m[0m  |  [34m[1m                             79.6                          [0m[0m  |                      52.4                   
      1      x 768   |                   50.1                  |  [34m[1m    298.0   [0m[0m  |  [34m[1m          52.6         [0m[0m  |  [92m[1m                    46.2                    [0m[0m  |  [92m[1m                             78.3                          [0m[0m  |  [92m[1m                    47.4                   [0m[0m

Times are in microseconds (us).

[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 12 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend script  |  Fine-grained + structured sparsity @ 80 with backend script  |  Dense benchmark - Compiled - backend script
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                296.1                [0m[0m  |  [31m[1m  26420.3   [0m[0m  |  [31m[1m         670.8         [0m[0m  |  [2m[91m                   232.1                    [0m[0m  |  [31m[1m                          20437.2                          [0m[0m  |  [31m[1m                   661.0                   [0m[0m
      1024   x 768   |  [2m[91m                157.4                [0m[0m  |  [31m[1m  13367.8   [0m[0m  |  [31m[1m         336.1         [0m[0m  |  [2m[91m                   140.7                    [0m[0m  |  [31m[1m                          10304.1                          [0m[0m  |  [31m[1m                   347.5                   [0m[0m
      512    x 768   |                   76.9                  |  [31m[1m   6721.4   [0m[0m  |  [2m[91m         172.2         [0m[0m  |                      79.8                      |  [31m[1m                           5190.7                          [0m[0m  |  [2m[91m                   196.2                   [0m[0m
      256    x 768   |                   47.4                  |  [31m[1m   3428.3   [0m[0m  |            93.4           |                      56.0                      |  [31m[1m                           2626.4                          [0m[0m  |                      96.3                   
      128    x 768   |                   50.1                  |  [31m[1m   1711.7   [0m[0m  |            58.5           |                      56.2                      |  [31m[1m                           1316.2                          [0m[0m  |                      58.3                   
      64     x 768   |                   54.6                  |  [2m[91m    862.6   [0m[0m  |  [34m[1m          51.5         [0m[0m  |  [34m[1m                    53.0                    [0m[0m  |  [31m[1m                            670.7                          [0m[0m  |                      54.0                   
      32     x 768   |                   53.9                  |      439.9     |            57.8           |  [34m[1m                    53.6                    [0m[0m  |  [2m[91m                            328.5                          [0m[0m  |                      54.8                   
      16     x 768   |                   54.8                  |  [92m[1m    284.0   [0m[0m  |  [34m[1m          54.5         [0m[0m  |  [34m[1m                    52.9                    [0m[0m  |  [2m[91m                            170.3                          [0m[0m  |  [34m[1m                    53.3                   [0m[0m
      8      x 768   |                   54.3                  |      335.9     |  [34m[1m          54.1         [0m[0m  |  [34m[1m                    52.7                    [0m[0m  |                               89.3                            |  [34m[1m                    53.6                   [0m[0m
      4      x 768   |                   54.3                  |  [34m[1m    297.7   [0m[0m  |  [34m[1m          51.4         [0m[0m  |  [92m[1m                    49.3                    [0m[0m  |  [92m[1m                             79.9                          [0m[0m  |                      54.4                   
      2      x 768   |  [92m[1m                 42.6                [0m[0m  |  [34m[1m    303.7   [0m[0m  |  [34m[1m          51.0         [0m[0m  |  [92m[1m                    49.5                    [0m[0m  |                               94.4                            |  [92m[1m                    48.8                   [0m[0m
      1      x 768   |  [34m[1m                 46.1                [0m[0m  |      343.3     |  [92m[1m          49.9         [0m[0m  |  [34m[1m                    52.2                    [0m[0m  |                              106.3                            |                      66.5                   

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 2048 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 80 num_threads 12 with compiler trace using backend trace
[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 12 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend trace  |  Fine-grained + structured sparsity @ 90 with backend trace  |  Dense benchmark - Compiled - backend trace
12 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                6026.5               [0m[0m  |  [31m[1m  693978.2  [0m[0m  |  [31m[1m        14947.4        [0m[0m  |  [31m[1m                   5383.3                  [0m[0m  |  [31m[1m                         729894.4                         [0m[0m  |  [31m[1m                 19587.2                  [0m[0m
      1024   x 768   |  [31m[1m                2731.1               [0m[0m  |  [31m[1m  378040.5  [0m[0m  |  [31m[1m         6825.5        [0m[0m  |  [31m[1m                   2866.9                  [0m[0m  |  [31m[1m                         381527.3                         [0m[0m  |  [31m[1m                  7111.2                  [0m[0m
      512    x 768   |  [31m[1m                1467.7               [0m[0m  |  [31m[1m  232461.9  [0m[0m  |  [31m[1m         3586.0        [0m[0m  |  [31m[1m                   1493.7                  [0m[0m  |  [31m[1m                         191885.2                         [0m[0m  |  [31m[1m                  3826.8                  [0m[0m
      256    x 768   |  [31m[1m                 923.8               [0m[0m  |  [31m[1m  114867.5  [0m[0m  |  [31m[1m         1915.9        [0m[0m  |  [31m[1m                    945.3                  [0m[0m  |  [31m[1m                          95916.0                         [0m[0m  |  [31m[1m                  1999.7                  [0m[0m
      128    x 768   |  [31m[1m                 445.1               [0m[0m  |  [31m[1m   51876.7  [0m[0m  |  [31m[1m         1021.6        [0m[0m  |  [31m[1m                    464.2                  [0m[0m  |  [31m[1m                          56012.7                         [0m[0m  |  [31m[1m                  1002.5                  [0m[0m
      64     x 768   |  [31m[1m                 290.6               [0m[0m  |  [31m[1m   28735.3  [0m[0m  |  [31m[1m          562.4        [0m[0m  |  [31m[1m                    287.2                  [0m[0m  |  [31m[1m                          30151.0                         [0m[0m  |  [31m[1m                   610.3                  [0m[0m
      32     x 768   |  [2m[91m                 191.8               [0m[0m  |  [31m[1m    9996.7  [0m[0m  |  [31m[1m          335.1        [0m[0m  |  [2m[91m                    178.2                  [0m[0m  |  [31m[1m                           9148.2                         [0m[0m  |  [2m[91m                   312.8                  [0m[0m
      16     x 768   |  [2m[91m                 127.8               [0m[0m  |  [31m[1m    2285.0  [0m[0m  |  [2m[91m          215.9        [0m[0m  |  [2m[91m                    142.7                  [0m[0m  |  [31m[1m                           2041.4                         [0m[0m  |  [2m[91m                   213.0                  [0m[0m
      8      x 768   |  [2m[91m                  97.5               [0m[0m  |  [2m[91m    1257.8  [0m[0m  |  [2m[91m          152.2        [0m[0m  |  [2m[91m                     98.7                  [0m[0m  |  [2m[91m                           1098.5                         [0m[0m  |  [2m[91m                   162.8                  [0m[0m
      4      x 768   |                    65.8                 |       762.9    |  [2m[91m          121.6        [0m[0m  |                       83.8                    |  [2m[91m                            610.4                         [0m[0m  |                     128.3                  
      2      x 768   |                    63.5                 |       546.5    |            109.5          |                       83.8                    |                              314.6                           |                     117.9                  
      1      x 768   |  [92m[1m                  39.3               [0m[0m  |  [92m[1m     441.0  [0m[0m  |  [92m[1m           57.0        [0m[0m  |  [92m[1m                     47.1                  [0m[0m  |  [92m[1m                            256.3                         [0m[0m  |  [92m[1m                    66.4                  [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 12 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend trace  |  Fine-grained + structured sparsity @ 80 with backend trace  |  Dense benchmark - Compiled - backend trace
12 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                5721.4               [0m[0m  |  [31m[1m 1411080.3  [0m[0m  |  [31m[1m        12867.5        [0m[0m  |  [31m[1m                   5692.8                  [0m[0m  |  [31m[1m                        1370532.1                         [0m[0m  |  [31m[1m                 14101.0                  [0m[0m
      1024   x 768   |  [31m[1m                2800.0               [0m[0m  |  [31m[1m  741904.5  [0m[0m  |  [31m[1m         6693.5        [0m[0m  |  [31m[1m                   2820.6                  [0m[0m  |  [31m[1m                         822492.6                         [0m[0m  |  [31m[1m                  7076.8                  [0m[0m
      512    x 768   |  [31m[1m                1552.5               [0m[0m  |  [31m[1m  446031.4  [0m[0m  |  [31m[1m         3588.5        [0m[0m  |  [31m[1m                   1533.6                  [0m[0m  |  [31m[1m                         356921.4                         [0m[0m  |  [31m[1m                  3392.0                  [0m[0m
      256    x 768   |  [31m[1m                1171.0               [0m[0m  |  [31m[1m  181995.5  [0m[0m  |  [31m[1m         1852.5        [0m[0m  |  [31m[1m                    941.6                  [0m[0m  |  [31m[1m                         193846.8                         [0m[0m  |  [31m[1m                  1829.4                  [0m[0m
      128    x 768   |  [31m[1m                 465.7               [0m[0m  |  [31m[1m   96569.8  [0m[0m  |  [31m[1m          991.5        [0m[0m  |  [31m[1m                    490.2                  [0m[0m  |  [31m[1m                          97922.7                         [0m[0m  |  [31m[1m                  1063.7                  [0m[0m
      64     x 768   |  [31m[1m                 286.6               [0m[0m  |  [31m[1m   51930.5  [0m[0m  |  [31m[1m          596.5        [0m[0m  |  [31m[1m                    284.9                  [0m[0m  |  [31m[1m                          49571.9                         [0m[0m  |  [31m[1m                   563.7                  [0m[0m
      32     x 768   |  [2m[91m                 171.6               [0m[0m  |  [31m[1m   26317.0  [0m[0m  |  [31m[1m          321.9        [0m[0m  |  [2m[91m                    186.9                  [0m[0m  |  [31m[1m                          26793.1                         [0m[0m  |  [2m[91m                   328.0                  [0m[0m
      16     x 768   |  [2m[91m                 126.6               [0m[0m  |  [31m[1m    5565.6  [0m[0m  |  [2m[91m          204.0        [0m[0m  |  [2m[91m                    137.1                  [0m[0m  |  [31m[1m                           8676.1                         [0m[0m  |  [2m[91m                   207.8                  [0m[0m
      8      x 768   |  [2m[91m                  90.8               [0m[0m  |  [2m[91m    2290.1  [0m[0m  |  [2m[91m          158.8        [0m[0m  |  [2m[91m                    105.7                  [0m[0m  |  [31m[1m                           2035.9                         [0m[0m  |  [2m[91m                   161.1                  [0m[0m
      4      x 768   |                    76.1                 |  [2m[91m    1395.6  [0m[0m  |  [2m[91m          118.9        [0m[0m  |                       86.6                    |  [2m[91m                           1041.1                         [0m[0m  |                     135.2                  
      2      x 768   |                    70.6                 |       821.0    |  [2m[91m          117.4        [0m[0m  |                       76.3                    |                              594.0                           |                     118.9                  
      1      x 768   |  [92m[1m                  41.3               [0m[0m  |  [92m[1m     551.8  [0m[0m  |  [92m[1m           58.6        [0m[0m  |  [92m[1m                     49.4                  [0m[0m  |  [92m[1m                            359.3                         [0m[0m  |  [92m[1m                    71.1                  [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 90 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 2048 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 80 num_threads 12 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 80 num_threads 12 with compiler trace using backend trace
[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 12 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend trace  |  Fine-grained + structured sparsity @ 90 with backend trace  |  Dense benchmark - Compiled - backend trace
12 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                278.0                [0m[0m  |  [31m[1m  11528.1   [0m[0m  |  [31m[1m         644.2         [0m[0m  |  [31m[1m                   280.1                   [0m[0m  |  [31m[1m                          9661.6                          [0m[0m  |  [31m[1m                  650.2                   [0m[0m
      1024   x 768   |  [2m[91m                142.2                [0m[0m  |  [31m[1m   5879.6   [0m[0m  |  [31m[1m         326.9         [0m[0m  |  [2m[91m                   141.6                   [0m[0m  |  [31m[1m                          4799.4                          [0m[0m  |  [31m[1m                  330.3                   [0m[0m
      512    x 768   |                   72.6                  |  [31m[1m   2975.0   [0m[0m  |  [2m[91m         168.2         [0m[0m  |                      76.3                     |  [31m[1m                          2402.9                          [0m[0m  |  [2m[91m                  168.9                   [0m[0m
      256    x 768   |                   51.1                  |  [31m[1m   1484.2   [0m[0m  |            92.0           |                      67.1                     |  [31m[1m                          1216.7                          [0m[0m  |                     92.8                   
      128    x 768   |  [34m[1m                 47.0                [0m[0m  |  [2m[91m    742.0   [0m[0m  |            58.0           |                      80.5                     |  [31m[1m                           595.6                          [0m[0m  |                     82.7                   
      64     x 768   |                   67.1                  |      373.9     |            64.2           |                      67.3                     |  [2m[91m                           292.1                          [0m[0m  |  [34m[1m                   64.2                   [0m[0m
      32     x 768   |                   56.9                  |  [34m[1m    285.4   [0m[0m  |  [34m[1m          51.2         [0m[0m  |                      65.0                     |                             148.7                            |  [34m[1m                   65.6                   [0m[0m
      16     x 768   |                   54.1                  |  [34m[1m    284.5   [0m[0m  |            55.5           |                      68.9                     |  [92m[1m                            88.1                          [0m[0m  |  [34m[1m                   68.7                   [0m[0m
      8      x 768   |                   56.6                  |  [34m[1m    299.9   [0m[0m  |            57.8           |                      70.4                     |  [34m[1m                            88.2                          [0m[0m  |  [34m[1m                   68.9                   [0m[0m
      4      x 768   |                   54.9                  |  [34m[1m    286.8   [0m[0m  |  [92m[1m          48.9         [0m[0m  |                      68.4                     |  [92m[1m                            88.1                          [0m[0m  |                     83.1                   
      2      x 768   |                   53.0                  |      337.6     |            64.2           |  [92m[1m                    52.6                   [0m[0m  |  [92m[1m                            87.3                          [0m[0m  |  [92m[1m                   62.7                   [0m[0m
      1      x 768   |  [92m[1m                 46.0                [0m[0m  |  [92m[1m    277.4   [0m[0m  |  [34m[1m          49.5         [0m[0m  |                      60.7                     |  [34m[1m                            91.2                          [0m[0m  |  [34m[1m                   65.4                   [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 12 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend trace  |  Fine-grained + structured sparsity @ 80 with backend trace  |  Dense benchmark - Compiled - backend trace
12 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                298.6                [0m[0m  |  [31m[1m  26612.4   [0m[0m  |  [31m[1m         684.5         [0m[0m  |  [31m[1m                   307.2                   [0m[0m  |  [31m[1m                         20707.7                          [0m[0m  |  [31m[1m                  682.6                   [0m[0m
      1024   x 768   |  [2m[91m                156.8                [0m[0m  |  [31m[1m  13369.3   [0m[0m  |  [31m[1m         342.9         [0m[0m  |  [2m[91m                   157.2                   [0m[0m  |  [31m[1m                         10376.4                          [0m[0m  |  [31m[1m                  342.7                   [0m[0m
      512    x 768   |  [2m[91m                 76.6                [0m[0m  |  [31m[1m   6717.7   [0m[0m  |  [2m[91m         172.6         [0m[0m  |                      84.0                     |  [31m[1m                          5220.6                          [0m[0m  |  [2m[91m                  172.9                   [0m[0m
      256    x 768   |                   63.1                  |  [31m[1m   3415.2   [0m[0m  |            94.0           |                      79.0                     |  [31m[1m                          2612.5                          [0m[0m  |                     94.1                   
      128    x 768   |                   52.1                  |  [31m[1m   1710.9   [0m[0m  |            58.7           |  [34m[1m                    62.7                   [0m[0m  |  [31m[1m                          1311.2                          [0m[0m  |                     83.2                   
      64     x 768   |                   54.2                  |  [2m[91m    859.8   [0m[0m  |            52.7           |                      69.8                     |  [31m[1m                           670.3                          [0m[0m  |  [34m[1m                   69.6                   [0m[0m
      32     x 768   |                   55.2                  |      440.3     |            56.1           |                      71.0                     |  [2m[91m                           328.4                          [0m[0m  |  [34m[1m                   70.2                   [0m[0m
      16     x 768   |                   57.8                  |  [34m[1m    289.6   [0m[0m  |            55.3           |                      69.0                     |                             170.1                            |  [34m[1m                   69.1                   [0m[0m
      8      x 768   |                   54.2                  |      309.2     |            58.8           |                      71.7                     |                             120.1                            |  [34m[1m                   69.1                   [0m[0m
      4      x 768   |                   55.8                  |  [34m[1m    284.1   [0m[0m  |  [92m[1m          47.7         [0m[0m  |                      67.9                     |  [92m[1m                            88.7                          [0m[0m  |  [92m[1m                   63.9                   [0m[0m
      2      x 768   |  [92m[1m                 38.3                [0m[0m  |  [34m[1m    298.0   [0m[0m  |  [34m[1m          48.5         [0m[0m  |                      74.3                     |                             112.5                            |                     81.0                   
      1      x 768   |                   53.0                  |  [92m[1m    278.9   [0m[0m  |  [34m[1m          50.5         [0m[0m  |  [92m[1m                    60.7                   [0m[0m  |  [92m[1m                            88.2                          [0m[0m  |                     72.5                   

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 2048 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 12 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                5720.1               [0m[0m  |  [31m[1m  749839.7  [0m[0m  |  [31m[1m        13029.7        [0m[0m  |  [31m[1m                    5504.4                    [0m[0m  |  [31m[1m                           17607.0                           [0m[0m  |  [31m[1m                   13521.1                   [0m[0m
      1024   x 768   |  [31m[1m                3266.8               [0m[0m  |  [31m[1m  372560.4  [0m[0m  |  [31m[1m         6543.7        [0m[0m  |  [31m[1m                    2944.4                    [0m[0m  |  [31m[1m                            8484.9                           [0m[0m  |  [31m[1m                    6817.5                   [0m[0m
      512    x 768   |  [31m[1m                1458.8               [0m[0m  |  [31m[1m  210059.7  [0m[0m  |  [31m[1m         3446.5        [0m[0m  |  [31m[1m                    1595.2                    [0m[0m  |  [31m[1m                            4503.9                           [0m[0m  |  [31m[1m                    3575.0                   [0m[0m
      256    x 768   |  [31m[1m                 947.9               [0m[0m  |  [31m[1m   73191.8  [0m[0m  |  [31m[1m         1836.1        [0m[0m  |  [31m[1m                    1028.4                    [0m[0m  |  [31m[1m                            2276.8                           [0m[0m  |  [31m[1m                    1955.4                   [0m[0m
      128    x 768   |  [31m[1m                 488.2               [0m[0m  |  [31m[1m   33241.0  [0m[0m  |  [31m[1m          971.0        [0m[0m  |  [31m[1m                     554.5                    [0m[0m  |  [31m[1m                            1183.4                           [0m[0m  |  [31m[1m                    1060.7                   [0m[0m
      64     x 768   |  [31m[1m                 266.3               [0m[0m  |  [31m[1m   11753.9  [0m[0m  |  [31m[1m          556.7        [0m[0m  |  [2m[91m                     357.6                    [0m[0m  |  [31m[1m                             663.3                           [0m[0m  |  [31m[1m                     572.7                   [0m[0m
      32     x 768   |  [31m[1m                 232.2               [0m[0m  |  [31m[1m    5895.5  [0m[0m  |  [31m[1m          329.7        [0m[0m  |  [2m[91m                     237.7                    [0m[0m  |  [2m[91m                             389.3                           [0m[0m  |  [2m[91m                     332.9                   [0m[0m
      16     x 768   |  [2m[91m                 131.2               [0m[0m  |  [31m[1m    2349.5  [0m[0m  |  [2m[91m          221.9        [0m[0m  |                       201.9                      |  [2m[91m                             244.3                           [0m[0m  |  [2m[91m                     239.8                   [0m[0m
      8      x 768   |  [2m[91m                  95.0               [0m[0m  |  [2m[91m    1313.4  [0m[0m  |  [2m[91m          228.6        [0m[0m  |                       162.1                      |                               164.8                             |  [2m[91m                     194.8                   [0m[0m
      4      x 768   |                    73.8                 |       769.7    |            119.9          |                       145.9                      |                               126.9                             |                       151.8                   
      2      x 768   |                    59.4                 |       567.3    |            119.8          |                       132.8                      |  [92m[1m                             107.9                           [0m[0m  |                       148.1                   
      1      x 768   |  [92m[1m                  37.3               [0m[0m  |  [92m[1m     441.4  [0m[0m  |  [92m[1m           60.4        [0m[0m  |  [92m[1m                     107.4                    [0m[0m  |  [92m[1m                             107.6                           [0m[0m  |  [92m[1m                      89.1                   [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 12 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                5535.9               [0m[0m  |  [31m[1m 1394612.6  [0m[0m  |  [31m[1m        14510.0        [0m[0m  |  [31m[1m                    5974.1                    [0m[0m  |  [31m[1m                           36023.0                           [0m[0m  |  [31m[1m                   17662.2                   [0m[0m
      1024   x 768   |  [31m[1m                2971.6               [0m[0m  |  [31m[1m  729863.9  [0m[0m  |  [31m[1m         7537.1        [0m[0m  |  [31m[1m                    2915.3                    [0m[0m  |  [31m[1m                           17846.2                           [0m[0m  |  [31m[1m                    7879.7                   [0m[0m
      512    x 768   |  [31m[1m                1494.0               [0m[0m  |  [31m[1m  336033.8  [0m[0m  |  [31m[1m         3613.3        [0m[0m  |  [31m[1m                    1564.3                    [0m[0m  |  [31m[1m                            9071.0                           [0m[0m  |  [31m[1m                    3501.7                   [0m[0m
      256    x 768   |  [31m[1m                1182.9               [0m[0m  |  [31m[1m  182145.0  [0m[0m  |  [31m[1m         2188.3        [0m[0m  |  [31m[1m                    1034.0                    [0m[0m  |  [31m[1m                            4558.6                           [0m[0m  |  [31m[1m                    2189.5                   [0m[0m
      128    x 768   |  [31m[1m                 782.6               [0m[0m  |  [31m[1m   73484.7  [0m[0m  |  [31m[1m         1032.9        [0m[0m  |  [2m[91m                     556.0                    [0m[0m  |  [31m[1m                            2327.2                           [0m[0m  |  [31m[1m                    1133.4                   [0m[0m
      64     x 768   |  [31m[1m                 282.1               [0m[0m  |  [31m[1m   32875.3  [0m[0m  |  [31m[1m          553.7        [0m[0m  |  [2m[91m                     374.8                    [0m[0m  |  [31m[1m                            1204.9                           [0m[0m  |  [31m[1m                     680.0                   [0m[0m
      32     x 768   |  [2m[91m                 184.5               [0m[0m  |  [31m[1m   11569.1  [0m[0m  |  [31m[1m          307.7        [0m[0m  |  [2m[91m                     253.9                    [0m[0m  |  [31m[1m                             648.9                           [0m[0m  |  [2m[91m                     338.2                   [0m[0m
      16     x 768   |  [2m[91m                 125.2               [0m[0m  |  [31m[1m    4854.7  [0m[0m  |  [2m[91m          200.0        [0m[0m  |                       197.0                      |  [2m[91m                             401.6                           [0m[0m  |  [2m[91m                     235.5                   [0m[0m
      8      x 768   |  [2m[91m                  95.3               [0m[0m  |  [2m[91m    2186.4  [0m[0m  |  [2m[91m          155.9        [0m[0m  |                       163.1                      |  [2m[91m                             231.7                           [0m[0m  |  [2m[91m                     211.3                   [0m[0m
      4      x 768   |                    75.3                 |  [2m[91m    1322.9  [0m[0m  |  [2m[91m          117.7        [0m[0m  |                       149.8                      |                               164.7                             |                       154.0                   
      2      x 768   |                    64.0                 |       775.6    |            112.9          |                       148.1                      |                               125.9                             |                       141.1                   
      1      x 768   |  [92m[1m                  38.5               [0m[0m  |  [92m[1m     532.0  [0m[0m  |  [92m[1m           56.9        [0m[0m  |  [92m[1m                     115.7                    [0m[0m  |  [92m[1m                             113.0                           [0m[0m  |  [92m[1m                      96.0                   [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 2048 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 12 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 12 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                272.3                [0m[0m  |  [31m[1m  11523.9   [0m[0m  |  [31m[1m         640.5         [0m[0m  |  [2m[91m                    289.1                     [0m[0m  |  [31m[1m                            3863.9                           [0m[0m  |  [31m[1m                    643.4                    [0m[0m
      1024   x 768   |  [2m[91m                143.7                [0m[0m  |  [31m[1m   5852.9   [0m[0m  |  [31m[1m         327.9         [0m[0m  |                      146.6                       |  [31m[1m                            1947.5                           [0m[0m  |  [2m[91m                    331.1                    [0m[0m
      512    x 768   |                   73.2                  |  [31m[1m   2954.7   [0m[0m  |  [2m[91m         169.5         [0m[0m  |  [34m[1m                    107.9                     [0m[0m  |  [31m[1m                             980.4                           [0m[0m  |                      168.6                    
      256    x 768   |  [34m[1m                 51.9                [0m[0m  |  [31m[1m   1488.3   [0m[0m  |            91.9           |  [34m[1m                    112.2                     [0m[0m  |  [2m[91m                             500.8                           [0m[0m  |                      110.9                    
      128    x 768   |                   63.1                  |  [2m[91m    741.8   [0m[0m  |            67.3           |                      126.6                       |  [2m[91m                             264.2                           [0m[0m  |                      105.8                    
      64     x 768   |                   67.5                  |      369.9     |  [34m[1m          53.9         [0m[0m  |  [34m[1m                    111.4                     [0m[0m  |                               136.0                             |  [34m[1m                     91.6                    [0m[0m
      32     x 768   |                   56.2                  |      346.3     |  [92m[1m          52.0         [0m[0m  |  [34m[1m                    104.5                     [0m[0m  |  [92m[1m                             104.4                           [0m[0m  |  [92m[1m                     86.8                    [0m[0m
      16     x 768   |                   55.0                  |  [34m[1m    287.5   [0m[0m  |  [34m[1m          55.4         [0m[0m  |  [34m[1m                    106.3                     [0m[0m  |  [92m[1m                             104.8                           [0m[0m  |  [34m[1m                     90.7                    [0m[0m
      8      x 768   |                   55.2                  |  [34m[1m    288.2   [0m[0m  |  [34m[1m          55.4         [0m[0m  |  [92m[1m                    103.0                     [0m[0m  |  [92m[1m                             104.1                           [0m[0m  |  [34m[1m                     90.0                    [0m[0m
      4      x 768   |                   54.8                  |  [34m[1m    288.8   [0m[0m  |  [92m[1m          51.8         [0m[0m  |  [34m[1m                    106.1                     [0m[0m  |  [34m[1m                             107.9                           [0m[0m  |                      102.5                    
      2      x 768   |  [34m[1m                 52.4                [0m[0m  |  [34m[1m    307.6   [0m[0m  |  [34m[1m          53.0         [0m[0m  |  [34m[1m                    107.5                     [0m[0m  |  [34m[1m                             113.6                           [0m[0m  |                      103.1                    
      1      x 768   |  [92m[1m                 49.4                [0m[0m  |  [92m[1m    282.4   [0m[0m  |  [92m[1m          52.1         [0m[0m  |  [34m[1m                    111.5                     [0m[0m  |  [34m[1m                             109.2                           [0m[0m  |                       96.2                    

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 12 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
12 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                298.5                [0m[0m  |  [31m[1m  26491.3   [0m[0m  |  [31m[1m         677.0         [0m[0m  |  [2m[91m                    286.7                     [0m[0m  |  [31m[1m                            7888.5                           [0m[0m  |  [31m[1m                    673.8                    [0m[0m
      1024   x 768   |  [2m[91m                158.4                [0m[0m  |  [31m[1m  13394.1   [0m[0m  |  [31m[1m         340.4         [0m[0m  |                      154.1                       |  [31m[1m                            3932.1                           [0m[0m  |  [2m[91m                    339.5                    [0m[0m
      512    x 768   |                   76.5                  |  [31m[1m   6693.3   [0m[0m  |  [2m[91m         172.4         [0m[0m  |                      117.0                       |  [31m[1m                            1973.4                           [0m[0m  |  [2m[91m                    172.8                    [0m[0m
      256    x 768   |                   46.6                  |  [31m[1m   3406.1   [0m[0m  |            93.8           |  [34m[1m                    109.9                     [0m[0m  |  [31m[1m                             996.9                           [0m[0m  |                      103.5                    
      128    x 768   |                   64.9                  |  [31m[1m   1703.6   [0m[0m  |            59.9           |  [34m[1m                    103.8                     [0m[0m  |  [2m[91m                             504.8                           [0m[0m  |  [34m[1m                     88.0                    [0m[0m
      64     x 768   |                   51.8                  |  [2m[91m    865.1   [0m[0m  |  [34m[1m          52.0         [0m[0m  |  [34m[1m                    107.4                     [0m[0m  |  [2m[91m                             255.3                           [0m[0m  |  [34m[1m                     86.9                    [0m[0m
      32     x 768   |                   52.8                  |      440.1     |  [34m[1m          51.3         [0m[0m  |  [92m[1m                    102.3                     [0m[0m  |                               132.4                             |  [34m[1m                     87.1                    [0m[0m
      16     x 768   |                   54.4                  |  [34m[1m    291.4   [0m[0m  |  [34m[1m          54.1         [0m[0m  |  [34m[1m                    104.1                     [0m[0m  |  [34m[1m                             108.3                           [0m[0m  |                       93.3                    
      8      x 768   |                   58.3                  |      313.2     |            58.2           |                      116.3                       |  [34m[1m                             111.9                           [0m[0m  |                       93.8                    
      4      x 768   |                   56.6                  |  [34m[1m    299.9   [0m[0m  |  [34m[1m          50.6         [0m[0m  |  [34m[1m                    104.1                     [0m[0m  |  [34m[1m                             107.1                           [0m[0m  |  [92m[1m                     82.5                    [0m[0m
      2      x 768   |  [92m[1m                 38.3                [0m[0m  |  [34m[1m    286.8   [0m[0m  |  [92m[1m          50.3         [0m[0m  |  [34m[1m                    105.7                     [0m[0m  |  [34m[1m                             104.8                           [0m[0m  |  [34m[1m                     83.5                    [0m[0m
      1      x 768   |                   46.6                  |  [92m[1m    283.2   [0m[0m  |  [92m[1m          50.0         [0m[0m  |  [34m[1m                    103.9                     [0m[0m  |  [92m[1m                             102.0                           [0m[0m  |  [92m[1m                     83.0                    [0m[0m

Times are in microseconds (us).
/home/user/build/.venv/lib/python3.10/site-packages/torch/jit/_script.py:1241: UserWarning: `optimize` is deprecated and has no effect. Use `with torch.jit.optimized_execution() instead
  warnings.warn(

Benchmarking batch size 2048 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 2048 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler script using backend script
[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend script  |  Fine-grained + structured sparsity @ 90 with backend script  |  Dense benchmark - Compiled - backend script
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                3683.1               [0m[0m  |  [31m[1m  582834.0  [0m[0m  |  [31m[1m         9404.3        [0m[0m  |  [31m[1m                   3669.0                   [0m[0m  |  [31m[1m                          599941.1                         [0m[0m  |  [31m[1m                   9885.9                  [0m[0m
      1024   x 768   |  [31m[1m                1940.8               [0m[0m  |  [31m[1m  291414.8  [0m[0m  |  [31m[1m         3229.5        [0m[0m  |  [31m[1m                   1986.0                   [0m[0m  |  [31m[1m                          328755.6                         [0m[0m  |  [31m[1m                   3136.9                  [0m[0m
      512    x 768   |  [31m[1m                 756.1               [0m[0m  |  [31m[1m  160166.7  [0m[0m  |  [31m[1m         2448.6        [0m[0m  |  [31m[1m                    680.4                   [0m[0m  |  [31m[1m                          173716.6                         [0m[0m  |  [31m[1m                   2001.5                  [0m[0m
      256    x 768   |  [31m[1m                 562.7               [0m[0m  |  [31m[1m  100703.7  [0m[0m  |  [31m[1m          930.3        [0m[0m  |  [31m[1m                    411.6                   [0m[0m  |  [31m[1m                           98528.7                         [0m[0m  |  [31m[1m                   1876.4                  [0m[0m
      128    x 768   |  [31m[1m                 364.2               [0m[0m  |  [31m[1m   33565.8  [0m[0m  |  [31m[1m          669.9        [0m[0m  |  [2m[91m                    244.2                   [0m[0m  |  [31m[1m                           51112.0                         [0m[0m  |  [31m[1m                    793.6                  [0m[0m
      64     x 768   |  [31m[1m                 183.0               [0m[0m  |  [31m[1m    9577.5  [0m[0m  |  [31m[1m          311.0        [0m[0m  |  [2m[91m                    148.5                   [0m[0m  |  [31m[1m                           24156.4                         [0m[0m  |  [31m[1m                    527.0                  [0m[0m
      32     x 768   |  [2m[91m                 141.0               [0m[0m  |  [31m[1m    2211.4  [0m[0m  |  [2m[91m          185.7        [0m[0m  |  [2m[91m                    122.3                   [0m[0m  |  [31m[1m                            7299.8                         [0m[0m  |  [2m[91m                    267.9                  [0m[0m
      16     x 768   |  [2m[91m                 107.4               [0m[0m  |  [2m[91m    1176.8  [0m[0m  |  [2m[91m          134.5        [0m[0m  |  [2m[91m                    124.8                   [0m[0m  |  [2m[91m                            1018.7                         [0m[0m  |                      120.7                  
      8      x 768   |  [2m[91m                  77.3               [0m[0m  |       711.8    |  [2m[91m          102.1        [0m[0m  |                       73.3                     |  [2m[91m                             536.0                         [0m[0m  |                       93.8                  
      4      x 768   |                    61.4                 |       630.5    |             80.5          |                       59.2                     |  [2m[91m                             491.2                         [0m[0m  |                       68.4                  
      2      x 768   |                    54.3                 |       474.5    |             72.1          |                       57.2                     |                               303.1                           |  [92m[1m                     61.7                  [0m[0m
      1      x 768   |  [92m[1m                  36.3               [0m[0m  |  [92m[1m     399.6  [0m[0m  |  [92m[1m           47.0        [0m[0m  |  [92m[1m                     50.6                   [0m[0m  |  [92m[1m                             215.9                         [0m[0m  |                       82.1                  

Times are in microseconds (us).

[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend script  |  Fine-grained + structured sparsity @ 80 with backend script  |  Dense benchmark - Compiled - backend script
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                2476.4               [0m[0m  |  [31m[1m 1111739.1  [0m[0m  |  [31m[1m         6441.7        [0m[0m  |  [31m[1m                   2640.3                   [0m[0m  |  [31m[1m                         1150095.3                         [0m[0m  |  [31m[1m                   9029.3                  [0m[0m
      1024   x 768   |  [31m[1m                1195.9               [0m[0m  |  [31m[1m  562805.0  [0m[0m  |  [31m[1m         3513.5        [0m[0m  |  [31m[1m                   1347.5                   [0m[0m  |  [31m[1m                          584435.6                         [0m[0m  |  [31m[1m                   3322.2                  [0m[0m
      512    x 768   |  [31m[1m                 761.0               [0m[0m  |  [31m[1m  297824.3  [0m[0m  |  [31m[1m         2472.7        [0m[0m  |  [31m[1m                    738.4                   [0m[0m  |  [31m[1m                          331621.4                         [0m[0m  |  [31m[1m                   3373.8                  [0m[0m
      256    x 768   |  [31m[1m                 668.9               [0m[0m  |  [31m[1m  175152.6  [0m[0m  |  [31m[1m         1460.9        [0m[0m  |  [31m[1m                    633.4                   [0m[0m  |  [31m[1m                          172244.1                         [0m[0m  |  [31m[1m                   1887.1                  [0m[0m
      128    x 768   |  [31m[1m                 278.7               [0m[0m  |  [31m[1m   95052.3  [0m[0m  |  [31m[1m          591.1        [0m[0m  |  [2m[91m                    220.2                   [0m[0m  |  [31m[1m                           94083.3                         [0m[0m  |  [31m[1m                    600.8                  [0m[0m
      64     x 768   |  [2m[91m                 179.1               [0m[0m  |  [31m[1m   49905.6  [0m[0m  |  [31m[1m          299.0        [0m[0m  |  [2m[91m                    141.9                   [0m[0m  |  [31m[1m                           47416.8                         [0m[0m  |  [31m[1m                    348.6                  [0m[0m
      32     x 768   |  [2m[91m                 134.3               [0m[0m  |  [31m[1m   23845.1  [0m[0m  |  [2m[91m          237.8        [0m[0m  |  [2m[91m                    108.7                   [0m[0m  |  [31m[1m                           23471.0                         [0m[0m  |  [2m[91m                    186.4                  [0m[0m
      16     x 768   |  [2m[91m                  96.3               [0m[0m  |  [2m[91m    2382.9  [0m[0m  |  [2m[91m          134.0        [0m[0m  |  [2m[91m                    118.5                   [0m[0m  |  [31m[1m                            2193.5                         [0m[0m  |  [2m[91m                    122.9                  [0m[0m
      8      x 768   |                    72.9                 |  [2m[91m    1158.8  [0m[0m  |  [2m[91m          102.5        [0m[0m  |                       66.6                     |  [2m[91m                             942.7                         [0m[0m  |                       97.2                  
      4      x 768   |                    60.1                 |       754.2    |             80.1          |  [34m[1m                     56.7                   [0m[0m  |                               510.2                           |                       68.4                  
      2      x 768   |                    53.9                 |       595.8    |             71.0          |  [92m[1m                     53.0                   [0m[0m  |                               460.2                           |  [34m[1m                     61.9                  [0m[0m
      1      x 768   |  [92m[1m                  36.9               [0m[0m  |  [92m[1m     527.4  [0m[0m  |  [92m[1m           47.8        [0m[0m  |  [92m[1m                     53.1                   [0m[0m  |  [92m[1m                             308.4                         [0m[0m  |  [92m[1m                     58.1                  [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler script using backend script
Benchmarking batch size 2048 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler script using backend script
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler script using backend script
[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend script  |  Fine-grained + structured sparsity @ 90 with backend script  |  Dense benchmark - Compiled - backend script
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                276.7                [0m[0m  |  [31m[1m  11664.1   [0m[0m  |  [31m[1m         647.2         [0m[0m  |  [2m[91m                   223.4                    [0m[0m  |  [31m[1m                           9679.4                          [0m[0m  |  [31m[1m                   648.1                   [0m[0m
      1024   x 768   |  [2m[91m                142.2                [0m[0m  |  [31m[1m   5902.2   [0m[0m  |  [31m[1m         328.6         [0m[0m  |  [2m[91m                   131.9                    [0m[0m  |  [31m[1m                           4890.1                          [0m[0m  |  [31m[1m                   342.0                   [0m[0m
      512    x 768   |                   72.4                  |  [31m[1m   2945.3   [0m[0m  |  [2m[91m         169.6         [0m[0m  |                      76.2                      |  [31m[1m                           2452.5                          [0m[0m  |  [2m[91m                   190.9                   [0m[0m
      256    x 768   |                   52.1                  |  [31m[1m   1478.7   [0m[0m  |            91.6           |                      50.3                      |  [31m[1m                           1199.9                          [0m[0m  |                      93.7                   
      128    x 768   |                   47.8                  |  [2m[91m    748.2   [0m[0m  |            58.2           |                      52.9                      |  [31m[1m                            593.3                          [0m[0m  |                      54.8                   
      64     x 768   |                   51.1                  |      385.6     |  [34m[1m          51.0         [0m[0m  |                      52.3                      |  [2m[91m                            285.1                          [0m[0m  |                      54.4                   
      32     x 768   |                   52.6                  |  [92m[1m    284.6   [0m[0m  |  [34m[1m          52.0         [0m[0m  |                      53.2                      |                              146.3                            |                      53.5                   
      16     x 768   |                   54.1                  |  [34m[1m    285.9   [0m[0m  |            55.5           |                      53.6                      |  [34m[1m                             80.6                          [0m[0m  |                      54.0                   
      8      x 768   |                   54.5                  |  [92m[1m    283.9   [0m[0m  |            55.2           |                      54.2                      |  [34m[1m                             80.6                          [0m[0m  |                      54.0                   
      4      x 768   |                   54.0                  |  [92m[1m    283.9   [0m[0m  |  [92m[1m          47.9         [0m[0m  |                      54.4                      |  [34m[1m                             79.8                          [0m[0m  |  [34m[1m                    48.3                   [0m[0m
      2      x 768   |  [92m[1m                 38.6                [0m[0m  |  [92m[1m    283.4   [0m[0m  |  [92m[1m          48.2         [0m[0m  |  [34m[1m                    47.5                    [0m[0m  |  [92m[1m                             79.0                          [0m[0m  |  [92m[1m                    47.7                   [0m[0m
      1      x 768   |                   46.2                  |  [92m[1m    282.4   [0m[0m  |  [34m[1m          49.9         [0m[0m  |  [92m[1m                    45.4                    [0m[0m  |  [92m[1m                             78.5                          [0m[0m  |  [92m[1m                    47.4                   [0m[0m

Times are in microseconds (us).

[----------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  ----------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend script  |  Fine-grained + structured sparsity @ 80 with backend script  |  Dense benchmark - Compiled - backend script
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                299.3                [0m[0m  |  [31m[1m  26952.9   [0m[0m  |  [31m[1m         687.0         [0m[0m  |  [31m[1m                   232.9                    [0m[0m  |  [31m[1m                          20499.2                          [0m[0m  |  [31m[1m                   661.9                   [0m[0m
      1024   x 768   |  [2m[91m                153.0                [0m[0m  |  [31m[1m  13551.6   [0m[0m  |  [31m[1m         343.1         [0m[0m  |  [2m[91m                   140.6                    [0m[0m  |  [31m[1m                          10381.3                          [0m[0m  |  [31m[1m                   348.0                   [0m[0m
      512    x 768   |  [2m[91m                 79.9                [0m[0m  |  [31m[1m   6723.5   [0m[0m  |  [2m[91m         172.7         [0m[0m  |                      80.3                      |  [31m[1m                           5219.1                          [0m[0m  |  [2m[91m                   196.5                   [0m[0m
      256    x 768   |                   48.0                  |  [31m[1m   3377.3   [0m[0m  |            93.9           |                      53.8                      |  [31m[1m                           2612.1                          [0m[0m  |  [2m[91m                    96.4                   [0m[0m
      128    x 768   |                   48.4                  |  [31m[1m   1717.3   [0m[0m  |            58.6           |                      54.2                      |  [31m[1m                           1318.6                          [0m[0m  |                      56.1                   
      64     x 768   |                   50.6                  |  [2m[91m    866.7   [0m[0m  |  [34m[1m          50.3         [0m[0m  |                      52.7                      |  [31m[1m                            672.9                          [0m[0m  |                      54.3                   
      32     x 768   |                   52.0                  |      439.8     |  [34m[1m          52.1         [0m[0m  |                      52.0                      |  [2m[91m                            328.3                          [0m[0m  |                      54.4                   
      16     x 768   |                   54.8                  |  [34m[1m    284.0   [0m[0m  |            55.4           |                      52.8                      |  [2m[91m                            169.6                          [0m[0m  |                      53.7                   
      8      x 768   |                   55.5                  |  [34m[1m    281.7   [0m[0m  |            54.4           |                      51.9                      |                               89.6                            |                      54.3                   
      4      x 768   |                   55.1                  |  [34m[1m    282.4   [0m[0m  |  [92m[1m          47.8         [0m[0m  |  [34m[1m                    47.0                    [0m[0m  |  [34m[1m                             79.6                          [0m[0m  |  [92m[1m                    47.1                   [0m[0m
      2      x 768   |  [92m[1m                 38.0                [0m[0m  |  [34m[1m    283.0   [0m[0m  |  [92m[1m          47.7         [0m[0m  |  [34m[1m                    47.2                    [0m[0m  |  [34m[1m                             80.6                          [0m[0m  |  [34m[1m                    47.9                   [0m[0m
      1      x 768   |                   46.7                  |  [92m[1m    276.8   [0m[0m  |  [34m[1m          48.7         [0m[0m  |  [92m[1m                    45.8                    [0m[0m  |  [92m[1m                             78.5                          [0m[0m  |  [92m[1m                    46.7                   [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 2048 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler trace using backend trace
[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend trace  |  Fine-grained + structured sparsity @ 90 with backend trace  |  Dense benchmark - Compiled - backend trace
32 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                3644.1               [0m[0m  |  [31m[1m  592915.5  [0m[0m  |  [31m[1m         9019.3        [0m[0m  |  [31m[1m                   3658.0                  [0m[0m  |  [31m[1m                         603985.5                         [0m[0m  |  [31m[1m                  9860.3                  [0m[0m
      1024   x 768   |  [31m[1m                1772.1               [0m[0m  |  [31m[1m  295914.0  [0m[0m  |  [31m[1m         4216.4        [0m[0m  |  [31m[1m                   1892.0                  [0m[0m  |  [31m[1m                         305668.8                         [0m[0m  |  [31m[1m                  4052.4                  [0m[0m
      512    x 768   |  [31m[1m                 712.0               [0m[0m  |  [31m[1m  154569.8  [0m[0m  |  [31m[1m         1578.7        [0m[0m  |  [31m[1m                    739.7                  [0m[0m  |  [31m[1m                         160203.1                         [0m[0m  |  [31m[1m                  1623.9                  [0m[0m
      256    x 768   |  [31m[1m                 557.3               [0m[0m  |  [31m[1m   83341.2  [0m[0m  |  [31m[1m          989.0        [0m[0m  |  [31m[1m                    491.1                  [0m[0m  |  [31m[1m                          83507.6                         [0m[0m  |  [31m[1m                   972.1                  [0m[0m
      128    x 768   |  [31m[1m                 282.9               [0m[0m  |  [31m[1m   47578.2  [0m[0m  |  [31m[1m          536.7        [0m[0m  |  [31m[1m                    296.0                  [0m[0m  |  [31m[1m                          47399.3                         [0m[0m  |  [31m[1m                   544.7                  [0m[0m
      64     x 768   |  [31m[1m                 235.2               [0m[0m  |  [31m[1m   24414.6  [0m[0m  |  [31m[1m          379.7        [0m[0m  |  [2m[91m                    196.9                  [0m[0m  |  [31m[1m                          24265.2                         [0m[0m  |  [31m[1m                   315.8                  [0m[0m
      32     x 768   |  [2m[91m                 144.2               [0m[0m  |  [31m[1m    7072.1  [0m[0m  |  [2m[91m          179.4        [0m[0m  |  [2m[91m                    152.2                  [0m[0m  |  [31m[1m                           6417.6                         [0m[0m  |  [2m[91m                   252.4                  [0m[0m
      16     x 768   |  [2m[91m                 109.5               [0m[0m  |  [2m[91m    1203.1  [0m[0m  |  [2m[91m          139.3        [0m[0m  |  [2m[91m                    120.5                  [0m[0m  |  [2m[91m                            965.5                         [0m[0m  |  [2m[91m                   154.3                  [0m[0m
      8      x 768   |  [2m[91m                  79.7               [0m[0m  |       799.0    |  [2m[91m          103.4        [0m[0m  |                       95.6                    |  [2m[91m                            551.0                         [0m[0m  |                     114.7                  
      4      x 768   |                    63.4                 |       701.8    |             86.5          |                       74.8                    |  [2m[91m                            481.0                         [0m[0m  |                      94.0                  
      2      x 768   |                    55.9                 |       504.7    |             74.1          |                       69.1                    |                              334.2                           |                      85.7                  
      1      x 768   |  [92m[1m                  38.5               [0m[0m  |  [92m[1m     430.1  [0m[0m  |  [92m[1m           51.5        [0m[0m  |  [92m[1m                     50.5                  [0m[0m  |  [92m[1m                            237.8                         [0m[0m  |  [92m[1m                    61.9                  [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend trace  |  Fine-grained + structured sparsity @ 80 with backend trace  |  Dense benchmark - Compiled - backend trace
32 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                2516.3               [0m[0m  |  [31m[1m 1175225.2  [0m[0m  |  [31m[1m         8759.5        [0m[0m  |  [31m[1m                   2807.7                  [0m[0m  |  [31m[1m                        1198580.1                         [0m[0m  |  [31m[1m                  8207.4                  [0m[0m
      1024   x 768   |  [31m[1m                1376.1               [0m[0m  |  [31m[1m  615987.5  [0m[0m  |  [31m[1m         4952.7        [0m[0m  |  [31m[1m                   1400.4                  [0m[0m  |  [31m[1m                         560635.3                         [0m[0m  |  [31m[1m                  3250.7                  [0m[0m
      512    x 768   |  [31m[1m                 780.2               [0m[0m  |  [31m[1m  320364.3  [0m[0m  |  [31m[1m         2447.0        [0m[0m  |  [31m[1m                    729.9                  [0m[0m  |  [31m[1m                         320291.9                         [0m[0m  |  [31m[1m                  2505.7                  [0m[0m
      256    x 768   |  [31m[1m                 547.5               [0m[0m  |  [31m[1m  166385.4  [0m[0m  |  [31m[1m         1114.2        [0m[0m  |  [31m[1m                    455.0                  [0m[0m  |  [31m[1m                         159537.8                         [0m[0m  |  [31m[1m                   973.8                  [0m[0m
      128    x 768   |  [31m[1m                 323.5               [0m[0m  |  [31m[1m   85984.0  [0m[0m  |  [31m[1m          511.9        [0m[0m  |  [31m[1m                    303.1                  [0m[0m  |  [31m[1m                          88953.6                         [0m[0m  |  [31m[1m                   734.2                  [0m[0m
      64     x 768   |  [2m[91m                 183.2               [0m[0m  |  [31m[1m   45903.9  [0m[0m  |  [31m[1m          292.8        [0m[0m  |  [2m[91m                    193.8                  [0m[0m  |  [31m[1m                          41374.6                         [0m[0m  |  [2m[91m                   303.3                  [0m[0m
      32     x 768   |  [2m[91m                 132.9               [0m[0m  |  [31m[1m   22026.1  [0m[0m  |  [2m[91m          186.1        [0m[0m  |  [2m[91m                    145.1                  [0m[0m  |  [31m[1m                          21233.1                         [0m[0m  |  [2m[91m                   219.9                  [0m[0m
      16     x 768   |  [2m[91m                 103.0               [0m[0m  |  [31m[1m    2579.9  [0m[0m  |  [2m[91m          141.7        [0m[0m  |  [2m[91m                    110.3                  [0m[0m  |  [31m[1m                           6660.9                         [0m[0m  |  [2m[91m                   149.7                  [0m[0m
      8      x 768   |                    75.7                 |  [2m[91m    1239.6  [0m[0m  |  [2m[91m          109.3        [0m[0m  |                       88.2                    |  [2m[91m                           1169.8                         [0m[0m  |                     115.7                  
      4      x 768   |                    61.5                 |       746.1    |             82.7          |                       73.4                    |                              528.6                           |                      96.0                  
      2      x 768   |                    56.4                 |       603.4    |             74.5          |                       67.7                    |                              404.5                           |                      86.0                  
      1      x 768   |  [92m[1m                  39.0               [0m[0m  |  [92m[1m     513.0  [0m[0m  |  [92m[1m           49.7        [0m[0m  |  [92m[1m                     51.7                  [0m[0m  |  [92m[1m                            359.0                         [0m[0m  |  [92m[1m                    60.8                  [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 2048 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler trace using backend trace
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler trace using backend trace
[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend trace  |  Fine-grained + structured sparsity @ 90 with backend trace  |  Dense benchmark - Compiled - backend trace
32 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                277.9                [0m[0m  |  [31m[1m  11594.7   [0m[0m  |  [31m[1m         647.1         [0m[0m  |  [2m[91m                   279.8                   [0m[0m  |  [31m[1m                          9645.3                          [0m[0m  |  [31m[1m                  650.5                   [0m[0m
      1024   x 768   |  [2m[91m                141.5                [0m[0m  |  [31m[1m   5889.3   [0m[0m  |  [31m[1m         328.5         [0m[0m  |  [2m[91m                   142.8                   [0m[0m  |  [31m[1m                          4905.8                          [0m[0m  |  [2m[91m                  331.0                   [0m[0m
      512    x 768   |                   73.7                  |  [31m[1m   2956.8   [0m[0m  |  [2m[91m         169.5         [0m[0m  |  [34m[1m                    73.5                   [0m[0m  |  [31m[1m                          2413.2                          [0m[0m  |  [2m[91m                  170.7                   [0m[0m
      256    x 768   |  [34m[1m                 56.8                [0m[0m  |  [2m[91m   1480.1   [0m[0m  |            92.8           |  [34m[1m                    71.4                   [0m[0m  |  [31m[1m                          1208.2                          [0m[0m  |                     92.4                   
      128    x 768   |                   64.6                  |  [2m[91m    760.4   [0m[0m  |  [34m[1m          68.2         [0m[0m  |                      79.4                     |  [31m[1m                           595.5                          [0m[0m  |                     85.7                   
      64     x 768   |                   67.7                  |  [34m[1m    367.2   [0m[0m  |  [34m[1m          67.2         [0m[0m  |                      84.0                     |  [2m[91m                           290.5                          [0m[0m  |                     85.9                   
      32     x 768   |                   68.9                  |  [34m[1m    348.6   [0m[0m  |  [34m[1m          68.7         [0m[0m  |                      84.7                     |                             150.1                            |                     84.7                   
      16     x 768   |                   71.0                  |  [34m[1m    347.6   [0m[0m  |            72.1           |                      87.4                     |  [34m[1m                           114.1                          [0m[0m  |                     88.9                   
      8      x 768   |                   71.7                  |  [34m[1m    348.0   [0m[0m  |            72.7           |                      87.2                     |  [92m[1m                           112.1                          [0m[0m  |                     87.8                   
      4      x 768   |                   71.3                  |  [34m[1m    341.8   [0m[0m  |  [92m[1m          65.4         [0m[0m  |                      87.6                     |  [34m[1m                           114.1                          [0m[0m  |                     82.9                   
      2      x 768   |  [92m[1m                 53.6                [0m[0m  |  [34m[1m    345.5   [0m[0m  |  [92m[1m          65.4         [0m[0m  |  [92m[1m                    70.0                   [0m[0m  |  [34m[1m                           114.1                          [0m[0m  |  [92m[1m                   71.8                   [0m[0m
      1      x 768   |                   62.0                  |  [92m[1m    338.3   [0m[0m  |  [34m[1m          66.6         [0m[0m  |                      80.3                     |  [92m[1m                           113.1                          [0m[0m  |                     83.0                   

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  ---------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend trace  |  Fine-grained + structured sparsity @ 80 with backend trace  |  Dense benchmark - Compiled - backend trace
32 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                290.5                [0m[0m  |  [31m[1m  26618.0   [0m[0m  |  [31m[1m         680.5         [0m[0m  |  [2m[91m                   307.2                   [0m[0m  |  [31m[1m                         20361.3                          [0m[0m  |  [31m[1m                  681.6                   [0m[0m
      1024   x 768   |  [2m[91m                152.3                [0m[0m  |  [31m[1m  13415.7   [0m[0m  |  [31m[1m         342.5         [0m[0m  |  [2m[91m                   159.7                   [0m[0m  |  [31m[1m                         10325.4                          [0m[0m  |  [2m[91m                  344.1                   [0m[0m
      512    x 768   |                   76.3                  |  [31m[1m   6691.7   [0m[0m  |  [2m[91m         172.5         [0m[0m  |                      84.7                     |  [31m[1m                          5176.5                          [0m[0m  |  [2m[91m                  172.5                   [0m[0m
      256    x 768   |                   63.7                  |  [31m[1m   3391.2   [0m[0m  |            93.9           |                      80.3                     |  [31m[1m                          2606.4                          [0m[0m  |                     94.0                   
      128    x 768   |                   64.8                  |  [31m[1m   1701.3   [0m[0m  |  [34m[1m          67.3         [0m[0m  |                      80.7                     |  [31m[1m                          1310.3                          [0m[0m  |  [34m[1m                   83.4                   [0m[0m
      64     x 768   |                   68.0                  |  [2m[91m    861.4   [0m[0m  |  [34m[1m          66.3         [0m[0m  |                      83.1                     |  [31m[1m                           674.3                          [0m[0m  |  [34m[1m                   83.3                   [0m[0m
      32     x 768   |                   69.4                  |      439.5     |  [34m[1m          68.7         [0m[0m  |                      84.6                     |  [2m[91m                           328.4                          [0m[0m  |  [34m[1m                   85.0                   [0m[0m
      16     x 768   |                   72.3                  |  [34m[1m    350.6   [0m[0m  |            75.8           |                      88.5                     |                             169.3                            |  [34m[1m                   89.3                   [0m[0m
      8      x 768   |                   72.0                  |  [34m[1m    349.2   [0m[0m  |            72.0           |                      88.1                     |  [92m[1m                           113.5                          [0m[0m  |  [34m[1m                   89.1                   [0m[0m
      4      x 768   |                   71.4                  |  [34m[1m    345.1   [0m[0m  |  [92m[1m          65.4         [0m[0m  |                      88.0                     |  [92m[1m                           113.0                          [0m[0m  |  [92m[1m                   81.8                   [0m[0m
      2      x 768   |  [92m[1m                 53.1                [0m[0m  |  [34m[1m    347.2   [0m[0m  |  [92m[1m          66.0         [0m[0m  |  [92m[1m                    70.9                   [0m[0m  |  [34m[1m                           114.5                          [0m[0m  |  [92m[1m                   82.3                   [0m[0m
      1      x 768   |                   62.0                  |  [92m[1m    335.7   [0m[0m  |  [34m[1m          66.6         [0m[0m  |                      78.9                     |  [92m[1m                           112.5                          [0m[0m  |  [34m[1m                   83.4                   [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2048 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                3557.5               [0m[0m  |  [31m[1m  599742.6  [0m[0m  |  [31m[1m         9229.7        [0m[0m  |  [31m[1m                    3627.6                    [0m[0m  |  [31m[1m                           17179.5                           [0m[0m  |  [31m[1m                    9347.4                   [0m[0m
      1024   x 768   |  [31m[1m                1899.5               [0m[0m  |  [31m[1m  305020.5  [0m[0m  |  [31m[1m         4896.7        [0m[0m  |  [31m[1m                    1294.1                    [0m[0m  |  [31m[1m                            8378.8                           [0m[0m  |  [31m[1m                    3934.0                   [0m[0m
      512    x 768   |  [31m[1m                 723.4               [0m[0m  |  [31m[1m  161439.0  [0m[0m  |  [31m[1m         1685.8        [0m[0m  |  [31m[1m                     799.6                    [0m[0m  |  [31m[1m                            3378.8                           [0m[0m  |  [31m[1m                    1563.9                   [0m[0m
      256    x 768   |  [31m[1m                 448.6               [0m[0m  |  [31m[1m   81446.2  [0m[0m  |  [31m[1m          968.6        [0m[0m  |  [2m[91m                     555.3                    [0m[0m  |  [31m[1m                            1714.9                           [0m[0m  |  [31m[1m                    1019.2                   [0m[0m
      128    x 768   |  [31m[1m                 282.2               [0m[0m  |  [31m[1m   31488.2  [0m[0m  |  [31m[1m          518.5        [0m[0m  |  [2m[91m                     350.2                    [0m[0m  |  [31m[1m                             911.6                           [0m[0m  |  [31m[1m                     542.1                   [0m[0m
      64     x 768   |  [31m[1m                 195.7               [0m[0m  |  [31m[1m   13103.7  [0m[0m  |  [31m[1m          413.6        [0m[0m  |  [2m[91m                     272.2                    [0m[0m  |  [31m[1m                             549.0                           [0m[0m  |  [2m[91m                     333.3                   [0m[0m
      32     x 768   |  [2m[91m                 145.6               [0m[0m  |  [31m[1m    2932.2  [0m[0m  |  [2m[91m          204.4        [0m[0m  |                       220.4                      |  [2m[91m                             355.5                           [0m[0m  |  [2m[91m                     216.0                   [0m[0m
      16     x 768   |  [2m[91m                 112.2               [0m[0m  |  [2m[91m    1226.1  [0m[0m  |  [2m[91m          156.0        [0m[0m  |                       183.2                      |  [2m[91m                             209.4                           [0m[0m  |                       161.5                   
      8      x 768   |  [2m[91m                  78.8               [0m[0m  |       762.3    |  [2m[91m          103.7        [0m[0m  |                       156.1                      |                               149.9                             |                       141.0                   
      4      x 768   |                    61.3                 |       615.1    |             82.3          |                       136.5                      |                               124.2                             |                       117.6                   
      2      x 768   |                    55.7                 |       526.7    |             71.6          |                       129.2                      |  [34m[1m                             104.3                           [0m[0m  |                       106.1                   
      1      x 768   |  [92m[1m                  37.5               [0m[0m  |  [92m[1m     423.7  [0m[0m  |  [92m[1m           49.0        [0m[0m  |  [92m[1m                     112.2                    [0m[0m  |  [92m[1m                              97.7                           [0m[0m  |  [92m[1m                      83.0                   [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                2241.4               [0m[0m  |  [31m[1m 1116006.1  [0m[0m  |  [31m[1m         6419.7        [0m[0m  |  [31m[1m                    2656.3                    [0m[0m  |  [31m[1m                           34276.7                           [0m[0m  |  [31m[1m                    5655.8                   [0m[0m
      1024   x 768   |  [31m[1m                1363.9               [0m[0m  |  [31m[1m  562916.0  [0m[0m  |  [31m[1m         3395.4        [0m[0m  |  [31m[1m                    1396.9                    [0m[0m  |  [31m[1m                           15039.7                           [0m[0m  |  [31m[1m                    4840.9                   [0m[0m
      512    x 768   |  [31m[1m                 832.5               [0m[0m  |  [31m[1m  296270.2  [0m[0m  |  [31m[1m         2327.2        [0m[0m  |  [31m[1m                     833.6                    [0m[0m  |  [31m[1m                            8082.8                           [0m[0m  |  [31m[1m                    1530.6                   [0m[0m
      256    x 768   |  [31m[1m                 477.6               [0m[0m  |  [31m[1m  153234.4  [0m[0m  |  [31m[1m          940.8        [0m[0m  |  [2m[91m                     543.2                    [0m[0m  |  [31m[1m                            3413.4                           [0m[0m  |  [31m[1m                    1043.9                   [0m[0m
      128    x 768   |  [31m[1m                 286.5               [0m[0m  |  [31m[1m   84407.6  [0m[0m  |  [31m[1m          507.7        [0m[0m  |  [2m[91m                     352.1                    [0m[0m  |  [31m[1m                            1725.9                           [0m[0m  |  [31m[1m                     555.2                   [0m[0m
      64     x 768   |  [31m[1m                 201.4               [0m[0m  |  [31m[1m   32896.9  [0m[0m  |  [31m[1m          410.7        [0m[0m  |  [2m[91m                     296.2                    [0m[0m  |  [31m[1m                             923.7                           [0m[0m  |  [2m[91m                     321.5                   [0m[0m
      32     x 768   |  [2m[91m                 135.1               [0m[0m  |  [31m[1m   13221.0  [0m[0m  |  [2m[91m          230.3        [0m[0m  |                       211.1                      |  [2m[91m                             511.3                           [0m[0m  |  [2m[91m                     214.8                   [0m[0m
      16     x 768   |  [2m[91m                  98.6               [0m[0m  |  [2m[91m    2306.3  [0m[0m  |  [2m[91m          132.2        [0m[0m  |                       171.3                      |  [2m[91m                             312.7                           [0m[0m  |                       160.7                   
      8      x 768   |                    74.6                 |  [2m[91m    1171.7  [0m[0m  |  [2m[91m          102.1        [0m[0m  |                       145.2                      |                               197.7                             |                       142.2                   
      4      x 768   |                    59.9                 |       729.9    |             79.8          |                       137.5                      |                               146.0                             |                       114.5                   
      2      x 768   |                    54.9                 |       584.5    |             72.6          |                       130.6                      |                               119.6                             |                       108.5                   
      1      x 768   |  [92m[1m                  38.0               [0m[0m  |  [92m[1m     516.7  [0m[0m  |  [92m[1m           49.0        [0m[0m  |  [92m[1m                     114.8                    [0m[0m  |  [92m[1m                             108.4                           [0m[0m  |  [92m[1m                      84.6                   [0m[0m

Times are in microseconds (us).

Benchmarking batch size 2048 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2048 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                272.5                [0m[0m  |  [31m[1m  11601.1   [0m[0m  |  [31m[1m         644.5         [0m[0m  |  [2m[91m                    286.0                     [0m[0m  |  [31m[1m                            3866.8                           [0m[0m  |  [31m[1m                    645.7                    [0m[0m
      1024   x 768   |  [2m[91m                142.1                [0m[0m  |  [31m[1m   5883.2   [0m[0m  |  [31m[1m         328.3         [0m[0m  |                      144.9                       |  [31m[1m                            1951.5                           [0m[0m  |  [2m[91m                    332.0                    [0m[0m
      512    x 768   |                   72.2                  |  [31m[1m   2942.9   [0m[0m  |  [2m[91m         169.0         [0m[0m  |  [34m[1m                    111.0                     [0m[0m  |  [31m[1m                            1000.6                           [0m[0m  |  [2m[91m                    167.2                    [0m[0m
      256    x 768   |                   53.6                  |  [31m[1m   1474.0   [0m[0m  |            91.7           |  [34m[1m                    108.9                     [0m[0m  |  [2m[91m                             500.3                           [0m[0m  |                       92.0                    
      128    x 768   |                   47.2                  |  [2m[91m    753.7   [0m[0m  |            57.7           |  [92m[1m                    104.2                     [0m[0m  |  [2m[91m                             261.0                           [0m[0m  |  [34m[1m                     86.4                    [0m[0m
      64     x 768   |                   51.7                  |      385.2     |  [34m[1m          51.6         [0m[0m  |  [34m[1m                    106.5                     [0m[0m  |                               135.8                             |  [34m[1m                     87.9                    [0m[0m
      32     x 768   |                   52.9                  |  [34m[1m    288.8   [0m[0m  |  [34m[1m          52.3         [0m[0m  |  [34m[1m                    105.8                     [0m[0m  |  [92m[1m                             104.2                           [0m[0m  |  [34m[1m                     86.6                    [0m[0m
      16     x 768   |                   55.1                  |  [34m[1m    288.8   [0m[0m  |            55.8           |  [92m[1m                    105.0                     [0m[0m  |  [34m[1m                             106.7                           [0m[0m  |  [34m[1m                     90.9                    [0m[0m
      8      x 768   |                   55.1                  |  [34m[1m    289.0   [0m[0m  |            55.6           |  [34m[1m                    106.4                     [0m[0m  |  [34m[1m                             106.2                           [0m[0m  |  [34m[1m                     89.4                    [0m[0m
      4      x 768   |                   55.0                  |  [92m[1m    281.7   [0m[0m  |  [92m[1m          48.2         [0m[0m  |  [34m[1m                    106.9                     [0m[0m  |  [92m[1m                             104.9                           [0m[0m  |  [92m[1m                     82.9                    [0m[0m
      2      x 768   |  [92m[1m                 38.7                [0m[0m  |  [92m[1m    284.3   [0m[0m  |  [34m[1m          49.0         [0m[0m  |  [92m[1m                    104.8                     [0m[0m  |  [92m[1m                             104.8                           [0m[0m  |  [92m[1m                     83.6                    [0m[0m
      1      x 768   |                   46.7                  |  [92m[1m    282.7   [0m[0m  |  [34m[1m          50.3         [0m[0m  |  [92m[1m                    104.5                     [0m[0m  |  [34m[1m                             105.3                           [0m[0m  |  [34m[1m                     84.5                    [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      2048   x 768   |  [31m[1m                297.1                [0m[0m  |  [31m[1m  26828.7   [0m[0m  |  [31m[1m         679.6         [0m[0m  |  [2m[91m                    285.8                     [0m[0m  |  [31m[1m                            7894.0                           [0m[0m  |  [31m[1m                    676.3                    [0m[0m
      1024   x 768   |  [2m[91m                152.5                [0m[0m  |  [31m[1m  13518.0   [0m[0m  |  [31m[1m         341.5         [0m[0m  |                      154.0                       |  [31m[1m                            3920.7                           [0m[0m  |  [2m[91m                    339.0                    [0m[0m
      512    x 768   |                   76.8                  |  [31m[1m   6701.5   [0m[0m  |  [2m[91m         172.6         [0m[0m  |  [34m[1m                    106.4                     [0m[0m  |  [31m[1m                            1967.7                           [0m[0m  |  [2m[91m                    172.3                    [0m[0m
      256    x 768   |                   48.1                  |  [31m[1m   3380.8   [0m[0m  |            93.7           |  [92m[1m                    105.4                     [0m[0m  |  [31m[1m                             998.7                           [0m[0m  |                       94.2                    
      128    x 768   |                   49.2                  |  [31m[1m   1719.3   [0m[0m  |            58.7           |  [92m[1m                    104.6                     [0m[0m  |  [2m[91m                             504.1                           [0m[0m  |  [34m[1m                     86.5                    [0m[0m
      64     x 768   |                   51.3                  |  [2m[91m    859.6   [0m[0m  |  [34m[1m          51.4         [0m[0m  |  [92m[1m                    105.0                     [0m[0m  |  [2m[91m                             254.9                           [0m[0m  |  [34m[1m                     87.0                    [0m[0m
      32     x 768   |                   52.4                  |      439.6     |  [34m[1m          52.8         [0m[0m  |  [34m[1m                    105.6                     [0m[0m  |                               132.3                             |  [34m[1m                     86.5                    [0m[0m
      16     x 768   |                   54.3                  |  [34m[1m    291.0   [0m[0m  |            56.1           |  [34m[1m                    106.4                     [0m[0m  |  [34m[1m                             104.7                           [0m[0m  |  [34m[1m                     90.6                    [0m[0m
      8      x 768   |                   54.9                  |  [34m[1m    286.6   [0m[0m  |            56.0           |  [34m[1m                    105.7                     [0m[0m  |  [34m[1m                             105.2                           [0m[0m  |  [34m[1m                     90.3                    [0m[0m
      4      x 768   |                   54.1                  |  [34m[1m    285.3   [0m[0m  |  [92m[1m          49.0         [0m[0m  |  [92m[1m                    105.2                     [0m[0m  |  [92m[1m                             103.4                           [0m[0m  |  [92m[1m                     83.6                    [0m[0m
      2      x 768   |  [92m[1m                 38.8                [0m[0m  |  [34m[1m    282.8   [0m[0m  |  [92m[1m          49.3         [0m[0m  |  [92m[1m                    105.0                     [0m[0m  |  [34m[1m                             104.8                           [0m[0m  |  [92m[1m                     82.9                    [0m[0m
      1      x 768   |                   47.1                  |  [92m[1m    279.5   [0m[0m  |  [34m[1m          49.9         [0m[0m  |  [34m[1m                    105.8                     [0m[0m  |  [34m[1m                             107.3                           [0m[0m  |  [34m[1m                     84.9                    [0m[0m

Times are in microseconds (us).
