/home/user/condensed-sparsity/src/condensed_sparsity/v2/condensed_linear.py:142: UserWarning: Sparse CSR tensor support is in beta state. If you miss a functionality in the sparse tensor support, please submit a feature request to https://github.com/pytorch/pytorch/issues. (Triggered internally at ../aten/src/ATen/SparseCsrTensorImpl.cpp:54.)
  torch.clone(self.weight.detach().type(dtype).to_sparse_csr()),
Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      1024   x 768   |  [31m[1m                6190.0               [0m[0m  |  [31m[1m  357972.7  [0m[0m  |  [31m[1m        13726.8        [0m[0m  |  [31m[1m                    6694.6                    [0m[0m  |  [31m[1m                           57271.1                           [0m[0m  |  [31m[1m                   13981.1                   [0m[0m
      512    x 768   |  [31m[1m                4455.4               [0m[0m  |  [31m[1m  195319.1  [0m[0m  |  [31m[1m         7599.0        [0m[0m  |  [31m[1m                    4737.9                    [0m[0m  |  [31m[1m                           29940.1                           [0m[0m  |  [31m[1m                    7742.7                   [0m[0m
      256    x 768   |  [31m[1m                2729.0               [0m[0m  |  [31m[1m  105131.3  [0m[0m  |  [31m[1m         4858.9        [0m[0m  |  [31m[1m                    2995.6                    [0m[0m  |  [31m[1m                           14204.8                           [0m[0m  |  [31m[1m                    5048.5                   [0m[0m
      128    x 768   |  [31m[1m                3357.3               [0m[0m  |  [31m[1m   30490.3  [0m[0m  |  [31m[1m         3386.2        [0m[0m  |  [31m[1m                    3601.7                    [0m[0m  |  [31m[1m                            7471.2                           [0m[0m  |  [31m[1m                    3500.9                   [0m[0m
      64     x 768   |  [31m[1m                3129.8               [0m[0m  |  [31m[1m   17369.2  [0m[0m  |  [31m[1m         2271.6        [0m[0m  |  [31m[1m                    3461.7                    [0m[0m  |  [31m[1m                            3967.7                           [0m[0m  |  [31m[1m                    2475.1                   [0m[0m
      32     x 768   |  [31m[1m                3085.6               [0m[0m  |  [31m[1m   13706.2  [0m[0m  |  [31m[1m         1746.4        [0m[0m  |  [31m[1m                    3108.8                    [0m[0m  |  [31m[1m                            2040.3                           [0m[0m  |  [31m[1m                    1901.8                   [0m[0m
      16     x 768   |  [31m[1m                2094.6               [0m[0m  |  [31m[1m    7929.4  [0m[0m  |  [31m[1m         1499.6        [0m[0m  |  [31m[1m                    2077.7                    [0m[0m  |  [31m[1m                            1000.4                           [0m[0m  |  [31m[1m                    1616.8                   [0m[0m
      8      x 768   |                   247.4                 |  [2m[91m    5057.2  [0m[0m  |            439.7          |                       395.0                      |  [2m[91m                             610.5                           [0m[0m  |                       527.7                   
      4      x 768   |                   210.8                 |  [2m[91m    3258.3  [0m[0m  |            352.3          |                       385.6                      |  [2m[91m                             325.1                           [0m[0m  |                       432.6                   
      2      x 768   |  [34m[1m                 188.7               [0m[0m  |      2146.8    |  [34m[1m          267.1        [0m[0m  |  [34m[1m                     352.7                    [0m[0m  |                               204.9                             |  [34m[1m                     332.5                   [0m[0m
      1      x 768   |  [92m[1m                 180.5               [0m[0m  |  [92m[1m    1579.3  [0m[0m  |  [92m[1m          249.2        [0m[0m  |  [92m[1m                     342.5                    [0m[0m  |  [92m[1m                             139.6                           [0m[0m  |  [92m[1m                     321.0                   [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      1024   x 768   |  [31m[1m                6430.8               [0m[0m  |  [31m[1m  657730.7  [0m[0m  |  [31m[1m        13781.4        [0m[0m  |  [31m[1m                    6944.8                    [0m[0m  |  [31m[1m                           111071.5                          [0m[0m  |  [31m[1m                   14109.7                   [0m[0m
      512    x 768   |  [31m[1m                4527.6               [0m[0m  |  [31m[1m  346996.5  [0m[0m  |  [31m[1m         7622.3        [0m[0m  |  [31m[1m                    4837.5                    [0m[0m  |  [31m[1m                            61036.6                          [0m[0m  |  [31m[1m                    7716.0                   [0m[0m
      256    x 768   |  [31m[1m                2895.5               [0m[0m  |  [31m[1m  191246.1  [0m[0m  |  [31m[1m         5039.3        [0m[0m  |  [31m[1m                    3148.6                    [0m[0m  |  [31m[1m                            30074.9                          [0m[0m  |  [31m[1m                    4999.9                   [0m[0m
      128    x 768   |  [31m[1m                3268.5               [0m[0m  |  [31m[1m  102059.3  [0m[0m  |  [31m[1m         3353.5        [0m[0m  |  [31m[1m                    3798.1                    [0m[0m  |  [31m[1m                            14675.6                          [0m[0m  |  [31m[1m                    3559.3                   [0m[0m
      64     x 768   |  [31m[1m                3068.4               [0m[0m  |  [31m[1m   30980.5  [0m[0m  |  [31m[1m         2333.8        [0m[0m  |  [31m[1m                    3259.8                    [0m[0m  |  [31m[1m                             8210.7                          [0m[0m  |  [31m[1m                    2492.3                   [0m[0m
      32     x 768   |  [31m[1m                2953.0               [0m[0m  |  [31m[1m   16982.3  [0m[0m  |  [31m[1m         1750.8        [0m[0m  |  [31m[1m                    3158.7                    [0m[0m  |  [31m[1m                             4023.4                          [0m[0m  |  [31m[1m                    1905.8                   [0m[0m
      16     x 768   |  [31m[1m                1956.8               [0m[0m  |  [2m[91m    9717.1  [0m[0m  |  [31m[1m         1514.1        [0m[0m  |  [31m[1m                    1954.9                    [0m[0m  |  [31m[1m                             1917.2                          [0m[0m  |  [2m[91m                    1613.1                   [0m[0m
      8      x 768   |                   266.7                 |  [2m[91m    7943.6  [0m[0m  |            440.8          |                       411.6                      |  [31m[1m                             1020.5                          [0m[0m  |                       520.8                   
      4      x 768   |                   225.1                 |  [2m[91m    5137.2  [0m[0m  |            352.4          |                       392.8                      |  [2m[91m                              642.5                          [0m[0m  |                       426.3                   
      2      x 768   |  [34m[1m                 194.2               [0m[0m  |      3250.8    |  [34m[1m          266.2        [0m[0m  |  [34m[1m                     361.0                    [0m[0m  |                                326.9                            |  [34m[1m                     342.9                   [0m[0m
      1      x 768   |  [92m[1m                 181.0               [0m[0m  |  [92m[1m    2106.1  [0m[0m  |  [92m[1m          249.8        [0m[0m  |  [92m[1m                     348.4                    [0m[0m  |  [92m[1m                              203.1                          [0m[0m  |  [92m[1m                     324.4                   [0m[0m

Times are in microseconds (us).
[2023-09-21 15:01:53,076] torch._inductor.utils: [WARNING] not enough cuda cores to use max_autotune mode

Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      1024   x 768   |  [2m[91m                102.4                [0m[0m  |  [31m[1m  11972.0   [0m[0m  |  [2m[91m         165.6         [0m[0m  |                      121.6                       |  [31m[1m                            3121.2                           [0m[0m  |  [2m[91m                    165.7                    [0m[0m
      512    x 768   |  [2m[91m                 64.9                [0m[0m  |  [31m[1m   5997.9   [0m[0m  |  [2m[91m          87.0         [0m[0m  |                       76.9                       |  [31m[1m                            1575.3                           [0m[0m  |                       88.0                    
      256    x 768   |  [2m[91m                 57.9                [0m[0m  |  [31m[1m   3013.4   [0m[0m  |            46.1           |  [34m[1m                     66.1                     [0m[0m  |  [31m[1m                             804.2                           [0m[0m  |  [34m[1m                     69.3                    [0m[0m
      128    x 768   |  [2m[91m                 44.7                [0m[0m  |  [31m[1m   1519.0   [0m[0m  |  [34m[1m          40.5         [0m[0m  |  [34m[1m                     63.8                     [0m[0m  |  [31m[1m                             407.7                           [0m[0m  |  [34m[1m                     70.4                    [0m[0m
      64     x 768   |                   44.2                  |  [2m[91m    767.4   [0m[0m  |            45.0           |  [34m[1m                     64.9                     [0m[0m  |  [2m[91m                             210.1                           [0m[0m  |                       75.8                    
      32     x 768   |                   41.6                  |  [2m[91m    395.6   [0m[0m  |            44.2           |  [34m[1m                     63.8                     [0m[0m  |                               116.3                             |  [34m[1m                     74.4                    [0m[0m
      16     x 768   |                   43.3                  |      209.8     |            44.0           |  [34m[1m                     63.1                     [0m[0m  |  [34m[1m                              64.6                           [0m[0m  |  [34m[1m                     75.2                    [0m[0m
      8      x 768   |                   44.1                  |  [34m[1m    184.9   [0m[0m  |            43.5           |  [92m[1m                     62.6                     [0m[0m  |  [34m[1m                              63.1                           [0m[0m  |  [34m[1m                     73.9                    [0m[0m
      4      x 768   |                   43.1                  |  [34m[1m    186.5   [0m[0m  |            43.2           |  [92m[1m                     62.4                     [0m[0m  |  [34m[1m                              63.5                           [0m[0m  |  [34m[1m                     73.1                    [0m[0m
      2      x 768   |  [92m[1m                 22.3                [0m[0m  |  [34m[1m    184.9   [0m[0m  |            43.9           |  [92m[1m                     62.5                     [0m[0m  |  [92m[1m                              62.4                           [0m[0m  |  [34m[1m                     73.6                    [0m[0m
      1      x 768   |  [34m[1m                 24.4                [0m[0m  |  [92m[1m    181.8   [0m[0m  |  [92m[1m          39.0         [0m[0m  |  [34m[1m                     65.4                     [0m[0m  |  [92m[1m                              62.8                           [0m[0m  |  [92m[1m                     68.4                    [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      1024   x 768   |  [2m[91m                 82.0                [0m[0m  |  [31m[1m  33348.9   [0m[0m  |  [2m[91m         176.4         [0m[0m  |                      102.7                       |  [31m[1m                            7551.6                           [0m[0m  |  [2m[91m                    177.3                    [0m[0m
      512    x 768   |  [2m[91m                 44.7                [0m[0m  |  [31m[1m  16684.7   [0m[0m  |  [2m[91m          94.1         [0m[0m  |  [92m[1m                     62.7                     [0m[0m  |  [31m[1m                            3779.2                           [0m[0m  |                       94.7                    
      256    x 768   |  [2m[91m                 40.4                [0m[0m  |  [31m[1m   8349.0   [0m[0m  |            48.8           |  [92m[1m                     62.7                     [0m[0m  |  [31m[1m                            1864.1                           [0m[0m  |  [34m[1m                     70.4                    [0m[0m
      128    x 768   |  [2m[91m                 39.6                [0m[0m  |  [31m[1m   4186.8   [0m[0m  |  [34m[1m          40.4         [0m[0m  |  [34m[1m                     64.1                     [0m[0m  |  [31m[1m                             932.9                           [0m[0m  |  [34m[1m                     73.3                    [0m[0m
      64     x 768   |  [2m[91m                 44.1                [0m[0m  |  [31m[1m   2100.9   [0m[0m  |            44.0           |  [92m[1m                     62.9                     [0m[0m  |  [31m[1m                             484.2                           [0m[0m  |  [34m[1m                     74.1                    [0m[0m
      32     x 768   |  [2m[91m                 42.9                [0m[0m  |  [31m[1m   1058.3   [0m[0m  |            44.0           |  [92m[1m                     62.8                     [0m[0m  |  [2m[91m                             240.3                           [0m[0m  |  [34m[1m                     75.3                    [0m[0m
      16     x 768   |  [2m[91m                 43.2                [0m[0m  |  [2m[91m    538.2   [0m[0m  |            44.7           |  [34m[1m                     65.3                     [0m[0m  |                               123.9                             |  [34m[1m                     73.2                    [0m[0m
      8      x 768   |  [2m[91m                 43.7                [0m[0m  |      276.8     |            43.7           |  [92m[1m                     62.7                     [0m[0m  |                                74.1                             |  [34m[1m                     75.2                    [0m[0m
      4      x 768   |  [2m[91m                 43.2                [0m[0m  |  [92m[1m    185.7   [0m[0m  |            43.2           |  [92m[1m                     62.9                     [0m[0m  |  [92m[1m                              62.9                           [0m[0m  |  [34m[1m                     74.4                    [0m[0m
      2      x 768   |  [92m[1m                 19.7                [0m[0m  |  [92m[1m    187.4   [0m[0m  |            42.7           |  [34m[1m                     63.7                     [0m[0m  |  [34m[1m                              64.5                           [0m[0m  |  [34m[1m                     75.1                    [0m[0m
      1      x 768   |                   25.1                  |  [34m[1m    190.3   [0m[0m  |  [92m[1m          38.5         [0m[0m  |  [92m[1m                     63.1                     [0m[0m  |  [92m[1m                              62.5                           [0m[0m  |  [92m[1m                     69.3                    [0m[0m

Times are in microseconds (us).
