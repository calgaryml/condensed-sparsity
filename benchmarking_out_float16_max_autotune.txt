/home/user/condensed-sparsity/src/condensed_sparsity/v2/condensed_linear.py:57: UserWarning: Sparse CSR tensor support is in beta state. If you miss a functionality in the sparse tensor support, please submit a feature request to https://github.com/pytorch/pytorch/issues. (Triggered internally at ../aten/src/ATen/SparseCsrTensorImpl.cpp:54.)
  torch.clone(self.weight.detach().type(dtype).to_sparse_csr())
Benchmarking batch size 1024 with sparsity 90 and num_threads 1
AUTOTUNE bias_addmm(512x1145, 512x768, 768x1145)
  triton_mm_15 0.0287s 100.0%
  triton_mm_13 0.0297s 96.6%
  triton_mm_14 0.0307s 93.3%
  triton_mm_16 0.0307s 93.3%
  triton_mm_20 0.0317s 90.3%
  triton_mm_12 0.0328s 87.5%
  triton_mm_18 0.0328s 87.5%
  triton_mm_17 0.0338s 84.8%
  triton_mm_21 0.0399s 71.8%
  triton_mm_23 0.0399s 71.8%
AUTOTUNE bias_addmm(256x1145, 256x768, 768x1145)
  triton_mm_32 0.0174s 100.0%
  triton_mm_30 0.0184s 94.4%
  triton_mm_29 0.0195s 89.5%
  triton_mm_27 0.0236s 73.9%
  triton_mm_33 0.0236s 73.9%
  triton_mm_25 0.0246s 70.8%
  triton_mm_26 0.0246s 70.8%
  triton_mm_24 0.0246s 70.8%
  triton_mm_28 0.0256s 68.0%
  triton_mm_35 0.0307s 56.7%
AUTOTUNE bias_addmm(128x1145, 128x768, 768x1145)
  triton_mm_42 0.0123s 100.0%
  triton_mm_41 0.0133s 92.3%
  triton_mm_45 0.0143s 85.7%
  triton_mm_44 0.0154s 80.0%
  bias_addmm 0.0164s 75.0%
  addmm 0.0205s 60.0%
  triton_mm_36 0.0225s 54.5%
  triton_mm_39 0.0236s 52.2%
  triton_mm_37 0.0236s 52.2%
  triton_mm_40 0.0236s 52.2%
AUTOTUNE bias_addmm(64x1145, 64x768, 768x1145)
  triton_mm_53 0.0113s 100.0%
  triton_mm_54 0.0123s 91.7%
  triton_mm_57 0.0123s 91.7%
  bias_addmm 0.0123s 91.7%
  triton_mm_56 0.0154s 73.3%
  addmm 0.0163s 69.3%
  triton_mm_50 0.0215s 52.4%
  triton_mm_52 0.0215s 52.4%
  triton_mm_48 0.0225s 50.0%
  triton_mm_49 0.0236s 47.8%
AUTOTUNE bias_addmm(32x1145, 32x768, 768x1145)
  triton_mm_69 0.0113s 100.0%
  triton_mm_65 0.0113s 100.0%
  triton_mm_66 0.0113s 100.0%
  bias_addmm 0.0123s 91.7%
  triton_mm_68 0.0143s 78.6%
  addmm 0.0154s 73.3%
  triton_mm_62 0.0215s 52.4%
  triton_mm_64 0.0215s 52.4%
  triton_mm_63 0.0215s 52.4%
  triton_mm_60 0.0215s 52.4%
AUTOTUNE bias_addmm(16x1145, 16x768, 768x1145)
  triton_mm_81 0.0102s 100.0%
  triton_mm_78 0.0113s 90.9%
  triton_mm_77 0.0113s 90.9%
  bias_addmm 0.0133s 76.9%
  triton_mm_80 0.0143s 71.4%
  addmm 0.0164s 62.5%
  triton_mm_74 0.0205s 50.0%
  triton_mm_73 0.0205s 50.0%
  triton_mm_75 0.0205s 50.0%
  triton_mm_76 0.0205s 50.0%
AUTOTUNE bias_addmm(8x1145, 8x768, 768x1145)
  triton_mm_90 0.0113s 100.0%
  triton_mm_93 0.0113s 100.0%
  bias_addmm 0.0123s 91.7%
  triton_mm_89 0.0143s 78.6%
  triton_mm_92 0.0143s 78.6%
  addmm 0.0154s 73.3%
  triton_mm_85 0.0205s 55.0%
  triton_mm_86 0.0205s 55.0%
  triton_mm_87 0.0205s 55.0%
  triton_mm_84 0.0215s 52.4%
AUTOTUNE bias_addmm(4x1145, 4x768, 768x1145)
  triton_mm_102 0.0113s 100.0%
  bias_addmm 0.0123s 91.7%
  triton_mm_105 0.0123s 91.7%
  addmm 0.0133s 84.6%
  triton_mm_104 0.0143s 78.6%
  triton_mm_101 0.0156s 72.4%
  triton_mm_99 0.0205s 55.0%
  triton_mm_97 0.0205s 55.0%
  triton_mm_96 0.0215s 52.4%
  triton_mm_98 0.0215s 52.4%
AUTOTUNE bias_addmm(2x1145, 2x768, 768x1145)
  bias_addmm 0.0102s 100.0%
  triton_mm_114 0.0102s 100.0%
  addmm 0.0143s 71.4%
  triton_mm_117 0.0164s 62.5%
  triton_mm_116 0.0164s 62.5%
  triton_mm_109 0.0205s 50.0%
  triton_mm_111 0.0205s 50.0%
  triton_mm_108 0.0236s 43.5%
  triton_mm_113 0.0236s 43.5%
  triton_mm_119 0.0256s 40.0%
AUTOTUNE bias_addmm(1x1145, 1x768, 768x1145)
  bias_addmm 0.0092s 100.0%
  addmm 0.0102s 90.0%
  triton_mm_126 0.0113s 81.8%
  triton_mm_121 0.0215s 42.9%
  triton_mm_123 0.0225s 40.9%
  triton_mm_128 0.0246s 37.5%
  triton_mm_129 0.0256s 36.0%
  triton_mm_131 0.0256s 36.0%
  triton_mm_120 0.0307s 30.0%
  triton_mm_130 0.0399s 23.1%
Benchmarking batch size 512 with sparsity 90 and num_threads 1
Benchmarking batch size 256 with sparsity 90 and num_threads 1
Benchmarking batch size 128 with sparsity 90 and num_threads 1
Benchmarking batch size 64 with sparsity 90 and num_threads 1
Benchmarking batch size 32 with sparsity 90 and num_threads 1
Benchmarking batch size 16 with sparsity 90 and num_threads 1
Benchmarking batch size 8 with sparsity 90 and num_threads 1
Benchmarking batch size 4 with sparsity 90 and num_threads 1
Benchmarking batch size 2 with sparsity 90 and num_threads 1
Benchmarking batch size 1 with sparsity 90 and num_threads 1
[-------------------------------------------------------- Condensed Linear @ 90 with 1 threads -------------------------------------------------------]
                     |  Structured sparsity @ 90  |  Fine-grained + structured sparsity @ 90  |  Dense benchmark - Compiled  |  Dense benchmark - Eager
1 threads: --------------------------------------------------------------------------------------------------------------------------------------------
      1024   x 768   |  [92m[1m         101.9          [0m[0m  |  [31m[1m                 1778.3                [0m[0m  |            114.5             |  [2m[91m         114.6         [0m[0m
      512    x 768   |  [34m[1m         103.7          [0m[0m  |  [31m[1m                  907.5                [0m[0m  |  [34m[1m           87.0           [0m[0m  |            61.2         
      256    x 768   |           126.9            |  [2m[91m                  462.0                [0m[0m  |            111.5             |            77.0         
      128    x 768   |  [34m[1m         104.8          [0m[0m  |  [2m[91m                  236.7                [0m[0m  |  [34m[1m           93.0           [0m[0m  |            58.3         
      64     x 768   |  [34m[1m         107.5          [0m[0m  |                    135.9                  |  [34m[1m           88.8           [0m[0m  |  [34m[1m          54.4         [0m[0m
      32     x 768   |  [34m[1m         105.4          [0m[0m  |  [34m[1m                  108.2                [0m[0m  |  [92m[1m           85.6           [0m[0m  |  [92m[1m          51.4         [0m[0m
      16     x 768   |  [34m[1m         106.9          [0m[0m  |  [92m[1m                  105.0                [0m[0m  |  [92m[1m           85.0           [0m[0m  |  [92m[1m          51.3         [0m[0m
      8      x 768   |  [34m[1m         104.0          [0m[0m  |  [92m[1m                  106.0                [0m[0m  |  [34m[1m           87.7           [0m[0m  |  [34m[1m          53.8         [0m[0m
      4      x 768   |  [34m[1m         109.9          [0m[0m  |  [34m[1m                  113.4                [0m[0m  |  [34m[1m           91.4           [0m[0m  |  [34m[1m          53.9         [0m[0m
      2      x 768   |           117.2            |                    115.6                  |  [34m[1m           90.7           [0m[0m  |            57.1         
      1      x 768   |  [34m[1m         111.6          [0m[0m  |  [34m[1m                  108.0                [0m[0m  |  [34m[1m           87.2           [0m[0m  |  [34m[1m          52.6         [0m[0m

Times are in microseconds (us).
