/home/user/condensed-sparsity/src/condensed_sparsity/v2/condensed_linear.py:142: UserWarning: Sparse CSR tensor support is in beta state. If you miss a functionality in the sparse tensor support, please submit a feature request to https://github.com/pytorch/pytorch/issues. (Triggered internally at ../aten/src/ATen/SparseCsrTensorImpl.cpp:54.)
  torch.clone(self.weight.detach().type(dtype).to_sparse_csr()),
Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      1024   x 768   |  [31m[1m               16518.2               [0m[0m  |  [31m[1m  270416.9  [0m[0m  |  [31m[1m        35240.2        [0m[0m  |  [31m[1m                   16856.3                    [0m[0m  |  [31m[1m                           162908.6                          [0m[0m  |  [31m[1m                   35436.1                   [0m[0m
      512    x 768   |  [31m[1m                9243.6               [0m[0m  |  [31m[1m  145788.7  [0m[0m  |  [31m[1m        21560.2        [0m[0m  |  [31m[1m                    9341.9                    [0m[0m  |  [31m[1m                            83835.9                          [0m[0m  |  [31m[1m                   21454.8                   [0m[0m
      256    x 768   |  [31m[1m                5986.2               [0m[0m  |  [31m[1m   65304.3  [0m[0m  |  [31m[1m        13457.6        [0m[0m  |  [31m[1m                    6078.5                    [0m[0m  |  [31m[1m                            40855.6                          [0m[0m  |  [31m[1m                   13152.7                   [0m[0m
      128    x 768   |  [31m[1m                4371.3               [0m[0m  |  [31m[1m   28016.4  [0m[0m  |  [31m[1m         9269.1        [0m[0m  |  [31m[1m                    4594.5                    [0m[0m  |  [31m[1m                            24522.1                          [0m[0m  |  [31m[1m                    9608.4                   [0m[0m
      64     x 768   |  [31m[1m                3026.4               [0m[0m  |  [31m[1m   16998.6  [0m[0m  |  [31m[1m         7068.0        [0m[0m  |  [31m[1m                    3271.5                    [0m[0m  |  [31m[1m                            12716.0                          [0m[0m  |  [31m[1m                    7203.2                   [0m[0m
      32     x 768   |  [2m[91m                1332.0               [0m[0m  |  [31m[1m   13165.1  [0m[0m  |  [31m[1m         2960.6        [0m[0m  |  [2m[91m                    1551.3                    [0m[0m  |  [31m[1m                             5658.9                          [0m[0m  |  [31m[1m                    3049.9                   [0m[0m
      16     x 768   |  [2m[91m                 684.0               [0m[0m  |  [2m[91m    7757.9  [0m[0m  |  [2m[91m         1737.3        [0m[0m  |                       849.4                      |  [31m[1m                             2595.2                          [0m[0m  |  [2m[91m                    1840.3                   [0m[0m
      8      x 768   |                   490.2                 |  [2m[91m    5259.5  [0m[0m  |  [2m[91m          879.0        [0m[0m  |                       506.2                      |  [31m[1m                             1737.8                          [0m[0m  |  [2m[91m                     972.4                   [0m[0m
      4      x 768   |                   413.7                 |  [2m[91m    3303.1  [0m[0m  |            551.6          |                       600.0                      |  [2m[91m                              739.4                          [0m[0m  |                       599.4                   
      2      x 768   |                   324.0                 |      2141.3    |            433.9          |                       502.9                      |                                368.1                            |                       526.9                   
      1      x 768   |  [92m[1m                 283.6               [0m[0m  |  [92m[1m    1583.5  [0m[0m  |  [92m[1m          348.6        [0m[0m  |  [92m[1m                     435.4                    [0m[0m  |  [92m[1m                              198.4                          [0m[0m  |  [92m[1m                     441.3                   [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      1024   x 768   |  [31m[1m               17591.2               [0m[0m  |  [31m[1m  503226.5  [0m[0m  |  [31m[1m        35424.2        [0m[0m  |  [31m[1m                   17093.7                    [0m[0m  |  [31m[1m                           359940.6                          [0m[0m  |  [31m[1m                   36098.2                   [0m[0m
      512    x 768   |  [31m[1m                9421.1               [0m[0m  |  [31m[1m  251544.7  [0m[0m  |  [31m[1m        21178.1        [0m[0m  |  [31m[1m                    9681.3                    [0m[0m  |  [31m[1m                           161108.6                          [0m[0m  |  [31m[1m                   20861.4                   [0m[0m
      256    x 768   |  [31m[1m                6201.2               [0m[0m  |  [31m[1m  139297.9  [0m[0m  |  [31m[1m        13378.9        [0m[0m  |  [31m[1m                    6279.1                    [0m[0m  |  [31m[1m                            85758.3                          [0m[0m  |  [31m[1m                   13170.7                   [0m[0m
      128    x 768   |  [31m[1m                4570.3               [0m[0m  |  [31m[1m   66016.4  [0m[0m  |  [31m[1m         9420.3        [0m[0m  |  [31m[1m                    4777.1                    [0m[0m  |  [31m[1m                            41114.1                          [0m[0m  |  [31m[1m                    9518.6                   [0m[0m
      64     x 768   |  [31m[1m                3185.4               [0m[0m  |  [31m[1m   26778.5  [0m[0m  |  [31m[1m         7273.7        [0m[0m  |  [31m[1m                    3427.7                    [0m[0m  |  [31m[1m                            22363.0                          [0m[0m  |  [31m[1m                    7200.5                   [0m[0m
      32     x 768   |  [2m[91m                1428.3               [0m[0m  |  [31m[1m   15278.5  [0m[0m  |  [31m[1m         3011.6        [0m[0m  |  [2m[91m                    1659.4                    [0m[0m  |  [31m[1m                            11216.2                          [0m[0m  |  [31m[1m                    3089.0                   [0m[0m
      16     x 768   |  [2m[91m                 736.6               [0m[0m  |  [2m[91m   10274.5  [0m[0m  |  [2m[91m         1750.1        [0m[0m  |                       893.6                      |  [31m[1m                             5491.4                          [0m[0m  |  [31m[1m                    1861.4                   [0m[0m
      8      x 768   |                   468.7                 |  [2m[91m    7926.7  [0m[0m  |  [2m[91m          877.0        [0m[0m  |                       545.5                      |  [31m[1m                             2566.7                          [0m[0m  |  [2m[91m                     954.4                   [0m[0m
      4      x 768   |                   423.0                 |  [2m[91m    5016.9  [0m[0m  |            543.9          |                       605.4                      |  [2m[91m                             1340.8                          [0m[0m  |                       600.1                   
      2      x 768   |                   331.0                 |      3263.0    |            447.0          |  [34m[1m                     513.1                    [0m[0m  |                                758.2                            |  [92m[1m                     367.2                   [0m[0m
      1      x 768   |  [92m[1m                 295.2               [0m[0m  |  [92m[1m    2128.8  [0m[0m  |  [92m[1m          357.3        [0m[0m  |  [92m[1m                     476.8                    [0m[0m  |  [92m[1m                              399.3                          [0m[0m  |                       434.1                   

Times are in microseconds (us).
[2023-09-21 14:38:19,664] torch._inductor.utils: [WARNING] not enough cuda cores to use max_autotune mode

Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      1024   x 768   |  [2m[91m                 81.9                [0m[0m  |  [31m[1m   6889.2   [0m[0m  |  [2m[91m          81.2         [0m[0m  |                       93.4                       |  [31m[1m                            2926.5                           [0m[0m  |                       82.6                    
      512    x 768   |  [2m[91m                 71.4                [0m[0m  |  [31m[1m   3489.7   [0m[0m  |            42.5           |                       79.7                       |  [31m[1m                            1503.7                           [0m[0m  |  [34m[1m                     72.7                    [0m[0m
      256    x 768   |  [2m[91m                 42.2                [0m[0m  |  [31m[1m   1779.3   [0m[0m  |  [34m[1m          41.0         [0m[0m  |  [34m[1m                     63.3                     [0m[0m  |  [31m[1m                             762.8                           [0m[0m  |  [34m[1m                     70.5                    [0m[0m
      128    x 768   |  [2m[91m                 43.8                [0m[0m  |  [2m[91m    902.1   [0m[0m  |  [92m[1m          38.7         [0m[0m  |  [34m[1m                     64.1                     [0m[0m  |  [31m[1m                             384.4                           [0m[0m  |  [34m[1m                     69.1                    [0m[0m
      64     x 768   |  [2m[91m                 42.4                [0m[0m  |  [2m[91m    462.9   [0m[0m  |  [92m[1m          38.3         [0m[0m  |  [92m[1m                     61.8                     [0m[0m  |  [2m[91m                             199.0                           [0m[0m  |  [92m[1m                     68.2                    [0m[0m
      32     x 768   |  [2m[91m                 44.7                [0m[0m  |      239.5     |  [34m[1m          40.5         [0m[0m  |  [92m[1m                     62.5                     [0m[0m  |                               110.6                             |  [34m[1m                     69.2                    [0m[0m
      16     x 768   |  [2m[91m                 40.6                [0m[0m  |  [34m[1m    185.0   [0m[0m  |            42.2           |  [92m[1m                     62.4                     [0m[0m  |  [34m[1m                              65.5                           [0m[0m  |  [34m[1m                     71.1                    [0m[0m
      8      x 768   |  [2m[91m                 39.9                [0m[0m  |  [34m[1m    185.3   [0m[0m  |  [34m[1m          41.4         [0m[0m  |  [34m[1m                     65.8                     [0m[0m  |  [34m[1m                              62.9                           [0m[0m  |  [34m[1m                     72.3                    [0m[0m
      4      x 768   |                   38.3                  |  [34m[1m    195.6   [0m[0m  |            44.3           |  [92m[1m                     62.2                     [0m[0m  |  [92m[1m                              61.9                           [0m[0m  |  [34m[1m                     71.7                    [0m[0m
      2      x 768   |  [92m[1m                 19.5                [0m[0m  |  [34m[1m    184.4   [0m[0m  |  [34m[1m          41.3         [0m[0m  |  [92m[1m                     62.4                     [0m[0m  |  [34m[1m                              64.1                           [0m[0m  |  [34m[1m                     72.0                    [0m[0m
      1      x 768   |  [92m[1m                 19.7                [0m[0m  |  [92m[1m    181.2   [0m[0m  |            44.3           |  [34m[1m                     64.1                     [0m[0m  |  [34m[1m                              63.4                           [0m[0m  |  [34m[1m                     72.6                    [0m[0m

Times are in microseconds (us).

[-------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  -------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      1024   x 768   |  [2m[91m                 42.5                [0m[0m  |  [31m[1m  18931.1   [0m[0m  |  [2m[91m          87.5         [0m[0m  |  [34m[1m                     63.1                     [0m[0m  |  [31m[1m                            6740.1                           [0m[0m  |                       88.2                    
      512    x 768   |  [2m[91m                 40.4                [0m[0m  |  [31m[1m   9423.3   [0m[0m  |            45.2           |  [34m[1m                     62.6                     [0m[0m  |  [31m[1m                            3365.3                           [0m[0m  |  [34m[1m                     72.9                    [0m[0m
      256    x 768   |                   38.7                  |  [31m[1m   4719.9   [0m[0m  |            42.3           |  [34m[1m                     62.9                     [0m[0m  |  [31m[1m                            1659.4                           [0m[0m  |  [34m[1m                     72.9                    [0m[0m
      128    x 768   |                   39.1                  |  [31m[1m   2370.8   [0m[0m  |  [34m[1m          40.4         [0m[0m  |  [34m[1m                     62.5                     [0m[0m  |  [31m[1m                             846.5                           [0m[0m  |  [92m[1m                     68.9                    [0m[0m
      64     x 768   |  [2m[91m                 39.6                [0m[0m  |  [31m[1m   1185.8   [0m[0m  |  [34m[1m          40.0         [0m[0m  |  [34m[1m                     63.1                     [0m[0m  |  [31m[1m                             433.0                           [0m[0m  |  [34m[1m                     70.1                    [0m[0m
      32     x 768   |  [2m[91m                 39.6                [0m[0m  |  [2m[91m    597.0   [0m[0m  |  [92m[1m          38.3         [0m[0m  |  [92m[1m                     61.8                     [0m[0m  |  [2m[91m                             225.6                           [0m[0m  |  [92m[1m                     69.3                    [0m[0m
      16     x 768   |  [2m[91m                 43.3                [0m[0m  |      305.4     |  [34m[1m          41.3         [0m[0m  |  [34m[1m                     62.4                     [0m[0m  |                               118.9                             |  [34m[1m                     71.5                    [0m[0m
      8      x 768   |  [2m[91m                 43.2                [0m[0m  |  [34m[1m    186.7   [0m[0m  |            42.5           |  [34m[1m                     63.5                     [0m[0m  |                                69.7                             |  [34m[1m                     72.2                    [0m[0m
      4      x 768   |  [2m[91m                 44.7                [0m[0m  |  [92m[1m    184.4   [0m[0m  |            43.1           |  [34m[1m                     62.6                     [0m[0m  |  [92m[1m                              63.6                           [0m[0m  |  [34m[1m                     72.6                    [0m[0m
      2      x 768   |                   23.8                  |  [92m[1m    184.3   [0m[0m  |            42.5           |  [34m[1m                     63.1                     [0m[0m  |  [92m[1m                              63.0                           [0m[0m  |  [34m[1m                     70.5                    [0m[0m
      1      x 768   |  [92m[1m                 19.8                [0m[0m  |  [34m[1m    192.7   [0m[0m  |            42.4           |  [34m[1m                     63.0                     [0m[0m  |  [92m[1m                              63.0                           [0m[0m  |  [34m[1m                     73.6                    [0m[0m

Times are in microseconds (us).
