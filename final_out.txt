/home/user/condensed-sparsity/src/condensed_sparsity/v2/condensed_linear.py:142: UserWarning: Sparse CSR tensor support is in beta state. If you miss a functionality in the sparse tensor support, please submit a feature request to https://github.com/pytorch/pytorch/issues. (Triggered internally at ../aten/src/ATen/SparseCsrTensorImpl.cpp:54.)
  torch.clone(self.weight.detach().type(dtype).to_sparse_csr()),
Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
[2023-09-21 14:14:45,616] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:14:58,780] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:15:11,845] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:15:26,067] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:15:38,711] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:15:51,444] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:16:02,488] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:16:14,199] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:16:26,828] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:16:38,974] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:16:49,910] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:17:03,664] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:17:17,715] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:17:30,688] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:17:42,523] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:17:56,575] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:18:09,221] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:18:20,399] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:18:32,506] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:18:44,317] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:18:57,036] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:19:08,725] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
[--------------------------------------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  ---------------------------------------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  structured sparsity + sparse op @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      1024   x 768   |  [31m[1m                6140.8               [0m[0m  |  [31m[1m  348391.7  [0m[0m  |  [31m[1m        13825.3        [0m[0m  |  [31m[1m                    6678.0                    [0m[0m  |  [31m[1m                           66824.2                           [0m[0m  |  [31m[1m                         31466.5                          [0m[0m  |  [31m[1m                   13966.1                   [0m[0m
      512    x 768   |  [31m[1m                4600.5               [0m[0m  |  [31m[1m  185245.8  [0m[0m  |  [31m[1m         7684.2        [0m[0m  |  [31m[1m                    4694.7                    [0m[0m  |  [31m[1m                           27652.4                           [0m[0m  |  [31m[1m                         18133.1                          [0m[0m  |  [31m[1m                    7782.5                   [0m[0m
      256    x 768   |  [31m[1m                2669.0               [0m[0m  |  [31m[1m  103187.8  [0m[0m  |  [31m[1m         4959.0        [0m[0m  |  [31m[1m                    2924.4                    [0m[0m  |  [31m[1m                           14325.8                           [0m[0m  |  [31m[1m                         13629.6                          [0m[0m  |  [31m[1m                    4944.6                   [0m[0m
      128    x 768   |  [31m[1m                3502.6               [0m[0m  |  [31m[1m   44397.2  [0m[0m  |  [31m[1m         3335.5        [0m[0m  |  [31m[1m                    3613.9                    [0m[0m  |  [31m[1m                            7514.4                           [0m[0m  |  [31m[1m                          9600.1                          [0m[0m  |  [31m[1m                    3504.6                   [0m[0m
      64     x 768   |  [31m[1m                2970.3               [0m[0m  |  [31m[1m   17005.9  [0m[0m  |  [31m[1m         2266.3        [0m[0m  |  [31m[1m                    3241.9                    [0m[0m  |  [31m[1m                            3946.6                           [0m[0m  |  [31m[1m                          5672.0                          [0m[0m  |  [31m[1m                    2497.5                   [0m[0m
      32     x 768   |  [31m[1m                2918.9               [0m[0m  |  [31m[1m   13662.4  [0m[0m  |  [31m[1m         1766.7        [0m[0m  |  [31m[1m                    2985.2                    [0m[0m  |  [31m[1m                            2022.8                           [0m[0m  |  [31m[1m                          3479.5                          [0m[0m  |  [31m[1m                    1858.9                   [0m[0m
      16     x 768   |  [31m[1m                1870.5               [0m[0m  |  [31m[1m    7828.6  [0m[0m  |  [31m[1m         1495.3        [0m[0m  |  [31m[1m                    1952.0                    [0m[0m  |  [31m[1m                            1026.5                           [0m[0m  |  [2m[91m                          2008.3                          [0m[0m  |  [2m[91m                    1612.4                   [0m[0m
      8      x 768   |                   253.1                 |  [2m[91m    5196.4  [0m[0m  |            438.8          |                       410.8                      |  [2m[91m                             565.1                           [0m[0m  |  [2m[91m                          1243.9                          [0m[0m  |                       521.5                   
      4      x 768   |                   214.9                 |  [2m[91m    3304.3  [0m[0m  |            357.6          |  [34m[1m                     370.8                    [0m[0m  |  [2m[91m                             327.2                           [0m[0m  |                             889.6                            |                       424.7                   
      2      x 768   |  [34m[1m                 186.5               [0m[0m  |      2106.7    |  [34m[1m          265.9        [0m[0m  |  [92m[1m                     343.4                    [0m[0m  |                               203.8                             |                             710.0                            |  [34m[1m                     344.0                   [0m[0m
      1      x 768   |  [92m[1m                 177.4               [0m[0m  |  [92m[1m    1555.2  [0m[0m  |  [92m[1m          250.6        [0m[0m  |  [92m[1m                     346.2                    [0m[0m  |  [92m[1m                             136.2                           [0m[0m  |  [92m[1m                           609.9                          [0m[0m  |  [92m[1m                     324.8                   [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  ---------------------------------------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  structured sparsity + sparse op @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      1024   x 768   |  [31m[1m                6440.0               [0m[0m  |  [31m[1m  636036.3  [0m[0m  |  [31m[1m        13785.3        [0m[0m  |  [31m[1m                    6864.6                    [0m[0m  |  [31m[1m                           125731.0                          [0m[0m  |  [31m[1m                         58929.4                          [0m[0m  |  [31m[1m                   13770.0                   [0m[0m
      512    x 768   |  [31m[1m                4553.0               [0m[0m  |  [31m[1m  335388.9  [0m[0m  |  [31m[1m         7581.0        [0m[0m  |  [31m[1m                    5008.4                    [0m[0m  |  [31m[1m                            59785.9                          [0m[0m  |  [31m[1m                         31357.6                          [0m[0m  |  [31m[1m                    7702.8                   [0m[0m
      256    x 768   |  [31m[1m                2828.2               [0m[0m  |  [31m[1m  189833.0  [0m[0m  |  [31m[1m         4789.9        [0m[0m  |  [31m[1m                    3167.5                    [0m[0m  |  [31m[1m                            28468.6                          [0m[0m  |  [31m[1m                         19416.6                          [0m[0m  |  [31m[1m                    5146.5                   [0m[0m
      128    x 768   |  [31m[1m                3606.9               [0m[0m  |  [31m[1m  102297.8  [0m[0m  |  [31m[1m         3500.5        [0m[0m  |  [31m[1m                    3726.8                    [0m[0m  |  [31m[1m                            14552.4                          [0m[0m  |  [31m[1m                         13725.3                          [0m[0m  |  [31m[1m                    3602.8                   [0m[0m
      64     x 768   |  [31m[1m                2984.1               [0m[0m  |  [31m[1m   44216.9  [0m[0m  |  [31m[1m         2283.2        [0m[0m  |  [31m[1m                    3489.1                    [0m[0m  |  [31m[1m                             8174.4                          [0m[0m  |  [31m[1m                          9483.7                          [0m[0m  |  [31m[1m                    2469.9                   [0m[0m
      32     x 768   |  [31m[1m                3025.8               [0m[0m  |  [31m[1m   17903.0  [0m[0m  |  [31m[1m         1758.8        [0m[0m  |  [31m[1m                    3341.9                    [0m[0m  |  [31m[1m                             4049.5                          [0m[0m  |  [31m[1m                          5573.3                          [0m[0m  |  [31m[1m                    1859.8                   [0m[0m
      16     x 768   |  [31m[1m                2079.3               [0m[0m  |  [2m[91m   10018.1  [0m[0m  |  [31m[1m         1510.3        [0m[0m  |  [31m[1m                    1989.4                    [0m[0m  |  [31m[1m                             1885.7                          [0m[0m  |  [2m[91m                          3405.5                          [0m[0m  |  [31m[1m                    1641.7                   [0m[0m
      8      x 768   |                   259.3                 |  [2m[91m    7771.0  [0m[0m  |            441.0          |  [34m[1m                     351.2                    [0m[0m  |  [2m[91m                             1019.7                          [0m[0m  |  [2m[91m                          2069.2                          [0m[0m  |                       534.1                   
      4      x 768   |                   215.0                 |  [2m[91m    5182.1  [0m[0m  |            353.7          |                       388.7                      |  [2m[91m                              592.5                          [0m[0m  |                            1278.5                            |                       436.2                   
      2      x 768   |  [34m[1m                 189.0               [0m[0m  |      3259.4    |  [34m[1m          266.1        [0m[0m  |  [34m[1m                     361.3                    [0m[0m  |                                347.9                            |                             924.9                            |  [34m[1m                     343.1                   [0m[0m
      1      x 768   |  [92m[1m                 181.1               [0m[0m  |  [92m[1m    2167.7  [0m[0m  |  [92m[1m          254.8        [0m[0m  |  [92m[1m                     344.7                    [0m[0m  |  [92m[1m                              214.5                          [0m[0m  |  [92m[1m                           749.7                          [0m[0m  |  [92m[1m                     323.3                   [0m[0m

Times are in microseconds (us).
/home/user/build/.venv/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:90: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
[2023-09-21 14:19:23,870] torch._inductor.utils: [WARNING] not enough cuda cores to use max_autotune mode
[2023-09-21 14:19:29,957] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:19:45,490] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:20:00,906] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:20:16,649] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:20:33,224] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:20:49,360] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:21:05,754] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:21:24,988] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:21:45,448] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:22:09,859] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:22:30,219] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:22:45,342] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:22:59,019] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:23:14,558] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:23:30,193] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:23:44,444] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:23:59,994] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:24:15,712] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:24:31,295] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:24:48,117] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:25:04,259] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.
[2023-09-21 14:25:21,732] torch._dynamo.utils: [WARNING] Unsupported: meta converter nyi with fake tensor propagation.

Benchmarking batch size 1024 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 90 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1024 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 512 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 256 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 128 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 64 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 32 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 16 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 8 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 4 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 2 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
Benchmarking batch size 1 with sparsity 80 num_threads 32 with compiler inductor using backend inductor
[--------------------------------------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 90 with 32 threads  ---------------------------------------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 90 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 90 with backend inductor  |  Fine-grained + structured sparsity @ 90 with backend inductor  |  structured sparsity + sparse op @ 90 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      1024   x 768   |  [31m[1m                211.3                [0m[0m  |  [31m[1m  11969.9   [0m[0m  |  [31m[1m         535.1         [0m[0m  |  [2m[91m                    227.4                     [0m[0m  |  [31m[1m                            3114.3                           [0m[0m  |  [31m[1m                          4909.3                          [0m[0m  |  [31m[1m                    536.2                    [0m[0m
      512    x 768   |  [31m[1m                113.7                [0m[0m  |  [31m[1m   5993.8   [0m[0m  |  [31m[1m         259.6         [0m[0m  |  [2m[91m                    125.5                     [0m[0m  |  [31m[1m                            1576.2                           [0m[0m  |  [31m[1m                          2496.1                          [0m[0m  |  [2m[91m                    261.4                    [0m[0m
      256    x 768   |  [2m[91m                 75.1                [0m[0m  |  [31m[1m   3002.4   [0m[0m  |  [2m[91m         139.0         [0m[0m  |                       82.9                       |  [31m[1m                             800.1                           [0m[0m  |  [31m[1m                          1269.1                          [0m[0m  |  [2m[91m                    139.9                    [0m[0m
      128    x 768   |  [2m[91m                 43.8                [0m[0m  |  [31m[1m   1518.1   [0m[0m  |  [2m[91m          77.8         [0m[0m  |                       67.3                       |  [31m[1m                             413.4                           [0m[0m  |  [31m[1m                           646.5                          [0m[0m  |                       81.5                    
      64     x 768   |  [2m[91m                 47.9                [0m[0m  |  [2m[91m    768.2   [0m[0m  |            50.7           |  [34m[1m                     63.3                     [0m[0m  |  [2m[91m                             209.3                           [0m[0m  |  [2m[91m                           257.7                          [0m[0m  |  [92m[1m                     66.5                    [0m[0m
      32     x 768   |  [2m[91m                 42.2                [0m[0m  |  [2m[91m    391.7   [0m[0m  |  [34m[1m          41.5         [0m[0m  |  [34m[1m                     63.2                     [0m[0m  |                               118.1                             |  [2m[91m                           123.0                          [0m[0m  |  [34m[1m                     71.1                    [0m[0m
      16     x 768   |  [2m[91m                 46.3                [0m[0m  |      210.1     |  [34m[1m          39.9         [0m[0m  |  [34m[1m                     62.6                     [0m[0m  |  [34m[1m                              64.3                           [0m[0m  |                              81.0                            |  [34m[1m                     69.4                    [0m[0m
      8      x 768   |  [2m[91m                 47.3                [0m[0m  |  [92m[1m    184.0   [0m[0m  |            42.9           |  [34m[1m                     62.7                     [0m[0m  |  [34m[1m                              66.5                           [0m[0m  |  [34m[1m                            63.1                          [0m[0m  |  [34m[1m                     69.7                    [0m[0m
      4      x 768   |  [2m[91m                 45.1                [0m[0m  |  [92m[1m    184.6   [0m[0m  |  [92m[1m          38.6         [0m[0m  |  [34m[1m                     62.1                     [0m[0m  |  [92m[1m                              62.2                           [0m[0m  |  [92m[1m                            61.4                          [0m[0m  |  [34m[1m                     67.7                    [0m[0m
      2      x 768   |  [92m[1m                 19.9                [0m[0m  |  [92m[1m    184.9   [0m[0m  |  [92m[1m          38.9         [0m[0m  |  [92m[1m                     61.2                     [0m[0m  |  [34m[1m                              64.0                           [0m[0m  |  [92m[1m                            61.2                          [0m[0m  |  [34m[1m                     67.5                    [0m[0m
      1      x 768   |                   24.4                  |  [34m[1m    187.0   [0m[0m  |  [34m[1m          40.2         [0m[0m  |  [34m[1m                     62.0                     [0m[0m  |  [34m[1m                              63.4                           [0m[0m  |  [34m[1m                            63.0                          [0m[0m  |  [34m[1m                     68.3                    [0m[0m

Times are in microseconds (us).

[--------------------------------------------------------------------------------------------------------------------------------------------------- Condensed Linear @ 80 with 32 threads  ---------------------------------------------------------------------------------------------------------------------------------------------------]
                     |  Structured sparsity @ 80 - eager mode  |  Vmap - Eager  |  Dense benchmark - Eager  |  Structured sparsity @ 80 with backend inductor  |  Fine-grained + structured sparsity @ 80 with backend inductor  |  structured sparsity + sparse op @ 80 with backend inductor  |  Dense benchmark - Compiled - backend inductor
32 threads: ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      1024   x 768   |  [31m[1m                263.8                [0m[0m  |  [31m[1m  33330.9   [0m[0m  |  [31m[1m         599.8         [0m[0m  |  [2m[91m                    277.0                     [0m[0m  |  [31m[1m                            7632.6                           [0m[0m  |  [31m[1m                          9954.4                          [0m[0m  |  [31m[1m                    609.7                    [0m[0m
      512    x 768   |  [31m[1m                137.4                [0m[0m  |  [31m[1m  16685.6   [0m[0m  |  [31m[1m         286.0         [0m[0m  |  [2m[91m                    148.8                     [0m[0m  |  [31m[1m                            3784.2                           [0m[0m  |  [31m[1m                          5031.8                          [0m[0m  |  [2m[91m                    286.9                    [0m[0m
      256    x 768   |  [2m[91m                 82.7                [0m[0m  |  [31m[1m   8347.7   [0m[0m  |  [2m[91m         145.9         [0m[0m  |                       89.7                       |  [31m[1m                            1861.4                           [0m[0m  |  [31m[1m                          2533.3                          [0m[0m  |  [2m[91m                    146.2                    [0m[0m
      128    x 768   |  [2m[91m                 48.2                [0m[0m  |  [31m[1m   4186.1   [0m[0m  |  [2m[91m          81.4         [0m[0m  |  [34m[1m                     63.8                     [0m[0m  |  [31m[1m                             924.6                           [0m[0m  |  [31m[1m                          1276.5                          [0m[0m  |                       82.0                    
      64     x 768   |                   36.7                  |  [31m[1m   2102.6   [0m[0m  |            52.9           |  [34m[1m                     64.3                     [0m[0m  |  [31m[1m                             487.8                           [0m[0m  |  [31m[1m                           493.0                          [0m[0m  |  [34m[1m                     70.0                    [0m[0m
      32     x 768   |  [2m[91m                 42.6                [0m[0m  |  [31m[1m   1058.8   [0m[0m  |  [34m[1m          41.3         [0m[0m  |  [34m[1m                     64.7                     [0m[0m  |  [2m[91m                             243.0                           [0m[0m  |  [2m[91m                           250.3                          [0m[0m  |  [34m[1m                     71.2                    [0m[0m
      16     x 768   |  [2m[91m                 43.2                [0m[0m  |  [2m[91m    537.8   [0m[0m  |  [34m[1m          40.7         [0m[0m  |  [92m[1m                     62.7                     [0m[0m  |                               124.7                             |  [2m[91m                           165.4                          [0m[0m  |  [34m[1m                     71.9                    [0m[0m
      8      x 768   |  [2m[91m                 43.7                [0m[0m  |      277.1     |  [34m[1m          41.1         [0m[0m  |  [92m[1m                     62.5                     [0m[0m  |                                74.0                             |  [2m[91m                           127.1                          [0m[0m  |  [92m[1m                     69.6                    [0m[0m
      4      x 768   |  [2m[91m                 39.5                [0m[0m  |  [34m[1m    186.7   [0m[0m  |  [34m[1m          39.1         [0m[0m  |  [34m[1m                     63.4                     [0m[0m  |  [92m[1m                              63.6                           [0m[0m  |                             115.4                            |  [92m[1m                     69.0                    [0m[0m
      2      x 768   |  [92m[1m                 19.6                [0m[0m  |  [92m[1m    184.7   [0m[0m  |  [34m[1m          39.1         [0m[0m  |  [92m[1m                     62.9                     [0m[0m  |  [92m[1m                              63.3                           [0m[0m  |                             114.5                            |  [34m[1m                     70.3                    [0m[0m
      1      x 768   |                   24.5                  |  [92m[1m    183.2   [0m[0m  |  [92m[1m          38.3         [0m[0m  |  [34m[1m                     63.4                     [0m[0m  |  [34m[1m                              64.0                           [0m[0m  |  [92m[1m                            61.9                          [0m[0m  |  [92m[1m                     69.1                    [0m[0m

Times are in microseconds (us).
